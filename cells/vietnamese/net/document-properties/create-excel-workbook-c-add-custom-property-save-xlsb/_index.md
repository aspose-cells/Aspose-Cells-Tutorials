---
category: general
date: 2026-02-15
description: H∆∞·ªõng d·∫´n t·∫°o workbook Excel b·∫±ng C# cho th·∫•y c√°ch th√™m thu·ªôc t√≠nh t√πy
  ch·ªânh, l∆∞u workbook d∆∞·ªõi d·∫°ng XLSB v√† l·∫•y gi√° tr·ªã thu·ªôc t√≠nh‚Äît·∫•t c·∫£ trong v√†i d√≤ng
  m√£.
draft: false
keywords:
- create excel workbook c#
- save workbook as xlsb
- retrieve custom property value
- add custom property excel
language: vi
og_description: T·∫°o workbook Excel b·∫±ng C# t·ª´ng b∆∞·ªõc. H·ªçc c√°ch th√™m thu·ªôc t√≠nh t√πy
  ch·ªânh, l∆∞u workbook d∆∞·ªõi d·∫°ng XLSB v√† l·∫•y gi√° tr·ªã thu·ªôc t√≠nh v·ªõi c√°c v√≠ d·ª• m√£ r√µ
  r√†ng.
og_title: T·∫°o Workbook Excel b·∫±ng C# ‚Äì Th√™m Thu·ªôc t√≠nh T√πy ch·ªânh & L∆∞u d∆∞·ªõi d·∫°ng XLSB
tags:
- Aspose.Cells
- C#
- Excel Automation
title: T·∫°o Workbook Excel b·∫±ng C# ‚Äì Th√™m Thu·ªôc t√≠nh T√πy ch·ªânh & L∆∞u d∆∞·ªõi d·∫°ng XLSB
url: /vi/net/document-properties/create-excel-workbook-c-add-custom-property-save-xlsb/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# T·∫°o Workbook Excel C# ‚Äì Th√™m Thu·ªôc t√≠nh T√πy ch·ªânh & L∆∞u XLSB

C·∫ßn **t·∫°o workbook Excel C#** v√† nh√∫ng m·ªôt s·ªë si√™u d·ªØ li·ªáu t√πy ch·ªânh? Trong h∆∞·ªõng d·∫´n n√†y, ch√∫ng t√¥i s·∫Ω h∆∞·ªõng d·∫´n c√°ch th√™m m·ªôt thu·ªôc t√≠nh t√πy ch·ªânh, **l∆∞u workbook d∆∞·ªõi d·∫°ng XLSB**, v√† sau ƒë√≥ **l·∫•y l·∫°i gi√° tr·ªã thu·ªôc t√≠nh t√πy ch·ªânh**‚Äît·∫•t c·∫£ b·∫±ng m√£ ng·∫Øn g·ªçn, s·∫µn s√†ng ch·∫°y.  

N·∫øu b·∫°n t·ª´ng t·ª± h·ªèi t·∫°i sao m·ªôt b·∫£ng t√≠nh l·∫°i c·∫ßn d·ªØ li·ªáu b·ªï sung m√† kh√¥ng hi·ªÉn th·ªã trong c√°c √¥, b·∫°n ƒëang ·ªü ƒë√∫ng ch·ªó. H√£y nghƒ© v·ªÅ c√°c thu·ªôc t√≠nh t√πy ch·ªânh nh∆∞ nh·ªØng ghi ch√∫ ·∫©n ƒëi c√πng v·ªõi t·ªáp, ho√†n h·∫£o ƒë·ªÉ li√™n k·∫øt m·ªôt workbook v·ªõi ID d·ª± √°n, th·∫ª phi√™n b·∫£n, ho·∫∑c b·∫•t k·ª≥ kh√≥a kinh doanh n√†o.

## Nh·ªØng g√¨ b·∫°n s·∫Ω h·ªçc

- C√°ch kh·ªüi t·∫°o m·ªôt workbook m·ªõi b·∫±ng Aspose.Cells cho .NET.  
- C√°c b∆∞·ªõc ch√≠nh x√°c ƒë·ªÉ **th√™m thu·ªôc t√≠nh t√πy ch·ªânh excel** theo ki·ªÉu, s·ª≠ d·ª•ng b·ªô s∆∞u t·∫≠p `CustomProperties`.  
- L∆∞u workbook ·ªü ƒë·ªãnh d·∫°ng nh·ªã ph√¢n n√©n XLSB.  
- T·∫£i l·∫°i t·ªáp v√† l·∫•y l·∫°i thu·ªôc t√≠nh ƒë√£ l∆∞u.  

Kh√¥ng c·∫ßn t·ªáp c·∫•u h√¨nh b√™n ngo√†i, kh√¥ng c√≥ th·ªß thu·∫≠t ph·ª©c t·∫°p‚Äîch·ªâ l√† C# thu·∫ßn t√∫y m√† b·∫°n c√≥ th·ªÉ d√°n v√†o m·ªôt ·ª©ng d·ª•ng console v√† xem n√≥ ho·∫°t ƒë·ªông. Y√™u c·∫ßu duy nh·∫•t l√† tham chi·∫øu t·ªõi th∆∞ vi·ªán Aspose.Cells (b·∫£n d√πng th·ª≠ mi·ªÖn ph√≠ ho·∫∑c phi√™n b·∫£n c√≥ gi·∫•y ph√©p).  

T·∫°i sao l·∫°i quan t√¢m? B·ªüi v√¨ vi·ªác nh√∫ng ID tr·ª±c ti·∫øp v√†o t·ªáp lo·∫°i b·ªè nhu c·∫ßu tra c·ª©u c∆° s·ªü d·ªØ li·ªáu ri√™ng khi b·∫°n m·ªü workbook sau n√†y. ƒê√≥ l√† m·ªôt th√≥i quen nh·ªè c√≥ th·ªÉ ti·∫øt ki·ªám h√†ng gi·ªù g·ª° l·ªói trong c√°c gi·∫£i ph√°p b√°o c√°o quy m√¥ l·ªõn.

![t·∫°o workbook excel c# v√≠ d·ª•](https://example.com/images/create-excel-workbook-csharp.png "t·∫°o workbook excel c# v√≠ d·ª•")

*H√¨nh ·∫£nh hi·ªÉn th·ªã m·ªôt d·ª± √°n console C# t·ªëi thi·ªÉu t·∫°o m·ªôt workbook Excel, th√™m m·ªôt thu·ªôc t√≠nh t√πy ch·ªânh v√† l∆∞u n√≥ d∆∞·ªõi d·∫°ng XLSB.*

## B∆∞·ªõc 1: Kh·ªüi t·∫°o Workbook & Th√™m Thu·ªôc t√≠nh T√πy ch·ªânh

ƒêi·ªÅu ƒë·∫ßu ti√™n b·∫°n c·∫ßn l√† m·ªôt ƒë·ªëi t∆∞·ª£ng `Workbook` m·ªõi. Khi ƒë√£ c√≥, b·ªô s∆∞u t·∫≠p `Worksheets[0].CustomProperties` cung c·∫•p cho b·∫°n m·ªôt n∆°i s·∫°ch s·∫Ω ƒë·ªÉ l∆∞u c√°c c·∫∑p kh√≥a/gi√° tr·ªã.

```csharp
using Aspose.Cells;

namespace ExcelCustomPropDemo
{
    class Program
    {
        static void Main(string[] args)
        {
            // Step 1 ‚Äì Create a new workbook instance
            Workbook workbook = new Workbook();

            // Step 2 ‚Äì Add a custom property named "ProjectId" with a numeric value
            // This is the "add custom property excel" part of the tutorial.
            workbook.Worksheets[0].CustomProperties.Add("ProjectId", 12345);
```

**T·∫°i sao ƒëi·ªÅu n√†y quan tr·ªçng:**  
- `Workbook()` t·∫°o ra m·ªôt bi·ªÉu di·ªÖn trong b·ªô nh·ªõ c·ªßa t·ªáp Excel, ch∆∞a c√≥ I/O ƒëƒ©a.  
- Th√™m thu·ªôc t√≠nh v√†o *worksheet* *ƒë·∫ßu ti√™n* (ch·ªâ s·ªë‚ÄØ0) ƒë·∫£m b·∫£o n√≥ ƒë∆∞·ª£c l∆∞u ·ªü m·ª©c workbook, gi√∫p truy c·∫≠p ƒë∆∞·ª£c b·∫•t k·ªÉ ng∆∞·ªùi d√πng xem sheet n√†o.  

> **M·∫πo:** Thu·ªôc t√≠nh t√πy ch·ªânh c√≥ th·ªÉ ch·ª©a chu·ªói, s·ªë, ng√†y th√°ng, ho·∫∑c th·∫≠m ch√≠ gi√° tr·ªã Boolean. Ch·ªçn ki·ªÉu ph√π h·ª£p nh·∫•t v·ªõi d·ªØ li·ªáu b·∫°n mu·ªën l∆∞u.

## B∆∞·ªõc 2: L∆∞u Workbook d∆∞·ªõi d·∫°ng XLSB

XLSB (Excel Binary Workbook) l√† ƒë·ªãnh d·∫°ng g·ªçn g√†ng, t·∫£i nhanh‚Äîl√Ω t∆∞·ªüng cho c√°c b·ªô d·ªØ li·ªáu l·ªõn. Ph∆∞∆°ng th·ª©c `Save` nh·∫≠n m·ªôt ƒë∆∞·ªùng d·∫´n t·ªáp v√† m·ªôt enum `SaveFormat`.

```csharp
            // Step 3 ‚Äì Save the workbook to disk in XLSB format
            string outputPath = @"C:\Temp\CustomProp.xlsb";
            workbook.Save(outputPath, SaveFormat.Xlsb);

            // At this point the file on disk already contains the custom property.
```

**T·∫°i sao d√πng XLSB?**  
- N√≥ gi·∫£m k√≠ch th∆∞·ªõc t·ªáp l√™n t·ªõi 70‚ÄØ% so v·ªõi XLSX truy·ªÅn th·ªëng.  
- L∆∞u tr·ªØ nh·ªã ph√¢n tƒÉng t·ªëc c·∫£ thao t√°c ghi v√† ƒë·ªçc, r·∫•t h·ªØu √≠ch cho t·ª± ƒë·ªông ho√° ph√≠a m√°y ch·ªß.

## B∆∞·ªõc 3: T·∫£i l·∫°i Workbook ƒë√£ l∆∞u v√† L·∫•y l·∫°i Thu·ªôc t√≠nh

B√¢y gi·ªù ch√∫ng ta ƒë·∫£o ng∆∞·ª£c k·ªãch b·∫£n: m·ªü t·ªáp v·ª´a ghi v√† l·∫•y l·∫°i gi√° tr·ªã ·∫©n. ƒêi·ªÅu n√†y ch·ª©ng minh thu·ªôc t√≠nh ƒë√£ t·ªìn t·∫°i qua v√≤ng quay.

```csharp
            // Step 4 ‚Äì Load the workbook we just saved
            Workbook loadedWorkbook = new Workbook(outputPath);

            // Step 5 ‚Äì Retrieve the value of the "ProjectId" custom property
            object projectIdValue = loadedWorkbook.Worksheets[0]
                                                .CustomProperties["ProjectId"]
                                                .Value;

            // Display the retrieved value
            System.Console.WriteLine($"Retrieved ProjectId: {projectIdValue}");
        }
    }
}
```

**B·∫°n s·∫Ω th·∫•y:**  
```
Retrieved ProjectId: 12345
```

N·∫øu t√™n thu·ªôc t√≠nh b·ªã vi·∫øt sai ho·∫∑c kh√¥ng t·ªìn t·∫°i, b·ªô ch·ªâ m·ª•c `CustomProperties` s·∫Ω n√©m ra `KeyNotFoundException`. M·ªôt c√°ch ph√≤ng ng·ª´a s·∫Ω l√†:

```csharp
if (loadedWorkbook.Worksheets[0].CustomProperties.Contains("ProjectId"))
{
    // safe to read
}
```

## V√≠ d·ª• Ho·∫°t ƒë·ªông ƒê·∫ßy ƒë·ªß (T·∫•t c·∫£ C√°c B∆∞·ªõc K·∫øt H·ª£p)

D∆∞·ªõi ƒë√¢y l√† ch∆∞∆°ng tr√¨nh ho√†n ch·ªânh, s·∫µn s√†ng sao ch√©p‚Äëd√°n v√†o m·ªôt d·ª± √°n console m·ªõi. Kh√¥ng c·∫ßn c·∫•u tr√∫c ph·ª• tr·ª£ n√†o.

```csharp
using Aspose.Cells;
using System;

namespace ExcelCustomPropDemo
{
    class Program
    {
        static void Main(string[] args)
        {
            // 1Ô∏è‚É£ Create a new workbook
            Workbook workbook = new Workbook();

            // 2Ô∏è‚É£ Add a custom property named "ProjectId" (add custom property excel)
            workbook.Worksheets[0].CustomProperties.Add("ProjectId", 12345);

            // 3Ô∏è‚É£ Save the workbook as XLSB (save workbook as xlsb)
            string filePath = @"C:\Temp\CustomProp.xlsb";
            workbook.Save(filePath, SaveFormat.Xlsb);

            // 4Ô∏è‚É£ Load the saved workbook back into memory
            Workbook loaded = new Workbook(filePath);

            // 5Ô∏è‚É£ Retrieve the custom property value (retrieve custom property value)
            object retrieved = loaded.Worksheets[0].CustomProperties["ProjectId"].Value;
            Console.WriteLine($"Retrieved ProjectId: {retrieved}");
        }
    }
}
```

Ch·∫°y ch∆∞∆°ng tr√¨nh, m·ªü `C:\Temp\CustomProp.xlsb` trong Excel, v√† b·∫°n s·∫Ω kh√¥ng th·∫•y g√¨ b·∫•t th∆∞·ªùng tr√™n b·ªÅ m·∫∑t‚Äîv√¨ c√°c thu·ªôc t√≠nh t√πy ch·ªânh ƒë∆∞·ª£c ·∫©n theo thi·∫øt k·∫ø. Tuy nhi√™n d·ªØ li·ªáu v·∫´n t·ªìn t·∫°i, s·∫µn s√†ng cho b·∫•t k·ª≥ quy tr√¨nh downstream n√†o.

## C√°c Tr∆∞·ªùng h·ª£p C·∫°nh & Bi·∫øn th·ªÉ

| T√¨nh hu·ªëng | C·∫ßn ƒêi·ªÅu ch·ªânh |
|-----------|----------------|
| **Nhi·ªÅu worksheet** | Th√™m thu·ªôc t√≠nh v√†o b·∫•t k·ª≥ sheet n√†o; n√≥ s·∫Ω ƒë∆∞·ª£c sao ch√©p ·ªü m·ª©c workbook. |
| **Thu·ªôc t√≠nh chu·ªói** | `CustomProperties.Add("Status", "Approved")` ‚Äì ho·∫°t ƒë·ªông t∆∞∆°ng t·ª±. |
| **Thu·ªôc t√≠nh thi·∫øu** | S·ª≠ d·ª•ng `Contains` tr∆∞·ªõc khi truy c·∫≠p ƒë·ªÉ tr√°nh ngo·∫°i l·ªá. |
| **ID s·ªë l·ªõn** | L∆∞u ch√∫ng d∆∞·ªõi d·∫°ng `long` ho·∫∑c `string` ƒë·ªÉ tr√°nh tr√†n. |
| **ƒêa n·ªÅn t·∫£ng** | Aspose.Cells ho·∫°t ƒë·ªông tr√™n .NET‚ÄØCore, .NET‚ÄØFramework, v√† th·∫≠m ch√≠ Mono, v√¨ v·∫≠y c√πng m·ªôt m√£ ch·∫°y tr√™n container Linux. |

## C√¢u h·ªèi Th∆∞·ªùng g·∫∑p

**H: C√¥ng c·ª• n√†y c√≥ ho·∫°t ƒë·ªông v·ªõi b·∫£n d√πng th·ª≠ mi·ªÖn ph√≠ c·ªßa Aspose.Cells kh√¥ng?**  
ƒê: C√≥. B·∫£n d√πng th·ª≠ ho√†n to√†n h·ªó tr·ª£ `CustomProperties` v√† l∆∞u XLSB; ch·ªâ c·∫ßn nh·ªõ watermark tr√™n t·ªáp ƒë·∫ßu ra.

**H: T√¥i c√≥ th·ªÉ xem c√°c thu·ªôc t√≠nh t√πy ch·ªânh trong Excel kh√¥ng?**  
ƒê: Trong Excel, v√†o *File ‚Üí Info ‚Üí Properties ‚Üí Advanced Properties ‚Üí Custom*. ‚ÄúProjectId‚Äù c·ªßa b·∫°n s·∫Ω ƒë∆∞·ª£c li·ªát k√™ ·ªü ƒë√≥.

**H: N·∫øu t√¥i c·∫ßn x√≥a m·ªôt thu·ªôc t√≠nh th√¨ sao?**  
ƒê: G·ªçi `CustomProperties.Remove("ProjectId")` tr∆∞·ªõc khi l∆∞u.

## T·ªïng k·∫øt

B√¢y gi·ªù b·∫°n ƒë√£ bi·∫øt c√°ch **t·∫°o workbook Excel C#**, nh√∫ng m·ªôt thu·ªôc t√≠nh t√πy ch·ªânh, **l∆∞u workbook d∆∞·ªõi d·∫°ng XLSB**, v√† sau ƒë√≥ **l·∫•y l·∫°i gi√° tr·ªã thu·ªôc t√≠nh t√πy ch·ªânh**. To√†n b·ªô quy tr√¨nh g√≥i g·ªçn trong m·ªôt ph∆∞∆°ng th·ª©c duy nh·∫•t, gi√∫p d·ªÖ d√†ng t√≠ch h·ª£p v√†o c√°c pipeline b√°o c√°o l·ªõn h∆°n ho·∫∑c d·ªãch v·ª• t·∫°o t√†i li·ªáu.

### Ti·∫øp theo l√† g√¨?

- Kh√°m ph√° **th√™m nhi·ªÅu thu·ªôc t√≠nh t√πy ch·ªânh** cho vi·ªác phi√™n b·∫£n, t√°c gi·∫£, ho·∫∑c m√£ ph√≤ng ban.  
- K·∫øt h·ª£p k·ªπ thu·∫≠t n√†y v·ªõi **d·ªØ li·ªáu c·∫•p √¥** ƒë·ªÉ x√¢y d·ª±ng b√°o c√°o t·ª± m√¥ t·∫£.  
- T√¨m hi·ªÉu **ƒë·ªçc thu·ªôc t√≠nh t√πy ch·ªânh** t·ª´ c√°c t·ªáp XLSX c·ªßa b√™n th·ª© ba hi·ªán c√≥‚ÄîAspose.Cells c≈©ng h·ªó tr·ª£.

B·∫°n c√≥ th·ªÉ t·ª± do ch·ªânh s·ª≠a v√≠ d·ª•, thay ƒë·ªïi ID s·ªë b·∫±ng GUID, ho·∫∑c th·ª≠ nghi·ªám v·ªõi c√°c ƒë·ªãnh d·∫°ng t·ªáp kh√°c nhau. API r·∫•t ƒë∆°n gi·∫£n; s·ª©c m·∫°nh th·ª±c s·ª± ƒë·∫øn t·ª´ c√°ch b·∫°n s·ª≠ d·ª•ng si√™u d·ªØ li·ªáu ·∫©n trong logic kinh doanh c·ªßa m√¨nh.

Ch√∫c l·∫≠p tr√¨nh vui! üöÄ

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}