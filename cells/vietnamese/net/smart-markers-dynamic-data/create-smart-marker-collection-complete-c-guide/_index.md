---
category: general
date: 2026-02-23
description: T·∫°o b·ªô s∆∞u t·∫≠p smart marker trong C# v·ªõi Aspose.Cells. T√¨m hi·ªÉu c√°ch
  th√™m marker, b√¨nh lu·∫≠n v√† √°p d·ª•ng ch√∫ng v√†o b·∫£ng t√≠nh ch·ªâ trong v√†i b∆∞·ªõc.
draft: false
keywords:
- create smart marker collection
- smart markers
- marker collection
- Aspose.Cells
- worksheet smart markers
language: vi
og_description: T·∫°o b·ªô s∆∞u t·∫≠p smart marker trong C# v·ªõi Aspose.Cells. H∆∞·ªõng d·∫´n n√†y
  cho b·∫°n bi·∫øt c√°ch th√™m marker, b√¨nh lu·∫≠n v√† √°p d·ª•ng ch√∫ng v√†o m·ªôt b·∫£ng t√≠nh.
og_title: T·∫°o b·ªô s∆∞u t·∫≠p marker th√¥ng minh ‚Äì H∆∞·ªõng d·∫´n C# ƒë·∫ßy ƒë·ªß
tags:
- Aspose.Cells
- C#
- SmartMarkers
title: T·∫°o b·ªô s∆∞u t·∫≠p marker th√¥ng minh ‚Äì H∆∞·ªõng d·∫´n C# to√†n di·ªán
url: /vi/net/smart-markers-dynamic-data/create-smart-marker-collection-complete-c-guide/
---

, SDK, class names). "smart marker collection" is a concept; we could keep it English. So we should not translate that phrase. So keep "smart marker collection". The rest of the sentence translate.

Thus when translating, keep "smart marker collection" unchanged.

Similarly "SmartMarkers", "MarkerCollection", etc remain.

Now produce final content.

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# T·∫°o b·ªô s∆∞u t·∫≠p smart marker ‚Äì H∆∞·ªõng d·∫´n ƒë·∫ßy ƒë·ªß C#

B·∫°n ƒë√£ bao gi·ªù c·∫ßn **t·∫°o b·ªô s∆∞u t·∫≠p smart marker** trong m·ªôt b·∫£ng t√≠nh nh∆∞ng kh√¥ng bi·∫øt b·∫Øt ƒë·∫ßu t·ª´ ƒë√¢u ch∆∞a? B·∫°n kh√¥ng c√¥ ƒë∆°n; nhi·ªÅu nh√† ph√°t tri·ªÉn g·∫∑p c√πng m·ªôt r√†o c·∫£n khi l·∫ßn ƒë·∫ßu l√†m vi·ªác v·ªõi t√≠nh nƒÉng SmartMarkers c·ªßa Aspose.Cells. Tin t·ªët l√† g√¨? N√≥ kh√° ƒë∆°n gi·∫£n m·ªôt khi b·∫°n n·∫Øm ƒë∆∞·ª£c m·∫´u, v√† t√¥i s·∫Ω h∆∞·ªõng d·∫´n b·∫°n t·ª´ng b∆∞·ªõc.

Trong tutorial n√†y, b·∫°n s·∫Ω h·ªçc c√°ch kh·ªüi t·∫°o m·ªôt `MarkerCollection`, ƒë∆∞a c√°c marker d·ªØ li·ªáu v√† comment v√†o, g·∫Øn n√≥ v√†o **SmartMarkers** c·ªßa m·ªôt worksheet, v√† cu·ªëi c√πng g·ªçi ph∆∞∆°ng th·ª©c `Apply()` ƒë·ªÉ m·ªçi th·ª© ƒë∆∞·ª£c render ƒë√∫ng. Kh√¥ng c·∫ßn t√†i li·ªáu b√™n ngo√†i‚Äîch·ªâ c·∫ßn m√£ C# c√≥ th·ªÉ ch·∫°y v√† m·ªôt v√†i gi·∫£i th√≠ch v·ªÅ ‚Äút·∫°i sao‚Äù m·ªói d√≤ng l·∫°i nh∆∞ v·∫≠y.

## Nh·ªØng g√¨ b·∫°n s·∫Ω nh·∫≠n ƒë∆∞·ª£c

- M·ªôt **b·ªô s∆∞u t·∫≠p marker** ho·∫°t ƒë·ªông, c√≥ th·ªÉ t√°i s·ª≠ d·ª•ng tr√™n nhi·ªÅu worksheet.  
- Ki·∫øn th·ª©c v·ªÅ c√°ch **smart markers** t∆∞∆°ng t√°c v·ªõi c√°c ƒë·ªëi t∆∞·ª£ng c·ªßa Aspose.Cells.  
- M·∫πo x·ª≠ l√Ω kh√≥a tr√πng l·∫∑p, c√¢n nh·∫Øc hi·ªáu nƒÉng, v√† c√°c l·ªói th∆∞·ªùng g·∫∑p.  
- M·ªôt v√≠ d·ª• ho√†n ch·ªânh, sao ch√©p‚Äëd√°n, b·∫°n c√≥ th·ªÉ ƒë∆∞a v√†o b·∫•t k·ª≥ d·ª± √°n .NET n√†o ƒë√£ tham chi·∫øu Aspose.Cells.

**Y√™u c·∫ßu tr∆∞·ªõc:**  
- .NET‚ÄØ6 (ho·∫∑c b·∫•t k·ª≥ phi√™n b·∫£n .NET m·ªõi n√†o) ƒë√£ c√†i ƒë·∫∑t Aspose.Cells for .NET.  
- Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ c√∫ ph√°p C# v√† c√°c kh√°i ni·ªám h∆∞·ªõng ƒë·ªëi t∆∞·ª£ng.  
- M·ªôt instance `Worksheet` ƒë√£ t·ªìn t·∫°i m√† b·∫°n mu·ªën ƒëi·ªÅn d·ªØ li·ªáu ‚Äì ch√∫ng t√¥i s·∫Ω gi·∫£ ƒë·ªãnh b·∫°n ƒë√£ t·∫£i ho·∫∑c t·∫°o workbook.

N·∫øu b·∫°n t·ª± h·ªèi *t·∫°i sao l·∫°i c·∫ßn m·ªôt b·ªô s∆∞u t·∫≠p smart marker*, h√£y nghƒ© n√≥ nh∆∞ m·ªôt t·ª´ ƒëi·ªÉn nh·∫π gi√∫p ch√®n n·ªôi dung ƒë·ªông m√† kh√¥ng c·∫ßn m√£ c·ª©ng ƒë·ªãa ch·ªâ √¥. N√≥ ƒë·∫∑c bi·ªát h·ªØu √≠ch cho c√°c b√°o c√°o m·∫´u, ho√° ƒë∆°n ki·ªÉu mail‚Äëmerge, ho·∫∑c b·∫•t k·ª≥ k·ªãch b·∫£n n√†o m√† c√πng m·ªôt b·ªë c·ª•c ƒë∆∞·ª£c l·∫•p ƒë·∫ßy b·∫±ng c√°c b·ªô d·ªØ li·ªáu kh√°c nhau.

---

## B∆∞·ªõc 1: C√°ch **Create Smart Marker Collection** trong C#

ƒêi·ªÅu ƒë·∫ßu ti√™n b·∫°n c·∫ßn l√† m·ªôt container r·ªóng ƒë·ªÉ ch·ª©a t·∫•t c·∫£ c√°c marker. Aspose.Cells cung c·∫•p l·ªõp `MarkerCollection` cho m·ª•c ƒë√≠ch n√†y.

```csharp
// Step 1: Initialize a fresh MarkerCollection instance
MarkerCollection markerCollection = new MarkerCollection();
```

> **T·∫°i sao ƒëi·ªÅu n√†y quan tr·ªçng:**  
> `MarkerCollection` ho·∫°t ƒë·ªông nh∆∞ m·ªôt b·∫£n ƒë·ªì, m·ªói kh√≥a t∆∞∆°ng ·ª©ng v·ªõi m·ªôt placeholder trong m·∫´u Excel c·ªßa b·∫°n. Khi t·∫°o n√≥ s·ªõm, b·∫°n gi·ªØ cho code g·ªçn g√†ng v√† tr√°nh vi·ªác ƒë·ªãnh nghƒ©a marker r·∫£i r√°c kh·∫Øp logic.

### M·∫πo chuy√™n nghi·ªáp
N·∫øu b·∫°n d·ª± ƒë·ªãnh t√°i s·ª≠ d·ª•ng c√πng m·ªôt collection tr√™n nhi·ªÅu worksheet, h√£y c√¢n nh·∫Øc clone n√≥ (`markerCollection.Clone()`) thay v√¨ x√¢y d·ª±ng l·∫°i t·ª´ ƒë·∫ßu m·ªói l·∫ßn. ƒêi·ªÅu n√†y c√≥ th·ªÉ gi·∫£m v√†i mili gi√¢y cho c√°c batch job l·ªõn.

---

## B∆∞·ªõc 2: Th√™m Data Markers v√† Comments

B√¢y gi·ªù collection ƒë√£ t·ªìn t·∫°i, b·∫°n c√≥ th·ªÉ b·∫Øt ƒë·∫ßu ƒë∆∞a c√°c data marker v√†o. V√≠ d·ª• d∆∞·ªõi ƒë√¢y th√™m m·ªôt marker gi√° tr·ªã ƒë∆°n gi·∫£n (`A1`) v√† m·ªôt comment marker (`A1.Comment`). Comment marker cho th·∫•y **smart markers** c√≥ th·ªÉ x·ª≠ l√Ω d·ªØ li·ªáu ph·ª• nh∆∞ ghi ch√∫ ho·∫∑c ch√¢n trang.

```csharp
// Step 2: Add a data marker and an associated comment marker
markerCollection.Add("A1", "Value");                 // Replaces ${A1} in the template
markerCollection.Add("A1.Comment", "This is a comment"); // Replaces ${A1.Comment}
```

> **T·∫°i sao ch√∫ng ta th√™m comment:**  
> Nhi·ªÅu k·ªãch b·∫£n b√°o c√°o c·∫ßn m·ªôt ghi ch√∫ c√≥ th·ªÉ ƒë·ªçc ƒë∆∞·ª£c b·ªüi con ng∆∞·ªùi b√™n c·∫°nh gi√° tr·ªã. B·∫±ng c√°ch s·ª≠ d·ª•ng h·∫≠u t·ªë `.Comment` b·∫°n gi·ªØ d·ªØ li·ªáu v√† ch√∫ th√≠ch g·∫Øn li·ªÅn, gi√∫p sheet cu·ªëi c√πng d·ªÖ ƒë·ªçc h∆°n.

### Tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát
N·∫øu b·∫°n v√¥ t√¨nh th√™m c√πng m·ªôt kh√≥a hai l·∫ßn, l·ªùi g·ªçi sau s·∫Ω ghi ƒë√® l√™n l·ªùi g·ªçi tr∆∞·ªõc. ƒê·ªÉ tr√°nh m·∫•t d·ªØ li·ªáu im l·∫∑ng, b·∫°n c√≥ th·ªÉ ki·ªÉm tra s·ª± t·ªìn t·∫°i tr∆∞·ªõc:

```csharp
if (!markerCollection.ContainsKey("A1"))
{
    markerCollection.Add("A1", "Value");
}
```

---

## B∆∞·ªõc 3: G·∫Øn Collection v√†o **Worksheet SmartMarkers**

Sau khi ƒë√£ ƒë·ªãnh nghƒ©a c√°c marker, b∆∞·ªõc ti·∫øp theo l√† g·∫Øn collection v√†o thu·ªôc t√≠nh `SmartMarkers` c·ªßa worksheet. ƒêi·ªÅu n√†y cho Aspose.Cells bi·∫øt n∆°i t√¨m ki·∫øm khi x·ª≠ l√Ω m·∫´u.

```csharp
// Step 3: Link the collection to the worksheet's SmartMarkers collection
worksheet.SmartMarkers.Add(markerCollection);
```

> **T·∫°i sao c√°ch n√†y ho·∫°t ƒë·ªông:**  
> `worksheet.SmartMarkers` t·ª± n√≥ l√† m·ªôt collection c√≥ th·ªÉ ch·ª©a nhi·ªÅu ƒë·ªëi t∆∞·ª£ng `MarkerCollection`. Khi b·∫°n th√™m collection c·ªßa m√¨nh, engine s·∫Ω thay th·∫ø m·ªçi placeholder `${...}` trong sheet b·∫±ng c√°c gi√° tr·ªã b·∫°n cung c·∫•p.

### M·∫πo th·ª±c t·∫ø
B·∫°n c√≥ th·ªÉ g·∫Øn nhi·ªÅu ƒë·ªëi t∆∞·ª£ng `MarkerCollection` v√†o c√πng m·ªôt worksheet‚Äîh·ªØu √≠ch khi c√°c module kh√°c nhau t·∫°o ra c√°c b·ªô d·ªØ li·ªáu ri√™ng (v√≠ d·ª•: header vs. body). Engine s·∫Ω h·ª£p nh·∫•t ch√∫ng theo th·ª© t·ª± ƒë∆∞·ª£c th√™m.

---

## B∆∞·ªõc 4: √Åp d·ª•ng Smart Markers ƒë·ªÉ X·ª≠ l√Ω Worksheet

H√†nh ƒë·ªông cu·ªëi c√πng l√† g·ªçi `Apply()`. Ph∆∞∆°ng th·ª©c n√†y duy·ªát qua sheet, t√¨m m·ªçi placeholder `${key}`, v√† thay th·∫ø b·∫±ng gi√° tr·ªã t∆∞∆°ng ·ª©ng t·ª´ collection c·ªßa b·∫°n.

```csharp
// Step 4: Execute the smart marker processing
worksheet.SmartMarkers.Apply();
```

> **ƒêi·ªÅu g√¨ x·∫£y ra ph√≠a sau:**  
> Aspose.Cells ph√¢n t√≠ch c√¥ng th·ª©c √¥, x√°c ƒë·ªãnh c√°c token `${}`, tra c·ª©u ch√∫ng trong c√°c collection ƒë√£ g·∫Øn, v√† ghi gi√° tr·ªã ƒë√£ gi·∫£i quy·∫øt tr·ªü l·∫°i c√°c √¥‚Äît·∫•t c·∫£ trong b·ªô nh·ªõ. Kh√¥ng c√≥ I/O file n√†o ƒë∆∞·ª£c th·ª±c hi·ªán tr·ª´ khi b·∫°n l∆∞u workbook m·ªôt c√°ch r√µ r√†ng sau ƒë√≥.

### L∆∞u √Ω v·ªÅ hi·ªáu nƒÉng
G·ªçi `Apply()` m·ªôt l·∫ßn sau khi ƒë√£ th√™m t·∫•t c·∫£ marker s·∫Ω hi·ªáu qu·∫£ h∆°n r·∫•t nhi·ªÅu so v·ªõi vi·ªác g·ªçi sau m·ªói l·∫ßn th√™m. X·ª≠ l√Ω batch gi·∫£m s·ªë l·∫ßn duy·ªát worksheet.

---

## B∆∞·ªõc 5: Ki·ªÉm tra K·∫øt qu·∫£ (B·∫°n s·∫Ω th·∫•y g√¨)

Sau l·ªùi g·ªçi `Apply()`, worksheet s·∫Ω ch·ª©a c√°c gi√° tr·ªã nguy√™n vƒÉn b·∫°n ƒë√£ ch√®n. N·∫øu m·ªü workbook trong Excel, b·∫°n s·∫Ω th·∫•y:

| A | B |
|---|---|
| Value | *(empty)* |
| *(empty)* | *(empty)* |
| *(empty)* | *(empty)* |

V√† comment g·∫Øn v√†o `A1` s·∫Ω xu·∫•t hi·ªán d∆∞·ªõi d·∫°ng comment √¥ (click chu·ªôt ph·∫£i ‚Üí *Show/Hide Comments* trong Excel).

B·∫°n c√≥ th·ªÉ x√°c nh·∫≠n k·∫øt qu·∫£ b·∫±ng m√£:

```csharp
// Optional: Verify that the cell now holds the expected value
string cellValue = worksheet.Cells["A1"].StringValue;
Console.WriteLine($"A1 = {cellValue}"); // Should output: A1 = Value

// Verify the comment
var comment = worksheet.Cells["A1"].GetComment();
Console.WriteLine($"Comment = {comment?.Note}"); // Should output: Comment = This is a comment
```

N·∫øu ƒë·∫ßu ra kh·ªõp, ch√∫c m·ª´ng‚Äîb·∫°n ƒë√£ **t·∫°o b·ªô s∆∞u t·∫≠p smart marker** v√† √°p d·ª•ng n√≥ v√†o worksheet th√†nh c√¥ng!

---

## Nh·ªØng l·ªói th∆∞·ªùng g·∫∑p & C√°ch tr√°nh

| Tri·ªáu ch·ª©ng | Nguy√™n nh√¢n c√≥ th·ªÉ | C√°ch kh·∫Øc ph·ª•c |
|------------|-------------------|----------------|
| `${A1}` kh√¥ng thay ƒë·ªïi | Marker ch∆∞a ƒë∆∞·ª£c th√™m ho·∫∑c collection ch∆∞a ƒë∆∞·ª£c g·∫Øn | Ki·ªÉm tra l·∫°i `markerCollection.Add("A1", ...)` v√† `worksheet.SmartMarkers.Add(markerCollection)` |
| Comment kh√¥ng hi·ªÉn th·ªã | D√πng sai h·∫≠u t·ªë kh√≥a ho·∫∑c ch∆∞a g·ªçi `GetComment()` | S·ª≠ d·ª•ng kh√≥a `"A1.Comment"` v√† ƒë·∫£m b·∫£o √¥ c√≥ ƒë·ªëi t∆∞·ª£ng comment |
| Gi√° tr·ªã tr√πng l·∫∑p | C√πng m·ªôt kh√≥a ƒë∆∞·ª£c th√™m nhi·ªÅu l·∫ßn m√† kh√¥ng c√≥ √Ω ƒë·ªãnh | D√πng guard `ContainsKey` ho·∫∑c ƒë·ªïi t√™n kh√≥a (v√≠ d·ª•: `A1_1`, `A1_2`) |
| Ch·∫≠m hi·ªáu nƒÉng tr√™n sheet l·ªõn | G·ªçi `Apply()` trong v√≤ng l·∫∑p | Gom t·∫•t c·∫£ marker l·∫°i, r·ªìi g·ªçi `Apply()` m·ªôt l·∫ßn |

---

## V√≠ d·ª• Ho√†n ch·ªânh

D∆∞·ªõi ƒë√¢y l√† m·ªôt ch∆∞∆°ng tr√¨nh t·ª± ch·ª©a b·∫°n c√≥ th·ªÉ bi√™n d·ªãch v√† ch·∫°y. N√≥ t·∫°o workbook, th√™m √¥ m·∫´u v·ªõi placeholder, x√¢y d·ª±ng smart marker collection, √°p d·ª•ng, v√† cu·ªëi c√πng l∆∞u file th√†nh `Result.xlsx`.

```csharp
using System;
using Aspose.Cells;

class SmartMarkerDemo
{
    static void Main()
    {
        // 1Ô∏è‚É£ Create a new workbook and get the first worksheet
        Workbook workbook = new Workbook();
        Worksheet worksheet = workbook.Worksheets[0];

        // Insert placeholders into the sheet (this mimics a template)
        worksheet.Cells["A1"].PutValue("${A1}");
        worksheet.Cells["A2"].PutValue("${A1.Comment}");

        // 2Ô∏è‚É£ Create the marker collection
        MarkerCollection markerCollection = new MarkerCollection();

        // 3Ô∏è‚É£ Add data and a comment marker
        markerCollection.Add("A1", "Value");
        markerCollection.Add("A1.Comment", "This is a comment");

        // 4Ô∏è‚É£ Attach the collection to the worksheet's SmartMarkers
        worksheet.SmartMarkers.Add(markerCollection);

        // 5Ô∏è‚É£ Apply the markers
        worksheet.SmartMarkers.Apply();

        // 6Ô∏è‚É£ Optional verification
        Console.WriteLine($"A1 = {worksheet.Cells["A1"].StringValue}");
        var comment = worksheet.Cells["A1"].GetComment();
        Console.WriteLine($"Comment = {comment?.Note}");

        // 7Ô∏è‚É£ Save the workbook
        workbook.Save("Result.xlsx");
        Console.WriteLine("Workbook saved as Result.xlsx");
    }
}
```

**K·∫øt qu·∫£ console d·ª± ki·∫øn**

```
A1 = Value
Comment = This is a comment
Workbook saved as Result.xlsx
```

M·ªü `Result.xlsx` v√† b·∫°n s·∫Ω th·∫•y ch·ªØ ‚ÄúValue‚Äù nguy√™n vƒÉn ·ªü √¥‚ÄØA1 c√πng m·ªôt comment ƒë∆∞·ª£c g·∫Øn v√†o c√πng √¥ ƒë√≥.

---

## üéâ K·∫øt lu·∫≠n

B√¢y gi·ªù b·∫°n ƒë√£ bi·∫øt c√°ch **t·∫°o b·ªô s∆∞u t·∫≠p smart marker** trong C# b·∫±ng Aspose.Cells, th√™m c·∫£ data v√† comment markers, g·∫Øn ch√∫ng v√†o worksheet, v√† g·ªçi `Apply()` ƒë·ªÉ hi·ªán th·ª±c c√°c thay ƒë·ªïi. M√¥ h√¨nh n√†y m·ªü r·ªông t·ªët: ch·ªâ c·∫ßn ƒëi·ªÅn collection v·ªõi bao nhi√™u kh√≥a b·∫°n c·∫ßn, g·∫Øn m·ªôt l·∫ßn, v√† ƒë·ªÉ engine th·ª±c hi·ªán ph·∫ßn c√≤n l·∫°i.

**Ti·∫øp theo b·∫°n c√≥ th·ªÉ:**  
- Th·ª≠ nghi·ªám v·ªõi c√°c collection l·ªìng nhau cho d·ªØ li·ªáu ph√¢n c·∫•p (v√≠ d·ª•: b√°o c√°o master‚Äëdetail).  
- K·∫øt h·ª£p smart markers v·ªõi vi·ªác t·∫°o bi·ªÉu ƒë·ªì **Aspose.Cells** cho c√°c dashboard ƒë·ªông.  
- Kh√°m ph√° ph∆∞∆°ng th·ª©c `MarkerCollection.Clone()` ƒë·ªÉ t√°i s·ª≠ d·ª•ng m·∫´u tr√™n nhi·ªÅu workbook m√† kh√¥ng c·∫ßn x√¢y d·ª±ng l·∫°i marker m·ªói l·∫ßn.

H√£y ƒë·ªÉ l·∫°i comment n·∫øu g·∫∑p kh√≥ khƒÉn, ho·∫∑c chia s·∫ª c√°ch b·∫°n ƒë√£ t·∫≠n d·ª•ng smart markers trong d·ª± √°n c·ªßa m√¨nh. Ch√∫c b·∫°n coding vui!  

---

![Diagram showing how to create smart marker collection in Aspose.Cells](https://example.com/images/smart-marker-collection-diagram.png "S∆° ƒë·ªì t·∫°o b·ªô s∆∞u t·∫≠p smart marker")  

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}