---
title: Excel で図形の接続ポイントを取得する
linktitle: Excel で図形の接続ポイントを取得する
second_title: Aspose.Cells .NET Excel 処理 API
description: Aspose.Cells for .NET を使用して Excel で図形の接続ポイントを取得する方法を学びます。ステップ バイ ステップ ガイドに従って、プログラムで図形ポイントを簡単に抽出して表示します。
weight: 11
url: /ja/net/excel-shapes-controls/get-connection-points-shape-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Excel で図形の接続ポイントを取得する

## 導入
Excel ファイルをプログラムで操作する場合、シートに埋め込まれた図形を操作する必要がよくあります。実行できるより高度なタスクの 1 つは、図形から接続ポイントを抽出することです。接続ポイントは、コネクタを使用して図形を接続し、レイアウトをより正確に管理するために使用されます。Excel で図形の接続ポイントを取得したい場合は、Aspose.Cells for .NET が最適なツールです。このチュートリアルでは、これを実現するための手順を順を追って説明します。
## 前提条件
コードに進む前に、次の前提条件を満たしていることを確認してください。
- Aspose.Cells for .NET: 開発環境にAspose.Cellsがインストールされている必要があります。まだインストールされていない場合は、[最新バージョンはこちらからダウンロードしてください](https://releases.aspose.com/cells/net/).
- 開発環境: Visual Studio またはその他の .NET 互換 IDE が正常にインストールされていることを確認します。
- C# の基本知識: このチュートリアルでは、C# プログラミングとオブジェクト指向の原則に関する基本的な知識があることを前提としています。
また、[Aspose.Cells の無料トライアル](https://releases.aspose.com/)まだお持ちでない場合は、これを行ってください。これにより、このガイドに必要なすべての機能にアクセスできるようになります。

## パッケージのインポート
プロジェクトで Aspose.Cells を使用するには、必要な名前空間を含める必要があります。次のインポート ステートメントをコードの先頭に配置する必要があります。
```csharp
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Drawing;
using System.Drawing;
```
これらの名前空間を使用すると、Aspose.Cells のコア機能にアクセスし、ワークシートや図形を操作できるようになります。

## 図形の接続ポイントを取得するためのステップバイステップガイド
このセクションでは、Excel ワークシート内の図形の接続ポイントを抽出する方法について説明します。明確に理解するために、各手順を注意深く実行してください。
## ステップ 1: 新しいワークブックをインスタンス化する
まず最初に、インスタンスを作成する必要があります`Workbook`クラス。これは、Aspose.Cells 内の Excel ファイルを表します。既存のファイルがない場合は、問題ありません。空のブックから始めることができます。
```csharp
//新しいワークブックをインスタンス化する
Workbook workbook = new Workbook();
```
このステップでは空のExcelブックを作成しましたが、ファイルパスを渡すことで既存のブックを読み込むこともできます。`Workbook`コンストラクタ。
## ステップ2: 最初のワークシートにアクセスする
次に、図形を操作するワークシートにアクセスする必要があります。この場合は、ワークブックの最初のワークシートを使用します。
```csharp
//ワークブックの最初のワークシートを取得する
Worksheet worksheet = workbook.Worksheets[0];
```
この行は、ワークブック内のワークシートのコレクションから最初のワークシートにアクセスします。特定のシートで作業している場合は、インデックスを置き換えることができます。`0`希望するインデックスで。
## ステップ3: 新しいテキストボックス（図形）を追加する
次に、ワークシートに新しい図形を追加しましょう。図形の一種であるテキスト ボックスを作成します。他の種類の図形を追加することもできますが、簡単にするために、このチュートリアルではテキスト ボックスのみを使用します。
```csharp
//コレクションに新しいテキストボックスを追加する
int textboxIndex = worksheet.TextBoxes.Add(2, 1, 160, 200);
```
私たちが行ったことは次のとおりです:
- 行にテキストボックスを追加しました`2`、 カラム`1`.
- テキストボックスのサイズを`160`幅の単位と`200`高さの単位。
## ステップ4: 図形コレクションから図形にアクセスする
テキストボックスを追加すると、ワークシートの図形コレクションの一部になります。次に、`Shapes`コレクション。
```csharp
//図形コレクションから図形（テキストボックス）にアクセスする
Shape shape = workbook.Worksheets[0].Shapes[0];
```
この手順では、コレクションから最初の図形 (テキスト ボックス) を取得します。図形が複数ある場合は、インデックスを指定するか、名前で図形を検索することもできます。
## ステップ5: 接続ポイントを取得する
図形ができたので、接続ポイントを抽出しましょう。これらのポイントは図形にコネクタを接続するために使用されます。`ConnectionPoints`図形のプロパティは、使用可能なすべての接続ポイントを返します。
```csharp
//この図形のすべての接続ポイントを取得します
var connectionPoints = shape.ConnectionPoints;
```
これにより、その図形で使用できるすべての接続ポイントのコレクションが提供されます。
## ステップ6: 接続ポイントを表示する
最後に、各接続ポイントの座標を表示します。ここで、接続ポイントをループし、コンソールに出力します。
```csharp
//すべてのシェイプポイントを表示
foreach (var pt in connectionPoints)
{
    System.Console.WriteLine(string.Format("X = {0}, Y = {1}", pt.X, pt.Y));
}
```
このループは各接続ポイントを反復処理し、`X`そして`Y`座標。これは、図形の接続ポイントをデバッグしたり視覚的に確認したりするのに役立ちます。
## ステップ7: 実行して完了する
上記の手順をすべて設定したら、コードを実行できます。プロセスが正常に完了することを保証する最後の行は次のとおりです。
```csharp
System.Console.WriteLine("GetShapeConnectionPoints executed successfully.");
```
この行は、プロセスが完了したことを示すメッセージをコンソールに記録するだけです。

## 結論
このチュートリアルでは、Aspose.Cells for .NET を使用して Excel の図形の接続ポイントを取得する方法について説明しました。タスクを小さなわかりやすいステップに分割して、ワークブックの作成、図形の追加、接続ポイントの抽出のプロセスを確認しました。
プログラムで図形を操作する方法を理解することで、動的でインタラクティブな Excel シートを作成するための可能性が広がります。レポートの作成、ダッシュボードの設計、図の作成など、どのような作業でも、この知識は役立ちます。
## よくある質問
### 図形内の接続ポイントとは何ですか?
接続ポイントは、コネクタを接続したり、他の図形にリンクしたりできる図形上の特定のポイントです。
### ワークシート内のすべての図形の接続ポイントを取得できますか?
はい、Aspose.Cells を使用すると、接続ポイントをサポートする任意の図形の接続ポイントを取得できます。ワークシート内の図形コレクションをループするだけです。
### Aspose.Cells を使用するにはライセンスが必要ですか?
はい、無料でお試しいただけますが、フル機能を使用するにはライセンスが必要です。[ここでライセンスを購入](https://purchase.aspose.com/buy)または[一時ライセンス](https://purchase.aspose.com/temporary-license/).
### Aspose.Cells にさまざまな種類の図形を追加するにはどうすればよいですか?
あなたは`Add`長方形、楕円などの図形用のメソッド。各図形にはカスタマイズ可能な特定のパラメータがあります。
### 新しい Excel ファイルを作成する代わりに、既存の Excel ファイルを読み込むにはどうすればよいですか?
既存のファイルを読み込むには、ファイルパスを`Workbook`コンストラクターは次のようになります。  
```csharp
Workbook workbook = new Workbook("path_to_file.xlsx");
```
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
