---
"description": "Aspose.Cells for .NET を使って、Excel の図形の接続ポイントを取得する方法を学びましょう。ステップバイステップのガイドに従って、図形の接続ポイントをプログラムで簡単に抽出し、表示しましょう。"
"linktitle": "Excelで図形の接続ポイントを取得する"
"second_title": "Aspose.Cells .NET Excel 処理 API"
"title": "Excelで図形の接続ポイントを取得する"
"url": "/ja/net/excel-shapes-controls/get-connection-points-shape-excel/"
"weight": 11
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Excelで図形の接続ポイントを取得する

## 導入
Excelファイルをプログラムで操作する場合、シートに埋め込まれた図形を操作する必要があることがよくあります。より高度なタスクの一つとして、図形から接続ポイントを抽出することが挙げられます。接続ポイントは、図形をコネクタで接続し、レイアウトをより正確に管理するために使用されます。Excelで図形の接続ポイントを取得したい場合は、Aspose.Cells for .NETが最適です。このチュートリアルでは、接続ポイントを取得する手順を段階的に説明します。
## 前提条件
コードに進む前に、次の前提条件が満たされていることを確認してください。
- Aspose.Cells for .NET: 開発環境にAspose.Cellsがインストールされている必要があります。まだインストールされていない場合は、 [最新バージョンはこちらからダウンロードしてください](https://releases。aspose.com/cells/net/).
- 開発環境: Visual Studio またはその他の .NET 互換 IDE がインストールされていることを確認してください。
- C# の基本知識: このチュートリアルでは、C# プログラミングとオブジェクト指向の原則について基本的な理解があることを前提としています。
また、 [Aspose.Cellsの無料トライアル](https://releases.aspose.com/) まだお持ちでない場合は、アカウントを作成してください。これにより、このガイドに必要なすべての機能にアクセスできるようになります。

## パッケージのインポート
プロジェクトでAspose.Cellsを使用するには、必要な名前空間を含める必要があります。以下のimport文をコードの先頭に記述してください。
```csharp
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Drawing;
using System.Drawing;
```
これらの名前空間により、Aspose.Cells のコア機能にアクセスし、ワークシートや図形を操作できるようになります。

## 図形の接続ポイントを取得するためのステップバイステップガイド
このセクションでは、Excelワークシート内の図形の接続ポイントを抽出する方法を詳しく説明します。各手順を注意深く実行することで、理解が深まります。
## ステップ1: 新しいワークブックをインスタンス化する
まず最初に、 `Workbook` クラスです。これはAspose.Cells内のExcelファイルを表します。既存のファイルがなくても問題ありません。空のワークブックから始めることができます。
```csharp
// 新しいワークブックをインスタンス化する
Workbook workbook = new Workbook();
```
この手順では空のExcelブックを作成しましたが、ファイルパスを渡すことで既存のブックを読み込むこともできます。 `Workbook` コンストラクタ。
## ステップ2: 最初のワークシートにアクセスする
次に、図形を操作するワークシートにアクセスする必要があります。今回は、ワークブックの最初のワークシートを使用します。
```csharp
// ワークブックの最初のワークシートを取得する
Worksheet worksheet = workbook.Worksheets[0];
```
この行は、ワークブック内のワークシートのコレクションの最初のワークシートにアクセスします。特定のシートを操作している場合は、インデックスを置き換えることができます。 `0` 希望するインデックスで。
## ステップ3: 新しいテキストボックス（図形）を追加する
それでは、ワークシートに新しい図形を追加しましょう。図形の一種であるテキストボックスを作成します。他の種類の図形を追加することもできますが、このチュートリアルでは簡潔にするためにテキストボックスのみを使用します。
```csharp
// コレクションに新しいテキストボックスを追加する
int textboxIndex = worksheet.TextBoxes.Add(2, 1, 160, 200);
```
私たちがやったことは以下の通りです:
- 行にテキストボックスを追加しました `2`、 カラム `1`。
- テキストボックスのサイズを `160` 幅の単位と `200` 高さの単位。
## ステップ4: 図形コレクションから図形にアクセスする
テキストボックスを追加すると、ワークシートの図形コレクションの一部になります。次に、 `Shapes` コレクション。
```csharp
// 図形コレクションから図形（テキストボックス）にアクセスする
Shape shape = workbook.Worksheets[0].Shapes[0];
```
このステップでは、コレクションから最初の図形（テキストボックス）を取得します。複数の図形がある場合は、インデックスを指定するか、名前で図形を検索することもできます。
## ステップ5: 接続ポイントを取得する
図形が完成したら、接続ポイントを抽出しましょう。これらのポイントは、コネクタを図形に接続するために使われます。 `ConnectionPoints` 図形のプロパティは、使用可能なすべての接続ポイントを返します。
```csharp
// この図形内のすべての接続ポイントを取得します
var connectionPoints = shape.ConnectionPoints;
```
これにより、その図形で使用できるすべての接続ポイントのコレクションが提供されます。
## ステップ6: 接続ポイントを表示する
最後に、各接続ポイントの座標を表示します。ここでは、接続ポイントをループ処理し、コンソールに出力します。
```csharp
// すべてのシェイプポイントを表示
foreach (var pt in connectionPoints)
{
    System.Console.WriteLine(string.Format("X = {0}, Y = {1}", pt.X, pt.Y));
}
```
このループは各接続ポイントを反復処理し、 `X` そして `Y` 座標。これは、図形の接続ポイントをデバッグしたり視覚的に確認したりするのに役立ちます。
## ステップ7: 実行して完了
上記の手順をすべて設定したら、コードを実行できます。プロセスが正常に完了することを保証する最後の行は次のとおりです。
```csharp
System.Console.WriteLine("GetShapeConnectionPoints executed successfully.");
```
この行は、プロセスが完了したことを示すメッセージをコンソールに記録するだけです。

## 結論
このチュートリアルでは、Aspose.Cells for .NET を使用して Excel の図形の接続ポイントを取得する方法を説明しました。タスクを小さな分かりやすいステップに分割することで、ワークブックの作成、図形の追加、接続ポイントの抽出というプロセスを詳しく見てきました。
プログラムで図形を操作する方法を理解することで、動的でインタラクティブなExcelシートを作成するための可能性が広がります。レポートの作成、ダッシュボードのデザイン、図の作成など、どんな場面でもこの知識は役立ちます。
## よくある質問
### 図形内の接続ポイントとは何ですか?
接続ポイントは、コネクタを接続したり、他の図形にリンクしたりできる図形上の特定のポイントです。
### ワークシート内のすべての図形の接続ポイントを取得できますか?
はい、Aspose.Cells では、接続ポイントをサポートするあらゆる図形の接続ポイントを取得できます。ワークシート内の図形コレクションをループするだけです。
### Aspose.Cells を使用するにはライセンスが必要ですか?
はい、無料でお試しいただけますが、すべての機能を使用するにはライセンスが必要です。 [ここでライセンスを購入](https://purchase.aspose.com/buy) または [一時ライセンス](https://purchase。aspose.com/temporary-license/).
### Aspose.Cells にさまざまな種類の図形を追加するにはどうすればよいですか?
使用することができます `Add` 長方形、楕円形などの図形に適用できるメソッドです。各図形にはカスタマイズ可能なパラメータがあります。
### 新しい Excel ファイルを作成する代わりに、既存の Excel ファイルを読み込むにはどうすればよいでしょうか?
既存のファイルを読み込むには、ファイルパスを `Workbook` コンストラクターは次のようになります。  
```csharp
Workbook workbook = new Workbook("path_to_file.xlsx");
```

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}