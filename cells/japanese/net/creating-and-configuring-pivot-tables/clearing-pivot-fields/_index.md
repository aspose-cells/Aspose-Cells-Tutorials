---
title: .NET でプログラム的にピボット フィールドをクリアする
linktitle: .NET でプログラム的にピボット フィールドをクリアする
second_title: Aspose.Cells .NET Excel 処理 API
description: Aspose.Cells for .NET のパワーを解き放ちましょう。完全なステップバイステップのチュートリアルで、Excel のピボット フィールドを簡単にクリアできます。
weight: 11
url: /ja/net/creating-and-configuring-pivot-tables/clearing-pivot-fields/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# .NET でプログラム的にピボット フィールドをクリアする

## 導入
数え切れないほどの Excel シートを調べて、乱雑なピボット フィールドをプログラムでクリーンアップする方法を考えたことはありませんか? まさにその通りです! この記事では、Excel ファイルを操作する強力なコンポーネントである Aspose.Cells for .NET を使用して、ピボット フィールドを簡単にクリアする方法について詳しく説明します。プロセスを段階的に説明するだけでなく、各手順の背後にある「理由」と「方法」も理解できるようにします。開発者でも Excel の熱狂的なファンでも、このガイドは Excel の自動化タスクを最大限に活用するのに役立ちます。

## 前提条件
この旅に乗り出す前に、ツールキットに用意しておく必要があるものがいくつかあります。

1. Visual Studio: お使いのマシンに Visual Studio がインストールされていることを確認してください。この IDE を使用して .NET コードを記述します。
2.  Aspose.Cells for .NET: これはExcelファイルを操作するために使用するメインパッケージです。まだダウンロードしていない場合は、ダウンロードできます。[ここ](https://releases.aspose.com/cells/net/).
3. C# の基本知識: 達人である必要はありませんが、C# の基本を理解しておくと、一緒に検討するコードを理解するのに役立ちます。

## パッケージのインポート
必要なものが揃ったら、ワークスペースを設定します。Aspose.Cells for .NET を使い始めるために必要なパッケージをインポートする方法は次のとおりです。

### 新しいプロジェクトを作成する
Visual Studio を開き、新しい C# コンソール アプリケーション プロジェクトを作成します。これがワークスペースとなり、ピボット フィールドをクリアするコードを記述します。

### 参照を追加
プロジェクトで、「参照」を右クリックします。「参照の追加」を選択し、ダウンロードした Aspose.Cells.dll ファイルを探します。この手順により、プロジェクトで Aspose.Cells が提供する機能を利用できるようになります。

### ディレクティブの使用を含める
C# ファイルの先頭に、次のディレクティブを追加します。

```csharp
using System.IO;
using Aspose.Cells;
using System.Drawing;
using Aspose.Cells.Pivot;
```

これは、Aspose.Cells ライブラリをコーディング パーティーに招待して、その素晴らしい機能にすぐにアクセスできるようにするようなものです。

それでは、Excel ワークシートからピボット フィールドをクリアするというメイン タスクに進みましょう。これをわかりやすい手順に分解します。

## ステップ1: ドキュメントディレクトリを設定する
まず最初に、Excel ファイルがどこに保存されているかを定義する必要があります。これは重要です。コードがどこを探せばよいか分からないと、間違った場所でキーを探しているようなものになってしまうからです。やり方は次のとおりです。

```csharp
//ドキュメント ディレクトリへのパス。
string dataDir = "Your Document Directory";
```
「Your Document Directory」を実際のドキュメントのパスに置き換えます。これにより、プログラムが正しいフォルダーを検索するようになります。

## ステップ2: ワークブックを読み込む
次に、作業する Excel ファイルを読み込みます。この手順は、本を開くことに似ています。本を開くまで、中身を読むことはできません。

```csharp
//テンプレートファイルを読み込む
Workbook workbook = new Workbook(dataDir + "Book1.xls");
```
ここでは、新しいインスタンスを作成します`Workbook`オブジェクトを作成し、「Book1.xls」という Excel ファイルを読み込みます。これにより、既存のデータとやり取りできるようになります。

## ステップ3: ワークシートにアクセスする
ワークブックを開いたら、ピボット テーブルを含む特定のワークシートにアクセスする必要があります。必要なワークシートを見つけるには、ページをめくるようなものです。

```csharp
//最初のワークシートを入手する
Worksheet sheet = workbook.Worksheets[0];
```
の`Worksheets`コレクションを使用すると、インデックス (0 から始まる) で任意のシートを取得できます。ここでは、最初のシートだけを取得します。

## ステップ4: ピボットテーブルを取得する
次のステップは、選択したワークシートからすべてのピボット テーブルを収集することです。 では、何を扱っているかを見てみましょう。

```csharp
//シート内のピボットテーブルを取得する
PivotTableCollection pivotTables = sheet.PivotTables;
```
私たちは`PivotTableCollection`シートにあるすべてのピボット テーブルを保持するインスタンス。これは、ピボット テーブルを管理するためのツールボックスです。

## ステップ5: 最初のピボットテーブルにアクセスする
この例では、最初のピボット テーブルに注目してみましょう。これは、一度に多くのプロジェクトを同時にこなすのではなく、1 つのプロジェクトに取り組むことを決めるようなものです。

```csharp
//最初のピボットテーブルを取得する
PivotTable pivotTable = pivotTables[0];
```
前回と同様に、最初のピボット テーブルにアクセスします。シートに少なくとも 1 つのピボット テーブルがあることを確認してください。そうでない場合、null 参照が発生する可能性があります。

## ステップ6: データフィールドをクリアする
さて、いよいよ重要な部分、つまりピボット テーブルのデータ フィールドをクリアする作業に入ります。これにより、計算や集計をリセットできます。
```csharp
//すべてのデータフィールドをクリアする
pivotTable.DataFields.Clear();
```
の`Clear()`この方法はリセットボタンを押すようなもので、データ フィールドを最初からやり直すことができます。

## ステップ7: 新しいデータフィールドを追加する
古いデータ フィールドをクリアしたら、新しいフィールドを追加できます。この手順は、レシピの材料を変更して新鮮な料理を作るのと似ています。

```csharp
//新しいデータフィールドを追加
pivotTable.AddFieldToArea(PivotFieldType.Data, "Betrag Netto FW");
```
ここでは、「Betrag Netto FW」という新しいデータ フィールドを追加します。これは、ピボット テーブルで分析するデータ ポイントです。

## ステップ8: データ更新フラグを設定する
次に、データが適切に更新されていることを確認しましょう。
```csharp
//更新データフラグをオンに設定
pivotTable.RefreshDataFlag = false;
```
設定`RefreshDataFlag`false に設定すると、不要なデータの取得が回避されます。これは、アシスタントに食料品の買い物にまだ行かないように指示するようなものです。

## ステップ9: データを更新して計算する
更新ボタンを押して計算を実行し、ピボット テーブルが新しいデータで更新されていることを確認しましょう。

```csharp
//ピボットテーブルデータを更新して計算する
pivotTable.RefreshData();
pivotTable.CalculateData();
```
の`RefreshData()`メソッドは現在のデータを取得し、ピボットテーブルを更新します。一方、`CalculateData()`実行する必要がある計算を処理します。

## ステップ10: ワークブックを保存する
最後に、Excel ファイルに加えた変更を保存しましょう。手紙を書いた後に封筒を封印するようなものです。

```csharp
// Excelファイルの保存
workbook.Save(dataDir + "output.xls");
```
ここでは、変更したワークブックを「output.xls」という名前で保存しています。ドキュメント ディレクトリへの書き込み権限があることを確認してください。

## 結論
Aspose.Cells を使用して .NET でプログラム的にピボット フィールドをクリアする方法を学びました。古いデータをクリーンアップする場合でも、新しい分析を準備する場合でも、このアプローチにより Excel ドキュメントをシームレスに操作できます。ぜひ試してみてください。練習を重ねれば完璧になります。Aspose.Cells を操作すればするほど、使いこなせるようになります。

## よくある質問

### Aspose.Cells for .NET とは何ですか?
Aspose.Cells for .NET は、Excel ファイル操作用のライブラリであり、ユーザーは Excel ファイルを作成、編集、変換、印刷できます。

### Aspose.Cells のライセンスは必要ですか?
 Aspose.Cellsは有料のライブラリですが、無料トライアルから始めることができます。[ここ](https://releases.aspose.com/).

### この方法を使用して複数のピボット フィールドをクリアできますか?
はい。ループを使用して複数のピボット テーブルを反復処理し、必要に応じてフィールドをクリアできます。

### Aspose.Cells で操作できるファイルの種類は何ですか?
XLS、XLSX、CSV など、さまざまな Excel 形式で作業できます。

### Aspose.Cells に関するヘルプのコミュニティはありますか?
もちろんです！Asposeコミュニティサポートは[ここ](https://forum.aspose.com/c/cells/9).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
