---
title: ワークシートに改ページプレビューを実装する
linktitle: ワークシートに改ページプレビューを実装する
second_title: Aspose.Cells .NET Excel 処理 API
description: Aspose.Cells for .NET を使用して、Excel でページ区切りプレビューを簡単に実装できます。このチュートリアルでは、最適な印刷レイアウトを手順ごとに説明します。
weight: 19
url: /ja/net/worksheet-display/implement-page-break-preview/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# ワークシートに改ページプレビューを実装する

## 導入
印刷前に Excel ワークシートのレイアウトを完璧にしたいですか? 改ページ プレビューを実装すれば解決です。Aspose.Cells for .NET を使用すると、このプロセスは簡単かつ迅速になります。このチュートリアルでは、セットアップの手順を説明し、コード構造を示し、ステップ バイ ステップでガイドします。ワークシートに改ページ プレビューを簡単にセットアップできます。さっそく始めましょう。
## 前提条件
コードに進む前に、このチュートリアルを実行するために必要なものがすべて揃っていることを確認しましょう。
1. Aspose.Cells for .NET ライブラリ  
   最新バージョンをダウンロードするには[Aspose.Cells for .NET ダウンロード ページ](https://releases.aspose.com/cells/net/)Visual Studio の NuGet 経由でインストールすることもできます。
2. 開発環境  
   コードを実行するには、Visual Studio などの開発環境が不可欠です。
3. C# と .NET の基礎知識  
   C# を全体的に理解しておくと、理解しやすくなります。
4. ライセンス  
   使用を検討してください[一時ライセンス](https://purchase.aspose.com/temporary-license/)機能をテストしている場合。
## パッケージのインポート
手順に入る前に、Aspose.Cells がスムーズに動作するように、必須のライブラリを必ず含めてください。インポート ステートメントは次のとおりです。
```csharp
using System.IO;
using Aspose.Cells;
```
セットアップが完了したので、詳細な手順でプロセスを確認してみましょう。
## ステップ1: ディレクトリパスを設定する
まず、Excel ファイルが保存されているディレクトリ パスを定義する必要があります。これは、プロジェクトの「ホーム ベース」を設定するものと考えてください。これは、入力ファイルが存在する場所であり、変更されたファイルが保存される場所でもあります。
```csharp
//ドキュメント ディレクトリへのパス。
string dataDir = "Your Document Directory";
```
交換する`"Your Document Directory"` Excel ファイルが保存されている実際のパスを入力します。
## ステップ2: ファイルストリームを作成する
Excel ファイルにアクセスして操作するには、FileStream を作成します。FileStream は、Aspose.Cells がファイルを読み取って変更できるようにファイルへのチャネルを開く「パイプライン」と考えてください。
```csharp
//開くExcelファイルを含むファイルストリームを作成する
FileStream fstream = new FileStream(dataDir + "book1.xls", FileMode.Open);
```
この行では、`book1.xls` FileMode.Open で、読み取りと変更が可能になります。指定されたディレクトリにこのファイルが存在することを確認してください。
## ステップ3: ワークブックオブジェクトをインスタンス化する
ワークブックオブジェクトは、ほとんどのアクションが発生する場所です。`Workbook`たとえば、基本的には Excel ファイルを「ロック解除」して Aspose.Cells が変更を実行できるようにします。
```csharp
//ワークブックオブジェクトのインスタンス化
//ファイルストリームを介してExcelファイルを開く
Workbook workbook = new Workbook(fstream);
```
この行はFileStreamからワークブックを初期化し、Aspose.Cellsが直接作業できるようにします。`book1.xls`.
## ステップ4: 最初のワークシートにアクセスする
ほとんどの Excel ファイルでは、特定のワークシートを操作します。ここでは、ワークブックの最初のワークシートにアクセスします。このワークシートには、改ページ プレビューが表示されます。
```csharp
// Excelファイルの最初のワークシートにアクセスする
Worksheet worksheet = workbook.Worksheets[0];
```
の`workbook.Worksheets[0]`コマンドはコレクション内の最初のワークシートを選択します。別のシートが必要な場合は、インデックスを変更できます。
## ステップ5: ページ区切りプレビューモードを有効にする
ここで改ページプレビューを有効にします。設定`IsPageBreakPreview`true に設定すると、ページが分割される場所が明確に示され、印刷時にワークシートがどのように表示されるかを視覚化できます。
```csharp
//改ページプレビューでワークシートを表示する
worksheet.IsPageBreakPreview = true;
```
この機能を有効にすると、ワークシートがページ区切りプレビュー モードに切り替わり、最適な印刷結果を得るためにレイアウトを簡単に確認および調整できるようになります。
## ステップ6: 変更したワークブックを保存する
調整を行った後、ファイルを保存する必要があります。このステップでは、すべての努力が結集され、変更内容が新しいファイルに保存されます。
```csharp
//変更したExcelファイルを保存する
workbook.Save(dataDir + "output.xls");
```
この例では、変更したワークブックを次のように保存します。`output.xls`元のファイルと同じディレクトリに保存します。必要に応じてファイル名を自由に変更してください。
## ステップ7: ファイルストリームを閉じる
最後に、ファイル ストリームを閉じて、すべてのリソースを解放します。これは、ファイルへの「パイプライン」をシャットダウンし、すべてが適切に保存され、ロックされていることを確認することと考えてください。
```csharp
//ファイルストリームを閉じてすべてのリソースを解放する
fstream.Close();
```
この手順を実行すると、ファイルの変更は完了です。ファイル ストリームは不要になったため、閉じると不要なメモリの使用を防ぐことができます。
## 結論
これで完了です。Aspose.Cells for .NET を使用すると、Excel でページ区切りのプレビューを設定することが効率的かつ管理しやすくなります。ディレクトリの設定から変更したファイルの保存まで、ここで説明した各手順により、印刷用にワークシートのレイアウトを自信を持って調整できます。詳細なレポートを作成する場合でも、単純なデータ シートを作成する場合でも、ページ区切りのプレビューをマスターすると、印刷プロセスがシームレスになります。
## よくある質問
### ページ区切りプレビューとは何ですか?  
ページ区切りプレビューを使用すると、印刷時にページがどこで区切られるかを確認できるため、最適な印刷結果を得るためにレイアウトを調整しやすくなります。
### Aspose.Cells for .NET を使用するにはライセンスが必要ですか?  
はい、フル機能を使用するにはライセンスが必要です。[一時ライセンス](https://purchase.aspose.com/temporary-license/)機能を試すことができます。
### 特定のワークシートを選択して改ページプレビューを表示できますか?  
はい、できます。ワークシートのインデックスを変更するか、ワークシート名を使用して特定のシートを選択するだけです。
### Aspose.Cells は .NET Core と互換性がありますか?  
はい、Aspose.Cells は .NET Framework および .NET Core と互換性があり、さまざまな .NET アプリケーションに幅広く使用できます。
### 問題が発生した場合、どうすればサポートを受けることができますか?  
Asposeは[サポートフォーラム](https://forum.aspose.com/c/cells/9)問題や質問があればサポートを受けることができます。
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
