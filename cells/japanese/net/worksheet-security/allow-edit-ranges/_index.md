---
"description": "Aspose.Cells for .NET を使用して Excel ワークシートに編集可能な範囲を作成し、特定のセルを編集可能にしながら、残りのセルをワークシート保護で保護する方法を学習します。"
"linktitle": "Aspose.Cells を使用してユーザーがワークシート内の範囲を編集できるようにする"
"second_title": "Aspose.Cells .NET Excel 処理 API"
"title": "Aspose.Cells を使用してユーザーがワークシート内の範囲を編集できるようにする"
"url": "/ja/net/worksheet-security/allow-edit-ranges/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Aspose.Cells を使用してユーザーがワークシート内の範囲を編集できるようにする

## 導入
Excelドキュメントには、不適切な編集から保護したい機密データや構造化コンテンツが含まれていることがよくあります。しかし、特定のセルや範囲を特定のユーザーに対して編集可能にしたい場合もあるでしょう。そこでAspose.Cells for .NETの強力なツールが役立ちます。このツールを使えば、ワークシート全体を保護しながら、指定した範囲に編集権限を与えることができます。予算表を共有する際に、特定のセルのみを編集可能にし、他のセルは保護したままにしておく、といった状況を想定してみてください。Aspose.Cellsを使えば、このような作業が簡単かつ効率的に行えます。
## 前提条件
コーディング部分に進む前に、必要なものがすべて揃っていることを確認しましょう。
- Aspose.Cells for .NET: Aspose.Cells for .NETライブラリがインストールされていることを確認してください。ダウンロードできます。 [ここ](https://releases。aspose.com/cells/net/).
- 開発環境: Visual Studio または C# 互換の IDE。
- .NET Framework: バージョン 4.0 以降。
- ライセンス：試用制限を回避するためにライセンスの取得を検討してください。 [仮免許証はこちら](https://purchase。aspose.com/temporary-license/).
## パッケージのインポート
コードの先頭に必要な Aspose.Cells 名前空間を含めるようにしてください。
```csharp
using System.IO;
using Aspose.Cells;
```
これにより、Excel ファイルで保護された範囲を設定するために必要なすべてのクラスとメソッドにアクセスできるようになります。
基礎が整いましたので、コードを 1 ステップずつ詳細に確認してみましょう。
## ステップ1: ディレクトリを設定する
ファイルを操作する前に、Excelファイルを保存するディレクトリを設定する必要があります。これにより、ファイルが適切に整理され、安全に保存されます。
```csharp
// ドキュメントディレクトリへのパスを定義する
string dataDir = "Your Document Directory";
// ディレクトリが存在するかどうかを確認し、存在しない場合は作成します
bool isExists = Directory.Exists(dataDir);
if (!isExists)
{
    Directory.CreateDirectory(dataDir);
}
```
このコード部分は、ディレクトリがファイル操作に対応できる状態であることを確認します。これは、後続のすべての処理の基盤を築くものと考えてください。
## ステップ2: ワークブックとワークシートを初期化する
次に、新しいワークブックを作成し、その既定のワークシートにアクセスして先に進みましょう。
```csharp
// 新しいワークブックを初期化する
Workbook book = new Workbook();
// ワークブックの最初のワークシートにアクセスする
Worksheet sheet = book.Worksheets[0];
```
ここでは、Excelブックを初期化し、その中の最初のワークシートを選択しています。このワークシートは、保護設定を適用し、編集可能な範囲を定義するキャンバスになります。
## ステップ3: 編集範囲のコレクションにアクセスする
Aspose.Cellsには、 `AllowEditRanges`は、ワークシートが保護されている場合でも編集可能な範囲のコレクションです。
```csharp
// 編集範囲の許可コレクションにアクセスする
ProtectedRangeCollection allowRanges = sheet.AllowEditRanges;
```
この行は、編集可能な特別な範囲のコレクションへのアクセスを設定します。これは、ワークシート内の特定の範囲のみが保護を回避できる「VIP」領域のようなものだと考えてください。
## ステップ4: 保護範囲の定義と作成
それでは、ワークシートに保護範囲を定義して作成しましょう。この範囲の開始セルと終了セルを指定します。
```csharp
// ProtectedRange変数を定義する
ProtectedRange protectedRange;
// 特定の名前とセル位置でコレクションに新しい範囲を追加します
int idx = allowRanges.Add("EditableRange", 1, 1, 3, 3);
protectedRange = allowRanges[idx];
```
このコード ブロックでは次のようになります。
- `EditableRange` 範囲に割り当てられた名前です。
- 数字 (1, 1, 3, 3) は範囲の座標を定義し、セル B2 (行 1、列 1) からセル D4 (行 3、列 3) までを意味します。
## ステップ5: 保護された範囲にパスワードを設定する
セキュリティを強化するために、保護された範囲にパスワードを設定できます。これにより、許可されたユーザーのみが範囲を編集できるようになり、保護層がさらに強化されます。
```csharp
// 編集可能な範囲にパスワードを設定する
protectedRange.Password = "123";
```
ここでは、パスワード（`"123"`）を保護された範囲に追加します。このパスワード要件により、変更を実行できるユーザーをさらに厳密に制御できます。
## ステップ6: ワークシートを保護する
編集範囲を設定したら、次はワークシート全体を保護します。この保護設定により、定義した範囲外のすべてのセルがロックされ、編集できなくなります。
```csharp
// ワークシートに保護を適用し、他のすべてのセルを編集不可にします
sheet.Protect(ProtectionType.All);
```
その `Protect` このメソッドは、編集可能として定義した範囲を除き、ワークシート全体をロックダウンします。このステップは、基本的に安全な「読み取り専用」環境を作成し、必要に応じて特定のセルにアクセスできる環境を実現します。
## ステップ7: ワークブックを保存する
最後の手順は、ワークブックを保存して、設定を適用および保存することです。
```csharp
// Excelファイルを指定されたディレクトリに保存します
book.Save(dataDir + "protectedrange.out.xls");
```
この手順では、手順 1 で設定したディレクトリに「protectedrange.out.xls」という名前でブックを保存します。これで、特定の範囲のみを編集できる、完全に機能する安全な Excel ファイルが完成しました。
## 結論
Aspose.Cells for .NET は、Excel ファイル内の保護と権限管理を優れた方法で実現します。編集可能な範囲を作成することで、ワークシートのセキュリティを確保しながら、特定の領域へのアクセスを許可することができます。この機能は、共同作業によるドキュメントで、一部のセルのみを編集用に開き、他のセルはロックしたままにしておく必要がある場合に特に便利です。
## よくある質問
### ワークシートに複数の編集可能な範囲を追加できますか?
はい、単に繰り返すだけで複数の範囲を追加できます。 `allowRanges.Add()` 新しい範囲ごとにメソッドを実行します。
### 保護された範囲を後で削除したい場合はどうすればよいでしょうか?
使用 `allowRanges.RemoveAt()` 削除したい範囲のインデックスをメソッドに渡します。
### 範囲ごとに異なるパスワードを設定できますか?
そうです。それぞれ `ProtectedRange` 独自のパスワードを設定できるため、きめ細かな制御が可能になります。
### 編集可能な範囲なしでワークシートを保護するとどうなりますか?
編集可能な範囲を定義しない場合、保護されるとワークシート全体が編集できなくなります。
### 保護された範囲は他のユーザーに表示されますか?
いいえ、保護は内部で行われます。保護された領域を編集しようとする場合にのみ、パスワードの入力が求められます。

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}