---
"description": "Aspose.Cells for .NET を使用して Excel ワークシートの行を保護する方法を学びましょう。行レベルの保護でデータを保護し、誤った変更を防ぎます。"
"linktitle": "Aspose.Cells を使用してワークシートの行を保護する"
"second_title": "Aspose.Cells .NET Excel 処理 API"
"title": "Aspose.Cells を使用してワークシートの行を保護する"
"url": "/ja/net/worksheet-security/protect-rows/"
"weight": 18
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Aspose.Cells を使用してワークシートの行を保護する

## 導入
Excelファイルをプログラムで操作する場合、多くの場合、データ操作だけでなくデータ保護も必要になります。機密データの保護や誤編集の防止など、ワークシート内の行の保護は非常に重要です。このチュートリアルでは、Aspose.Cells for .NETを使用してExcelワークシート内の特定の行を保護する方法を詳しく説明します。環境の準備から保護機能の実装まで、必要な手順をすべて分かりやすく解説します。
## 前提条件
ワークシート内の行を保護する前に、いくつかの準備が必要です。
1. Aspose.Cells for .NET: 開発マシンにAspose.Cells for .NETがインストールされていることを確認してください。まだインストールされていない場合は、以下のリンクから簡単にダウンロードできます。 [Aspose Cells のダウンロードページ](https://releases。aspose.com/cells/net/).
2. Visual Studio または任意の .NET IDE: ソリューションを実装するには、開発環境をセットアップする必要があります。Visual Studio は最適な選択肢ですが、.NET 互換の IDE であればどれでも使用できます。
3. C# の基本知識: C# プログラミングの基本を理解すると、チュートリアルに沿って進み、ニーズに合わせてサンプル コードを変更するのに役立ちます。
4. Aspose.Cells APIドキュメント: [Aspose.Cells for .NET ドキュメント](https://reference.aspose.com/cells/net/) ライブラリで使用されるクラス構造とメソッドの概要を取得します。
前提条件がすべて整ったら、すぐに実装に取り掛かることができます。
## パッケージのインポート
まず、必要なパッケージをインポートする必要があります。これらのライブラリは、C#プロジェクトでExcelファイルを操作するために不可欠です。
```csharp
using System.IO;
using Aspose.Cells;
```
必要なパッケージをインポートしたら、コーディングを開始できます。 
それでは、プロセスをより分かりやすくするために、小さなステップに分解してみましょう。各ステップは実装の特定の部分に焦点を当てているため、すぐに理解して適用できます。 
## ステップ1: 新しいワークブックとワークシートを作成する
保護設定を適用する前に、新しいブックを作成し、作業対象のワークシートを選択する必要があります。これが作業文書となります。
```csharp
// ドキュメント ディレクトリへのパス。
string dataDir = "Your Document Directory";
// ディレクトリがまだ存在しない場合は作成します。
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
	System.IO.Directory.CreateDirectory(dataDir);
// 新しいワークブックを作成します。
Workbook wb = new Workbook();
// ワークシート オブジェクトを作成し、最初のシートを取得します。
Worksheet sheet = wb.Worksheets[0];
```
この例では、1つのワークシートを持つ新しいワークブックを作成します（これはAspose.Cellsを使用して新しいワークブックを作成する際のデフォルトの設定です）。次に、ワークブック内の最初のワークシートを取得します。これが行保護の対象となります。
## ステップ2: StyleオブジェクトとStyleFlagオブジェクトを定義する
次のステップは、スタイルオブジェクトとスタイルフラグオブジェクトを定義することです。これらのオブジェクトを使用すると、セルのプロパティ（ロックされているかロック解除されているかなど）を変更できます。
```csharp
// スタイル オブジェクトを定義します。
Style style;
// styleflag オブジェクトを定義します。
StyleFlag flag;
```
後の手順でこれらのオブジェクトを使用して、セルのプロパティをカスタマイズし、ワークシートに適用します。
## ステップ3: ワークシート内のすべての列のロックを解除する
Excelワークシートでは、デフォルトですべてのセルがロックされています。ただし、ワークシートを保護すると、ロック状態が強制的に適用されます。特定の行またはセルのみを保護するには、まずすべての列のロックを解除します。特定の行のみを保護したい場合は、この手順が不可欠です。
```csharp
// ワークシート内のすべての列をループしてロックを解除します。
for (int i = 0; i <= 255; i++)
{
    style = sheet.Cells.Columns[(byte)i].Style;
    style.IsLocked = false;
    flag = new StyleFlag();
    flag.Locked = true;
    sheet.Cells.Columns[(byte)i].ApplyStyle(style, flag);
}
```
このコードでは、ワークシートの256列すべてをループ処理し（Excelワークシートには最大256列あり、0から255までのインデックスが付けられています）、 `IsLocked` 財産に `false`このアクションにより、すべての列のロックが解除されますが、後で特定の行をロックします。
## ステップ4：最初の行をロックする
列のロックを解除したら、次は保護したい特定の行をロックします。この例では、最初の行をロックします。これにより、他の行がロックされていない間は、ユーザーが最初の行を変更できなくなります。
```csharp
// 最初の行のスタイルを取得します。
style = sheet.Cells.Rows[0].Style;
// ロックしてください。
style.IsLocked = true;
// フラグをインスタンス化します。
flag = new StyleFlag();
// ロック設定をします。
flag.Locked = true;
// 最初の行にスタイルを適用します。
sheet.Cells.ApplyRowStyle(0, style, flag);
```
ここでは、最初の行のスタイルにアクセスし、 `IsLocked` 財産に `true`その後、 `ApplyRowStyle()` 行全体にロックスタイルを適用するには、この手順を繰り返します。保護したい他の行もロックできます。
## ステップ5: シートを保護する
必要な行のロック解除とロックが完了したら、ワークシートを保護します。保護により、保護パスワード（設定されている場合）を解除しない限り、ロックされた行やセルは変更できなくなります。
```csharp
// シートを保護します。
sheet.Protect(ProtectionType.All);
```
このステップでは、シート全体に保護を適用します。 `ProtectionType.All`このタイプの保護は、ロックされた行やセルを含むシートのあらゆる側面が保護されることを意味します。必要に応じて、異なる保護タイプを指定して、この保護をカスタマイズすることもできます。
## ステップ6: ワークブックを保存する
最後に、必要なスタイルと保護を適用した後、ブックを保存する必要があります。ブックは、Excel 97-2003、Excel 2010など、さまざまな形式で保存できます。
```csharp
// Excel ファイルを保存します。
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```
このコード行は、変更を適用したExcel 97-2003形式でブックを保存します。必要に応じて、様々な形式から選択してファイル形式を変更できます。 `SaveFormat` オプション。
## 結論
これで完了です！Aspose.Cells for .NET を使用してワークシートの行を保護する方法を学習しました。上記の手順に従うことで、必要に応じて行または列のロックを解除またはロックし、データの整合性を確保するための保護を適用できます。
## よくある質問
### 複数の行を一度に保護するにはどうすればよいですか?  
複数の行をループし、各行に個別にロックスタイルを適用できます。 `0` ロックする行インデックスを使用します。
### シート保護にパスワードを設定できますか?  
はい！パスワードを渡すこともできます `sheet.Protect()` パスワード保護を強制する方法。
### 列全体ではなくセルのロックを解除できますか?  
はい！列のロックを解除する代わりに、個々のセルのスタイル プロパティを変更してロックを解除できます。
### 保護された行を編集しようとするとどうなりますか?  
行が保護されている場合、シートの保護を解除しない限り、Excel ではロックされたセルへの編集ができなくなります。
### 特定の範囲を連続して保護することはできますか?  
はい！設定することで、行内の個々の範囲をロックできます。 `IsLocked` 範囲内の特定のセルのプロパティ。

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}