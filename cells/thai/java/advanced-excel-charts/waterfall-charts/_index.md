---
date: 2025-12-10
description: เรียนรู้วิธีสร้างแผนภูมิน้ำตกใน Java ด้วย Aspose.Cells คู่มือทีละขั้นตอนในการเพิ่มแผนภูมิลงในแผ่นงาน
  ปรับแต่ง และบันทึกเวิร์กบุ๊กเป็นไฟล์ XLSX.
linktitle: Waterfall Charts
second_title: Aspose.Cells Java Excel Processing API
title: วิธีสร้างแผนภูมิน้ำตกด้วย Aspose.Cells สำหรับ Java
url: /th/java/advanced-excel-charts/waterfall-charts/
weight: 18
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# แผนภูมิน้ำตก

## แนะนำแผนภูมิน้ำตกด้วย Aspose.Cells for Java

ในบทเรียนนี้คุณจะได้เรียนรู้วิธี **สร้างแผนภูมิน้ำตก** ด้วย Aspose.Cells for Java. แผนภูมิน้ำตกเป็นเครื่องมือสำคัญในการแสดงข้อมูลเชิงภาพ เพราะช่วยให้คุณเห็นผลรวมของค่าบวกและค่าลบที่เรียงต่อกัน ไม่ว่าคุณจะกำลังจัดทำงบการเงิน รายงานผลการขาย หรือการวิเคราะห์ข้อมูลใด ๆ แผนภูมิน้ำตกสามารถเปลี่ยนตัวเลขดิบให้เป็นข้อมูลเชิงลึกที่ชัดเจนและนำไปปฏิบัติได้

## คำตอบสั้น
- **แผนภูนีน้ำตกคืออะไร?** เป็นภาพที่แสดงว่าค่าตั้งต้นถูกเพิ่มและลดลงโดยค่ากลางหลายค่า จนได้ผลรวมสุดท้าย  
- **ใช้ไลบรารีใด?** Aspose.Cells for Java  
- **ต้องมีลิขสิทธิ์หรือไม่?** สามารถใช้รุ่นทดลองฟรีสำหรับการพัฒนา; ต้องมีลิขสิทธิ์เชิงพาณิชย์สำหรับการใช้งานจริง  
- **สามารถบันทึกไฟล์เป็น XLSX ได้หรือไม่?** ได้ – ใช้ `workbook.save("FileName.xlsx")`  
- **เหมาะกับการแสดงผลข้อมูลด้วย Java หรือไม่?** แน่นอน; Aspose.Cells ให้คุณสมบัติการสร้างแผนภูมิที่ครบถ้วนโดยไม่ต้องติดตั้ง Office

## แผนภูนีน้ำตกคืออะไร?
แผนภูนีน้ำตกแสดงการมีส่วนร่วมเชิงบวกและเชิงลบต่อค่าตั้งต้นอย่างต่อเนื่อง ช่วยให้คุณเข้าใจว่าคอมโพเนนต์แต่ละส่วนส่งผลต่อผลลัพธ์โดยรวมอย่างไร

## ทำไมต้องใช้ Aspose.Cells for Java เพื่อเพิ่มแผนภูนีน้ำตก?
- **ไม่ต้องใช้ Microsoft Excel** – สร้างแผนภูมิได้บนเซิร์ฟเวอร์หรือใน pipeline CI ใดก็ได้  
- **ควบคุมการจัดรูปแบบได้เต็มที่** – สี, ป้ายข้อมูล, และแกนสามารถปรับแต่งได้ด้วยโค้ด  
- **รองรับหลายรูปแบบการส่งออก** – XLSX, PDF, HTML และอื่น ๆ  
- **ประสิทธิภาพสูง** – เหมาะสำหรับเวิร์กบุ๊กขนาดใหญ่และการรายงานอัตโนมัติ

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะลงลึกในโค้ด โปรดตรวจสอบว่าคุณมีข้อกำหนดต่อไปนี้พร้อมใช้งานแล้ว:

- Aspose.Cells for Java: คุณต้องติดตั้ง Aspose.Cells for Java ก่อน สามารถดาวน์โหลดได้จาก [here](https://releases.aspose.com/cells/java/)  
- สภาพแวดล้อมการพัฒนา Java: ตรวจสอบว่ามี Java ติดตั้งอยู่ในระบบของคุณ

ตอนนี้เรามาเริ่มสร้างแผนภูมิน้ำตกกันทีละขั้นตอน

## วิธีสร้างแผนภูนีน้ำตกใน Java

### ขั้นตอนที่ 1: นำเข้า Aspose.Cells

```java
import com.aspose.cells.*;
```

ก่อนอื่นคุณต้องนำเข้าไลบรารี Aspose.Cells ไปยังโปรเจกต์ Java ของคุณ ไลบรารีนี้ให้ฟังก์ชันการทำงานที่ครอบคลุมสำหรับการทำงานกับไฟล์ Excel รวมถึงการสร้างแผนภูมิด้วย

### ขั้นตอนที่ 2: เริ่มต้น Workbook และ Worksheet

```java
Workbook workbook = new Workbook();
Worksheet worksheet = workbook.getWorksheets().get(0);
```

สร้างเวิร์กบุ๊กใหม่และเพิ่มเวิร์กชีตเข้าไป เราจะใช้เวิร์กชีตนี้เพื่อใส่ข้อมูลและ **เพิ่มแผนภูมิเข้าในเวิร์กชีต**  

### ขั้นตอนที่ 3: ป้อนข้อมูล

ตอนนี้เราจะใส่ข้อมูลลงในเวิร์กชีตเพื่อใช้เป็นฐานในการสร้างแผนภูมิน้ำตก

```java
Cells cells = worksheet.getCells();

// Insert data
cells.get("A1").putValue("Categories");
cells.get("A2").putValue("Start");
cells.get("A3").putValue("Positive Value 1");
cells.get("A4").putValue("Negative Value 1");
cells.get("A5").putValue("Positive Value 2");
cells.get("A6").putValue("End");

cells.get("B1").putValue("Values");
cells.get("B2").putValue(0);
cells.get("B3").putValue(20);
cells.get("B4").putValue(-10);
cells.get("B5").putValue(15);
cells.get("B6").putValue(25);
```

ในตัวอย่างนี้ เรามีหมวดหมู่อยู่ในคอลัมน์ A และค่าที่สอดคล้องกันในคอลัมน์ B คุณสามารถเปลี่ยนข้อมูลนี้เป็นชุดข้อมูลของคุณเองได้

### ขั้นตอนที่ 4: สร้างแผนภูนีน้ำตก

```java
int chartIndex = worksheet.getCharts().add(ChartType.WATERFALL, 5, 0, 15, 5);
Chart waterfallChart = worksheet.getCharts().get(chartIndex);
waterfallChart.getNSeries().add("B2:B6", true);
waterfallChart.getNSeries().setCategoryData("A2:A6");
```

เราได้เพิ่มแผนภูนีน้ำตกลงในเวิร์กชีตของเรา กำหนดชุดข้อมูลและข้อมูลหมวดหมู่ นี่คือขั้นตอนหลักที่ **เพิ่มแผนภูนีน้ำตก** ลงในแผ่นงานของคุณ คุณสามารถปรับแต่งลักษณะของแผนภูมิ (สี, ป้ายข้อมูล ฯลฯ) ได้เพิ่มเติมโดยใช้คุณสมบัติของอ็อบเจ็กต์ `Chart`

### ขั้นตอนที่ 5: บันทึก Workbook

```java
workbook.save("WaterfallChart.xlsx");
```

บันทึกเวิร์กบุ๊กเป็นไฟล์ ตัวอย่างใช้รูปแบบ XLSX แต่ Aspose.Cells ยังสามารถส่งออกเป็น PDF, CSV และรูปแบบอื่น ๆ อีกมากมาย ซึ่งสอดคล้องกับความต้องการ **บันทึกเวิร์กบุ๊กเป็น xlsx**

## ปัญหาที่พบบ่อยและวิธีแก้

- **แผนภูมิเกิดเป็นค่าว่าง** – ตรวจสอบให้แน่ใจว่าช่วงข้อมูล (`B2:B6` และ `A2:A6`) ตรงกับเซลล์ที่มีค่าจริงและหมวดหมู่ของคุณ  
- **ค่าลบไม่แสดงอย่างถูกต้อง** – ตรวจสอบว่าชนิดของซีรีส์ตั้งเป็น `ChartType.WATERFALL`; ชนิดแผนภูมิอื่นอาจจัดการค่าลบแตกต่างกัน  
- **ไฟล์ไม่เปิดใน Excel** – ตรวจสอบว่าคุณใช้ Aspose.Cells เวอร์ชันล่าสุดและนามสกุลไฟล์ตรงกับรูปแบบ (`.xlsx` สำหรับ Excel)

## คำถามที่พบบ่อย

### ฉันจะปรับแต่งลักษณะของแผนภูนีน้ำตกได้อย่างไร?

คุณสามารถปรับแต่งลักษณะของแผนภูนีน้ำตกได้โดยแก้ไขคุณสมบัติต่าง ๆ เช่น สี, ป้ายข้อมูล, และป้ายแกน ดูเอกสารของ Aspose.Cells สำหรับคำแนะนำโดยละเอียด

### สามารถสร้างแผนภูนีน้ำตกหลายแผนภูมิในเวิร์กชีตเดียวได้หรือไม่?

ได้ คุณสามารถสร้างแผนภูนีน้ำตกหลายแผนภูมิในเวิร์กชีตเดียวโดยทำตามขั้นตอนเดียวกันกับช่วงข้อมูลที่ต่างกัน

### Aspose.Cells รองรับสภาพแวดล้อมการพัฒนา Java ต่าง ๆ หรือไม่?

ได้, Aspose.Cells for Java รองรับสภาพแวดล้อมการพัฒนา Java หลากหลาย รวมถึง Eclipse, IntelliJ IDEA, และ NetBeans

### สามารถเพิ่มซีรีส์ข้อมูลเพิ่มเติมลงในแผนภูนีน้ำตกได้หรือไม่?

แน่นอน คุณสามารถเพิ่มซีรีส์ข้อมูลเพิ่มเติมลงในแผนภูนีน้ำตกเพื่อแสดงสถานการณ์ข้อมูลที่ซับซ้อนได้อย่างมีประสิทธิภาพ

### จะหาแหล่งข้อมูลและตัวอย่างเพิ่มเติมสำหรับ Aspose.Cells for Java ได้จากที่ไหน?

คุณสามารถสำรวจเอกสารของ Aspose.Cells for Java ที่ [reference.aspose.com/cells/java/](https://reference.aspose.com/cells/java/) เพื่อรับข้อมูลเชิงลึกและตัวอย่างโค้ดเพิ่มเติม

---

**อัปเดตล่าสุด:** 2025-12-10  
**ทดสอบกับ:** Aspose.Cells for Java 24.12 (ล่าสุด)  
**ผู้เขียน:** Aspose  

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}