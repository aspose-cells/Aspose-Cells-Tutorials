---
"description": "เรียนรู้วิธีเปิดและแยกไฟล์ CSV ด้วยตัวแยกวิเคราะห์แบบกำหนดเองใน Aspose.Cells สำหรับ .NET จัดการข้อความและวันที่ได้อย่างง่ายดาย เหมาะสำหรับนักพัฒนา"
"linktitle": "การเปิดไฟล์ CSV ด้วยโปรแกรมแยกวิเคราะห์ที่ต้องการ"
"second_title": "API การประมวลผล Excel ของ Aspose.Cells .NET"
"title": "การเปิดไฟล์ CSV ด้วยโปรแกรมแยกวิเคราะห์ที่ต้องการ"
"url": "/th/net/csv-file-handling/csv-file-opening-csv-files-with-preferred-parser/"
"weight": 11
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# การเปิดไฟล์ CSV ด้วยโปรแกรมแยกวิเคราะห์ที่ต้องการ

## การแนะนำ
เมื่อต้องจัดการกับไฟล์ CSV บางครั้งคุณอาจต้องการจัดการประเภทข้อมูลที่แตกต่างกันด้วยตัวแยกวิเคราะห์แบบกำหนดเอง บทช่วยสอนนี้จะแนะนำคุณเกี่ยวกับวิธีการเปิดไฟล์ CSV ด้วยตัวแยกวิเคราะห์ที่ต้องการโดยใช้ Aspose.Cells สำหรับ .NET ไม่ว่าคุณต้องการจัดการกับข้อความ วันที่ หรือรูปแบบที่กำหนดเองอื่นๆ คู่มือนี้จะแนะนำคุณในแต่ละขั้นตอนพร้อมคำอธิบายที่ชัดเจน
## ข้อกำหนดเบื้องต้น
ก่อนที่จะเจาะลึกโค้ด เรามาพูดถึงสิ่งสำคัญที่คุณต้องมีเพื่อเริ่มต้นกันก่อน
1. Aspose.Cells สำหรับไลบรารี .NET: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้งไลบรารี Aspose.Cells แล้ว คุณสามารถดาวน์โหลดได้ [ที่นี่](https://releases.aspose.com/cells/net/). คุณยังสามารถใช้รุ่นทดลองใช้งานฟรีได้ [ที่นี่](https://releases-aspose.com/).
2. สภาพแวดล้อมการพัฒนา .NET: แนะนำให้ใช้ Visual Studio แต่ IDE ที่เข้ากันได้กับ .NET ตัวอื่น ๆ ก็สามารถใช้ได้เช่นกัน
3. ความรู้พื้นฐานเกี่ยวกับ C#: บทช่วยสอนนี้ถือว่าคุณมีความคุ้นเคยกับ C# และการเขียนโปรแกรมเชิงวัตถุ
## แพ็คเกจนำเข้า
ในการใช้ Aspose.Cells คุณจะต้องนำเข้าเนมสเปซที่จำเป็นที่ด้านบนของไฟล์ C# ของคุณ:
```csharp
using System.IO;
using Aspose.Cells;
using System;
```
ตอนนี้เราได้เตรียมขั้นตอนเรียบร้อยแล้ว มาดูวิธีการเปิดไฟล์ CSV ด้วยตัวแยกวิเคราะห์ที่ต้องการ การจัดการรูปแบบข้อมูลต่างๆ เช่น ข้อความและวันที่ กัน
## ขั้นตอนที่ 1: กำหนดตัววิเคราะห์แบบกำหนดเอง
ในการจัดการประเภทข้อมูลที่แตกต่างกัน เช่น ข้อความหรือรูปแบบวันที่เฉพาะ คุณจำเป็นต้องกำหนดตัววิเคราะห์แบบกำหนดเอง ใน Aspose.Cells ตัววิเคราะห์แบบกำหนดเองจะใช้ `ICustomParser` อินเทอร์เฟซ
### 1.1 สร้างตัวแยกข้อความ
ตัววิเคราะห์นี้จัดการค่าข้อความปกติ โดยจะไม่ปรับเปลี่ยนรูปแบบ ดังนั้นค่าจึงถูกส่งกลับตามเดิม
```csharp
class TextParser : ICustomParser
{
    public object ParseObject(string value)
    {
        return value;
    }
    public string GetFormat()
    {
        return "";
    }
}
```
การ `ParseObject` วิธีการนี้จะส่งคืนค่าอินพุตเท่านั้น เหมือนกับการบอกว่า "อย่าเปลี่ยนแปลงอะไรเลย แค่ส่งข้อความมาให้ฉันก็พอ!"
### 1.2 สร้างตัวแยกวิเคราะห์วันที่
สำหรับวันที่ คุณจะต้องตรวจสอบให้แน่ใจว่าข้อมูล CSV ถูกแยกวิเคราะห์อย่างถูกต้อง `DateTime` วัตถุ นี่คือวิธีที่คุณสามารถสร้างตัวแยกวิเคราะห์วันที่:
```csharp
class DateParser : ICustomParser
{
    public object ParseObject(string value)
    {
        DateTime myDate = DateTime.ParseExact(value, "dd/MM/yyyy", 
            System.Globalization.CultureInfo.InvariantCulture);
        return myDate;
    }
    public string GetFormat()
    {
        return "dd/MM/yyyy";
    }
}
```
ในตัววิเคราะห์นี้เราใช้ `ParseExact` เพื่อให้แน่ใจว่าวันที่ได้รับการตีความอย่างถูกต้องตามรูปแบบที่กำหนดไว้ล่วงหน้า (`"dd/MM/yyyy"`) วิธีนี้จะทำให้วันที่ใดๆ ใน CSV ของคุณตามรูปแบบนี้ได้รับการประมวลผลโดยไม่มีปัญหา
## ขั้นตอนที่ 2: กำหนดค่าตัวเลือกการโหลด
ขั้นต่อไป คุณต้องกำหนดค่าวิธีการโหลดไฟล์ CSV ซึ่งทำได้โดยใช้ `TxtLoadOptions` คลาสที่อนุญาตให้คุณระบุตัวเลือกการแยกวิเคราะห์ รวมถึงการเข้ารหัสและตัวแยกวิเคราะห์แบบกำหนดเอง
### 2.1 ตั้งค่าตัวเลือกการโหลด
เราจะเริ่มต้นด้วยการเริ่มต้น `TxtLoadOptions` และการกำหนดพารามิเตอร์สำคัญเช่นตัวคั่นและการเข้ารหัส:
```csharp
TxtLoadOptions oTxtLoadOptions = new TxtLoadOptions(LoadFormat.Csv);
oTxtLoadOptions.Separator = Convert.ToChar(",");
oTxtLoadOptions.Encoding = Encoding.UTF8;
oTxtLoadOptions.ConvertDateTimeData = true;
```
- ตัวคั่น: กำหนดอักขระที่ใช้แยกค่าในไฟล์ CSV (เครื่องหมายจุลภาคในกรณีนี้)
- การเข้ารหัส: เราใช้การเข้ารหัส UTF-8 เพื่อจัดการกับอักขระหลากหลายประเภท
- ConvertDateTimeData: การตั้งค่านี้เป็นจริงจะทำให้มั่นใจว่าค่าวันที่จะถูกแปลงเป็นค่าโดยอัตโนมัติ `DateTime` วัตถุเมื่อเป็นไปได้
### 2.2 ใช้ตัววิเคราะห์แบบกำหนดเอง
ต่อไปเราจะกำหนดตัววิเคราะห์ที่เราสร้างไว้ก่อนหน้านี้เพื่อจัดการค่าใน CSV:
```csharp
oTxtLoadOptions.PreferredParsers = new ICustomParser[] 
{ 
    new TextParser(), 
    new DateParser() 
};
```
นี่จะบอก Aspose.Cells ให้ใช้ `TextParser` สำหรับค่าข้อความทั่วไปและ `DateParser` สำหรับฟิลด์วันที่ใดๆ ที่พบในไฟล์ CSV
## ขั้นตอนที่ 3: โหลดและอ่านไฟล์ CSV
เมื่อกำหนดค่าตัวเลือกการโหลดแล้ว คุณสามารถโหลดไฟล์ CSV ลงใน `Aspose.Cells.Workbook` วัตถุ.
### 3.1 โหลดไฟล์ CSV
เราโหลดไฟล์ CSV โดยส่งเส้นทางไฟล์และการกำหนดค่า `TxtLoadOptions` ไปที่ `Workbook` ผู้สร้าง:
```csharp
string sourceDir = "Your Document Directory";
Workbook oExcelWorkBook = new Aspose.Cells.Workbook(sourceDir + "samplePreferredParser.csv", oTxtLoadOptions);
```
ขั้นตอนนี้จะแปลงข้อมูล CSV ของคุณให้เป็นเวิร์กบุ๊ก Excel ที่มีฟังก์ชันครบถ้วน โดยแต่ละค่าจะถูกแยกวิเคราะห์ตามกฎที่คุณต้องการ
## ขั้นตอนที่ 4: เข้าถึงและแสดงข้อมูลเซลล์
เมื่อโหลด CSV ลงในเวิร์กบุ๊กแล้ว คุณสามารถเริ่มทำงานกับข้อมูลได้ ตัวอย่างเช่น คุณอาจต้องการพิมพ์ประเภทและค่าของเซลล์เฉพาะ
### 4.1 ดึงข้อมูลและแสดงเซลล์ A1
มาเรียกข้อมูลเซลล์แรก (A1) และแสดงค่าและประเภทของมัน:
```csharp
Cell oCell = oExcelWorkBook.Worksheets[0].Cells["A1"];
Console.WriteLine("A1: " + oCell.Type.ToString() + " - " + oCell.DisplayStringValue);
```
ที่นี่ `Type` คุณสมบัติแสดงประเภทข้อมูล (เช่น `String` หรือ `DateTime`), และ `DisplayStringValue` จะให้ค่าตามรูปแบบแก่คุณ
### 4.2 ดึงข้อมูลและแสดงเซลล์ B1
ในทำนองเดียวกันเราสามารถดึงและแสดงเซลล์อื่น เช่น B1:
```csharp
oCell = oExcelWorkBook.Worksheets[0].Cells["B1"];
Console.WriteLine("B1: " + oCell.Type.ToString() + " - " + oCell.DisplayStringValue);
```
ขั้นตอนนี้สามารถทำซ้ำได้กับเซลล์จำนวนเท่าที่คุณต้องการตรวจสอบ
## ขั้นตอนที่ 5: บันทึกสมุดงาน
หลังจากทำงานกับข้อมูลแล้ว คุณอาจต้องการบันทึกเวิร์กบุ๊กไปยังไฟล์ใหม่ Aspose.Cells ช่วยให้ทำสิ่งนี้ได้ง่ายด้วยฟังก์ชันที่เรียบง่าย `Save` วิธี:
```csharp
string outputDir = "Your Document Directory";
oExcelWorkBook.Save(outputDir + "outputsamplePreferredParser.xlsx");
```
การดำเนินการนี้จะบันทึกเวิร์กบุ๊กเป็นไฟล์ Excel โดยรักษาการจัดรูปแบบและการแยกวิเคราะห์ข้อมูลทั้งหมดที่คุณใช้ไว้
## บทสรุป
การเปิดไฟล์ CSV ด้วยตัวแยกวิเคราะห์ที่ต้องการใน Aspose.Cells สำหรับ .NET เป็นวิธีที่ยืดหยุ่นและมีประสิทธิภาพในการจัดการประเภทข้อมูลที่แตกต่างกัน โดยการสร้างตัวแยกวิเคราะห์แบบกำหนดเองและกำหนดค่าตัวเลือกการโหลด คุณสามารถมั่นใจได้ว่าไฟล์ CSV ของคุณจะถูกแยกวิเคราะห์อย่างแม่นยำตามที่คุณต้องการ ไม่ว่าคุณจะจัดการกับข้อความ วันที่ หรือรูปแบบที่กำหนดเองอื่นๆ ด้วยบทช่วยสอนนี้ ตอนนี้คุณพร้อมที่จะจัดการกับสถานการณ์การแยกวิเคราะห์ข้อมูลที่ซับซ้อนมากขึ้นในโครงการของคุณแล้ว
## คำถามที่พบบ่อย
### วัตถุประสงค์ของตัวแยกวิเคราะห์แบบกำหนดเองใน Aspose.Cells สำหรับ .NET คืออะไร
ตัวแยกวิเคราะห์แบบกำหนดเองช่วยให้คุณกำหนดได้ว่าจะต้องแยกประเภทข้อมูลเฉพาะ เช่น ข้อความหรือวันที่ เมื่อโหลดไฟล์ CSV
### ฉันสามารถใช้ตัวคั่นอื่นในไฟล์ CSV ได้หรือไม่
ใช่ คุณสามารถระบุอักขระใดๆ เป็นตัวคั่นในได้ `TxtLoadOptions.Separator` คุณสมบัติ.
### ฉันจะจัดการการเข้ารหัสใน Aspose.Cells เมื่อโหลด CSV ได้อย่างไร
คุณสามารถตั้งค่าได้ `Encoding` ทรัพย์สินของ `TxtLoadOptions` กับรูปแบบการเข้ารหัสใดๆ เช่น UTF-8, ASCII เป็นต้น
### จะเกิดอะไรขึ้นหากรูปแบบวันที่ใน CSV แตกต่างกัน?
คุณสามารถกำหนดรูปแบบวันที่ที่เฉพาะเจาะจงได้โดยใช้ตัวแยกวิเคราะห์แบบกำหนดเอง เพื่อให้แน่ใจว่าการแยกวิเคราะห์ค่าวันที่ถูกต้อง
### ฉันสามารถบันทึกสมุดงานในรูปแบบอื่นได้หรือไม่
ใช่ Aspose.Cells ช่วยให้คุณบันทึกเวิร์กบุ๊กในรูปแบบต่างๆ เช่น XLSX, CSV, PDF และอื่นๆ

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}