---
title: ปกป้องคอลัมน์ในเวิร์กชีตโดยใช้ Aspose.Cells
linktitle: ปกป้องคอลัมน์ในเวิร์กชีตโดยใช้ Aspose.Cells
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีปกป้องคอลัมน์ใน Excel โดยใช้ Aspose.Cells สำหรับ .NET ทำตามบทช่วยสอนโดยละเอียดนี้เพื่อล็อกคอลัมน์ในแผ่นงาน Excel อย่างมีประสิทธิภาพ
weight: 13
url: /th/net/worksheet-security/protect-columns/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# ปกป้องคอลัมน์ในเวิร์กชีตโดยใช้ Aspose.Cells

## การแนะนำ
เมื่อทำงานกับไฟล์ Excel ด้วยโปรแกรม คุณอาจจำเป็นต้องป้องกันพื้นที่เฉพาะของเวิร์กชีตจากการแก้ไข หนึ่งในงานที่พบมากที่สุดคือการป้องกันคอลัมน์ในเวิร์กชีต ในขณะที่ยังอนุญาตให้แก้ไขส่วนอื่นๆ ของชีตได้ นี่คือจุดที่ Aspose.Cells สำหรับ .NET เข้ามามีบทบาท ในบทช่วยสอนนี้ เราจะแนะนำคุณเกี่ยวกับกระบวนการป้องกันคอลัมน์เฉพาะในเวิร์กชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET ทีละขั้นตอน
## ข้อกำหนดเบื้องต้น
ก่อนที่คุณจะเริ่มปกป้องคอลัมน์ มีบางสิ่งที่คุณต้องมี:
- Visual Studio: คุณควรมี Visual Studio หรือ IDE ที่เข้ากันได้กับ .NET อื่น ๆ ติดตั้งอยู่บนเครื่องของคุณ
-  Aspose.Cells สำหรับ .NET: คุณต้องมีไลบรารี Aspose.Cells สำหรับ .NET ที่รวมเข้าไว้ในโปรเจ็กต์ของคุณ คุณสามารถดาวน์โหลดได้จาก[เว็บไซต์](https://releases.aspose.com/cells/net/).
- ความรู้พื้นฐานเกี่ยวกับ C#: บทช่วยสอนนี้ถือว่าคุณมีความเข้าใจพื้นฐานเกี่ยวกับการเขียนโปรแกรม C#
 หากคุณเพิ่งเริ่มใช้ Aspose.Cells ควรลองดู[เอกสารประกอบ](https://reference.aspose.com/cells/net/) เพื่อทำความเข้าใจเพิ่มเติมเกี่ยวกับฟังก์ชันการทำงานของไลบรารีและวิธีการใช้งาน
## แพ็คเกจนำเข้า
ในการเริ่มต้น คุณต้องนำเข้าเนมสเปซที่จำเป็นซึ่งจะช่วยให้คุณทำงานกับ Aspose.Cells ได้ ด้านล่างนี้คือการนำเข้าที่คุณต้องใช้สำหรับตัวอย่างนี้:
```csharp
using System.IO;
using Aspose.Cells;
```
- Aspose.Cells: เนมสเปซนี้มีความจำเป็น เนื่องจากให้สิทธิ์ในการเข้าถึงคลาสทั้งหมดที่จำเป็นสำหรับการทำงานกับไฟล์ Excel
- ระบบ: เนมสเปซนี้ใช้สำหรับฟังก์ชันระบบพื้นฐานเช่นการจัดการไฟล์
ตอนนี้ คุณได้นำเข้าแพ็คเกจที่จำเป็นแล้ว มาเข้าสู่กระบวนการจริงในการปกป้องคอลัมน์ในเวิร์กชีตกัน
## คู่มือทีละขั้นตอนในการป้องกันคอลัมน์ในเวิร์กชีต
เราจะแบ่งกระบวนการนี้ออกเป็นขั้นตอนที่จัดการได้เพื่อให้คุณทำตามได้อย่างง่ายดาย ต่อไปนี้เป็นวิธีการป้องกันคอลัมน์โดยใช้ Aspose.Cells สำหรับ .NET
## ขั้นตอนที่ 1: ตั้งค่าไดเรกทอรีเอกสาร
ขั้นแรก เราต้องตรวจสอบให้แน่ใจว่าไดเร็กทอรีที่จะบันทึกไฟล์นั้นมีอยู่ หากไม่มี เราจะสร้างไดเร็กทอรีนั้นขึ้นมา ซึ่งเป็นสิ่งสำคัญเพื่อหลีกเลี่ยงข้อผิดพลาดเมื่อพยายามบันทึกเวิร์กบุ๊กในภายหลัง
```csharp
string dataDir = "Your Document Directory";
// สร้างไดเร็กทอรีหากยังไม่มีอยู่
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
- dataDir: เส้นทางไดเร็กทอรีที่คุณจะเก็บไฟล์เอาต์พุตของคุณ
- Directory.Exists(): ตรวจสอบว่าไดเร็กทอรีมีอยู่แล้วหรือไม่
- Directory.CreateDirectory(): ถ้าไดเร็กทอรีไม่มีอยู่ การดำเนินการนี้จะสร้างมันขึ้นมา
## ขั้นตอนที่ 2: สร้างสมุดงานใหม่
เมื่อกำหนดไดเรกทอรีเรียบร้อยแล้ว เรามาสร้างเวิร์กบุ๊กใหม่กัน เวิร์กบุ๊กนี้จะทำหน้าที่เป็นไฟล์ฐานที่เราจะทำการเปลี่ยนแปลง
```csharp
Workbook wb = new Workbook();
```
- เวิร์กบุ๊ก: นี่คือวัตถุหลักที่แสดงไฟล์ Excel คุณสามารถมองว่ามันเป็นคอนเทนเนอร์สำหรับแผ่นงานและข้อมูลทั้งหมด
## ขั้นตอนที่ 3: เข้าถึงแผ่นงานแรก
เวิร์กบุ๊กทุกเล่มมีเวิร์กชีตหลายแผ่น และเราจำเป็นต้องเข้าถึงเวิร์กชีตแรกที่เราจะใช้การป้องกันคอลัมน์
```csharp
Worksheet sheet = wb.Worksheets[0];
```
- ใบงาน[[0]: การดำเนินการนี้จะเรียกค้นเวิร์กชีตแรกในเวิร์กบุ๊ก (เวิร์กชีต Excel มีดัชนีเป็นศูนย์)
## ขั้นตอนที่ 4: กำหนดวัตถุ Style และ StyleFlag
ถัดไป เราจะกำหนดอ็อบเจ็กต์สองรายการคือ Style และ StyleFlag ซึ่งใช้เพื่อปรับแต่งลักษณะที่ปรากฏและการตั้งค่าการป้องกันของเซลล์
```csharp
Style style;
StyleFlag flag;
```
- รูปแบบ: ช่วยให้เราเปลี่ยนแปลงคุณสมบัติ เช่น แบบอักษร สี และการตั้งค่าการป้องกันของเซลล์หรือคอลัมน์ได้
- StyleFlag: ใช้เพื่อระบุคุณสมบัติที่จะใช้เมื่อใช้เมธอด ApplyStyle
## ขั้นตอนที่ 5: ปลดล็อคคอลัมน์ทั้งหมด
ตามค่าเริ่มต้น Excel จะล็อกเซลล์ทั้งหมดในเวิร์กชีตเมื่อมีการใช้การป้องกัน แต่เราต้องการปลดล็อกคอลัมน์ทั้งหมดก่อน ดังนั้นเราจึงล็อกเฉพาะคอลัมน์ใดคอลัมน์หนึ่งในภายหลังได้ เช่น คอลัมน์แรก
```csharp
for (int i = 0; i <= 255; i++)
{
    style = sheet.Cells.Columns[(byte)i].Style;
    style.IsLocked = false;
    flag = new StyleFlag();
    flag.Locked = true;
    sheet.Cells.Columns[(byte)i].ApplyStyle(style, flag);
}
```
- คอลัมน์[[(ไบต์)i]: การเข้าถึงคอลัมน์ที่ระบุในเวิร์กชีตโดยใช้ดัชนี (เราวนซ้ำผ่านคอลัมน์ 0 ถึง 255 ที่นี่)
- style.IsLocked = false: นี้จะปลดล็อกเซลล์ทั้งหมดในคอลัมน์
- ApplyStyle(): จะใช้สไตล์ (ปลดล็อคหรือล็อค) กับคอลัมน์ตามแฟล็ก
## ขั้นตอนที่ 6: ล็อคคอลัมน์แรก
เมื่อปลดล็อกคอลัมน์ทั้งหมดแล้ว เรามาล็อกคอลัมน์แรกเพื่อปกป้องคอลัมน์นี้กัน คอลัมน์นี้เป็นคอลัมน์ที่ผู้ใช้ไม่สามารถปรับเปลี่ยนได้
```csharp
style = sheet.Cells.Columns[0].Style;
style.IsLocked = true;
flag = new StyleFlag();
flag.Locked = true;
sheet.Cells.Columns[0].ApplyStyle(style, flag);
```
- คอลัมน์[0]: การเข้าถึงคอลัมน์แรก (ดัชนี 0)
- style.IsLocked = true: นี้จะล็อคคอลัมน์แรก เพื่อป้องกันไม่ให้ผู้ใช้ทำการเปลี่ยนแปลงใดๆ ได้
## ขั้นตอนที่ 7: ปกป้องแผ่นงาน
ตอนนี้เราได้ตั้งค่าการป้องกันสำหรับคอลัมน์แรกแล้ว เราจำเป็นต้องใช้การป้องกันกับเวิร์กชีตทั้งหมด การดำเนินการนี้จะช่วยให้มั่นใจว่าเซลล์ที่ถูกล็อก (เช่น คอลัมน์แรก) จะไม่สามารถแก้ไขได้ เว้นแต่จะลบการป้องกันออก
```csharp
sheet.Protect(ProtectionType.All);
```
- sheet.Protect(): การป้องกันนี้ใช้กับชีตทั้งหมด เราใช้ ProtectionType.All เพื่อป้องกันการเปลี่ยนแปลงใดๆ แต่คุณสามารถแก้ไขได้หากต้องการให้ผู้ใช้สามารถโต้ตอบกับองค์ประกอบบางอย่างได้
## ขั้นตอนที่ 8: บันทึกสมุดงาน
ในที่สุด เราจะบันทึกเวิร์กบุ๊กไปยังตำแหน่งที่ระบุ ในตัวอย่างนี้ เราจะบันทึกลงในไดเร็กทอรีที่เราสร้างไว้ก่อนหน้านี้
```csharp
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```
- บันทึก(): บันทึกสมุดงานลงในระบบไฟล์
- SaveFormat.Excel97To2003: เราบันทึกเวิร์กบุ๊กเป็นรูปแบบ Excel 97-2003 รุ่นเก่า คุณสามารถเปลี่ยนเป็น SaveFormat.Xlsx เพื่อใช้รูปแบบใหม่กว่าได้
## บทสรุป
ในบทช่วยสอนนี้ เราได้แนะนำคุณตลอดกระบวนการปกป้องคอลัมน์ในเวิร์กชีตโดยใช้ Aspose.Cells สำหรับ .NET คุณสามารถกำหนดคอลัมน์ที่แก้ไขได้และคอลัมน์ที่ได้รับการปกป้องได้อย่างง่ายดายโดยทำตามขั้นตอนเหล่านี้ ซึ่งจะช่วยให้ควบคุมเอกสาร Excel ของคุณได้ดีขึ้น Aspose.Cells มอบวิธีที่มีประสิทธิภาพในการจัดการไฟล์ Excel ด้วยโปรแกรม และด้วยการฝึกฝนเพียงเล็กน้อย คุณสามารถเชี่ยวชาญงานเหล่านี้เพื่อทำให้เวิร์กโฟลว์ของคุณเป็นอัตโนมัติได้
## คำถามที่พบบ่อย
### ฉันสามารถป้องกันมากกว่าหนึ่งคอลัมน์ในครั้งเดียวได้ไหม  
ใช่ คุณสามารถปกป้องคอลัมน์หลายคอลัมน์ได้ด้วยการล็อคคอลัมน์แต่ละคอลัมน์ เช่นเดียวกับที่เราทำกับคอลัมน์แรก
### ฉันสามารถอนุญาตให้ผู้ใช้แก้ไขคอลัมน์ที่เจาะจงในขณะที่ปกป้องคอลัมน์อื่นๆ ได้หรือไม่  
 แน่นอน! คุณสามารถปลดล็อคคอลัมน์เฉพาะได้โดยการตั้งค่า`style.IsLocked = false` สำหรับพวกเขาแล้วให้ใช้การป้องกันกับแผ่นงาน
### ฉันจะลบการป้องกันออกจากเวิร์กชีตได้อย่างไร  
 หากต้องการยกเลิกการป้องกัน เพียงโทร`sheet.Unprotect()`คุณสามารถส่งรหัสผ่านได้หากมีการตั้งรหัสผ่านไว้ระหว่างการป้องกัน
### ฉันสามารถตั้งรหัสผ่านเพื่อป้องกันเวิร์กชีตได้หรือไม่  
ใช่ คุณสามารถส่งรหัสผ่านเป็นพารามิเตอร์ได้`sheet.Protect("yourPassword")` เพื่อให้แน่ใจว่าผู้ใช้ที่ได้รับอนุญาตเท่านั้นที่สามารถยกเลิกการป้องกันแผ่นงานได้
### เป็นไปได้ไหมที่จะปกป้องเซลล์แต่ละเซลล์แทนคอลัมน์ทั้งหมด?  
ใช่ คุณสามารถล็อคเซลล์แต่ละเซลล์ได้โดยการเข้าถึงรูปแบบของแต่ละเซลล์และใช้คุณสมบัติล็อคกับเซลล์เหล่านั้น

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
