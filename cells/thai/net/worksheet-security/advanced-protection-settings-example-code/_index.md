---
title: นำการตั้งค่าการป้องกันขั้นสูงไปใช้งานด้วยโค้ดตัวอย่างโดยใช้ Aspose.Cells
linktitle: นำการตั้งค่าการป้องกันขั้นสูงไปใช้งานด้วยโค้ดตัวอย่างโดยใช้ Aspose.Cells
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีใช้การตั้งค่าการป้องกันขั้นสูงใน Excel โดยใช้ Aspose.Cells สำหรับ .NET ควบคุมว่าใครสามารถแก้ไขไฟล์ของคุณได้อย่างมีประสิทธิภาพ
weight: 24
url: /th/net/worksheet-security/advanced-protection-settings-example-code/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# นำการตั้งค่าการป้องกันขั้นสูงไปใช้งานด้วยโค้ดตัวอย่างโดยใช้ Aspose.Cells

## การแนะนำ
เมื่อต้องจัดการแผ่นงาน Excel โดยเฉพาะในสภาพแวดล้อมการทำงานร่วมกัน การควบคุมว่าใครสามารถทำอะไรได้จึงมีความสำคัญมาก นี่คือจุดที่ Aspose.Cells สำหรับ .NET เข้ามามีบทบาท ทำให้การตั้งค่าการป้องกันขั้นสูงเป็นเรื่องง่าย หากคุณต้องการเพิ่มความปลอดภัยให้กับไฟล์ Excel ของคุณโดยจำกัดการกระทำของผู้ใช้ คุณมาถูกที่แล้ว ในบทความนี้ เราจะอธิบายทุกอย่างทีละขั้นตอน ดังนั้นไม่ว่าคุณจะเป็นนักพัฒนาที่มีประสบการณ์หรือเพียงแค่กำลังเล่น .NET อยู่ คุณก็จะสามารถทำตามได้โดยไม่มีปัญหา!
## ข้อกำหนดเบื้องต้น
ก่อนที่เราจะเจาะลึกโค้ด เรามาเริ่มต้นกันก่อนดีกว่า คุณจะไม่สามารถใช้ประโยชน์จาก Aspose.Cells ได้หากไม่มีเครื่องมือและซอฟต์แวร์ที่จำเป็น นี่คือสิ่งที่คุณต้องการ:
1. .NET Framework: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง .NET framework เวอร์ชันที่เหมาะสมบนเครื่องของคุณแล้ว ตัวอย่างโค้ดส่วนใหญ่จะทำงานกับ .NET Core หรือ .NET Framework 4.x
2.  Aspose.Cells สำหรับ .NET: คุณต้องติดตั้ง Aspose.Cells คุณสามารถดาวน์โหลดได้อย่างง่ายดายจาก[ลิงค์ดาวน์โหลด](https://releases.aspose.com/cells/net/).
3. โปรแกรมแก้ไขข้อความหรือ IDE: ไม่ว่าคุณจะชอบ Visual Studio, Visual Studio Code หรือ IDE อื่นๆ คุณก็ต้องมีที่สำหรับเขียนและรันโค้ดของคุณ
4. ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับภาษา C# จะช่วยได้เนื่องจากตัวอย่างของเราเน้นโค้ดเป็นหลัก
เข้าใจแล้วใช่ไหม เยี่ยมเลย มาเริ่มสนุกกันเลยดีกว่า: การเขียนโค้ด
## แพ็คเกจนำเข้า
สิ่งแรกที่ต้องทำ: เราต้องตั้งค่าโครงการโดยนำเข้าแพ็คเกจที่จำเป็น คุณต้องรวมไลบรารี Aspose.Cells ไว้ในโครงการของคุณ ดังต่อไปนี้:
## ขั้นตอนที่ 1: เพิ่มแพ็กเกจ Aspose.Cells NuGet
หากต้องการรวมไลบรารี Aspose.Cells ไว้ในโปรเจ็กต์ของคุณได้อย่างง่ายดายผ่าน NuGet คุณสามารถทำได้ผ่านคอนโซล Package Manager หรือค้นหาไลบรารีนี้ใน NuGet Package Manager
- การใช้คอนโซลตัวจัดการแพ็กเกจ NuGet: 
  ```bash
  Install-Package Aspose.Cells
```
- Using Visual Studio: 
- Right-click on your project in the Solution Explorer.
- Select "Manage NuGet Packages."
- Search for "Aspose.Cells" and install it.
Once you've got that covered, you’re ready to go!
```csharp
using System.IO;
using Aspose.Cells;
```
ตอนนี้มาดูขั้นตอนในการใช้การตั้งค่าการป้องกันขั้นสูงในเวิร์กบุ๊ก Excel โดยใช้ Aspose.Cells กัน ทำตามนี้เพื่อดูรายละเอียด:
## ขั้นตอนที่ 1: กำหนดไดเรกทอรีเอกสาร
ขั้นแรก คุณต้องกำหนดว่าไฟล์ Excel ของคุณอยู่ที่ใด ขั้นตอนนี้จะกำหนดตำแหน่งที่จะอ่านและบันทึกโค้ดของคุณ มีลักษณะดังนี้:
```csharp
string dataDir = "Your Document Directory";
```
 แทนที่`"Your Document Directory"` ด้วยเส้นทางจริงไปยังที่จัดเก็บเอกสาร Excel ของคุณ สิ่งสำคัญคือต้องแน่ใจว่าเส้นทางนี้ถูกต้องเพื่อหลีกเลี่ยงข้อผิดพลาดระหว่างการทำงาน
## ขั้นตอนที่ 2: สร้าง FileStream เพื่ออ่านไฟล์ Excel
เมื่อกำหนดไดเรกทอรีเอกสารเรียบร้อยแล้ว ก็ถึงเวลาสร้างสตรีมไฟล์ที่จะอนุญาตให้โค้ดของคุณเปิดไฟล์ Excel ได้ ซึ่งก็เหมือนกับการเปิดประตูสู่ไฟล์ Excel ของคุณเพื่อการอ่านและการเขียน
```csharp
FileStream fstream = new FileStream(dataDir + "book1.xls", FileMode.Open);
```
ในบรรทัดนี้เราจะเปิดไฟล์ Excel ชื่อ`book1.xls` ในโหมดอ่าน/เขียน
## ขั้นตอนที่ 3: สร้างอินสแตนซ์ของวัตถุเวิร์กบุ๊ก
 คุณยังไม่เสร็จ! ตอนนี้คุณต้องสร้าง`Workbook` วัตถุซึ่งเป็นจุดเข้าหลักของคุณสำหรับการทำงานกับไฟล์ Excel ลองนึกถึงการสร้างพื้นที่ทำงานที่การเปลี่ยนแปลงทั้งหมดของคุณจะเกิดขึ้น
```csharp
Workbook excel = new Workbook(fstream);
```
 ด้วยโค้ดนี้ไฟล์ Excel จะอยู่ในของคุณแล้ว`excel` วัตถุ!
## ขั้นตอนที่ 4: เข้าถึงแผ่นงานแรก
ตอนนี้คุณมีเวิร์กบุ๊กอยู่ในมือแล้ว ถึงเวลาเข้าถึงเวิร์กชีตเฉพาะที่คุณต้องการจัดการ ในตัวอย่างนี้ เราจะยึดตามเวิร์กชีตแรก
```csharp
Worksheet worksheet = excel.Worksheets[0];
```
บรรทัดนี้จะคว้าเวิร์กชีตแรก ดังนั้นคุณจึงสามารถใช้การตั้งค่าการป้องกันของคุณกับมันได้
## ขั้นตอนที่ 5: การดำเนินการตั้งค่าการป้องกัน
ความสนุกเริ่มต้นที่นี่! ภายในวัตถุเวิร์กชีตของคุณ คุณสามารถระบุประเภทของการกระทำที่ผู้ใช้สามารถทำหรือไม่สามารถทำได้ มาสำรวจข้อจำกัดทั่วไปบางประการกัน
### จำกัดการลบคอลัมน์และแถว
```csharp
worksheet.Protection.AllowDeletingColumn = false;
worksheet.Protection.AllowDeletingRow = false;
```
การตั้งค่าเหล่านี้ช่วยให้แน่ใจว่าผู้ใช้ไม่สามารถลบคอลัมน์หรือแถวได้ ซึ่งก็เหมือนกับการปกป้องความสมบูรณ์ของเอกสารของคุณนั่นเอง!
### การจำกัดการแก้ไขเนื้อหาและวัตถุ
ขั้นตอนต่อไป คุณอาจต้องการหยุดผู้ใช้จากการแก้ไขเนื้อหาหรือแก้ไขวัตถุภายในชีต ดังต่อไปนี้:
```csharp
worksheet.Protection.AllowEditingContent = false;
worksheet.Protection.AllowEditingObject = false;
worksheet.Protection.AllowEditingScenario = false;
```
บรรทัดเหล่านี้ทำให้ชัดเจนว่าอย่าสัมผัสเนื้อหาหรือวัตถุใด ๆ บนแผ่นงาน! 
### จำกัดการกรองและเปิดใช้งานตัวเลือกการจัดรูปแบบ
แม้ว่าคุณอาจต้องการหยุดการแก้ไข แต่การอนุญาตให้จัดรูปแบบบางอย่างอาจเป็นประโยชน์ได้ ต่อไปนี้คือการผสมผสานทั้งสองอย่าง:
```csharp
worksheet.Protection.AllowFiltering = false;
worksheet.Protection.AllowFormattingCell = true;
worksheet.Protection.AllowFormattingRow = true;
worksheet.Protection.AllowFormattingColumn = true;
```
ผู้ใช้จะไม่สามารถกรองข้อมูลได้ แต่ยังคงจัดรูปแบบเซลล์ แถว และคอลัมน์ได้ ถือเป็นความสมดุลที่ดีใช่ไหม
### อนุญาตให้แทรกไฮเปอร์ลิงก์และแถว
คุณสามารถให้ผู้ใช้มีความยืดหยุ่นในการแทรกข้อมูลหรือลิงก์ใหม่ได้ ดังนี้:
```csharp
worksheet.Protection.AllowInsertingHyperlink = true;
worksheet.Protection.AllowInsertingRow = true;
```
ผู้ใช้สามารถแทรกไฮเปอร์ลิงก์และแถว เพื่อให้แผ่นงานมีความไดนามิกในขณะที่ยังคงควบคุมองค์ประกอบอื่นๆ ได้
### การอนุญาตขั้นสุดท้าย: เลือกเซลล์ที่ล็อคและปลดล็อค
นอกจากนี้ คุณอาจต้องการให้ผู้ใช้สามารถเลือกเซลล์ที่ล็อกหรือปลดล็อกได้ นี่คือความมหัศจรรย์:
```csharp
worksheet.Protection.AllowSelectingLockedCell = true;
worksheet.Protection.AllowSelectingUnlockedCell = true;
```
ซึ่งจะช่วยให้ผู้ใช้ยังสามารถโต้ตอบกับส่วนที่ไม่ได้รับการป้องกันของชีตของคุณได้โดยไม่รู้สึกว่าถูกจำกัดอย่างเข้มงวด
## ขั้นตอนที่ 6: อนุญาตการเรียงลำดับและการใช้ตารางสรุปข้อมูล
หากแผ่นงานของคุณเกี่ยวข้องกับการวิเคราะห์ข้อมูล คุณอาจต้องการอนุญาตให้มีการเรียงลำดับและใช้ตารางสรุปข้อมูล วิธีอนุญาตให้ใช้ฟังก์ชันเหล่านี้มีดังนี้
```csharp
worksheet.Protection.AllowSorting = true;
worksheet.Protection.AllowUsingPivotTable = true;
```
บรรทัดเหล่านี้ช่วยให้ผู้ใช้สามารถจัดการข้อมูลของตนให้เป็นระเบียบโดยยังคงได้รับการปกป้องจากการเปลี่ยนแปลงที่ไม่ต้องการ!
## ขั้นตอนที่ 7: บันทึกไฟล์ Excel ที่ปรับเปลี่ยนแล้ว
ตอนนี้คุณได้ตั้งค่าการป้องกันทั้งหมดแล้ว สิ่งสำคัญคือต้องบันทึกการเปลี่ยนแปลงเหล่านั้นลงในไฟล์ใหม่ วิธีบันทึกมีดังนี้:
```csharp
excel.Save(dataDir + "output.xls", SaveFormat.Excel97To2003);
```
 บรรทัดนี้จะบันทึกสมุดงานภายใต้ชื่อ`output.xls`เพื่อให้แน่ใจว่าไม่มีการเปลี่ยนแปลงใด ๆ ต่อไฟล์ต้นฉบับ 
## ขั้นตอนที่ 8: การปิด FileStream
สุดท้ายแต่ไม่ท้ายสุด คุณต้องปลดปล่อยทรัพยากรโดยการปิดสตรีมไฟล์ อย่าลืมทำสิ่งนี้เสมอ!
```csharp
fstream.Close();
```
และแล้วคุณก็จะมีมัน! คุณได้สร้างสภาพแวดล้อมที่ควบคุมได้รอบไฟล์ Excel ของคุณอย่างมีประสิทธิภาพโดยใช้ Aspose.Cells
## บทสรุป
การนำการตั้งค่าการป้องกันขั้นสูงไปใช้กับ Aspose.Cells สำหรับ .NET นั้นไม่เพียงแต่ตรงไปตรงมาเท่านั้น แต่ยังมีความจำเป็นต่อการรักษาความสมบูรณ์ของไฟล์ Excel ของคุณอีกด้วย การกำหนดข้อจำกัดและการอนุญาตอย่างเหมาะสมจะช่วยให้คุณมั่นใจได้ว่าข้อมูลของคุณจะปลอดภัยในขณะที่ยังคงให้ผู้ใช้โต้ตอบกับข้อมูลได้อย่างมีประโยชน์ ดังนั้น ไม่ว่าคุณจะกำลังทำงานกับรายงาน การวิเคราะห์ข้อมูล หรือโครงการร่วมมือ ขั้นตอนเหล่านี้จะช่วยให้คุณเดินไปบนเส้นทางที่ถูกต้อง
## คำถามที่พบบ่อย
### Aspose.Cells คืออะไร?
Aspose.Cells เป็นส่วนประกอบ .NET ที่มีประสิทธิภาพสำหรับการจัดการและปรับเปลี่ยนไฟล์ Excel ช่วยให้นักพัฒนาสามารถทำงานกับสเปรดชีตโดยทางโปรแกรมได้
### ฉันจะติดตั้ง Aspose.Cells ได้อย่างไร?
 คุณสามารถติดตั้ง Aspose.Cells ผ่าน NuGet ใน Visual Studio หรือจาก[ลิงค์ดาวน์โหลด](https://releases.aspose.com/cells/net/).
### ฉันสามารถทดลองใช้ Aspose.Cells ฟรีได้หรือไม่?
 ใช่ครับ! คุณสามารถรับได้[ทดลองใช้งานฟรี](https://releases.aspose.com/) เพื่อสำรวจคุณสมบัติของมัน
### Aspose.Cells สามารถทำงานกับไฟล์ Excel ประเภทใดได้บ้าง
Aspose.Cells รองรับรูปแบบต่างๆ รวมถึง XLS, XLSX, CSV และอื่นๆ
### ฉันสามารถค้นหาการสนับสนุนสำหรับ Aspose.Cells ได้ที่ไหน
คุณสามารถเข้าถึงการสนับสนุนชุมชนได้ผ่านทาง[ฟอรั่ม Aspose](https://forum.aspose.com/c/cells/9).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
