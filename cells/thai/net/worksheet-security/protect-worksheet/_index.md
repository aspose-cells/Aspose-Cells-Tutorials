---
title: ปกป้องเวิร์กชีตทั้งหมดโดยใช้ Aspose.Cells
linktitle: ปกป้องเวิร์กชีตทั้งหมดโดยใช้ Aspose.Cells
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีป้องกันเวิร์กชีต Excel ด้วยรหัสผ่านโดยใช้ Aspose.Cells สำหรับ .NET บทช่วยสอนแบบทีละขั้นตอนเพื่อรักษาความปลอดภัยข้อมูลของคุณได้อย่างง่ายดาย
weight: 17
url: /th/net/worksheet-security/protect-worksheet/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# ปกป้องเวิร์กชีตทั้งหมดโดยใช้ Aspose.Cells

## การแนะนำ
คุณกำลังมองหาวิธีปกป้องเวิร์กชีต Excel ของคุณจากการแก้ไขโดยไม่ได้ตั้งใจหรือการปรับเปลี่ยนที่ไม่ได้รับอนุญาตหรือไม่ ไม่ว่าคุณจะทำงานกับข้อมูลที่ละเอียดอ่อนหรือต้องการเพียงแค่ให้แน่ใจว่าสูตรและเนื้อหาของคุณได้รับการดูแล การปกป้องเวิร์กชีตของคุณก็มีความสำคัญ ในบทช่วยสอนนี้ เราจะมาสำรวจวิธีการปกป้องเวิร์กชีตทั้งหมดโดยใช้ Aspose.Cells สำหรับ .NET
## ข้อกำหนดเบื้องต้น
ก่อนที่เราจะเจาะลึกโค้ด มาดูสิ่งต่างๆ บางอย่างที่คุณจำเป็นต้องเริ่มต้นกันก่อน:
1.  Aspose.Cells สำหรับ .NET: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Aspose.Cells ไว้ในสภาพแวดล้อมของคุณแล้ว คุณสามารถดาวน์โหลดได้จากเว็บไซต์[ที่นี่](https://releases.aspose.com/cells/net/).
2. Visual Studio: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Visual Studio สำหรับการเขียนโค้ดใน .NET แล้ว คุณสามารถใช้เวอร์ชันใดก็ได้ที่รองรับ C# หรือ VB.NET
3. ความรู้พื้นฐานเกี่ยวกับ C#: คู่มือนี้ถือว่าคุณมีความเข้าใจพื้นฐานเกี่ยวกับ C# และวิธีทำงานกับไฟล์ Excel โดยโปรแกรม
4.  ไฟล์ Excel: ในตัวอย่างนี้ เราจะทำงานกับไฟล์ Excel ชื่อ`book1.xls`คุณจะต้องมีไฟล์ตัวอย่างเพื่อใช้ทดลอง
## แพ็คเกจนำเข้า
 ขั้นตอนแรกคือการนำเข้าไลบรารีที่จำเป็น ในการใช้ Aspose.Cells สำหรับ .NET คุณจำเป็นต้องอ้างอิงไลบรารีในโปรเจ็กต์ของคุณ คุณสามารถทำได้โดยเพิ่มไลบรารีที่เหมาะสม`using` คำสั่งที่ด้านบนของโค้ด C# ของคุณ
นี่คือวิธีนำเข้าแพ็คเกจที่จำเป็น:
```csharp
using System.IO;
using Aspose.Cells;
```
เนมสเปซเหล่านี้มีความจำเป็นสำหรับการสร้างและจัดการเวิร์กบุ๊กและเวิร์กชีต Excel ใน Aspose.Cells
ตอนนี้เรามาแบ่งขั้นตอนออกเป็นขั้นตอนง่ายๆ กัน เราจะอธิบายแต่ละส่วนของกระบวนการอย่างชัดเจน เพื่อให้แน่ใจว่าคุณเข้าใจวิธีปกป้องเวิร์กชีตของคุณอย่างมีประสิทธิภาพ
## ขั้นตอนที่ 1: ตั้งค่าไดเรกทอรีเอกสารของคุณ
ก่อนเริ่มดำเนินการกับ Excel คุณจะต้องกำหนดเส้นทางไปยังโฟลเดอร์ที่ไฟล์ Excel ของคุณตั้งอยู่เสียก่อน วิธีนี้จะช่วยให้คุณอ่านและบันทึกไฟล์ได้อย่างราบรื่น
```csharp
string dataDir = "Your Document Directory";
```
 ในกรณีนี้ให้แทนที่`"Your Document Directory"` ด้วยเส้นทางจริงที่จัดเก็บไฟล์ Excel ของคุณ ตัวอย่างเช่น`"C:\\Documents\\"` หรือ`"/Users/YourName/Documents/"`คุณจะใช้เส้นทางนี้เพื่อเปิดและบันทึกไฟล์ในภายหลัง
## ขั้นตอนที่ 2: สร้างสตรีมไฟล์สำหรับเปิดไฟล์ Excel
 ถัดไปคุณต้องเปิดไฟล์ Excel โดยใช้`FileStream`นี้จะช่วยให้คุณสามารถอ่านและจัดการไฟล์ผ่านโปรแกรมได้
```csharp
FileStream fstream = new FileStream(dataDir + "book1.xls", FileMode.Open);
```
 รหัสนี้จะเปิด`book1.xls` ไฟล์จากไดเร็กทอรีที่ระบุ`FileMode.Open` อาร์กิวเมนต์ช่วยให้แน่ใจว่าไฟล์ถูกเปิดเพื่อการอ่าน คุณสามารถแทนที่`"book1.xls"` ด้วยชื่อไฟล์จริงของคุณ
## ขั้นตอนที่ 3: สร้างอินสแตนซ์ของวัตถุเวิร์กบุ๊ก
 ตอนนี้คุณเปิดไฟล์แล้ว ถึงเวลาโหลดเนื้อหาของไฟล์ลงในอ็อบเจ็กต์ที่ Aspose.Cells สามารถทำงานด้วยได้ ซึ่งทำได้โดยการสร้าง`Workbook` วัตถุ.
```csharp
Workbook excel = new Workbook(fstream);
```
 บรรทัดโค้ดนี้จะโหลดไฟล์ Excel ลงใน`excel` วัตถุซึ่งตอนนี้แสดงถึงสมุดงานทั้งหมด
## ขั้นตอนที่ 4: เข้าถึงแผ่นงานที่คุณต้องการปกป้อง
 หลังจากโหลดเวิร์กบุ๊กแล้ว คุณต้องเข้าถึงเวิร์กชีตที่คุณต้องการปกป้อง ไฟล์ Excel สามารถมีเวิร์กชีตได้หลายแผ่น ดังนั้น คุณจะต้องระบุว่าจะทำงานกับแผ่นใดโดยการสร้างดัชนี`Worksheets`ของสะสม.
```csharp
Worksheet worksheet = excel.Worksheets[0];
```
 ในกรณีนี้ เราจะเข้าถึงเวิร์กชีตแรกในเวิร์กบุ๊ก (ดัชนี`0` หมายถึงแผ่นงานแรก) หากคุณต้องการทำงานกับแผ่นงานอื่น เพียงแค่เปลี่ยนหมายเลขดัชนีให้ตรงกับแผ่นงานที่ถูกต้อง
## ขั้นตอนที่ 5: ป้องกันเวิร์กชีตด้วยรหัสผ่าน
 นี่เป็นขั้นตอนสำคัญที่การป้องกันจะเข้ามามีบทบาท คุณสามารถป้องกันเวิร์กชีตได้โดยใช้`Protect` วิธีการและการระบุรหัสผ่าน รหัสผ่านนี้จะป้องกันไม่ให้ผู้ใช้ที่ไม่ได้รับอนุญาตยกเลิกการป้องกันและแก้ไขแผ่นงาน
```csharp
worksheet.Protect(ProtectionType.All, "aspose", null);
```
นี่คือสิ่งที่เกิดขึ้น:
-  ProtectionType.All: ระบุระดับการป้องกันที่คุณต้องการใช้`ProtectionType.All` ใช้การป้องกันแบบเต็มรูปแบบเพื่อป้องกันการเปลี่ยนแปลงใดๆ ต่อเวิร์กชีต
- `"aspose"`:นี่คือรหัสผ่านที่จะใช้ในการป้องกันเวิร์กชีต คุณสามารถตั้งค่าเป็นสตริงใดก็ได้ตามต้องการ
- `null`:นี่ระบุว่าไม่มีการระบุการตั้งค่าการป้องกันเพิ่มเติม
## ขั้นตอนที่ 6: บันทึกสมุดงานที่ได้รับการป้องกัน
เมื่อเวิร์กชีตได้รับการป้องกันแล้ว คุณจะต้องการบันทึกการเปลี่ยนแปลงลงในไฟล์ใหม่ Aspose.Cells ช่วยให้คุณบันทึกเวิร์กบุ๊กที่แก้ไขแล้วในรูปแบบต่างๆ ที่นี่ เราจะบันทึกเป็นรูปแบบ Excel 97-2003 (`.xls`-
```csharp
excel.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```
 บรรทัดโค้ดนี้จะบันทึกสมุดงานพร้อมการป้องกันภายใต้ชื่อ`output.out.xls`คุณสามารถระบุชื่อหรือรูปแบบอื่นได้หากจำเป็น
## ขั้นตอนที่ 7: ปิดสตรีมไฟล์
 สุดท้ายหลังจากบันทึกไฟล์แล้ว สิ่งสำคัญคือการปิด`FileStream` เพื่อปล่อยทรัพยากรระบบใดๆ ที่ถูกใช้งาน
```csharp
fstream.Close();
```
วิธีนี้จะช่วยให้แน่ใจว่าไฟล์ถูกปิดอย่างถูกต้องและไม่มีการสูญเสียหน่วยความจำ
## บทสรุป
การปกป้องเวิร์กชีต Excel ของคุณเป็นขั้นตอนสำคัญในการปกป้องข้อมูลที่ละเอียดอ่อน โดยให้แน่ใจว่ามีเพียงบุคคลที่ได้รับอนุญาตเท่านั้นที่สามารถทำการเปลี่ยนแปลงได้ ด้วย Aspose.Cells สำหรับ .NET กระบวนการนี้จะกลายเป็นเรื่องง่ายและมีประสิทธิภาพอย่างเหลือเชื่อ ด้วยการทำตามขั้นตอนที่ระบุไว้ในบทช่วยสอนนี้ คุณจะสามารถใช้การป้องกันด้วยรหัสผ่านกับเวิร์กชีตทั้งหมดได้อย่างง่ายดาย เพื่อป้องกันการแก้ไขโดยไม่ได้รับอนุญาตและรักษาความสมบูรณ์ของเอกสารของคุณ
## คำถามที่พบบ่อย
### ฉันสามารถป้องกันช่วงเฉพาะภายในเวิร์กชีตได้หรือไม่  
ใช่ Aspose.Cells ช่วยให้คุณปกป้องช่วงข้อมูลที่ต้องการโดยการใช้การป้องกันกับเซลล์หรือช่วงข้อมูลแต่ละรายการ แทนที่จะใช้กับเวิร์กชีตทั้งหมด
### ฉันสามารถยกเลิกการป้องกันเวิร์กชีตโดยโปรแกรมได้หรือไม่  
 ใช่ คุณสามารถยกเลิกการป้องกันเวิร์กชีตได้โดยใช้`Unprotect` วิธีการและการระบุรหัสผ่านที่ถูกต้อง
### ฉันสามารถใช้การป้องกันหลายประเภทได้ไหม?  
แน่นอน! คุณสามารถใช้การป้องกันประเภทต่างๆ ได้ (เช่น การปิดใช้งานการแก้ไข การจัดรูปแบบ ฯลฯ) ขึ้นอยู่กับความต้องการของคุณ
### ฉันจะใช้การป้องกันกับเวิร์กชีตหลายแผ่นได้อย่างไร  
คุณสามารถวนซ้ำผ่านเวิร์กชีตในเวิร์กบุ๊กของคุณและป้องกันแต่ละแผ่นได้
### ฉันจะทดสอบว่าเวิร์กชีตได้รับการป้องกันหรือไม่ได้อย่างไร  
 คุณสามารถตรวจสอบว่าแผ่นงานได้รับการป้องกันหรือไม่โดยใช้`IsProtected` ทรัพย์สินของ`Worksheet` ระดับ.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
