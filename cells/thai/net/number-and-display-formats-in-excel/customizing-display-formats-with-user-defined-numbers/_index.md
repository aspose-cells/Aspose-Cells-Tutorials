---
"description": "เรียนรู้วิธีปรับแต่งรูปแบบการแสดงผลด้วย Aspose.Cells สำหรับ .NET จัดรูปแบบวันที่ เปอร์เซ็นต์ และสกุลเงินโดยใช้คู่มือทีละขั้นตอนนี้"
"linktitle": "การปรับแต่งรูปแบบการแสดงผลด้วยตัวเลขที่ผู้ใช้กำหนด"
"second_title": "API การประมวลผล Excel ของ Aspose.Cells .NET"
"title": "การปรับแต่งรูปแบบการแสดงผลด้วยตัวเลขที่ผู้ใช้กำหนด"
"url": "/th/net/number-and-display-formats-in-excel/customizing-display-formats-with-user-defined-numbers/"
"weight": 11
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# การปรับแต่งรูปแบบการแสดงผลด้วยตัวเลขที่ผู้ใช้กำหนด

## การแนะนำ
การทำงานกับไฟล์ Excel มักต้องมีการจัดรูปแบบเซลล์แบบกำหนดเองเพื่อแสดงข้อมูลในรูปแบบที่มีความหมายและเป็นมิตรต่อผู้ใช้มากขึ้น ลองนึกภาพว่าคุณกำลังสร้างไฟล์ Excel สำหรับรายงาน คุณไม่ได้ต้องการแค่ตัวเลขดิบๆ เท่านั้น แต่คุณต้องการให้วันที่ เปอร์เซ็นต์ และสกุลเงินดูสวยงามและเป็นมืออาชีพใช่หรือไม่ นั่นคือจุดที่รูปแบบการแสดงผลแบบกำหนดเองเข้ามามีบทบาท ในบทช่วยสอนนี้ เราจะเจาะลึก Aspose.Cells สำหรับ .NET เพื่อแสดงให้คุณเห็นถึงวิธีการปรับแต่งรูปแบบการแสดงผลของตัวเลขโดยใช้การตั้งค่าที่ผู้ใช้กำหนด
## ข้อกำหนดเบื้องต้น
ก่อนเริ่มต้น ตรวจสอบให้แน่ใจว่าคุณมีทุกอย่างพร้อมสำหรับปฏิบัติตามบทช่วยสอนนี้แล้ว นี่คือสิ่งที่คุณต้องการ:
- ติดตั้ง Aspose.Cells สำหรับ .NET แล้ว [ดาวน์โหลดได้ที่นี่](https://releases-aspose.com/cells/net/).
- ความรู้พื้นฐานเกี่ยวกับ C# และ .NET framework
- ใบอนุญาตที่ถูกต้องสำหรับ Aspose.Cells หากคุณยังไม่มี ให้ดาวน์โหลด [ทดลองใช้งานฟรี](https://releases.aspose.com/) หรือร้องขอ [ใบอนุญาตชั่วคราว](https://purchase-aspose.com/temporary-license/).
- IDE เช่น Visual Studio
- .NET Framework 4.0 หรือสูงกว่า
หากคุณพลาดสิ่งใดไป ไม่ต้องกังวล คุณสามารถกลับมาที่ลิงก์เหล่านี้เพื่อดาวน์โหลดไฟล์ที่จำเป็นหรือขอความช่วยเหลือจาก [ฟอรั่มสนับสนุน Aspose](https://forum-aspose.com/c/cells/9).
## นำเข้าเนมสเปซ
ก่อนที่จะเริ่มเขียนโค้ด คุณต้องนำเข้าเนมสเปซที่จำเป็นเพื่อเข้าถึงฟังก์ชันการทำงาน Aspose.Cells ที่จำเป็นทั้งหมด
```csharp
using System.IO;
using Aspose.Cells;
using System;
```
เนมสเปซทั้งสองนี้จะเป็นเครื่องมือหลักของคุณในบทช่วยสอนนี้ ตอนนี้มาดูส่วนที่สนุกกันเลย:
## ขั้นตอนที่ 1: การตั้งค่าไดเรกทอรีโครงการ
ขั้นแรก คุณต้องมีที่สำหรับเก็บไฟล์ใช่ไหม มาสร้างไดเรกทอรีเพื่อบันทึกไฟล์ Excel เอาท์พุตกัน ในขั้นตอนนี้ เราจะตรวจสอบให้แน่ใจว่ามีไดเรกทอรีนั้นอยู่ก่อนจะบันทึกอะไรก็ตาม
```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "Your Document Directory";
// สร้างไดเร็กทอรีหากยังไม่มีอยู่
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
- เรากำลังกำหนด `dataDir` ตัวแปรสำหรับเก็บเส้นทางที่ไฟล์เอาท์พุต Excel จะไปถึง
- จากนั้นเราตรวจสอบว่าไดเร็กทอรีมีอยู่หรือไม่โดยใช้ `System-IO.Directory.Exists()`.
- ถ้าไดเร็กทอรีไม่มีอยู่ จะสร้างโดยใช้ `System-IO.Directory.CreateDirectory()`.
## ขั้นตอนที่ 2: สร้างสมุดงานใหม่และเพิ่มเวิร์กชีต
ตอนนี้เรามีไดเร็กทอรีแล้ว เรามาสร้างเวิร์กบุ๊ก Excel ใหม่และเพิ่มเวิร์กชีตลงไปกัน
```csharp
// การสร้างอินสแตนซ์ของวัตถุเวิร์กบุ๊ก
Workbook workbook = new Workbook();
// การเพิ่มเวิร์กชีตใหม่ลงในวัตถุ Excel
int i = workbook.Worksheets.Add();
// การรับข้อมูลอ้างอิงของเวิร์กชีตที่เพิ่มใหม่โดยส่งดัชนีชีตของมัน
Worksheet worksheet = workbook.Worksheets[i];
```
- ขั้นแรกเราสร้างใหม่ `Workbook` วัตถุ คิดว่านี่เป็นไฟล์ Excel ของคุณ
- เราเพิ่มเวิร์กชีตใหม่ลงในเวิร์กบุ๊กนี้โดยใช้ `Add()` วิธีการและเก็บดัชนีในตัวแปร `i`-
- เราอ้างอิงแผ่นงานนี้โดยใช้ `workbook-Worksheets[i]`.
## ขั้นตอนที่ 3: การเพิ่มวันที่ลงในเซลล์และปรับแต่งรูปแบบ
ตอนนี้เรามาแทรกวันที่ปัจจุบันลงในเซลล์และจัดรูปแบบให้แสดงในรูปแบบที่กำหนดเอง แทนที่จะใช้รูปแบบวันที่เริ่มต้น เราจะตั้งค่ารูปแบบที่กำหนดเอง เช่น `d-mmm-yy`-
```csharp
// การเพิ่มวันที่ระบบปัจจุบันลงในเซลล์ "A1"
worksheet.Cells["A1"].PutValue(DateTime.Now);
// การได้สไตล์ของเซลล์ A1
Style style = worksheet.Cells["A1"].GetStyle();
// ตั้งค่ารูปแบบการแสดงผลแบบกำหนดเองให้แสดงวันที่เป็น "d-mmm-yy"
style.Custom = "d-mmm-yy";
// การใช้สไตล์กับเซลล์ A1
worksheet.Cells["A1"].SetStyle(style);
```
- เราเพิ่มวันที่ระบบปัจจุบันลงในเซลล์ `A1` โดยใช้ `PutValue(DateTime-Now)`.
- เราดึงรูปแบบปัจจุบันของเซลล์ `A1` โดยใช้ `GetStyle()`-
- เราปรับเปลี่ยนรูปแบบเซลล์โดยการตั้งค่า `style.Custom = "d-mmm-yy"`ซึ่งจัดรูปแบบวันที่ให้แสดงวัน เดือนย่อ และปี
- สุดท้ายเราใช้รูปแบบใหม่กับเซลล์ด้วย `SetStyle()`-
## ขั้นตอนที่ 4: การจัดรูปแบบเซลล์เป็นเปอร์เซ็นต์
ต่อไปเรามาทำงานกับตัวเลขกัน เราจะเพิ่มค่าตัวเลขลงในเซลล์อื่น เช่น `A2`และจัดรูปแบบเป็นเปอร์เซ็นต์
```csharp
// การเพิ่มค่าตัวเลขลงในเซลล์ "A2"
worksheet.Cells["A2"].PutValue(20);
// การได้สไตล์ของเซลล์ A2
style = worksheet.Cells["A2"].GetStyle();
// การตั้งค่ารูปแบบการแสดงแบบกำหนดเองให้แสดงค่าเป็นเปอร์เซ็นต์
style.Custom = "0.0%";
// การใช้สไตล์กับเซลล์ A2
worksheet.Cells["A2"].SetStyle(style);
```
- เราเพิ่มมูลค่า `20` สู่เซลล์ `A2`-
- เราดึงสไตล์ของเซลล์กลับมา `A2` และตั้งค่ารูปแบบกำหนดเองเป็น `0.0%` เพื่อแสดงค่าเป็นเปอร์เซ็นต์ (เช่น 20%)
- สุดท้ายเราใช้รูปแบบกับเซลล์โดยใช้ `SetStyle()`-
## ขั้นตอนที่ 5: การจัดรูปแบบเซลล์เป็นสกุลเงิน
มาเพิ่มค่าอีกค่าหนึ่ง เช่น ให้กับเซลล์ `A3`และจัดรูปแบบให้แสดงเป็นสกุลเงิน เพื่อให้สิ่งต่างๆ น่าสนใจยิ่งขึ้น เราจะใช้รูปแบบที่แสดงค่าบวกเป็นสกุลเงินปอนด์และค่าลบเป็นดอลลาร์
```csharp
// การเพิ่มค่าตัวเลขลงในเซลล์ "A3"
worksheet.Cells["A3"].PutValue(2546);
// การได้สไตล์ของเซลล์ A3
style = worksheet.Cells["A3"].GetStyle();
// การตั้งค่ารูปแบบการแสดงแบบกำหนดเองเพื่อแสดงค่าเป็นสกุลเงิน
style.Custom = "£#,##0;[Red]$-#,##0";
// การนำสไตล์ไปใช้กับเซลล์ A3
worksheet.Cells["A3"].SetStyle(style);
```
- เราเพิ่มมูลค่า `2546` สู่เซลล์ `A3`-
- เรากำหนดรูปแบบที่กำหนดเอง `£#,##0;[Red]$-#,##0`ซึ่งแสดงค่าบวกด้วยเครื่องหมายปอนด์ และค่าลบเป็นสีแดงด้วยเครื่องหมายดอลลาร์
- เราใช้รูปแบบกับเซลล์โดยใช้ `SetStyle()`-
## ขั้นตอนที่ 6: การบันทึกสมุดงาน
ขั้นตอนสุดท้ายคือการบันทึกเวิร์กบุ๊กเป็นไฟล์ Excel เราจะใช้รูปแบบ Excel 97-2003 สำหรับบทช่วยสอนนี้
```csharp
// การบันทึกไฟล์ Excel
workbook.Save(dataDir + "book1.out.xls", SaveFormat.Excel97To2003);
```
- การ `Save()` วิธีการบันทึกสมุดงานในไดเร็กทอรีที่ระบุ
- เราเลือก `SaveFormat.Excel97To2003` เพื่อให้แน่ใจว่าเข้ากันได้กับ Excel เวอร์ชันเก่ากว่า
## บทสรุป
เท่านี้คุณก็สร้างไฟล์ Excel ได้แล้ว เพิ่มรูปแบบวันที่ เปอร์เซ็นต์ และสกุลเงินที่กำหนดเองให้กับเซลล์เฉพาะโดยใช้ Aspose.Cells สำหรับ .NET และบันทึกไฟล์ การจัดรูปแบบที่กำหนดเองทำให้ไฟล์ Excel ของคุณอ่านง่ายและดูเป็นมืออาชีพมากขึ้น อย่าลืมสำรวจตัวเลือกการจัดรูปแบบอื่นๆ ใน Aspose.Cells เช่น การจัดรูปแบบตามเงื่อนไข เพื่อให้ควบคุมลักษณะข้อมูลของคุณได้ดียิ่งขึ้น
## คำถามที่พบบ่อย
### ฉันจะใช้ตัวเลือกการจัดรูปแบบที่ซับซ้อนมากขึ้นใน Aspose.Cells ได้อย่างไร
คุณสามารถรวมรูปแบบการจัดรูปแบบที่แตกต่างกัน เช่น สีแบบอักษร ขอบ และสีพื้นหลัง เข้ากับรูปแบบตัวเลขแบบกำหนดเองได้
### ฉันสามารถใช้รูปแบบตัวเลขแบบกำหนดเองกับช่วงเซลล์ได้หรือไม่
ใช่ Aspose.Cells ช่วยให้คุณสามารถใช้รูปแบบกับช่วงเซลล์ได้โดยใช้ `Range.SetStyle()` วิธี.
### ฉันสามารถบันทึกสมุดงานในรูปแบบไฟล์อื่นใดได้บ้าง
Aspose.Cells รองรับรูปแบบต่างๆ มากมาย รวมถึง XLSX, CSV และ PDF เพียงเปลี่ยนรูปแบบ `SaveFormat` ใน `Save()` วิธี.
### ฉันสามารถจัดรูปแบบตัวเลขติดลบแตกต่างกันได้หรือไม่
แน่นอน! คุณสามารถใช้รูปแบบตัวเลขแบบกำหนดเองเพื่อแสดงตัวเลขติดลบด้วยสีหรือสัญลักษณ์ที่แตกต่างกันได้
### Aspose.Cells สำหรับ .NET ฟรีหรือไม่?
Aspose.Cells เสนอให้ทดลองใช้งานฟรี แต่หากต้องการใช้งานฟังก์ชันครบถ้วน คุณจะต้องมีใบอนุญาตที่ถูกต้อง คุณสามารถรับได้ [ใบอนุญาตชั่วคราวที่นี่](https://purchase-aspose.com/temporary-license/).


{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}