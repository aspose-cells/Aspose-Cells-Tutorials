---
title: การใช้รูปแบบตัวเลขในตัวในโปรแกรม Excel
linktitle: การใช้รูปแบบตัวเลขในตัวในโปรแกรม Excel
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: จัดรูปแบบตัวเลขอัตโนมัติใน Excel โดยใช้ Aspose.Cells สำหรับ .NET เรียนรู้วิธีการใช้รูปแบบวันที่ เปอร์เซ็นต์ และสกุลเงินในการเขียนโปรแกรม
weight: 10
url: /th/net/number-and-display-formats-in-excel/using-built-in-number-formats/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# การใช้รูปแบบตัวเลขในตัวในโปรแกรม Excel

## การแนะนำ
ในบทช่วยสอนนี้ เราจะแนะนำคุณเกี่ยวกับการใช้รูปแบบตัวเลขในตัวใน Excel โดยใช้ Aspose.Cells สำหรับ .NET เราจะครอบคลุมทุกอย่างตั้งแต่การตั้งค่าสภาพแวดล้อมของคุณไปจนถึงการใช้รูปแบบต่างๆ เช่น วันที่ เปอร์เซ็นต์ และสกุลเงิน ไม่ว่าคุณจะเป็นผู้เชี่ยวชาญหรือเพิ่งเริ่มใช้ระบบนิเวศ .NET คู่มือนี้จะช่วยให้คุณจัดรูปแบบเซลล์ Excel ได้อย่างง่ายดาย
## ข้อกำหนดเบื้องต้น
ก่อนที่จะดำน้ำ ให้แน่ใจว่าคุณมีสิ่งต่อไปนี้:
-  ติดตั้ง Aspose.Cells สำหรับไลบรารี .NET แล้ว คุณสามารถ[ดาวน์โหลดได้ที่นี่](https://releases.aspose.com/cells/net/).
- ความรู้ในการใช้งาน C# และการเขียนโปรแกรม .NET ขั้นพื้นฐาน
- Visual Studio หรือ .NET IDE ใด ๆ ติดตั้งอยู่บนเครื่องของคุณ
-  ใบอนุญาต Aspose ที่ถูกต้องหรือ[ใบอนุญาตชั่วคราว](https://purchase.aspose.com/temporary-license/).
- ติดตั้ง .NET framework (เวอร์ชัน 4.0 หรือสูงกว่า)
  
หากคุณพลาดสิ่งใดสิ่งหนึ่งข้างต้น ให้ทำตามลิงก์ที่ให้ไว้เพื่อตั้งค่าทุกอย่าง พร้อมหรือยัง มาเริ่มสนุกกันเลย!
## แพ็คเกจนำเข้า
ก่อนที่เราจะเริ่มใช้งานบทช่วยสอน โปรดแน่ใจว่าได้นำเข้าเนมสเปซที่จำเป็นสำหรับการใช้งาน Aspose.Cells สำหรับ .NET:
```csharp
using System.IO;
using Aspose.Cells;
using System;
```
เมื่อคุณนำเข้าไฟล์เหล่านี้แล้ว คุณก็พร้อมที่จะจัดการไฟล์ Excel ตามโปรแกรมได้แล้ว ตอนนี้มาดูคำแนะนำทีละขั้นตอนกันเลย!
## ขั้นตอนที่ 1: สร้างหรือเข้าถึงเวิร์กบุ๊ก Excel ของคุณ
ในขั้นตอนนี้ คุณจะสร้างเวิร์กบุ๊กใหม่ ลองนึกถึงการเปิดไฟล์ Excel ใหม่ แต่คุณทำผ่านโค้ด!
```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "Your Document Directory";
// สร้างไดเร็กทอรีหากยังไม่มีอยู่
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
	System.IO.Directory.CreateDirectory(dataDir);
// การสร้างอินสแตนซ์ของวัตถุเวิร์กบุ๊ก
Workbook workbook = new Workbook();
```
 ที่นี่เราเพียงแต่สร้างตัวอย่างใหม่`Workbook` วัตถุ ทำหน้าที่เป็นไฟล์ Excel ของคุณที่พร้อมสำหรับการจัดการข้อมูล นอกจากนี้ คุณยังสามารถโหลดไฟล์ที่มีอยู่ได้โดยระบุเส้นทางของไฟล์
## ขั้นตอนที่ 2: เข้าถึงแผ่นงาน
เวิร์กบุ๊ก Excel สามารถมีเวิร์กชีตได้หลายแผ่น ในขั้นตอนนี้ เราจะเข้าถึงเวิร์กชีตแรกในเวิร์กบุ๊กของคุณ:
```csharp
Worksheet worksheet = workbook.Worksheets[0];
```
ตอนนี้เรากำลังเข้าถึงเวิร์กชีตแรกในเวิร์กบุ๊ก หากคุณต้องการจัดการชีตเพิ่มเติม คุณสามารถอ้างอิงชีตเหล่านั้นโดยใช้ดัชนีหรือชื่อของชีตได้
## ขั้นตอนที่ 3: เพิ่มข้อมูลลงในเซลล์
มาเริ่มเพิ่มข้อมูลลงในเซลล์ที่ต้องการกันก่อน ขั้นแรก เราจะแทรกวันที่ระบบปัจจุบันลงในเซลล์ "A1":
```csharp
worksheet.Cells["A1"].PutValue(DateTime.Now);
```
บรรทัดนี้จะแทรกวันที่ปัจจุบันลงในเซลล์ A1 เจ๋งใช่ไหม ลองนึกภาพว่าต้องทำแบบนี้กับเซลล์หลายร้อยเซลล์ด้วยตนเองดูสิ คงจะเป็นฝันร้ายทีเดียว ตอนนี้เราจะไปดูการจัดรูปแบบกันเลย!
## ขั้นตอนที่ 4: จัดรูปแบบวันที่ในเซลล์ "A1"
ต่อไป เราจะจัดรูปแบบวันที่ให้เป็นรูปแบบที่อ่านง่ายขึ้น เช่น "15-ต.ค.-24" นี่คือจุดที่ Aspose.Cells ทำได้ดีที่สุด:
1. ดึงข้อมูลสไตล์ของเซลล์:
```csharp
Style style = worksheet.Cells["A1"].GetStyle();
```
ตรงนี้ เราจะมาดูสไตล์ของเซลล์ A1 กันก่อน ลองนึกถึง "แฟชั่น" ของเซลล์ก่อนจะปรับแต่งอะไร
2. ตั้งค่ารูปแบบวันที่:
```csharp
style.Number = 15;
```
 การตั้งค่า`Number` คุณสมบัติ 15 จะใช้รูปแบบวันที่ที่ต้องการ นี่คือรหัสรูปแบบตัวเลขในตัวสำหรับแสดงวันที่ในรูปแบบ "d-mmm-yy"
3. นำสไตล์ไปใช้กับเซลล์:
```csharp
worksheet.Cells["A1"].SetStyle(style);
```
บรรทัดนี้ใช้การเปลี่ยนแปลงรูปแบบกับเซลล์ ตอนนี้ แทนที่จะใช้รูปแบบวันที่เริ่มต้น คุณจะเห็นรูปแบบที่ใช้งานง่ายกว่ามาก เช่น "15-ต.ค.-24"
## ขั้นตอนที่ 5: เพิ่มและจัดรูปแบบเปอร์เซ็นต์ในเซลล์ "A2"
มาดูการจัดรูปแบบเปอร์เซ็นต์กัน ลองนึกภาพว่าคุณต้องการแทรกค่าและแสดงเป็นเปอร์เซ็นต์ ในขั้นตอนนี้ เราจะเพิ่มค่าตัวเลขลงในเซลล์ "A2" และจัดรูปแบบเป็นเปอร์เซ็นต์:
1. ใส่ค่าตัวเลข:
```csharp
worksheet.Cells["A2"].PutValue(20);
```
การดำเนินการนี้จะแทรกตัวเลข 20 ลงในเซลล์ A2 คุณอาจคิดว่า "นั่นเป็นเพียงตัวเลขธรรมดา ฉันจะแปลงเป็นเปอร์เซ็นต์ได้อย่างไร" ตอนนี้เรากำลังจะเข้าสู่ขั้นตอนนั้น
2. ดึงข้อมูลสไตล์และตั้งค่ารูปแบบเปอร์เซ็นต์:
```csharp
style = worksheet.Cells["A2"].GetStyle();
style.Number = 9;  // รูปแบบเป็นเปอร์เซ็นต์
worksheet.Cells["A2"].SetStyle(style);
    ```
Setting the `Number` property to 9 applies the built-in percentage format. Now the value in A2 will be displayed as "2000%." (Yes, 20 is treated as 2000% in percentage formatting).
## Step 6: Add and Format Currency in Cell "A3"
Now, let’s add a numeric value in cell A3 and format it as currency. This is a common use case for financial reports.
1. Insert Numeric Value:
```csharp
worksheet.Cells["A3"].PutValue(2546);
```
ที่นี่ เราจะเพิ่ม 2546 ลงในเซลล์ A3 ต่อไป เราจะจัดรูปแบบตัวเลขนี้ให้แสดงเป็นสกุลเงิน
2. ดึงข้อมูลสไตล์และรูปแบบสกุลเงิน:
```csharp
style = worksheet.Cells["A3"].GetStyle();
style.Number = 6;  // รูปแบบเป็นสกุลเงิน
worksheet.Cells["A3"].SetStyle(style);
```
 การตั้งค่า`Number` คุณสมบัติ 6 จะใช้รูปแบบสกุลเงิน ตอนนี้ค่าในเซลล์ A3 จะแสดงเป็น "2,546.00" พร้อมเครื่องหมายจุลภาคและทศนิยมสองตำแหน่ง
## ขั้นตอนที่ 7: บันทึกไฟล์ Excel
ตอนนี้เราได้ใช้การจัดรูปแบบทั้งหมดแล้ว ถึงเวลาบันทึกไฟล์:
```csharp
// การบันทึกไฟล์ Excel
workbook.Save(dataDir + "book1.out.xls", SaveFormat.Excel97To2003);
```
 บรรทัดนี้จะบันทึกไฟล์ Excel ในรูปแบบ Excel 97-2003 คุณสามารถเปลี่ยนแปลงได้`SaveFormat`เพื่อให้เหมาะกับความต้องการของคุณ และเพียงแค่นั้น คุณก็สามารถสร้างและจัดรูปแบบไฟล์ Excel ได้ตามโปรแกรมแล้ว!
## บทสรุป
ขอแสดงความยินดี! คุณได้เรียนรู้วิธีใช้ Aspose.Cells สำหรับ .NET เพื่อนำรูปแบบตัวเลขในตัวไปใช้กับเซลล์ในไฟล์ Excel สำเร็จแล้ว ตั้งแต่วันที่ไปจนถึงเปอร์เซ็นต์และสกุลเงิน เราได้ครอบคลุมความต้องการในการจัดรูปแบบทั่วไปบางส่วนสำหรับการประมวลผลข้อมูล Excel แล้ว ขณะนี้ แทนที่จะจัดรูปแบบเซลล์ด้วยตนเอง คุณสามารถทำให้กระบวนการทั้งหมดเป็นแบบอัตโนมัติได้ ช่วยประหยัดเวลาและลดข้อผิดพลาด
## คำถามที่พบบ่อย
### ฉันสามารถใช้รูปแบบตัวเลขแบบกำหนดเองโดยใช้ Aspose.Cells สำหรับ .NET ได้หรือไม่
 ใช่! นอกจากรูปแบบในตัวแล้ว Aspose.Cells ยังรองรับรูปแบบตัวเลขที่กำหนดเองอีกด้วย คุณสามารถสร้างรูปแบบเฉพาะเจาะจงได้โดยใช้`Custom` ทรัพย์สินใน`Style` ระดับ.
### ฉันจะจัดรูปแบบเซลล์เป็นสกุลเงินที่มีสัญลักษณ์เฉพาะได้อย่างไร
 หากต้องการใช้สัญลักษณ์สกุลเงินเฉพาะ คุณสามารถใช้การจัดรูปแบบแบบกำหนดเองได้โดยตั้งค่า`Style.Custom` คุณสมบัติ.
### ฉันสามารถจัดรูปแบบแถวหรือคอลัมน์ทั้งหมดได้หรือไม่
 แน่นอน! คุณสามารถใช้รูปแบบกับทั้งแถวหรือคอลัมน์ได้โดยใช้`Rows` หรือ`Columns`คอลเลกชันใน`Worksheet` วัตถุ.
### ฉันจะจัดรูปแบบเซลล์หลายเซลล์ในครั้งเดียวได้อย่างไร?
คุณสามารถใช้`Range` วัตถุในการเลือกเซลล์หลายเซลล์และนำสไตล์ไปใช้กับเซลล์ทั้งหมดในครั้งเดียว
### ฉันจำเป็นต้องติดตั้ง Microsoft Excel เพื่อใช้ Aspose.Cells หรือไม่
ไม่ Aspose.Cells ทำงานอย่างเป็นอิสระจาก Microsoft Excel ดังนั้นคุณไม่จำเป็นต้องติดตั้ง Excel ไว้ในเครื่องของคุณ

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
