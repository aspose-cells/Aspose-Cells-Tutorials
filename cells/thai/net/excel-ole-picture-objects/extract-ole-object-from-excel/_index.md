---
title: แยกวัตถุ OLE จาก Excel
linktitle: แยกวัตถุ OLE จาก Excel
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีแยกวัตถุ OLE จากไฟล์ Excel โดยใช้ Aspose.Cells สำหรับ .NET คำแนะนำทีละขั้นตอนเพื่อการแยกข้อมูลที่ง่ายดาย
weight: 10
url: /th/net/excel-ole-picture-objects/extract-ole-object-from-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# แยกวัตถุ OLE จาก Excel

## การแนะนำ
ในโลกปัจจุบันที่เทคโนโลยีก้าวหน้า การจัดการไฟล์ Excel ถือเป็นงานทั่วไป โดยเฉพาะอย่างยิ่งสำหรับนักวิเคราะห์ข้อมูล การเงิน และการจัดการโครงการ ประเด็นที่มักมองข้ามประการหนึ่งคือการจัดการวัตถุ OLE (Object Linking and Embedding) ในสเปรดชีต Excel วัตถุเหล่านี้อาจเป็นเอกสารที่ฝังไว้ รูปภาพ หรือแม้แต่ประเภทข้อมูลที่ซับซ้อนซึ่งมีบทบาทสำคัญในการเพิ่มฟังก์ชันและความสมบูรณ์ของไฟล์ Excel ของคุณ หากคุณเป็นผู้ใช้ Aspose.Cells ที่ต้องการแยกวัตถุ OLE เหล่านี้ด้วยโปรแกรมโดยใช้ .NET คุณมาถูกที่แล้ว! คู่มือนี้จะแนะนำคุณทีละขั้นตอน เพื่อให้คุณเข้าใจไม่เพียงแค่ว่าต้องทำอย่างไร แต่ยังเข้าใจด้วยว่าเหตุใดแต่ละส่วนของกระบวนการจึงมีความสำคัญ
## ข้อกำหนดเบื้องต้น
ก่อนที่เราจะเจาะลึกรายละเอียดสำคัญของการแยกวัตถุ OLE มีบางสิ่งที่คุณต้องมี:
1. ความรู้พื้นฐานเกี่ยวกับ C#: หากคุณคุ้นเคยกับ C# คุณก็อยู่ในเส้นทางที่ถูกต้องแล้ว หากไม่เป็นเช่นนั้น ก็ไม่ต้องกังวล เราจะทำให้ทุกอย่างตรงไปตรงมา
2. ติดตั้ง Aspose.Cells แล้ว: คุณจะต้องมีไลบรารี Aspose.Cells คุณสามารถดาวน์โหลดได้จากไซต์[ที่นี่](https://releases.aspose.com/cells/net/).
3. สภาพแวดล้อมการพัฒนาที่เข้ากันได้: ตรวจสอบให้แน่ใจว่าคุณมีการตั้งค่าสภาพแวดล้อมการพัฒนา .NET เช่น Visual Studio พร้อมใช้งาน
4. ตัวอย่างไฟล์ Excel: คุณจะต้องมีไฟล์ Excel ที่มีวัตถุ OLE ฝังอยู่สำหรับการทดสอบ 
เมื่อคุณมีข้อกำหนดเบื้องต้นเหล่านี้แล้ว เราก็สามารถเริ่มต้นการเดินทางสู่โลกของการแยกอ็อบเจ็กต์ OLE ได้
## แพ็คเกจนำเข้า
ก่อนอื่น ให้เราอิมพอร์ตแพ็คเกจที่จำเป็นซึ่งเราจะใช้ในบทช่วยสอนของเรา ในโปรเจ็กต์ C# ของคุณ คุณจะต้องรวมเนมสเปซ Aspose.Cells เข้าไปด้วย วิธีดำเนินการมีดังนี้:
```csharp
using System.IO;
using Aspose.Cells;
```
## ขั้นตอนที่ 1: ตั้งค่าไดเรกทอรีเอกสาร
ในขั้นตอนนี้ เราจะกำหนดเส้นทางที่ไฟล์ Excel ของเราตั้งอยู่ คุณอาจสงสัยว่าเหตุใดจึงมีความสำคัญ เหมือนกับการจัดเตรียมฉากสำหรับการแสดง โดยจะช่วยให้สคริปต์ทราบว่าจะค้นหานักแสดงได้จากที่ใด (ในกรณีของเราคือไฟล์ Excel)
```csharp
string dataDir = "Your Document Directory";
```
 แทนที่`"Your Document Directory"` ด้วยเส้นทางจริงที่ไฟล์ Excel ของคุณ (`book1.xls`) ได้ถูกเก็บไว้
## ขั้นตอนที่ 2: เปิดไฟล์ Excel
ตอนนี้เราได้ตั้งค่าไดเรกทอรีเอกสารเรียบร้อยแล้ว ขั้นตอนต่อไปคือเปิดไฟล์ Excel ลองนึกถึงการเปิดหนังสือก่อนเริ่มอ่านดูสิ เพราะการดูเนื้อหาภายในถือเป็นสิ่งสำคัญ
```csharp
Workbook workbook = new Workbook(dataDir + "book1.xls");
```
## ขั้นตอนที่ 3: เข้าถึงคอลเลกชันวัตถุ OLE
เวิร์กชีตทุกแผ่นในเวิร์กบุ๊ก Excel สามารถมีวัตถุต่างๆ ได้ รวมถึงวัตถุ OLE ที่นี่ เราจะเข้าถึงคอลเลกชันวัตถุ OLE ของเวิร์กชีตแรก ซึ่งจะคล้ายกับการเลือกหน้าเพื่อตรวจสอบรูปภาพและเอกสารที่ฝังไว้
```csharp
Aspose.Cells.Drawing.OleObjectCollection oles = workbook.Worksheets[0].OleObjects;
```
## ขั้นตอนที่ 4: วนซ้ำผ่านวัตถุ OLE
ตอนนี้มาถึงส่วนที่สนุกแล้ว นั่นคือการวนซ้ำผ่านวัตถุ OLE ทั้งหมดในคอลเล็กชันของเรา ขั้นตอนนี้มีความสำคัญมาก เนื่องจากช่วยให้เราจัดการวัตถุ OLE หลายรายการได้อย่างมีประสิทธิภาพ ลองนึกภาพว่าต้องค้นหาสิ่งของมีค่าในหีบสมบัติ!
```csharp
for (int i = 0; i < oles.Count; i++)
{
    Aspose.Cells.Drawing.OleObject ole = oles[i];
    // ตรรกะเพิ่มเติมในการจัดการแต่ละวัตถุ
}
```
## ขั้นตอนที่ 5: ระบุชื่อไฟล์ผลลัพธ์
เมื่อเราเจาะลึกเข้าไปในแต่ละอ็อบเจ็กต์ OLE มากขึ้น เราจำเป็นต้องตั้งชื่อไฟล์สำหรับอ็อบเจ็กต์ที่แยกออกมา เหตุใดจึงเป็นเช่นนั้น เนื่องจากเมื่อเราแยกออกมาแล้ว เราต้องการจัดระเบียบทุกอย่างเพื่อให้สามารถค้นหาสมบัติของเราได้อย่างง่ายดายในภายหลัง
```csharp
string fileName = dataDir + "ole_" + i + ".";
```
## ขั้นตอนที่ 6: กำหนดประเภทรูปแบบไฟล์
วัตถุ OLE แต่ละรายการสามารถมีประเภทต่างๆ ได้ (เช่น เอกสาร สเปรดชีต รูปภาพ) การกำหนดประเภทรูปแบบจึงมีความสำคัญมาก เพื่อให้คุณสามารถแยกข้อมูลออกมาได้อย่างถูกต้อง เหมือนกับการรู้สูตรอาหาร—คุณต้องรู้ส่วนผสม!
```csharp
switch (ole.FileFormatType)
{
    case FileFormatType.Doc:
        fileName += "doc";
        break;
    case FileFormatType.Xlsx:
        fileName += "xlsx";
        break;
    case FileFormatType.Ppt:
        fileName += "ppt";
        break;
    case FileFormatType.Pdf:
        fileName += "pdf";
        break;
    case FileFormatType.Unknown:
        fileName += "jpg";
        break;
    default:
        // จัดการรูปแบบไฟล์อื่น ๆ
        break;
}
```
## ขั้นตอนที่ 7: บันทึกวัตถุ OLE
 ตอนนี้เรามาบันทึกวัตถุ OLE กัน หากวัตถุนั้นเป็นไฟล์ Excel เราจะบันทึกโดยใช้`MemoryStream` ซึ่งช่วยให้เราจัดการข้อมูลในหน่วยความจำได้ก่อนจะเขียนออกมา ขั้นตอนนี้คล้ายกับการบรรจุสมบัติของคุณก่อนจะส่งไปให้เพื่อน
```csharp
if (ole.FileFormatType == FileFormatType.Xlsx)
{
    MemoryStream ms = new MemoryStream();
    ms.Write(ole.ObjectData, 0, ole.ObjectData.Length);
    Workbook oleBook = new Workbook(ms);
    oleBook.Settings.IsHidden = false;
    oleBook.Save(dataDir + "Excel_File" + i + ".out.xlsx");
}
```
 สำหรับไฟล์ประเภทอื่นเราจะใช้`FileStream` เพื่อสร้างไฟล์บนดิสก์
```csharp
else
{
    FileStream fs = File.Create(fileName);
    fs.Write(ole.ObjectData, 0, ole.ObjectData.Length);
    fs.Close();
}
```

## บทสรุป
เพียงเท่านี้ คุณก็จะสามารถแยกวัตถุ OLE ออกมาได้สำเร็จด้วย Aspose.Cells สำหรับ .NET! โดยทำตามขั้นตอนเหล่านี้ คุณจะสามารถแยกและจัดการวัตถุที่ฝังตัวจากไฟล์ Excel ได้อย่างง่ายดาย โปรดจำไว้ว่า เช่นเดียวกับทักษะที่มีค่าอื่นๆ การฝึกฝนจะนำไปสู่ความสมบูรณ์แบบ ดังนั้น ให้ค่อยๆ ทดลองใช้ไฟล์ Excel ต่างๆ แล้วคุณจะกลายเป็นผู้เชี่ยวชาญในการแยก OLE ในไม่ช้า!
## คำถามที่พบบ่อย
### วัตถุ OLE ใน Excel คืออะไร?
วัตถุ OLE เป็นเทคโนโลยีที่ช่วยให้ฝังและเชื่อมโยงกับเอกสารและข้อมูลในแอปพลิเคชันอื่นภายในเวิร์กชีต Excel ได้
### เหตุใดฉันจึงต้องแยกวัตถุ OLE?
การแยกวัตถุ OLE ช่วยให้คุณสามารถเข้าถึงและจัดการเอกสารหรือรูปภาพที่ฝังไว้ได้อย่างอิสระจากไฟล์ Excel ต้นฉบับ
### Aspose.Cells จัดการกับไฟล์ฝังตัวทุกประเภทได้หรือไม่
ใช่ Aspose.Cells สามารถจัดการวัตถุ OLE ต่างๆ ได้ รวมถึงเอกสาร Word แผ่นงาน Excel งานนำเสนอ PowerPoint และรูปภาพ
### ฉันจะติดตั้ง Aspose.Cells สำหรับ .NET ได้อย่างไร?
 คุณสามารถติดตั้ง Aspose.Cells ได้โดยดาวน์โหลดจาก[หน้าวางจำหน่าย](https://releases.aspose.com/cells/net/).
### ฉันสามารถค้นหาการสนับสนุนสำหรับ Aspose.Cells ได้ที่ไหน
คุณสามารถรับการสนับสนุนสำหรับ Aspose.Cells ได้[ฟอรั่มสนับสนุน](https://forum.aspose.com/c/cells/9).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
