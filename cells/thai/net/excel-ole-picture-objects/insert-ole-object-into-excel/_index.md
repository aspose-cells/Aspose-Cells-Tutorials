---
title: แทรกวัตถุ OLE ลงใน Excel
linktitle: แทรกวัตถุ OLE ลงใน Excel
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีแทรกวัตถุ OLE ลงในไฟล์ Excel โดยใช้ Aspose.Cells สำหรับ .NET ในคู่มือที่ครอบคลุมนี้ซึ่งมีคำแนะนำทีละขั้นตอน
weight: 11
url: /th/net/excel-ole-picture-objects/insert-ole-object-into-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# แทรกวัตถุ OLE ลงใน Excel

## การแนะนำ
ไม่ว่าคุณจะฝังรูปภาพ แผนภูมิ หรือไฟล์อื่นใด การใช้ Aspose.Cells สำหรับ .NET จะช่วยให้คุณทำสิ่งนี้ได้สำเร็จอย่างง่ายดาย ในคู่มือนี้ เราจะอธิบายขั้นตอนที่จำเป็นในการแทรกวัตถุ OLE ลงในแผ่นงาน Excel เมื่ออ่านจบ คุณจะสามารถปรับปรุงเวิร์กบุ๊ก Excel ของคุณด้วยการฝังแบบเฉพาะตัวที่สามารถสร้างความประทับใจให้กับผู้ชมหรือตอบสนองความต้องการทางวิชาชีพต่างๆ ได้ 
## ข้อกำหนดเบื้องต้น
ก่อนที่จะเจาะลึกถึงรายละเอียดของโค้ด มีบางสิ่งบางอย่างที่คุณจะต้องมี:
1. Visual Studio: โดยปกติแล้วคุณควรทำงานในสภาพแวดล้อมที่รองรับ .NET เช่น Visual Studio IDE นี้ทำให้การเขียน ทดสอบ และดีบักแอปพลิเคชันของคุณเป็นเรื่องง่าย
2. ไลบรารี Aspose.Cells: คุณต้องติดตั้งไลบรารี Aspose.Cells คุณสามารถรับไลบรารีนี้ได้ผ่านตัวจัดการแพ็กเกจ NuGet หรือดาวน์โหลดโดยตรงจาก[เว็บไซต์อาโพส](https://releases.aspose.com/cells/net/).
3.  ไฟล์ตัวอย่าง: เพื่อวัตถุประสงค์ในการสาธิต ให้แน่ใจว่าคุณมีรูปภาพ (เช่น`logo.jpg`) และไฟล์ Excel (`book1.xls`) เพื่อใช้งาน สิ่งเหล่านี้จะถูกอ้างอิงในโค้ด
4. ความเข้าใจพื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับ C# จะช่วยให้คุณเข้าใจขั้นตอนที่เกี่ยวข้องและทำการปรับเปลี่ยนหากจำเป็น
เมื่อคุณเตรียมทุกอย่างลงตัวแล้ว ก็ถึงเวลาเริ่มแทรกวัตถุ OLE ลงใน Excel ได้เลย!
## แพ็คเกจนำเข้า
หากต้องการจัดการไฟล์ Excel ด้วย Aspose.Cells ก่อนอื่นคุณต้องนำเข้าแพ็คเกจที่จำเป็น เพิ่มเนมสเปซต่อไปนี้ที่ด้านบนของไฟล์ C#:
```csharp
using System.IO;
using Aspose.Cells;
using System;
```
การตั้งค่าพื้นฐานนี้ช่วยให้คุณสามารถโต้ตอบกับเวิร์กบุ๊ก เวิร์กชีต และส่วนประกอบจำเป็นอื่นๆ ที่จำเป็นสำหรับงานของคุณได้
มาแบ่งขั้นตอนออกเป็นขั้นตอนย่อยๆ ง่ายๆ กัน
## ขั้นตอนที่ 1: ตั้งค่าไดเรกทอรีเอกสารของคุณ
ขั้นตอนแรกคือการกำหนดว่าจะเก็บเอกสารของคุณไว้ที่ไหน ซึ่งเป็นเรื่องง่ายๆ
```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "Your Document Directory";
```
 อย่าลืมเปลี่ยน`"Your Document Directory"` พร้อมด้วยเส้นทางไดเร็กทอรีจริงบนระบบของคุณซึ่งคุณวางแผนจะบันทึกไฟล์ของคุณ
## ขั้นตอนที่ 2: สร้างไดเรกทอรีหากไม่มีอยู่
ขั้นต่อไป เราต้องการให้แน่ใจว่าไดเรกทอรีนี้มีอยู่ หากไม่มี เราจะต้องสร้างขึ้นมาใหม่
```csharp
// สร้างไดเร็กทอรีหากยังไม่มีอยู่
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
การตรวจสอบแบบง่ายๆ นี้จะช่วยป้องกันไม่ให้โปรแกรมของคุณแสดงข้อผิดพลาดที่ไม่จำเป็นในภายหลัง
## ขั้นตอนที่ 3: สร้างเวิร์กบุ๊กใหม่
ตอนนี้เรามาสร้างเวิร์กบุ๊กใหม่กัน โดยเราจะทำงานกับวัตถุ OLE ของเรา
```csharp
// สร้างเวิร์กบุ๊กใหม่
Workbook workbook = new Workbook();
```
เวิร์กบุ๊กใหม่นี้จะทำหน้าที่เป็นผืนผ้าใบสำหรับวัตถุ OLE ที่คุณวางแผนจะแทรก
## ขั้นตอนที่ 4: รับแผ่นงานแรก
หลังจากที่เรามีสมุดงานแล้ว เราจำเป็นต้องหยิบแผ่นงานแรกขึ้นมา โดยปกติแล้ว นี่คือส่วนที่คุณจะทำงานอย่างแข็งขันที่สุด
```csharp
// รับแผ่นงานแรก
Worksheet sheet = workbook.Worksheets[0];
```
ดีและเรียบง่าย! เราพร้อมที่จะเริ่มเพิ่มเนื้อหาลงในแผ่นงานนี้แล้ว
## ขั้นตอนที่ 5: กำหนดเส้นทางสำหรับภาพ
ตอนนี้เรามาตั้งค่าเส้นทางสำหรับรูปภาพที่คุณต้องการฝังลงในไฟล์ Excel กัน
```csharp
//กำหนดตัวแปรสตริงเพื่อจัดเก็บเส้นทางของรูปภาพ
string ImageUrl = dataDir + "logo.jpg";
```
 ตรวจสอบให้แน่ใจว่าเส้นทางนี้สะท้อนถึงตำแหน่งของคุณอย่างถูกต้อง`logo.jpg` ไฟล์ถูกเก็บไว้แล้ว
## ขั้นตอนที่ 6: โหลดภาพลงในอาร์เรย์ไบต์
เราจะต้องอ่านภาพในรูปแบบที่เราสามารถใช้งานได้ ในการทำเช่นนี้ เราเปิดสตรีมไฟล์และอ่านข้อมูลลงในอาร์เรย์ไบต์
```csharp
// รับภาพลงในสตรีม
FileStream fs = File.OpenRead(ImageUrl);
// กำหนดอาร์เรย์ไบต์
byte[] imageData = new Byte[fs.Length];
// รับรูปภาพลงในอาร์เรย์ของไบต์จากสตรีม
fs.Read(imageData, 0, imageData.Length);
// ปิดลำธาร
fs.Close();
```
เมื่ออ่านรูปภาพลงในอาร์เรย์ไบต์ เราจะเตรียมรูปภาพให้พร้อมสำหรับการแทรกเข้าในเวิร์กชีต Excel
## ขั้นตอนที่ 7: รับเส้นทางไฟล์ Excel
ตอนนี้เรามากำหนดกันว่าไฟล์ Excel ของคุณอยู่ที่ไหนกัน
```csharp
// รับเส้นทางไฟล์ Excel ในตัวแปร
string path = dataDir + "book1.xls";
```
อีกครั้ง ตรวจสอบให้แน่ใจว่าเส้นทางนี้ถูกต้องและชี้ไปที่ไฟล์ที่ถูกต้อง
## ขั้นตอนที่ 8: โหลดไฟล์ Excel ลงในอาร์เรย์ไบต์
เช่นเดียวกับที่เราทำกับรูปภาพ เราต้องโหลดไฟล์ Excel เองลงในอาร์เรย์ไบต์
```csharp
// รับไฟล์เข้าสู่สตรีม
fs = File.OpenRead(path);
//กำหนดอาร์เรย์ของไบต์
byte[] objectData = new Byte[fs.Length];
// จัดเก็บไฟล์จากสตรีม
fs.Read(objectData, 0, objectData.Length);
// ปิดลำธาร
fs.Close();
```
นี่เป็นการเตรียมไฟล์ Excel สำหรับการฝังวัตถุ OLE ของเรา
## ขั้นตอนที่ 9: เพิ่มวัตถุ OLE ลงในเวิร์กชีต
เมื่อข้อมูลของเราพร้อมแล้ว เราสามารถแทรกวัตถุ OLE ลงในเวิร์กชีตได้
```csharp
// เพิ่มวัตถุ OLE ลงในเวิร์กชีตพร้อมกับรูปภาพ
sheet.OleObjects.Add(14, 3, 200, 220, imageData);
// ตั้งค่าข้อมูลวัตถุ OLE ที่ฝังตัว
sheet.OleObjects[0].ObjectData = objectData;
```
 บรรทัดนี้จะสร้างวัตถุที่ฝังอยู่ในเอกสาร Excel พารามิเตอร์`(14, 3, 200, 220)` ระบุตำแหน่งและขนาดของวัตถุที่ฝังไว้ ปรับค่าเหล่านี้ตามความจำเป็นสำหรับกรณีการใช้งานเฉพาะของคุณ
## ขั้นตอนที่ 10: บันทึกไฟล์ Excel
ในที่สุด ก็ถึงเวลาบันทึกการเปลี่ยนแปลงของคุณลงในไฟล์ Excel แล้ว
```csharp
// บันทึกไฟล์ Excel
workbook.Save(dataDir + "output.out.xls");
```
บรรทัดนี้จะบันทึกเวิร์กบุ๊กโดยแทรกวัตถุ OLE เข้าไป โปรดใช้ชื่อที่สมเหตุสมผล!
## บทสรุป
การแทรกวัตถุ OLE ลงในไฟล์ Excel โดยใช้ Aspose.Cells สำหรับ .NET ไม่เพียงแต่เป็นประโยชน์แต่ยังตรงไปตรงมาเมื่อคุณแบ่งขั้นตอนต่างๆ ออกเป็นขั้นตอนที่จัดการได้ เครื่องมืออันทรงพลังนี้ช่วยให้คุณปรับปรุงเอกสาร Excel ของคุณให้โต้ตอบได้และดึงดูดสายตา ไม่ว่าคุณจะเป็นนักพัฒนาที่ต้องการสร้างรายงานอัตโนมัติหรือเป็นนักวิเคราะห์ที่ต้องการนำเสนอข้อมูลอย่างมีประสิทธิภาพ การเรียนรู้การฝัง OLE ถือเป็นสินทรัพย์สำคัญในชุดเครื่องมือของคุณ
## คำถามที่พบบ่อย
### OLE Object คืออะไร?
วัตถุ OLE คือไฟล์ที่สามารถฝังลงในเอกสารได้ ช่วยให้แอปพลิเคชันต่างๆ สามารถบูรณาการเข้าด้วยกันได้ ตัวอย่างเช่น รูปภาพ เอกสาร Word และงานนำเสนอ
### ฉันสามารถใช้ Aspose.Cells ได้ฟรีหรือไม่?
 คุณสามารถทดลองใช้ Aspose.Cells ได้ฟรีโดยดาวน์โหลดเวอร์ชันทดลองใช้ที่มีให้ใน[เว็บไซต์](https://releases.aspose.com/).
### ฉันสามารถใช้รูปแบบไฟล์ใดกับวัตถุ OLE ได้บ้าง?
คุณสามารถใช้รูปแบบต่างๆ รวมถึงรูปภาพ (JPEG, PNG), เอกสาร Word, PDF และอื่นๆ ขึ้นอยู่กับแอปพลิเคชันของคุณ
### Aspose.Cells ได้รับการสนับสนุนบนทุกแพลตฟอร์มหรือไม่
Aspose.Cells สำหรับ .NET ได้รับการออกแบบมาโดยเฉพาะสำหรับแพลตฟอร์ม .NET อย่างไรก็ตาม ฟังก์ชันการทำงานอาจแตกต่างกันไปตามสภาพแวดล้อม Windows, Mac หรือคลาวด์ที่แตกต่างกัน
### ฉันจะได้รับความช่วยเหลือหากประสบปัญหาได้อย่างไร?
 คุณสามารถเข้าถึงการสนับสนุนได้ผ่านทาง[ฟอรั่ม Aspose](https://forum.aspose.com/c/cells/9) ที่นักพัฒนามาแบ่งปันข้อมูลเชิงลึกและโซลูชั่น
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
