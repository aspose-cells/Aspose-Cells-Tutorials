---
title: สร้างผลรวมย่อยใน Excel
linktitle: สร้างผลรวมย่อยใน Excel
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีการสร้างผลรวมย่อยใน Excel โดยใช้ Aspose.Cells สำหรับ .NET ด้วยบทช่วยสอนทีละขั้นตอนง่ายๆ นี้
weight: 10
url: /th/net/excel-subtotal-calculation/create-subtotals-in-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# สร้างผลรวมย่อยใน Excel

## การแนะนำ
คุณพร้อมที่จะพัฒนาทักษะ Excel ของคุณและทำให้สเปรดชีตของคุณมีความคล่องตัวมากขึ้นหรือยัง การสร้างผลรวมย่อยใน Excel จะช่วยให้คุณจัดหมวดหมู่และสรุปข้อมูลได้อย่างมีประสิทธิภาพ ช่วยให้ตีความและรายงานข้อมูลได้ดีขึ้น หากคุณเป็นคนที่มักต้องดิ้นรนกับตัวเลขจำนวนมาก การสร้างสรุปแบบมีโครงสร้างจึงมีความจำเป็น วันนี้เราจะมาเจาะลึกถึงวิธีการสร้างผลรวมย่อยอย่างง่ายดายโดยใช้ Aspose.Cells สำหรับ .NET ซึ่งเป็นไลบรารีอันทรงพลังที่ออกแบบมาเพื่อจัดการการจัดการไฟล์ Excel ทั้งหมดของคุณ
## ข้อกำหนดเบื้องต้น
ก่อนที่เราจะเจาะลึกรายละเอียดในการสร้างผลรวมย่อยใน Excel คุณควรมีข้อกำหนดเบื้องต้นบางประการดังต่อไปนี้:
1.  ติดตั้ง Aspose.Cells สำหรับ .NET: ตรวจสอบให้แน่ใจว่าคุณได้ตั้งค่าไลบรารี Aspose.Cells ไว้ในสภาพแวดล้อมการพัฒนาของคุณแล้ว หากคุณยังไม่ได้ดำเนินการนี้ คุณสามารถทำได้ง่ายๆ[ดาวน์โหลดได้ที่นี่](https://releases.aspose.com/cells/net/).
2. สภาพแวดล้อม .NET: คุณควรมีสภาพแวดล้อม .NET ที่ใช้งานได้ซึ่งเราสามารถทำงานกับไลบรารีได้ ไม่ว่าจะเป็น Visual Studio หรือ IDE อื่นๆ โปรดแน่ใจว่าคุณสามารถเขียนโค้ดใน C# ได้อย่างคล่องแคล่ว
3. ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับ C# จะเป็นประโยชน์ ตัวอย่างที่เราจะนำเสนออยู่ในรูปแบบ C# ดังนั้นการคุ้นเคยกับรูปแบบดังกล่าวจะช่วยให้คุณเข้าใจกระบวนการได้
4.  เวิร์กชีต Excel: ไฟล์ Excel ตัวอย่างสำหรับฝึกฝน เราจะใช้ไฟล์ชื่อ`book1.xls` ในบทช่วยสอนของเรา
5.  การเข้าถึงเอกสารและการสนับสนุนออนไลน์: ทำความคุ้นเคยกับ[เอกสารประกอบ Aspose.Cells](https://reference.aspose.com/cells/net/) อาจมีประโยชน์อย่างยิ่งเมื่อคุณก้าวหน้าในการใช้ห้องสมุด
ตอนนี้เราได้วางรากฐานไว้แล้ว มาดูส่วนทางเทคนิคกัน!
## แพ็คเกจนำเข้า
ก่อนที่จะเริ่มเขียนโค้ดจริง เราต้องตรวจสอบให้แน่ใจก่อนว่าเรามีแพ็คเกจที่จำเป็นทั้งหมดแล้ว ด้านล่างนี้คือวิธีนำเข้าเนมสเปซที่จำเป็นในโปรเจ็กต์ของคุณ:
```csharp
using System.IO;
using Aspose.Cells;
```
การดำเนินการนี้จะนำเข้าทุกสิ่งที่เราต้องการจากไลบรารี Aspose เพื่อจัดการไฟล์ Excel ตอนนี้เรามาแบ่งโค้ดออกเป็นขั้นตอนทีละขั้นตอนเพื่อสร้างผลรวมย่อยในเวิร์กชีต Excel กัน
## ขั้นตอนที่ 1: ตั้งค่าเส้นทางไฟล์
ในการเริ่มต้น เราต้องกำหนดว่าไฟล์ Excel ของเราอยู่ที่ไหน นี่คือตำแหน่งที่เราแจ้งให้โปรแกรมทราบเกี่ยวกับไดเร็กทอรีเอกสารของเรา
```csharp
string dataDir = "Your Document Directory";
```
 แทนที่`"Your Document Directory"` ด้วยเส้นทางจริงที่คุณ`book1.xls` จะถูกเก็บไว้ ซึ่งจะบอกให้โปรแกรมทราบว่าจะค้นหาไฟล์ Excel ที่เราจะจัดการได้จากที่ใด
## ขั้นตอนที่ 2: สร้างเวิร์กบุ๊กใหม่
ขั้นตอนต่อไป เราจะสร้างอินสแตนซ์ใหม่ของออบเจ็กต์ Workbook ซึ่งจะช่วยให้เราเปิดและแก้ไขไฟล์ Excel ได้
```csharp
Workbook workbook = new Workbook(dataDir + "book1.xls");
```
 ที่นี่เราจะสร้างวัตถุของ`Workbook` และโหลดด้วยสิ่งที่เรากำหนดไว้`book1.xls` ไฟล์ วัตถุเวิร์กบุ๊กนี้ตอนนี้มีข้อมูลทั้งหมดจากไฟล์ Excel และอนุญาตให้เราปรับเปลี่ยนได้
## ขั้นตอนที่ 3: เข้าถึงคอลเลกชันเซลล์
ในการดำเนินการกับเนื้อหาของเวิร์กชีต Excel เราจำเป็นต้องเข้าถึงคอลเลกชัน "เซลล์"
```csharp
Cells cells = workbook.Worksheets[0].Cells;
```
 การดำเนินการนี้จะดึงข้อมูลเซลล์จากเวิร์กชีตแรก (ดัชนี 0) ของเวิร์กบุ๊กของเรา`cells` วัตถุจะช่วยให้เราโต้ตอบกับเซลล์แต่ละเซลล์ในสเปรดชีตได้
## ขั้นตอนที่ 4: กำหนดพื้นที่เซลล์สำหรับผลรวมย่อย
ตอนนี้ถึงเวลาที่จะระบุช่วงของเซลล์ที่เราต้องการใช้ผลรวมย่อย 
```csharp
CellArea ca = new CellArea();
ca.StartRow = 2; // บี3
ca.StartColumn = 1; 
ca.EndRow = 18; // ซี19
ca.EndColumn = 2;
```
 ที่นี่เราจะกำหนด`CellArea` ซึ่งระบุช่วงที่เราสนใจ ในกรณีนี้ เราได้เลือกพื้นที่ตั้งแต่ B3 (แถวที่ 2 คอลัมน์ที่ 1) ถึง C19 (แถวที่ 18 คอลัมน์ที่ 2) นี่คือจุดที่เราจะคำนวณผลรวมย่อยของเรา
## ขั้นตอนที่ 5: ใช้ผลรวมย่อย
นี่คือหัวใจของการดำเนินการของเรา - การนำผลรวมย่อยไปใช้กับพื้นที่เซลล์ที่กำหนดไว้
```csharp
cells.Subtotal(ca, 0, ConsolidationFunction.Sum, new int[] { 1 });
```
 ในบรรทัดนี้เราเรียกว่า`Subtotal` วิธีการ พารามิเตอร์ที่กำหนดมีดังนี้:
- `ca`:ช่วงของเซลล์ที่เราได้กำหนดไว้ก่อนหน้านี้
- `0`:ดัชนีนี้จะอ้างอิงถึงคอลัมน์ที่มีค่าที่ต้องทำการสรุปรวมย่อย 
- `ConsolidationFunction.Sum`นี่ระบุว่าเราต้องการรวมค่าต่างๆ
- `new int[] { 1 }`:นี่แสดงว่าเรากำลังรวมค่าจากคอลัมน์ที่สอง (คอลัมน์ C)
## ขั้นตอนที่ 6: บันทึกไฟล์ Excel ที่ปรับเปลี่ยนแล้ว
สุดท้ายเราจะต้องบันทึกการเปลี่ยนแปลงของเราลงในไฟล์ Excel ใหม่ 
```csharp
workbook.Save(dataDir + "output.out.xls");
```
 การ`Save` วิธีการเขียนการเปลี่ยนแปลงไปยังไฟล์ใหม่ที่ชื่อ`output.out.xls`คุณสามารถระบุชื่อไฟล์เอาต์พุตได้ตามความต้องการ
## บทสรุป
ด้วยขั้นตอนง่ายๆ เหล่านี้ คุณก็สามารถสร้างผลรวมย่อยในเวิร์กชีต Excel ได้สำเร็จโดยใช้ Aspose.Cells สำหรับ .NET! ตั้งแต่การสร้างเวิร์กบุ๊กไปจนถึงการใช้ผลรวมย่อยและการบันทึกผลลัพธ์ เราครอบคลุมทุกพื้นฐาน ไลบรารีนี้ไม่เพียงแต่ช่วยลดความซับซ้อนในการจัดการ Excel ของคุณเท่านั้น แต่ยังช่วยให้คุณจัดการข้อมูลได้อย่างมีประสิทธิภาพมากขึ้นอีกด้วย
ตอนนี้ลองดูสิ! คุณจะประหลาดใจว่าการจัดการข้อมูลในสเปรดชีตจะง่ายขึ้นแค่ไหนเมื่อคุณรู้วิธีใช้เครื่องมือที่ถูกต้อง 
## คำถามที่พบบ่อย
### Aspose.Cells สำหรับ .NET คืออะไร?
Aspose.Cells สำหรับ .NET เป็นไลบรารีอันทรงพลังที่ช่วยให้นักพัฒนาสามารถจัดการไฟล์ Excel ในโปรแกรมแอปพลิเคชัน .NET ได้
### ฉันจำเป็นต้องติดตั้งอะไรพิเศษเพื่อใช้ Aspose.Cells หรือไม่
 ใช่ คุณต้องดาวน์โหลดและเพิ่มไลบรารี Aspose.Cells ลงในโปรเจ็กต์ .NET ของคุณ[ดาวน์โหลดที่นี่](https://releases.aspose.com/cells/net/).
### เป็นไปได้ไหมที่จะสร้างฟีเจอร์ Excel ประเภทอื่น ๆ โดยใช้ Aspose.Cells?
แน่นอน! Aspose.Cells ช่วยให้คุณสามารถดำเนินการ Excel ต่างๆ ได้ เช่น การสร้างแผนภูมิ การจัดการเวิร์กชีต และการปรับเปลี่ยนรูปแบบเซลล์ และอื่นๆ อีกมากมาย
### ฉันสามารถใช้ Aspose.Cells ได้ฟรีหรือไม่?
 คุณสามารถทำได้[ทดลองใช้งานฟรี](https://releases.aspose.com/) ของ Aspose.Cells เพื่อสำรวจคุณลักษณะต่างๆ ก่อนตัดสินใจซื้อ
### มีตัวเลือกการสนับสนุนอะไรบ้าง?
 หากมีปัญหาใดๆ สามารถเข้าไปเยี่ยมชมได้ที่[ฟอรั่มสนับสนุน Aspose](https://forum.aspose.com/c/cells/9) เพื่อรับความช่วยเหลือและแบ่งปันข้อมูลเชิงลึกกับชุมชนผู้ใช้และนักพัฒนา
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
