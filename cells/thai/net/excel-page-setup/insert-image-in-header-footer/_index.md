---
"description": "เรียนรู้วิธีการแทรกภาพในส่วนหัว ส่วนท้าย โดยใช้ Aspose.Cells สำหรับ .NET ด้วยคู่มือทีละขั้นตอนที่ครอบคลุมนี้"
"linktitle": "แทรกภาพในส่วนหัวส่วนท้าย"
"second_title": "เอกสารอ้างอิง API Aspose.Cells สำหรับ .NET"
"title": "แทรกภาพในส่วนหัวส่วนท้าย"
"url": "/th/net/excel-page-setup/insert-image-in-header-footer/"
"weight": 60
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# แทรกภาพในส่วนหัวส่วนท้าย

## การแนะนำ

เมื่อทำงานกับไฟล์ Excel ส่วนหัวและส่วนท้ายมีบทบาทสำคัญในการให้บริบทและข้อมูลอันมีค่า ลองนึกภาพว่าคุณกำลังร่างรายงานสำหรับธุรกิจของคุณ และโลโก้บริษัทต้องปรากฏอยู่ในส่วนหัวเพื่อให้ดูเป็นมืออาชีพ ในคู่มือนี้ เราจะแสดงวิธีใช้ Aspose.Cells สำหรับ .NET เพื่อแทรกภาพในส่วนหัวหรือส่วนท้ายของแผ่นงาน Excel ของคุณ

## ข้อกำหนดเบื้องต้น

ก่อนที่จะลงโค้ดจริง มีบางสิ่งที่คุณจำเป็นต้องพร้อม:

1. Aspose.Cells สำหรับไลบรารี .NET: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้งไลบรารี Aspose.Cells ในสภาพแวดล้อม .NET ของคุณแล้ว หากยังไม่มี คุณสามารถทำได้ [ดาวน์โหลดได้ที่นี่](https://releases-aspose.com/cells/net/).
2. Visual Studio หรือ IDE อื่นๆ: คุณจะต้องมีสภาพแวดล้อมการพัฒนาแบบบูรณาการเพื่อเขียนและดำเนินการโค้ด C# ของคุณ
3. ภาพตัวอย่าง: เตรียมภาพที่คุณต้องการแทรกในส่วนหัวหรือส่วนท้าย สำหรับตัวอย่างของเรา เราจะใช้โลโก้บริษัทที่เรียกว่า `aspose-logo-jpg`.
4. ความรู้พื้นฐานเกี่ยวกับ C#: ถึงแม้จะไม่บังคับ แต่การทำความเข้าใจ C# จะช่วยให้คุณทำตามบทช่วยสอนนี้ได้ง่ายขึ้น
5. การเข้าถึงระบบไฟล์: ตรวจสอบให้แน่ใจว่าคุณสามารถเข้าถึงระบบไฟล์ของคุณซึ่งคุณจะอ่านภาพและบันทึกไฟล์ Excel

## แพ็คเกจนำเข้า

ในการเริ่มต้น คุณต้องนำเข้าเนมสเปซที่จำเป็นในไฟล์ C# ของคุณ นี่คือรายละเอียดโดยย่อ:

```csharp
using System.IO;
using Aspose.Cells;
using System;
```

การนำเข้าเหล่านี้จะช่วยให้สามารถเข้าถึงคลาสทั้งหมดที่เราจำเป็นต้องใช้เพื่อจัดการไฟล์ Excel และจัดการไฟล์บนระบบ

## ขั้นตอนที่ 1: ตั้งค่าเส้นทางไดเร็กทอรี

ขั้นแรก คุณจะต้องระบุไดเรกทอรีที่ไฟล์ Excel และรูปภาพของคุณอยู่ อัปเดตเส้นทางให้เหมาะกับโครงสร้างภายในเครื่องของคุณ

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY"; // อัพเดทตามความเหมาะสม
```

เส้นนี้ตั้งค่า `dataDir` ตัวแปรซึ่งเป็นเส้นทางฐานสำหรับค้นหาภาพที่คุณต้องการแทรกไว้ในส่วนหัว

## ขั้นตอนที่ 2: การสร้างวัตถุเวิร์กบุ๊ก

จากนั้นคุณต้องสร้างเวิร์กบุ๊กใหม่ที่คุณจะเพิ่มรูปภาพของคุณ

```csharp
Workbook workbook = new Workbook();
```

บรรทัดโค้ดนี้จะเริ่มต้นอินสแตนซ์ใหม่ของ `Workbook` คลาสที่ช่วยให้คุณสามารถจัดการกับสเปรดชีต Excel ได้

## ขั้นตอนที่ 3: การกำหนดเส้นทางของภาพ

ถึงเวลาสร้างตัวแปรสตริงเพื่อเก็บเส้นทางไปยังรูปภาพที่คุณต้องการใช้ ในกรณีของเรา เราจะใช้ `aspose-logo-jpg`.

```csharp
string logo_url = dataDir + "aspose-logo.jpg";
```

ที่นี่ เราเชื่อมโยงเส้นทางไดเร็กทอรีกับชื่อไฟล์โลโก้

## ขั้นตอนที่ 4: การอ่านภาพเป็นข้อมูลไบนารี

ในการแทรกภาพลงในส่วนหัว เราจำเป็นต้องอ่านไฟล์ภาพเป็นข้อมูลไบนารี

```csharp
FileStream inFile = new FileStream(logo_url, FileMode.Open, FileAccess.Read);
byte[] binaryData = new byte[inFile.Length];
long bytesRead = inFile.Read(binaryData, 0, (int)inFile.Length);
```

- การ `FileStream` ใช้เพื่อเปิดภาพในโหมดอ่าน
- จากนั้นเราประกาศอาร์เรย์ไบต์ `binaryData` เพื่อเก็บข้อมูลภาพ
- สุดท้ายเราอ่านข้อมูลภาพจาก `FileStream`-

## ขั้นตอนที่ 5: การเข้าถึงวัตถุการตั้งค่าหน้า

การจะทำการเปลี่ยนแปลงส่วนหัว เราต้องเข้าถึง `PageSetup` วัตถุที่เชื่อมโยงกับเวิร์กชีตแรก 

```csharp
PageSetup pageSetup = workbook.Worksheets[0].PageSetup;
```

ที่นี่เราได้รับ `PageSetup` วัตถุที่ช่วยให้เราจัดการการตั้งค่าการพิมพ์สำหรับเวิร์กชีตได้

## ขั้นตอนที่ 6: การแทรกภาพลงในส่วนหัว

เมื่อมีข้อมูลไบนารีของภาพแล้ว เราก็สามารถแทรกข้อมูลเหล่านั้นลงในส่วนหัวได้

```csharp
pageSetup.SetHeaderPicture(1, binaryData);
```

บรรทัดนี้จะวางรูปภาพไว้ที่ส่วนกลางของส่วนหัว พารามิเตอร์ `1` ระบุส่วนหัว

## ขั้นตอนที่ 7: การตั้งค่าเนื้อหาส่วนหัว

ตอนนี้เรามีภาพแล้ว เรามาเพิ่มข้อความลงในส่วนหัวเพื่อเพิ่มบริบทกัน 

```csharp
pageSetup.SetHeader(1, "&G"); // แทรกภาพ
pageSetup.SetHeader(2, "&A"); // แทรกชื่อชีท
```

- บรรทัดแรกจะแทรกตัวแทนรูปภาพ (`&G`-
- บรรทัดที่สองจะเพิ่มชื่อแผ่นงานที่ส่วนด้านขวาของส่วนหัวโดยใช้ตัวแทน (`&A`-

## ขั้นตอนที่ 8: การบันทึกสมุดงาน

หลังจากทำการเปลี่ยนแปลงที่จำเป็นทั้งหมดแล้ว ก็ถึงเวลาบันทึกสมุดงาน

```csharp
workbook.Save(dataDir + "InsertImageInHeaderFooter_out.xls");
```

บรรทัดนี้จะบันทึกเวิร์กบุ๊กโดยใช้ชื่อไฟล์ที่ระบุในไดเร็กทอรีที่คุณกำหนดไว้ก่อนหน้านี้

## ขั้นตอนที่ 9: การปิด FileStream

สุดท้ายอย่าลืมปิด `FileStream` เพื่อปลดปล่อยทรัพยากร

```csharp
inFile.Close();
```

วิธีนี้ช่วยให้แอปพลิเคชันของคุณเป็นระเบียบเรียบร้อยและป้องกันการรั่วไหลของหน่วยความจำ

## บทสรุป

ขอแสดงความยินดี! คุณได้เพิ่มรูปภาพลงในส่วนหัวของไฟล์ Excel สำเร็จแล้วโดยใช้ Aspose.Cells สำหรับ .NET ไม่ว่าจะเป็นโลโก้บริษัทหรือคำคมสร้างแรงบันดาลใจ ส่วนหัวสามารถเพิ่มความเป็นมืออาชีพให้กับเอกสารของคุณได้อย่างมาก ตอนนี้คุณสามารถนำความรู้ไปใช้กับโปรเจ็กต์ต่างๆ ลองนึกดูว่ารายงานของคุณจะดูสวยงามแค่ไหนหากใช้ส่วนหัวและส่วนท้ายที่ปรับแต่งเองได้!

## คำถามที่พบบ่อย

### Aspose.Cells รองรับรูปแบบไฟล์ใดบ้างสำหรับรูปภาพ?
Aspose.Cells รองรับรูปแบบต่างๆ รวมถึง JPEG, PNG, BMP, GIF และ TIFF

### ฉันสามารถแทรกภาพหลายภาพลงในส่วนหัว/ส่วนท้ายได้หรือไม่
ใช่ คุณสามารถแทรกภาพแยกต่างหากลงในส่วนต่างๆ ของส่วนหัวหรือส่วนท้ายได้โดยใช้ตัวแทนตำแหน่งที่แตกต่างกัน

### Aspose.Cells ฟรีหรือเปล่า?
Aspose.Cells นำเสนอรุ่นทดลองใช้งานฟรี แต่มีเวอร์ชันที่ได้รับอนุญาตสำหรับการเข้าถึงแบบเต็มรูปแบบและฟีเจอร์เพิ่มเติม คุณสามารถรับ [ใบอนุญาตชั่วคราวที่นี่](https://purchase-aspose.com/temporary-license/).

### ฉันจะแก้ไขปัญหารูปภาพไม่แสดงได้อย่างไร
ตรวจสอบให้แน่ใจว่าเส้นทางของภาพถูกต้องและไฟล์มีอยู่ ตรวจสอบความเข้ากันได้ของรูปแบบภาพด้วย

### ฉันสามารถหาเอกสารเพิ่มเติมสำหรับ Aspose.Cells ได้จากที่ใด
คุณสามารถค้นหาเอกสารรายละเอียดได้ [ที่นี่](https://reference-aspose.com/cells/net/).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}