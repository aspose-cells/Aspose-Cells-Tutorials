---
title: คิวรีพื้นที่เซลล์ที่แมปกับเส้นทางแผนที่ XML โดยใช้ Aspose.Cells
linktitle: คิวรีพื้นที่เซลล์ที่แมปกับเส้นทางแผนที่ XML โดยใช้ Aspose.Cells
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีการสอบถามพื้นที่เซลล์ที่แมปด้วย XML ใน Excel โดยใช้ Aspose.Cells สำหรับ .NET คำแนะนำทีละขั้นตอนนี้จะช่วยให้คุณแยกข้อมูล XML ที่มีโครงสร้างได้อย่างราบรื่น
weight: 12
url: /th/net/xml-map-operations/query-cell-areas-mapped-to-xml-map-path/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# คิวรีพื้นที่เซลล์ที่แมปกับเส้นทางแผนที่ XML โดยใช้ Aspose.Cells

## การแนะนำ
คุณเคยสงสัยไหมว่าจะทำงานกับข้อมูล XML ใน Excel โดยใช้ .NET ได้อย่างไร ด้วย Aspose.Cells สำหรับ .NET ซึ่งเป็นไลบรารีที่มีประสิทธิภาพสำหรับการจัดการสเปรดชีต คุณสามารถโต้ตอบกับแมป XML ภายในไฟล์ Excel ได้อย่างง่ายดาย ลองนึกภาพว่าคุณมีไฟล์ Excel ที่เต็มไปด้วยข้อมูลที่มีโครงสร้าง และคุณจำเป็นต้องค้นหาพื้นที่เฉพาะที่แมปกับเส้นทาง XML นี่คือจุดที่ Aspose.Cells มีประโยชน์ ในบทช่วยสอนนี้ เราจะเจาะลึกการค้นหาพื้นที่เซลล์ที่แมปกับเส้นทางแมป XML ในไฟล์ Excel โดยใช้ Aspose.Cells สำหรับ .NET ไม่ว่าคุณจะต้องการสร้างรายงานแบบไดนามิกหรือทำการดึงข้อมูลโดยอัตโนมัติ คู่มือนี้ก็มีคำแนะนำทีละขั้นตอนให้คุณ
## ข้อกำหนดเบื้องต้น
ก่อนที่จะเริ่มเขียนโค้ด มีบางสิ่งที่คุณต้องมี:
1.  Aspose.Cells สำหรับ .NET: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้งไลบรารีนี้แล้ว คุณสามารถดาวน์โหลดได้[ที่นี่](https://releases.aspose.com/cells/net/) หรือรับได้ผ่าน NuGet
2. ไฟล์ Excel ที่แมปด้วย XML: สำหรับบทช่วยสอนนี้ คุณจะต้องมีไฟล์ Excel (.xlsx) ที่มีแมป XML
3. สภาพแวดล้อมการพัฒนา: คู่มือนี้จะถือว่าคุณใช้ Visual Studio แต่ตัวแก้ไข C# ตัวใดก็ได้จะทำงานได้ดี
4.  ใบอนุญาต Aspose: คุณสามารถใช้ใบอนุญาตชั่วคราวได้หากจำเป็น ซึ่งคุณสามารถรับได้[ที่นี่](https://purchase.aspose.com/temporary-license/).
## แพ็คเกจนำเข้า
ในการเริ่มต้น โปรดแน่ใจว่าได้นำเข้าเนมสเปซที่จำเป็นในไฟล์โค้ดของคุณ:
```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Diagnostics;
using System.Collections;
```
ด้วยแพ็คเกจเหล่านี้ คุณจะพร้อมเข้าถึงเวิร์กบุ๊ก จัดการเวิร์กชีต และสอบถามแผนที่ XML ภายในสเปรดชีตได้
## ขั้นตอนที่ 1: โหลดไฟล์ Excel ที่มี XML Map
ขั้นแรก คุณจะต้องโหลดไฟล์ Excel ที่มีการแมป XML อยู่แล้ว ไฟล์นี้ทำหน้าที่เป็นแหล่งข้อมูล
```csharp
// กำหนดเส้นทางไดเรกทอรีสำหรับแหล่งที่มาและเอาต์พุต
string sourceDir = "Your Document Directory";
// โหลดไฟล์ Excel
Workbook wb = new Workbook(sourceDir + "sampleXmlMapQuery.xlsx");
```
 ที่นี่,`Workbook` เป็นคลาสที่แสดงไฟล์ Excel ทั้งหมด ซึ่งคุณโหลดโดยใช้เส้นทางไฟล์ แทนที่`"Your Document Directory"` พร้อมด้วยเส้นทางไดเร็กทอรีจริงที่ไฟล์ของคุณตั้งอยู่
## ขั้นตอนที่ 2: เข้าถึงแผนที่ XML ในเวิร์กบุ๊ก
เมื่อโหลดไฟล์แล้ว ขั้นตอนต่อไปคือการเข้าถึงแผนที่ XML ภายในเวิร์กบุ๊ก แผนที่นี้ทำหน้าที่เป็นสะพานเชื่อมระหว่างสเปรดชีตและข้อมูล XML ของคุณ
```csharp
//เข้าถึงแผนที่ XML แรกในเวิร์กบุ๊ก
XmlMap xmap = wb.Worksheets.XmlMaps[0];
```
 ที่นี่ เราจะดึงข้อมูลแผนที่ XML แรกในเวิร์กบุ๊กโดยเข้าถึง`XmlMaps[0]` จาก`Worksheets` คอลเลกชัน คุณสามารถมีแผนที่ XML หลายรายการในเวิร์กบุ๊ก และบทช่วยสอนนี้จะเน้นที่แผนที่แรก
## ขั้นตอนที่ 3: เข้าถึงเวิร์กชีตเพื่อสอบถาม
เมื่อแผนที่ XML พร้อมแล้ว ตอนนี้คุณจะต้องเลือกเวิร์กชีตเฉพาะที่ข้อมูลที่แมปตั้งอยู่ โดยทั่วไปนี่คือเวิร์กชีตแรก แต่ขึ้นอยู่กับการตั้งค่าไฟล์ของคุณ
```csharp
// เข้าถึงเวิร์กชีตแรกในเวิร์กบุ๊ก
Worksheet ws = wb.Worksheets[0];
```
การเข้าถึงเวิร์กชีตที่มีข้อมูลที่แมปด้วย XML ช่วยให้คุณสามารถกำหนดเป้าหมายเซลล์ที่ต้องการได้ ที่นี่ เราใช้เวิร์กชีตแรก แต่คุณสามารถเลือกเวิร์กชีตอื่น ๆ ได้โดยเปลี่ยนดัชนีหรือระบุชื่อ
## ขั้นตอนที่ 4: สอบถามแผนที่ XML โดยใช้เส้นทาง
ตอนนี้มาถึงส่วนหลักแล้ว: การสอบถามแผนที่ XML ที่นี่ คุณจะระบุเส้นทาง XML และดึงข้อมูลที่แมปกับเส้นทางนั้นภายในเวิร์กชีต
```csharp
Console.WriteLine("Query Xml Map from Path - /MiscData");
ArrayList ret = ws.XmlMapQuery("/MiscData", xmap);
```
 การ`XmlMapQuery`วิธีนี้ใช้พารามิเตอร์สองตัว คือ เส้นทาง XML และแผนที่ XML ที่คุณดึงมาก่อนหน้านี้ ในตัวอย่างนี้ เราจะสอบถามเส้นทาง`/MiscData` ซึ่งเป็นเส้นทางระดับบนสุดในโครงสร้าง XML ผลลัพธ์จะถูกเก็บไว้ใน`ArrayList`ทำให้สามารถทำซ้ำได้ง่าย
## ขั้นตอนที่ 5: แสดงผลลัพธ์การค้นหา
 เมื่อทำการสอบถามข้อมูลแล้ว ขั้นตอนต่อไปคือการแสดงผลลัพธ์ มาพิมพ์แต่ละรายการจาก`ArrayList` ไปที่คอนโซลเพื่อดูข้อมูลที่ถูกแยกออกมาอย่างชัดเจน
```csharp
// พิมพ์ผลลัพธ์ของการค้นหา
for (int i = 0; i < ret.Count; i++)
{
    Console.WriteLine(ret[i]);
}
```
 ลูปนี้จะผ่านแต่ละรายการใน`ArrayList` และพิมพ์ไปยังคอนโซล คุณจะเห็นข้อมูลที่แยกออกมาจากเส้นทางแผนที่ XML`/MiscData`.
## ขั้นตอนที่ 6: สอบถามเส้นทาง XML แบบซ้อนกัน
 หากต้องการปรับแต่งแบบสอบถามของคุณ ให้เจาะลึกลงไปในเส้นทางที่ซ้อนกันภายในโครงสร้าง XML เช่น`/MiscData/row/Color`.
```csharp
Console.WriteLine("Query Xml Map from Path - /MiscData/row/Color");
ret = ws.XmlMapQuery("/MiscData/row/Color", xmap);
```
 ที่นี่ เรากำลังสอบถามเส้นทางที่เฉพาะเจาะจงมากขึ้นภายในข้อมูล XML โดยการจำกัดให้แคบลงเป็น`/MiscData/row/Color` คุณกำหนดเป้าหมายเฉพาะข้อมูลสีภายใต้`row` โหนดในโครงสร้าง XML
## ขั้นตอนที่ 7: แสดงผลลัพธ์ของแบบสอบถามเส้นทางแบบซ้อน
สุดท้าย คุณจะต้องการพิมพ์ผลลัพธ์ของแบบสอบถามที่ปรับแต่งนี้เพื่อดูค่าเฉพาะที่แมปไว้`/MiscData/row/Color`.
```csharp
// พิมพ์ผลลัพธ์ของแบบสอบถามเส้นทางซ้อนกัน
for (int i = 0; i < ret.Count; i++)
{
    Console.WriteLine(ret[i]);
}
```
เช่นเดียวกับก่อนหน้านี้ ลูปนี้จะส่งออกผลลัพธ์ของแบบสอบถามไปยังคอนโซล ช่วยให้คุณสามารถตรวจสอบข้อมูลเฉพาะที่ดึงมาจากเส้นทาง XML ที่ซ้อนกันได้
## บทสรุป
และแล้วคุณก็ทำได้! ด้วย Aspose.Cells สำหรับ .NET การสอบถามพื้นที่เซลล์ที่แมปกับเส้นทางแมป XML เป็นเรื่องง่ายและมีประสิทธิภาพสูง ฟีเจอร์อันทรงพลังนี้ถือเป็นตัวเปลี่ยนเกมสำหรับนักพัฒนาที่ต้องการดึงข้อมูล XML เฉพาะจากสเปรดชีต ตอนนี้คุณมีพื้นฐานในการนำการสอบถาม XML ที่ซับซ้อนยิ่งขึ้นมาใช้และรวมการแมป XML หลายรายการภายในเวิร์กโฟลว์ Excel ของคุณแล้ว พร้อมที่จะก้าวไปอีกขั้นหรือยัง สำรวจเอกสาร Aspose.Cells เพื่อดูฟังก์ชันแมป XML เพิ่มเติมเพื่อเพิ่มประสิทธิภาพให้กับแอปพลิเคชันของคุณ!
## คำถามที่พบบ่อย
### ฉันสามารถแมปไฟล์ XML หลายไฟล์ในเวิร์กบุ๊ก Excel เดียวได้หรือไม่  
ใช่ Aspose.Cells ช่วยให้คุณจัดการแผนที่ XML หลายรายการในเวิร์กบุ๊กได้ ทำให้เกิดการโต้ตอบข้อมูลที่ซับซ้อนได้
### จะเกิดอะไรขึ้นถ้าเส้นทาง XML ไม่มีอยู่ในแผนที่?  
 หากเส้นทางไม่ถูกต้องหรือไม่มีอยู่`XmlMapQuery` วิธีการนี้จะคืนค่าว่าง`ArrayList`.
### ฉันต้องมีใบอนุญาตเพื่อใช้ Aspose.Cells สำหรับ .NET หรือไม่?  
 ใช่ ต้องมีใบอนุญาตจึงจะใช้งานได้เต็มรูปแบบ คุณสามารถลองใช้[ทดลองใช้งานฟรี](https://releases.aspose.com/)หรือรับ[ใบอนุญาตชั่วคราว](https://purchase.aspose.com/temporary-license/).
### ฉันสามารถบันทึกข้อมูลที่สอบถามลงในไฟล์ Excel ใหม่ได้หรือไม่  
แน่นอน! คุณสามารถดึงข้อมูลที่สอบถามออกมาและเขียนลงในไฟล์ Excel อื่นหรือรูปแบบอื่น ๆ ที่รองรับโดย Aspose.Cells ได้
### สามารถค้นหาแผนที่ XML ในรูปแบบอื่นนอกเหนือจาก Excel (.xlsx) ได้หรือไม่  
ไฟล์ .xlsx รองรับการแมป XML สำหรับรูปแบบอื่น ฟังก์ชันการทำงานอาจจำกัดหรือไม่รองรับ
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
