---
title: การใช้โปรแกรมคัดลอกใน Excel
linktitle: การใช้โปรแกรมคัดลอกใน Excel
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีใช้เมธอดคัดลอกใน Aspose.Cells สำหรับ .NET เพื่อจัดการไฟล์ Excel อย่างมีประสิทธิภาพ มีคู่มือทีละขั้นตอนรวมอยู่ด้วย
weight: 10
url: /th/net/excel-formatting-methods-and-options/using-copy-method/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# การใช้โปรแกรมคัดลอกใน Excel

## การแนะนำ
เมื่อต้องจัดการและปรับเปลี่ยนสเปรดชีตด้วยโปรแกรม Aspose.Cells สำหรับ .NET เป็นเครื่องมือทรงพลังที่ช่วยประหยัดเวลาและเพิ่มประสิทธิภาพเวิร์กโฟลว์ของคุณได้ หนึ่งในงานที่นักพัฒนามักเผชิญคือการคัดลอกช่วงจากเวิร์กชีตหนึ่งไปยังอีกเวิร์กบุ๊กหนึ่งในเวิร์กบุ๊ก Excel ในบทช่วยสอนนี้ เราจะแนะนำคุณเกี่ยวกับการใช้เมธอด Copy ใน Aspose.Cells พร้อมทั้งอธิบายแต่ละขั้นตอนอย่างชัดเจนและมีตัวอย่างโค้ดให้ด้วย
## ข้อกำหนดเบื้องต้น
ก่อนที่เราจะเจาะลึกลงไปในขั้นตอนการใช้การคัดลอก คุณจะต้องแน่ใจว่าคุณมีข้อกำหนดเบื้องต้นดังต่อไปนี้:
1. .NET Framework: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง .NET Framework ไว้ในเครื่องของคุณแล้ว Aspose.Cells เข้ากันได้กับเวอร์ชันต่างๆ ดังนั้นให้ตรวจสอบเวอร์ชันเหล่านั้น[เอกสารประกอบ](https://reference.aspose.com/cells/net/) สำหรับข้อมูลเฉพาะ
2. Visual Studio: การมี Visual Studio หรือ IDE ที่เข้ากันได้สำหรับการพัฒนา .NET ถือเป็นสิ่งสำคัญ ซึ่งจะช่วยให้คุณสร้างและจัดการโปรเจ็กต์ของคุณได้อย่างสะดวก
3.  ไลบรารี Aspose.Cells: ดาวน์โหลดไลบรารี Aspose.Cells จาก[หน้าวางจำหน่าย](https://releases.aspose.com/cells/net/) และเพิ่มการอ้างอิงถึงมันในโครงการของคุณ
4.  ตัวอย่างไฟล์ Excel: สร้างหรือมีไฟล์ Excel พร้อมใช้งาน (เช่น`Book1.xlsx`) ที่คุณจะใช้ในบทช่วยสอนนี้
5. ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับแนวคิดและไวยากรณ์ของภาษา C#
เมื่อตรงตามข้อกำหนดเบื้องต้นเหล่านี้แล้ว คุณก็พร้อมที่จะเริ่มเขียนโค้ดได้เลย!
## แพ็คเกจนำเข้า
หากต้องการใช้ฟังก์ชันต่างๆ ที่ Aspose.Cells จัดเตรียมไว้ให้ คุณต้องนำเข้าแพ็คเกจที่จำเป็น ในโปรเจ็กต์ C# ของคุณ อย่าลืมรวมคำสั่ง using ต่อไปนี้ไว้ที่ด้านบนของไฟล์โค้ด:
```csharp
using System.IO;
using Aspose.Cells;
using System.Drawing;
```
สิ่งนี้ทำให้คุณสามารถเข้าถึงคลาสและวิธีการที่จำเป็นในการจัดการไฟล์ Excel ได้อย่างง่ายดาย
ตอนนี้คุณจัดการทุกอย่างเรียบร้อยแล้ว เรามาแบ่งขั้นตอนการใช้เมธอด Copy ออกเป็นขั้นตอนที่จัดการได้ เราจะเริ่มต้นด้วยการโหลดไฟล์ Excel แล้วจึงดำเนินการคัดลอกช่วงที่ต้องการ
## ขั้นตอนที่ 1: การตั้งค่าสตรีมไฟล์
ขั้นตอนแรกคือการสร้างสตรีมไฟล์ที่จะช่วยให้เราเปิดและทำงานกับไฟล์ Excel ได้ โดยทำได้ดังนี้:
```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "Your Document Directory";
// การสร้างสตรีมไฟล์ที่มีไฟล์ Excel ที่จะเปิด
FileStream fstream = new FileStream(dataDir + "Book1.xlsx", FileMode.Open);
```
 ในโค้ดนี้ คุณต้องระบุเส้นทางที่คุณ`Book1.xlsx` ไฟล์อยู่ที่ตั้งแล้ว`FileMode.Open` พารามิเตอร์ระบุว่าเราต้องการเปิดไฟล์ที่มีอยู่
## ขั้นตอนที่ 2: การเปิดสมุดงาน
ต่อไปเราจะสร้างวัตถุเวิร์กบุ๊กโดยใช้สตรีมไฟล์ที่เราเพิ่งตั้งค่า ซึ่งจะทำให้เข้าถึงเนื้อหาของไฟล์ Excel ได้
```csharp
// การเปิดไฟล์ Excel ผ่านทางสตรีมไฟล์
Workbook workbook = new Workbook(fstream);
```
เมื่อถึงจุดนี้ เราได้เปิดเวิร์กบุ๊กแล้วและสามารถเริ่มทำงานกับเนื้อหาได้
## ขั้นตอนที่ 3: การเข้าถึงแผ่นงาน
เมื่อโหลดเวิร์กบุ๊กแล้ว เราจำเป็นต้องเข้าถึงเวิร์กชีตที่ต้องการใช้งาน โดยทั่วไป นี่จะเป็นเวิร์กชีตแรกในเวิร์กบุ๊ก
```csharp
// การเข้าถึงเวิร์กชีตแรกในไฟล์ Excel
Worksheet worksheet = workbook.Worksheets[0];
```
 ที่นี่,`Worksheets[0]` คว้าแผ่นงานแรก หากคุณต้องการเข้าถึงแผ่นงานอื่น เพียงเปลี่ยนดัชนี
## ขั้นตอนที่ 4: การคัดลอกช่วง
ตอนนี้มาถึงส่วนหลักแล้ว นั่นก็คือการคัดลอกช่วงของเซลล์ สำหรับบทช่วยสอนนี้ เราจะสาธิตวิธีการคัดลอกการตั้งค่าการจัดรูปแบบตามเงื่อนไขจากเซลล์หนึ่งไปยังอีกเซลล์หนึ่ง รวมไปถึงวิธีการคัดลอกช่วงทั้งหมดของแผ่นงาน Excel
### การคัดลอกการจัดรูปแบบตามเงื่อนไข (ตัวอย่าง)
```csharp
// การคัดลอกการตั้งค่ารูปแบบตามเงื่อนไขจากเซลล์ "A1" ไปยังเซลล์ "B1"
// แผ่นงาน.CopyConditionalFormatting(0, 0, 0, 1);
```
บรรทัดนี้ถูกใส่เครื่องหมายแสดงความคิดเห็นไว้ในโค้ดต้นฉบับ แต่จะแสดงให้คุณเห็นวิธีการคัดลอกการจัดรูปแบบตามเงื่อนไขจากเซลล์ A1 ไปยังเซลล์ B1 บนเวิร์กชีตเดียวกัน พารามิเตอร์แสดงดัชนีแถวและคอลัมน์ของเซลล์ต้นทางและปลายทาง คุณสามารถยกเลิกการใส่เครื่องหมายแสดงความคิดเห็นได้หากจำเป็นต้องใช้ฟังก์ชันนี้
### การคัดลอกช่วงทั้งหมด (ตัวอย่าง)
เราสามารถขยายฟังก์ชันการคัดลอกของเราเพิ่มเติมเพื่อรวมถึงการคัดลอกช่วงทั้งหมด โดยเราจะใช้ลูปเพื่อดูเวิร์กชีตทั้งหมด
```csharp
int TotalRowCount = 0;
for (int i = 0; i < workbook.Worksheets.Count; i++)
{
    // การเข้าถึงแผ่นงานแต่ละแผ่น
    Worksheet sourceSheet = workbook.Worksheets[i];
    // การรับช่วงการแสดงผลในเวิร์กชีต
    Range sourceRange = sourceSheet.Cells.MaxDisplayRange;
    // การสร้างช่วงในเวิร์กชีตปลายทาง
    Range destRange = worksheet.Cells.CreateRange(
        sourceRange.FirstRow + TotalRowCount,
        sourceRange.FirstColumn,
        sourceRange.RowCount,
        sourceRange.ColumnCount);
    // การคัดลอกช่วงแหล่งที่มาไปยังช่วงปลายทาง
    destRange.Copy(sourceRange);
    // การอัปเดตจำนวนแถวทั้งหมดสำหรับการวนซ้ำรอบถัดไป
    TotalRowCount += sourceRange.RowCount; 
}
```
## ขั้นตอนที่ 5: การบันทึกสมุดงานที่แก้ไขแล้ว
หลังจากคัดลอกช่วงที่ต้องการแล้ว คุณจะต้องการบันทึกเวิร์กบุ๊กที่แก้ไขเพื่อรักษาการเปลี่ยนแปลงของคุณ ดังต่อไปนี้:
```csharp
// การบันทึกไฟล์ Excel ที่แก้ไขแล้ว
workbook.Save(dataDir + "output.xls");
```
 รหัสนี้จะบันทึกสมุดงานที่แก้ไขของคุณเป็น`output.xls` ในไดเร็กทอรีที่คุณระบุ โปรดเลือกรูปแบบที่เหมาะสมกับความต้องการของคุณ 
## ขั้นตอนที่ 6: การปิดสตรีมไฟล์
สุดท้ายเพื่อให้แน่ใจว่าเราได้ปลดปล่อยทรัพยากรระบบ เราจำเป็นต้องปิดสตรีมไฟล์ที่เราเปิดไว้ในตอนแรก
```csharp
// การปิดสตรีมไฟล์เพื่อปลดปล่อยทรัพยากรทั้งหมด
fstream.Close();
```
และเพียงเท่านี้ คุณก็ได้เสร็จสิ้นกระบวนการคัดลอกช่วงและบันทึกไฟล์ Excel ที่อัปเดตสำเร็จแล้ว!
## บทสรุป
การใช้เมธอด Copy ใน Aspose.Cells สำหรับ .NET ช่วยให้คุณสามารถจัดการไฟล์ Excel ได้อย่างง่ายดาย โดยปฏิบัติตามคำแนะนำทีละขั้นตอนนี้ คุณจะสามารถคัดลอกช่วงเซลล์และการจัดรูปแบบตามเงื่อนไขจากเวิร์กชีตหนึ่งไปยังอีกเวิร์กชีตหนึ่งได้อย่างมีประสิทธิภาพ ทำให้การจัดการข้อมูลของคุณมีประสิทธิภาพมากขึ้น 
## คำถามที่พบบ่อย
### Aspose.Cells สำหรับ .NET คืออะไร?
Aspose.Cells สำหรับ .NET เป็นไลบรารีที่ช่วยให้นักพัฒนาสามารถสร้าง จัดการ และจัดการไฟล์ Excel ด้วยโปรแกรมในแอปพลิเคชัน .NET ได้
### ฉันสามารถคัดลอกรูปแบบ สูตร และค่าโดยใช้ Aspose.Cells ได้หรือไม่
ใช่ Aspose.Cells ช่วยให้คุณคัดลอกไม่เพียงแค่ค่า แต่ยังรวมถึงรูปแบบและสูตรระหว่างช่วงด้วย
### การใช้ Aspose.Cells ฟรีหรือไม่?
 Aspose.Cells เสนอให้ทดลองใช้งานฟรี แต่หากต้องการใช้งานต่อ จะต้องซื้อใบอนุญาต คุณสามารถดูข้อมูลเพิ่มเติมได้[ที่นี่](https://purchase.aspose.com/buy).
### ฉันจะได้รับการสนับสนุนได้อย่างไรหากประสบปัญหา?
 คุณสามารถขอความช่วยเหลือได้ผ่านฟอรัมสนับสนุน Aspose ที่พบ[ที่นี่](https://forum.aspose.com/c/cells/9).
### ฉันสามารถดาวน์โหลดไลบรารี Aspose.Cells ได้ที่ไหน
 คุณสามารถดาวน์โหลดไลบรารีได้จากหน้าเผยแพร่[ที่นี่](https://releases.aspose.com/cells/net/).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
