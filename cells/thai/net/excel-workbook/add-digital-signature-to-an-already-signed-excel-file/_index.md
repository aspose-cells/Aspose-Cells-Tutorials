---
title: เพิ่มลายเซ็นดิจิทัลลงในไฟล์ Excel ที่ลงนามแล้ว
linktitle: เพิ่มลายเซ็นดิจิทัลลงในไฟล์ Excel ที่ลงนามแล้ว
second_title: เอกสารอ้างอิง Aspose.Cells สำหรับ API .NET
description: เรียนรู้วิธีการเพิ่มลายเซ็นดิจิทัลลงในไฟล์ Excel ที่ลงนามแล้วโดยใช้ Aspose.Cells สำหรับ .NET ด้วยคู่มือทีละขั้นตอนโดยละเอียดนี้
weight: 30
url: /th/net/excel-workbook/add-digital-signature-to-an-already-signed-excel-file/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# เพิ่มลายเซ็นดิจิทัลลงในไฟล์ Excel ที่ลงนามแล้ว

## การแนะนำ

ในโลกดิจิทัลทุกวันนี้ การรักษาความปลอดภัยเอกสารมีความสำคัญมากกว่าที่เคย ลายเซ็นดิจิทัลช่วยให้สามารถรับรองความถูกต้องและความสมบูรณ์ของไฟล์ได้ โดยเฉพาะอย่างยิ่งเมื่อต้องจัดการกับข้อมูลที่ละเอียดอ่อน หากคุณกำลังทำงานกับไฟล์ Excel และต้องการเพิ่มลายเซ็นดิจิทัลใหม่ลงในเวิร์กบุ๊กที่ลงนามแล้ว คุณมาถูกที่แล้ว! ในคู่มือนี้ เราจะแนะนำคุณเกี่ยวกับขั้นตอนการเพิ่มลายเซ็นดิจิทัลลงในไฟล์ Excel ที่ลงนามแล้วโดยใช้ Aspose.Cells สำหรับ .NET มาเริ่มกันเลย!

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเข้าสู่รายละเอียดเล็กๆ น้อยๆ ของการเขียนโค้ด มีบางสิ่งบางอย่างที่คุณต้องมี:

1.  Aspose.Cells สำหรับ .NET: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้งไลบรารี Aspose.Cells ไว้ในโปรเจ็กต์ .NET แล้ว คุณสามารถดาวน์โหลดได้จาก[เว็บไซต์](https://releases.aspose.com/cells/net/).
2.  ไฟล์ใบรับรอง: คุณจะต้องมีไฟล์ใบรับรองที่ถูกต้อง (โดยทั่วไปคือ`.pfx`ไฟล์) ที่มีใบรับรองดิจิทัลของคุณ ตรวจสอบให้แน่ใจว่าคุณทราบรหัสผ่านสำหรับไฟล์นี้
3. สภาพแวดล้อมการพัฒนา: ตั้งค่าสภาพแวดล้อมการพัฒนาของคุณด้วย Visual Studio หรือ IDE อื่นๆ ที่สนับสนุน .NET
4. ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับการเขียนโปรแกรม C# จะช่วยให้คุณทำตามได้อย่างราบรื่น
5. ไฟล์ตัวอย่าง: มีไฟล์ Excel ตัวอย่างที่ลงนามดิจิทัลแล้ว นี่จะเป็นไฟล์ที่คุณจะเพิ่มลายเซ็นใหม่

ตอนนี้เรามีทุกอย่างลงตัวแล้ว มาเริ่มเขียนโค้ดกันเลย!

## แพ็คเกจนำเข้า

ในการเริ่มต้น คุณจะต้องนำเข้าแพ็คเกจที่จำเป็นลงในไฟล์ C# ของคุณ โดยทำตามขั้นตอนต่อไปนี้:

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```

เนมสเปซเหล่านี้ช่วยให้คุณทำงานกับไฟล์ Excel และจัดการลายเซ็นดิจิทัลได้อย่างราบรื่น

## ขั้นตอนที่ 1: ตั้งค่าไดเรกทอรีต้นทางและปลายทาง

ก่อนที่คุณจะจัดการไฟล์ Excel ได้ คุณต้องกำหนดตำแหน่งไฟล์ต้นฉบับและตำแหน่งที่คุณต้องการบันทึกไฟล์เอาต์พุต วิธีดำเนินการมีดังต่อไปนี้:

```csharp
// ไดเรกทอรีแหล่งที่มา
string sourceDir = "Your Document Directory";
// ไดเรกทอรีผลลัพธ์
string outputDir = "Your Document Directory";
```

ในขั้นตอนนี้ เราจะใช้เมธอดในการรับเส้นทางสำหรับไดเร็กทอรีต้นทางและปลายทาง ตรวจสอบให้แน่ใจว่ามีไดเร็กทอรีเหล่านี้อยู่และมีไฟล์ที่จำเป็น

## ขั้นตอนที่ 2: โหลดสมุดงานที่ลงนามแล้ว

 ขั้นต่อไป คุณจะต้องโหลดเวิร์กบุ๊ก Excel ที่คุณต้องการแก้ไข ซึ่งทำได้โดยการสร้างอินสแตนซ์ของ`Workbook` คลาสและส่งผ่านเส้นทางของไฟล์ที่ลงนาม

```csharp
// โหลดสมุดงานที่มีลายเซ็นดิจิทัลแล้ว
Aspose.Cells.Workbook workbook = new Aspose.Cells.Workbook(sourceDir + "sampleDigitallySignedByCells.xlsx");
```

 ที่นี่เรากำลังโหลดสมุดงานที่ชื่อ`sampleDigitallySignedByCells.xlsx`. ตรวจสอบให้แน่ใจว่าไฟล์นี้ได้รับการลงนามแล้ว

## ขั้นตอนที่ 3: สร้างคอลเลกชันลายเซ็นดิจิทัล

ตอนนี้เรามาสร้างคอลเลกชันลายเซ็นดิจิทัลกัน คอลเลกชันนี้จะเก็บลายเซ็นดิจิทัลทั้งหมดที่คุณต้องการเพิ่มลงในเวิร์กบุ๊ก

```csharp
// สร้างคอลเลกชันลายเซ็นดิจิทัล
Aspose.Cells.DigitalSignatures.DigitalSignatureCollection dsCollection = new Aspose.Cells.DigitalSignatures.DigitalSignatureCollection();
```

ขั้นตอนนี้มีความสำคัญเนื่องจากช่วยให้คุณสามารถจัดการลายเซ็นหลายรายการได้หากจำเป็น

## ขั้นตอนที่ 4: สร้างใบรับรองใหม่

 คุณต้องโหลดไฟล์ใบรับรองของคุณเพื่อสร้างลายเซ็นดิจิทัลใหม่ นี่คือที่ที่คุณจะระบุเส้นทางไปยัง`.pfx` ไฟล์และรหัสผ่าน

```csharp
// ไฟล์ใบรับรองและรหัสผ่าน
string certFileName = sourceDir + "AsposeDemo.pfx";
string password = "aspose";

// สร้างใบรับรองใหม่
System.Security.Cryptography.X509Certificates.X509Certificate2 certificate = new System.Security.Cryptography.X509Certificates.X509Certificate2(certFileName, password);
```

 อย่าลืมเปลี่ยน`AsposeDemo.pfx`และรหัสผ่านพร้อมชื่อไฟล์ใบรับรองจริงและรหัสผ่านของคุณ

## ขั้นตอนที่ 5: สร้างลายเซ็นดิจิทัล

เมื่อมีใบรับรองในมือแล้ว คุณสามารถสร้างลายเซ็นดิจิทัลได้แล้ว นอกจากนี้ คุณยังต้องระบุเหตุผลสำหรับลายเซ็น รวมถึงวันที่และเวลาปัจจุบันด้วย

```csharp
// สร้างลายเซ็นดิจิทัลใหม่และเพิ่มลงในคอลเลกชันลายเซ็นดิจิทัล
Aspose.Cells.DigitalSignatures.DigitalSignature signature = new Aspose.Cells.DigitalSignatures.DigitalSignature(certificate, "Aspose.Cells added new digital signature in existing digitally signed workbook.", DateTime.Now);
```

ขั้นตอนนี้จะเพิ่มลายเซ็นใหม่ลงในคอลเลกชั่นของคุณ ซึ่งคุณจะนำไปใช้กับเวิร์กบุ๊กในภายหลัง

## ขั้นตอนที่ 6: เพิ่มคอลเลกชันลายเซ็นดิจิทัลลงในเวิร์กบุ๊ก

ตอนนี้ถึงเวลาเพิ่มคอลเลกชันลายเซ็นดิจิทัลลงในเวิร์กบุ๊กแล้ว นี่คือจุดที่ความมหัศจรรย์เกิดขึ้น!

```csharp
// เพิ่มคอลเลกชันลายเซ็นดิจิทัลภายในสมุดงาน
workbook.AddDigitalSignature(dsCollection);
```

การดำเนินการตามบรรทัดนี้ ถือว่าคุณแนบลายเซ็นดิจิทัลใหม่เข้ากับสมุดงานที่ลงนามแล้ว

## ขั้นตอนที่ 7: บันทึกและกำจัดสมุดงาน

สุดท้ายคุณจะต้องการบันทึกเวิร์กบุ๊กที่แก้ไขแล้วไปยังไดเร็กทอรีเอาท์พุตของคุณและปล่อยทรัพยากรใดๆ ที่กำลังใช้อยู่

```csharp
//บันทึกสมุดงานและกำจัดมัน
workbook.Save(outputDir + "outputDigitallySignedByCells.xlsx");
workbook.Dispose();
```

ขั้นตอนนี้จะช่วยให้แน่ใจว่าการเปลี่ยนแปลงของคุณได้รับการบันทึกและสมุดงานจะถูกกำจัดอย่างถูกต้องเพื่อเพิ่มทรัพยากร

## ขั้นตอนที่ 8: ยืนยันการดำเนินการ

เพื่อสรุปสิ่งต่างๆ ควรยืนยันว่าโค้ดของคุณทำงานสำเร็จ คุณสามารถทำได้โดยใช้ข้อความคอนโซลง่ายๆ

```csharp
Console.WriteLine("AddDigitalSignatureToAnAlreadySignedExcelFile executed successfully.\r\n");
```

นี่จะเป็นการแจ้งว่าการดำเนินการของคุณประสบความสำเร็จ ซึ่งเป็นเรื่องดีเสมอที่จะได้เห็น!

## บทสรุป

และแล้วคุณก็ทำได้! คุณได้เพิ่มลายเซ็นดิจิทัลใหม่ลงในไฟล์ Excel ที่ลงนามแล้วโดยใช้ Aspose.Cells สำหรับ .NET สำเร็จแล้ว ลายเซ็นดิจิทัลเป็นวิธีที่มีประสิทธิภาพในการรับรองความถูกต้องของเอกสารของคุณ และตอนนี้คุณก็รู้วิธีจัดการเอกสารเหล่านี้ด้วยโปรแกรมแล้ว ไม่ว่าคุณจะทำงานกับเอกสารทางการเงิน สัญญา หรือข้อมูลสำคัญใดๆ การนำลายเซ็นดิจิทัลมาใช้จะช่วยเพิ่มความปลอดภัยและความน่าเชื่อถือได้

## คำถามที่พบบ่อย

### ลายเซ็นดิจิทัลคืออะไร?
ลายเซ็นดิจิทัลเป็นวิธีการเข้ารหัสที่ใช้เพื่อตรวจสอบความถูกต้องและความสมบูรณ์ของข้อความหรือเอกสาร

### ฉันสามารถเพิ่มลายเซ็นดิจิทัลหลายรายการลงในไฟล์ Excel เดียวกันได้หรือไม่
ใช่ คุณสามารถสร้างคอลเลกชันลายเซ็นดิจิทัลและเพิ่มลายเซ็นหลายรายการลงในเวิร์กบุ๊กเดียวกันได้

### Aspose.Cells รองรับรูปแบบใดบ้างสำหรับลายเซ็นดิจิทัล?
 Aspose.Cells รองรับรูปแบบต่างๆ รวมถึง`.pfx` เพื่อขอรับใบรับรอง

### ฉันต้องมี .NET เวอร์ชันเฉพาะเพื่อใช้ Aspose.Cells หรือไม่
 ตรวจสอบ[เอกสารประกอบ Aspose.Cells](https://reference.aspose.com/cells/net/) เพื่อให้เข้ากันได้กับเวอร์ชัน .NET ของคุณ

### ฉันจะได้รับใบอนุญาตชั่วคราวสำหรับ Aspose.Cells ได้อย่างไร
 คุณสามารถขอใบอนุญาตชั่วคราวได้จาก[หน้าการซื้อของ Aspose](https://purchase.aspose.com/temporary-license/).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
