---
"description": "เรียนรู้วิธีดึงข้อมูลจากเซลล์ Excel โดยใช้ Aspose.Cells สำหรับ .NET ในบทช่วยสอนทีละขั้นตอนนี้ ซึ่งเหมาะสำหรับทั้งผู้เริ่มต้นและนักพัฒนาที่มีประสบการณ์"
"linktitle": "ดึงข้อมูลจากเซลล์ใน Excel"
"second_title": "API การประมวลผล Excel ของ Aspose.Cells .NET"
"title": "ดึงข้อมูลจากเซลล์ใน Excel"
"url": "/th/net/excel-data-export-retrieval/retrieve-data-from-cells-in-excel/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# ดึงข้อมูลจากเซลล์ใน Excel

## การแนะนำ

เมื่อต้องจัดการข้อมูลใน Excel ความสามารถในการอ่านและดึงข้อมูลจากเซลล์ถือเป็นสิ่งสำคัญ Aspose.Cells สำหรับ .NET เป็นไลบรารีที่มีประสิทธิภาพที่ช่วยให้นักพัฒนาสามารถจัดการไฟล์ Excel ได้อย่างราบรื่น ในบทช่วยสอนนี้ เราจะเจาะลึกถึงวิธีดึงข้อมูลจากเซลล์ในเวิร์กบุ๊ก Excel โดยใช้ Aspose.Cells ไม่ว่าคุณจะเป็นนักพัฒนาที่มีประสบการณ์หรือเพิ่งเริ่มต้น คู่มือนี้จะแนะนำคุณทีละขั้นตอนในกระบวนการนี้

## ข้อกำหนดเบื้องต้น

ก่อนที่จะเริ่มลงรายละเอียดในโค้ด มีข้อกำหนดเบื้องต้นบางประการที่คุณต้องมี:

1. Visual Studio: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Visual Studio ไว้ในเครื่องของคุณแล้ว ซึ่งเป็น IDE ที่เราจะใช้เขียนและรันโค้ด
2. Aspose.Cells สำหรับ .NET: คุณต้องมีไลบรารี Aspose.Cells คุณสามารถดาวน์โหลดได้จาก [เว็บไซต์อาโพส](https://releases-aspose.com/cells/net/).
3. ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับการเขียนโปรแกรม C# จะช่วยให้คุณเข้าใจตัวอย่างต่างๆ ได้ดีขึ้น
4. ไฟล์ Excel: เตรียมไฟล์ Excel ไว้ (ตัวอย่างเช่น `book1.xls`) ที่คุณจะใช้สำหรับบทช่วยสอนนี้

เมื่อคุณได้จัดเรียงข้อกำหนดเบื้องต้นเหล่านี้แล้ว เราก็สามารถเริ่มสำรวจวิธีการดึงข้อมูลจากเซลล์ Excel ได้

## แพ็คเกจนำเข้า

ในการเริ่มต้น คุณต้องนำเข้าเนมสเปซที่จำเป็นในโปรเจ็กต์ C# ของคุณ ซึ่งจะช่วยให้คุณใช้คลาสและเมธอดที่ Aspose.Cells จัดเตรียมไว้ได้

```csharp
using System.IO;
using Aspose.Cells;
using System;
```

เมื่อนำเนมสเปซเหล่านี้เข้ามาแล้ว คุณก็พร้อมที่จะเริ่มเขียนโค้ดได้แล้ว มาแบ่งกระบวนการออกเป็นขั้นตอนที่จัดการได้

## ขั้นตอนที่ 1: ตั้งค่าไดเรกทอรีเอกสารของคุณ

ขั้นตอนแรกคือการกำหนดเส้นทางไปยังไดเร็กทอรีเอกสารซึ่งไฟล์ Excel ของคุณตั้งอยู่ ขั้นตอนนี้มีความสำคัญมาก เนื่องจากขั้นตอนนี้จะแจ้งให้แอปพลิเคชันทราบว่าจะค้นหาไฟล์ที่คุณต้องการทำงานด้วยได้จากที่ใด


```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "Your Document Directory";
```

แทนที่ `"Your Document Directory"` ด้วยเส้นทางจริงที่คุณ `book1.xls` ไฟล์จะถูกเก็บไว้ เส้นทางนี้คือที่ที่ Aspose.Cells จะค้นหาไฟล์เมื่อคุณพยายามเปิดมัน

## ขั้นตอนที่ 2: เปิดสมุดงานที่มีอยู่

ตอนนี้คุณได้ตั้งค่าไดเร็กทอรีเอกสารแล้ว ขั้นตอนถัดไปคือเปิดเวิร์กบุ๊ก (ไฟล์ Excel) ที่คุณต้องการทำงานด้วย


```csharp
// การเปิดสมุดงานที่มีอยู่
Workbook workbook = new Workbook(dataDir + "book1.xls");
```

ที่นี่เราสร้าง `Workbook` วัตถุโดยส่งเส้นทางเต็มของไฟล์ Excel ขั้นตอนนี้จะเริ่มต้นเวิร์กบุ๊กและทำให้พร้อมสำหรับการดึงข้อมูล

## ขั้นตอนที่ 3: เข้าถึงแผ่นงานแรก

หลังจากเปิดเวิร์กบุ๊กแล้ว คุณจะต้องการเข้าถึงเวิร์กชีตที่ต้องการดึงข้อมูล ในกรณีนี้ เราจะเข้าถึงเวิร์กชีตแรก


```csharp
// การเข้าถึงแผ่นงานแรก
Worksheet worksheet = workbook.Worksheets[0];
```

การ `Worksheets` คอลเลกชันช่วยให้คุณเข้าถึงแผ่นงานต่างๆ ในสมุดงานได้ ดัชนี `[0]` หมายถึงเวิร์กชีตแรก หากต้องการเข้าถึงชีตถัดไป คุณสามารถเปลี่ยนดัชนีได้ตามนั้น

## ขั้นตอนที่ 4: วนซ้ำผ่านเซลล์

ตอนนี้คุณมีเวิร์กชีตแล้ว ถึงเวลาวนซ้ำในแต่ละเซลล์เพื่อดึงข้อมูล นี่คือจุดที่ความมหัศจรรย์เกิดขึ้น!


```csharp
foreach (Cell cell1 in worksheet.Cells)
{
    // ตัวแปรสำหรับเก็บค่าประเภทข้อมูลที่แตกต่างกัน
    string stringValue;
    double doubleValue;
    bool boolValue;
    DateTime dateTimeValue;

    // การส่งประเภทของข้อมูลที่มีอยู่ในเซลล์เพื่อการประเมิน
    switch (cell1.Type)
    {
        // การประเมินประเภทข้อมูลของข้อมูลเซลล์สำหรับค่าสตริง
        case CellValueType.IsString:
            stringValue = cell1.StringValue;
            Console.WriteLine("String Value: " + stringValue);
            break;

        // การประเมินชนิดข้อมูลของข้อมูลเซลล์สำหรับค่าสองเท่า
        case CellValueType.IsNumeric:
            doubleValue = cell1.DoubleValue;
            Console.WriteLine("Double Value: " + doubleValue);
            break;

        // การประเมินประเภทข้อมูลของข้อมูลเซลล์สำหรับค่าบูลีน
        case CellValueType.IsBool:
            boolValue = cell1.BoolValue;
            Console.WriteLine("Bool Value: " + boolValue);
            break;

        // การประเมินประเภทข้อมูลของข้อมูลเซลล์สำหรับค่าวันที่/เวลา
        case CellValueType.IsDateTime:
            dateTimeValue = cell1.DateTimeValue;
            Console.WriteLine("DateTime Value: " + dateTimeValue);
            break;

        // การประเมินชนิดข้อมูลที่ไม่รู้จักของข้อมูลเซลล์
        case CellValueType.IsUnknown:
            stringValue = cell1.StringValue;
            Console.WriteLine("Unknown Value: " + stringValue);
            break;

        // การยุติการตรวจสอบชนิดของข้อมูลเซลล์เป็นค่าว่าง
        case CellValueType.IsNull:
            break;
    }
}
```

ในขั้นตอนนี้ เราจะวนซ้ำผ่านแต่ละเซลล์ในเวิร์กชีต สำหรับแต่ละเซลล์ เราจะตรวจสอบประเภทข้อมูลโดยใช้ `switch` คำสั่ง ขึ้นอยู่กับประเภท เราจะเรียกค้นค่าและพิมพ์ค่าดังกล่าวไปยังคอนโซล ต่อไปนี้คือรายละเอียดของกรณีต่างๆ:

- IsString: หากเซลล์มีสตริง เราจะดึงข้อมูลโดยใช้ `StringValue`-
- IsNumeric: สำหรับค่าตัวเลข เราใช้ `DoubleValue`-
- IsBool: หากเซลล์เก็บค่าบูลีน เราจะเข้าถึงโดยใช้ `BoolValue`-
- IsDateTime: สำหรับค่าวันที่และเวลา เราใช้ `DateTimeValue`-
- IsUnknown: ถ้าชนิดข้อมูลไม่เป็นที่รู้จัก เราจะยังคงดึงการแสดงสตริง
- IsNull: หากเซลล์ว่าง เราเพียงแค่ข้ามมันไป

## บทสรุป

การดึงข้อมูลจากเซลล์ Excel โดยใช้ Aspose.Cells สำหรับ .NET เป็นกระบวนการที่ตรงไปตรงมา เมื่อทำตามขั้นตอนเหล่านี้ คุณจะสามารถดึงข้อมูลประเภทต่างๆ จากไฟล์ Excel ได้อย่างมีประสิทธิภาพ ไม่ว่าคุณจะกำลังสร้างเครื่องมือรายงาน ป้อนข้อมูลอัตโนมัติ หรือเพียงแค่ต้องการวิเคราะห์ข้อมูล Aspose.Cells มอบความยืดหยุ่นและประสิทธิภาพที่คุณต้องการเพื่อให้ทำงานสำเร็จ

## คำถามที่พบบ่อย

### Aspose.Cells คืออะไร?  
Aspose.Cells คือไลบรารี .NET ที่ช่วยให้นักพัฒนาสามารถสร้าง จัดการ และแปลงไฟล์ Excel ได้โดยไม่ต้องติดตั้ง Microsoft Excel

### ฉันสามารถใช้ Aspose.Cells ได้ฟรีหรือไม่?  
ใช่ Aspose.Cells เสนอรุ่นทดลองใช้ฟรีที่คุณสามารถใช้ทดสอบฟีเจอร์ต่างๆ ได้ คุณสามารถดาวน์โหลดได้ [ที่นี่](https://releases-aspose.com/).

### ฉันสามารถดึงข้อมูลประเภทใดจากเซลล์ Excel ได้บ้าง  
คุณสามารถเรียกค้นประเภทข้อมูลต่าง ๆ ได้ เช่น สตริง ตัวเลข บูลีน และค่าวันที่/เวลา

### ฉันจะได้รับการสนับสนุนสำหรับ Aspose.Cells ได้อย่างไร  
คุณสามารถรับการสนับสนุนได้โดยการเยี่ยมชม [ฟอรั่ม Aspose](https://forum.aspose.com/c/cells/9) ที่คุณสามารถสอบถามและขอความช่วยเหลือจากชุมชนได้

### มีใบอนุญาตชั่วคราวให้ใช้หรือไม่?  
ใช่ Aspose เสนอใบอนุญาตชั่วคราวเพื่อวัตถุประสงค์ในการประเมินผล คุณสามารถค้นหาข้อมูลเพิ่มเติมได้ [ที่นี่](https://purchase-aspose.com/temporary-license/).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}