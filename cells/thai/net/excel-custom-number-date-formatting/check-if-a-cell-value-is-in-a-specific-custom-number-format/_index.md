---
title: ตรวจสอบว่าค่าเซลล์อยู่ในรูปแบบตัวเลขที่กำหนดเองหรือไม่
linktitle: ตรวจสอบว่าค่าเซลล์อยู่ในรูปแบบตัวเลขที่กำหนดเองหรือไม่
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีการตรวจสอบค่าเซลล์ Excel เทียบกับรูปแบบตัวเลขที่กำหนดเองโดยใช้ Aspose.Cells สำหรับ .NET ด้วยบทช่วยสอนทีละขั้นตอนนี้
weight: 10
url: /th/net/excel-custom-number-date-formatting/check-if-a-cell-value-is-in-a-specific-custom-number-format/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# ตรวจสอบว่าค่าเซลล์อยู่ในรูปแบบตัวเลขที่กำหนดเองหรือไม่

## การแนะนำ

เมื่อทำงานกับสเปรดชีต โดยเฉพาะอย่างยิ่งในสภาพแวดล้อมระดับมืออาชีพ ความแม่นยำและการจัดรูปแบบถือเป็นสิ่งสำคัญ ไม่ว่าคุณจะกำลังวิเคราะห์ข้อมูลหรือสร้างรายงานที่ดึงดูดสายตา การตรวจสอบให้แน่ใจว่าค่าเซลล์สอดคล้องกับรูปแบบเฉพาะสามารถสร้างความแตกต่างได้อย่างมาก วันนี้ เราจะเจาะลึกการใช้งานจริงของ Aspose.Cells สำหรับ .NET โดยเราจะสาธิตวิธีตรวจสอบว่าค่าเซลล์สอดคล้องกับรูปแบบตัวเลขที่กำหนดเองหรือไม่ หากคุณเพิ่งเริ่มใช้ Aspose.Cells หรือต้องการปรับปรุงทักษะของคุณ คุณมาถูกที่แล้ว!

## ข้อกำหนดเบื้องต้น

ก่อนที่จะเจาะลึกโค้ด มีข้อกำหนดเบื้องต้นบางประการที่คุณจะต้องตั้งค่า:

1. ติดตั้ง Visual Studio: ตรวจสอบให้แน่ใจว่าคุณมี Visual Studio (เวอร์ชันใดก็ได้) พร้อมใช้งานบนเครื่องของคุณ เนื่องจากเราจะทำงานในสภาพแวดล้อม .NET
2.  ไลบรารี Aspose.Cells สำหรับ .NET: คุณจะต้องดาวน์โหลดและเพิ่มไลบรารี Aspose.Cells ลงในโปรเจ็กต์ของคุณ คุณสามารถดาวน์โหลดเวอร์ชันล่าสุดได้[ที่นี่](https://releases.aspose.com/cells/net/).
3. ความเข้าใจพื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับการเขียนโปรแกรม C# จะช่วยให้คุณทำตามได้อย่างราบรื่น

ตอนนี้เราได้เตรียมการเบื้องต้นเรียบร้อยแล้ว เรามาเริ่มนำเข้าแพ็คเกจที่จำเป็นเลยดีกว่า

## แพ็คเกจนำเข้า

ในการใช้งาน Aspose.Cells ก่อนอื่นคุณต้องนำเข้าเนมสเปซที่จำเป็นไปยังโปรเจ็กต์ C# ของคุณ ที่ด้านบนของไฟล์ C# ให้เพิ่ม using directives ดังต่อไปนี้:

```csharp
using Aspose.Cells;
using System;
```

คำสั่งเหล่านี้ทำให้คุณสามารถเข้าถึงคลาสและวิธีการทั้งหมดที่มีอยู่ในไลบรารี Aspose.Cells ทำให้คุณสร้างและจัดการไฟล์ Excel ได้อย่างง่ายดาย

ตอนนี้เรามีทุกอย่างพร้อมแล้ว เรามาแบ่งกระบวนการออกเป็นขั้นตอนที่ทำตามได้ง่าย ๆ กัน เราจะสร้างเวิร์กบุ๊ก ตั้งค่าเซลล์ กำหนดรูปแบบตัวเลขแบบกำหนดเอง และตรวจสอบข้อยกเว้นในรูปแบบที่ไม่ถูกต้อง วิธีดำเนินการมีดังนี้:

## ขั้นตอนที่ 1: สร้างสมุดงาน

ในการเริ่มต้น คุณต้องสร้างอินสแตนซ์ของเวิร์กบุ๊ก นี่คือรากฐานของไฟล์ Excel ของเราซึ่งข้อมูลและรูปแบบทั้งหมดจะอยู่ในนั้น

```csharp
// สร้างสมุดงาน
Workbook wb = new Workbook();
```

 โดยการเริ่มต้น`Workbook`เราตั้งค่าไฟล์ Excel ใหม่ในหน่วยความจำเพื่อให้พร้อมสำหรับการจัดการ

## ขั้นตอนที่ 2: ตั้งค่าการตั้งค่าสมุดงาน

ขั้นต่อไป เราต้องกำหนดค่าการตั้งค่าสำหรับเวิร์กบุ๊กของเรา ซึ่งถือเป็นสิ่งสำคัญ เนื่องจากจะช่วยตรวจจับข้อผิดพลาดเกี่ยวกับรูปแบบตัวเลขที่กำหนดเอง

```csharp
// เปิดใช้งานข้อยกเว้นสำหรับรูปแบบตัวเลขที่กำหนดเองที่ไม่ถูกต้อง
wb.Settings.CheckCustomNumberFormat = true;
```

 การตั้งค่า`CheckCustomNumberFormat` ถึง`true` สั่งให้ Aspose.Cells โยนข้อยกเว้นเมื่อใดก็ตามที่มีการใช้รูปแบบที่ไม่ถูกต้อง ช่วยให้จัดการข้อผิดพลาดได้ดีขึ้น

## ขั้นตอนที่ 3: เข้าถึงแผ่นงานแรก

เมื่อตั้งค่าเวิร์กบุ๊กของคุณแล้ว คุณสามารถเข้าถึงเวิร์กชีตแรกที่จะจัดเก็บข้อมูลของคุณได้

```csharp
// เข้าถึงแผ่นงานแรก
Worksheet ws = wb.Worksheets[0];
```

นี่จะทำให้คุณอ้างอิงถึงแผ่นงานแรกในเวิร์กบุ๊กซึ่งเราจะเพิ่มข้อมูลเซลล์ของเรา

## ขั้นตอนที่ 4: การทำงานกับเซลล์

ตอนนี้เรามีเวิร์กชีตแล้ว เราจะเข้าถึงเซลล์เฉพาะ ในกรณีนี้คือ "A1" จากนั้นเราจะป้อนค่าตัวเลขลงในเซลล์นี้

```csharp
// เข้าถึงเซลล์ A1 และใส่ตัวเลขลงไป
Cell c = ws.Cells["A1"];
c.PutValue(2347);
```

 โดยการใช้`PutValue` , เราใส่ตัวเลข`2347` ลงในเซลล์ "A1" 

## ขั้นตอนที่ 5: ตั้งค่ารูปแบบของเซลล์

หลังจากใส่ค่าลงในเซลล์แล้ว ก็ถึงเวลาเข้าถึงและปรับเปลี่ยนรูปแบบของเซลล์ได้

```csharp
// เข้าถึงรูปแบบเซลล์และตั้งค่าคุณสมบัติ Style.Custom
Style s = c.GetStyle();
```

เราเรียกค้นรูปแบบปัจจุบันของเซลล์ "A1" จากตรงนี้เราสามารถกำหนดรูปแบบตัวเลขที่กำหนดเองได้

## ขั้นตอนที่ 6: กำหนดรูปแบบตัวเลขแบบกำหนดเอง

ตอนนี้เราจะพยายามตั้งค่ารูปแบบตัวเลขแบบกำหนดเองที่ไม่ถูกต้องเพื่อดูว่าเวิร์กบุ๊กของเราตอบสนองอย่างไร

```csharp
try
{
    // บรรทัดนี้จะแสดงข้อยกเว้นหากรูปแบบไม่ถูกต้อง
    s.Custom = "ggg @ fff"; // รูปแบบตัวเลขกำหนดเองไม่ถูกต้อง
    c.SetStyle(s);
}
catch (Exception ex)
{
    Console.WriteLine("Exception Occurred. Exception: " + ex.Message);
}
```

ในบล็อกโค้ดนี้ เราพยายามตั้งค่ารูปแบบตัวเลขแบบกำหนดเองที่ไม่ถูกต้อง เนื่องจากเราได้เปิดใช้งานการโยนข้อยกเว้นในการตั้งค่าเวิร์กบุ๊ก การดำเนินการนี้จะตรวจจับปัญหาและแสดงข้อความแสดงข้อผิดพลาด

## ขั้นตอนที่ 7: ตรวจสอบความสำเร็จในการดำเนินการ

สุดท้ายให้พิมพ์ข้อความยืนยันเพื่อระบุว่าการดำเนินการได้ดำเนินการสำเร็จหรือไม่

```csharp
Console.WriteLine("CheckCustomNumberFormat executed successfully.");
```

สิ่งนี้ช่วยให้คุณสังเกตได้ว่าการตรวจสอบของคุณดำเนินการแล้ว โดยไม่คำนึงว่าจะสำเร็จหรือล้มเหลว

## บทสรุป

การสำรวจความสามารถของ Aspose.Cells สำหรับ .NET มอบชุดเครื่องมืออเนกประสงค์สำหรับการจัดการไฟล์ Excel ด้วยโปรแกรม ในบทช่วยสอนนี้ เราจะแนะนำวิธีการปฏิบัติจริงในการตรวจสอบค่าเซลล์กับรูปแบบตัวเลขที่กำหนดเองเฉพาะ รวมถึงการจัดการข้อผิดพลาด คุณสมบัติของ Aspose.Cells ไม่เพียงแต่ทำให้การจัดการ Excel ง่ายขึ้นเท่านั้น แต่ยังเพิ่มประสิทธิภาพการทำงานผ่านการจัดการข้อผิดพลาดที่มีประสิทธิภาพอีกด้วย

## คำถามที่พบบ่อย

### Aspose.Cells คืออะไร?
Aspose.Cells คือไลบรารี .NET ที่ออกแบบมาสำหรับการสร้าง จัดการ และแปลงไฟล์ Excel โดยไม่ต้องติดตั้ง Microsoft Excel

### ฉันสามารถทดลองใช้ Aspose.Cells ฟรีได้หรือไม่?
 ใช่ คุณสามารถดาวน์โหลด Aspose.Cells เวอร์ชันทดลองใช้งานฟรีได้[ที่นี่](https://releases.aspose.com/).

### ฉันสามารถหาเอกสารเพิ่มเติมได้ที่ไหน
 หากต้องการข้อมูลเพิ่มเติม โปรดตรวจสอบ[เอกสารประกอบ](https://reference.aspose.com/cells/net/).

### Aspose.Cells รองรับภาษาโปรแกรมอะไรบ้าง?
Aspose.Cells รองรับภาษา .NET เช่น C# และ VB.NET เป็นหลัก

### ฉันจะรายงานปัญหาหรือรับการสนับสนุนได้อย่างไร
 คุณสามารถถามคำถามหรือรายงานปัญหาเกี่ยวกับ[ฟอรั่ม Aspose](https://forum.aspose.com/c/cells/9).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
