---
"description": "เรียนรู้วิธีการนำเข้าข้อมูลลงในแผ่นงาน Excel ด้วยฟิลด์สูตรที่ระบุโดยใช้ Aspose.Cells สำหรับ .NET ในบทช่วยสอนโดยละเอียดนี้"
"linktitle": "ระบุฟิลด์สูตรเมื่อนำเข้าข้อมูลไปยังแผ่นงาน Excel"
"second_title": "API การประมวลผล Excel ของ Aspose.Cells .NET"
"title": "ระบุฟิลด์สูตรเมื่อนำเข้าข้อมูลไปยังแผ่นงาน Excel"
"url": "/th/net/excel-custom-number-date-formatting/specify-formula-fields-while-importing-data-to-worksheet-in-excel/"
"weight": 11
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# ระบุฟิลด์สูตรเมื่อนำเข้าข้อมูลไปยังแผ่นงาน Excel

## การแนะนำ

เมื่อต้องจัดการไฟล์ Excel ด้วยโปรแกรม Aspose.Cells สำหรับ .NET เป็นเครื่องมือที่มีค่าอย่างยิ่ง เนื่องจากมีฟังก์ชันการทำงานที่แข็งแกร่งสำหรับการสร้าง แก้ไข และจัดการสเปรดชีต Excel ได้อย่างง่ายดาย หนึ่งในคุณสมบัติที่น่าสนใจคือความสามารถในการระบุฟิลด์สูตรขณะนำเข้าข้อมูลลงในแผ่นงาน Excel ลองนึกภาพว่าคุณกำลังทำงานกับรายงานทางการเงินและจำเป็นต้องคำนวณผลรวมโดยอัตโนมัติตามข้อมูลที่ผู้ใช้ป้อน บทช่วยสอนนี้จะแนะนำคุณทีละขั้นตอนในการบรรลุเป้าหมายดังกล่าวด้วยแนวทางที่ชัดเจนและตรงไปตรงมา

## ข้อกำหนดเบื้องต้น

ก่อนที่จะเจาะลึกโค้ด เรามาตรวจสอบก่อนว่าคุณมีทุกสิ่งที่คุณต้องการ 

1. Visual Studio หรือสภาพแวดล้อมการพัฒนาแบบบูรณาการ (IDE) ของ .NET ใดๆ ตรวจสอบให้แน่ใจว่าคุณมี IDE ที่เหมาะสมในการเขียนและรันโค้ด C# ของคุณ
2. Aspose.Cells สำหรับ .NET: คุณจะต้องดาวน์โหลดและอ้างอิงไลบรารี Aspose.Cells ในโปรเจ็กต์ของคุณ คุณสามารถดาวน์โหลดได้จาก [การเปิดตัว Aspose](https://releases-aspose.com/cells/net/).
3. ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับ C# และแนวคิดการเขียนโปรแกรมเชิงวัตถุจะช่วยให้คุณเข้าใจตัวอย่างต่างๆ ได้ดีขึ้น
4. .NET Framework: บทช่วยสอนนี้ถือว่าคุณใช้ .NET Framework 4.5 ขึ้นไป

เมื่อคุณได้จัดการข้อกำหนดเบื้องต้นเรียบร้อยแล้ว ให้เราดำเนินการนำเข้าข้อมูลบางส่วนไปยังแผ่นงาน Excel พร้อมฟิลด์สูตรที่ระบุ

## แพ็คเกจนำเข้า

ก่อนที่คุณจะเริ่มเขียนโค้ด คุณจะต้องนำเข้าเนมสเปซ Aspose.Cells ที่จำเป็นก่อน โดยปกติจะทำที่ส่วนบนสุดของไฟล์ C#:

```csharp
using Aspose.Cells;
using System;
using System.Collections.Generic;
```

สิ่งนี้ทำให้คุณสามารถใช้คลาสและวิธีการต่างๆ ที่ไลบรารี Aspose.Cells จัดเตรียมไว้ได้ โดยไม่จำเป็นต้องนำหน้าด้วยเนมสเปซทุกครั้ง

มาแบ่งกระบวนการทั้งหมดออกเป็นขั้นตอนที่สามารถจัดการได้:

## ขั้นตอนที่ 1: กำหนดไดเรกทอรีผลลัพธ์

ขั้นแรก คุณต้องกำหนดตำแหน่งที่จะบันทึกไฟล์ Excel ของคุณ โดยทำได้ดังนี้:

```csharp
static string outputDir = "Your Document Directory"; // ระบุไดเร็กทอรีเอกสารของคุณที่นี่
```

แทนที่ `"Your Document Directory"` โดยใช้เส้นทางไฟล์จริงของคุณ นี่คือที่ที่ไฟล์ Excel ที่สร้างขึ้นจะถูกบันทึก

## ขั้นตอนที่ 2: สร้างคลาสที่ผู้ใช้กำหนดสำหรับรายการข้อมูล

ถัดไปเราจะกำหนดคลาสเพื่อสร้างโครงสร้างให้กับข้อมูลที่เราวางแผนจะนำเข้า

```csharp
class DataItems
{
    public int Number1 { get; set; }
    public int Number2 { get; set; }
    public string Formula1 { get; set; }
    public string Formula2 { get; set; }
}
```

นี้ `DataItems` คลาสจะเก็บจำนวนเต็มดิบและสูตรที่เราจะเขียนลงในแผ่นงาน Excel 

## ขั้นตอนที่ 3: สร้างรายการเพื่อเก็บข้อมูล

เราจะใช้รายการเพื่อเก็บอินสแตนซ์ต่างๆ ของเราหลายรายการ `DataItems` ระดับ.

```csharp
List<DataItems> dis = new List<DataItems>();
```

## ขั้นตอนที่ 4: เพิ่มรายการข้อมูลลงในรายการ

ตอนนี้เรามาเพิ่มรายการลงในรายการของเรากัน แต่ละรายการจะมีตัวเลขสองตัวและสูตรสองสูตร

```csharp
// กำหนดและเพิ่มรายการข้อมูลแต่ละรายการ
DataItems di = new DataItems();
di.Number1 = 2002;
di.Number2 = 3502;
di.Formula1 = "=SUM(A2,B2)";
di.Formula2 = "=HYPERLINK(\"https://www.aspose.com\",\"เว็บไซต์ Aspose\")";
dis.Add(di);

// ทำซ้ำสำหรับรายการข้อมูลเพิ่มเติม
```

อย่าลืมปรับแต่งแต่ละอย่าง `DataItems` อินสแตนซ์ที่มีค่าและสูตรที่ไม่ซ้ำกัน

## ขั้นตอนที่ 5: สร้างสมุดงานและเข้าถึงแผ่นงาน

ขั้นต่อไปคือสร้างเวิร์กบุ๊กและเข้าถึงเวิร์กชีตแรกที่เราจะนำเข้าข้อมูลในที่สุด

```csharp
Workbook wb = new Workbook(); // สร้างสมุดงานใหม่
Worksheet ws = wb.Worksheets[0]; // เข้าถึงแผ่นงานแรก
```

## ขั้นตอนที่ 6: ระบุตัวเลือกตารางการนำเข้า

นี่คือจุดที่เวทมนตร์เกิดขึ้น คุณต้องระบุว่าฟิลด์ใดในข้อมูลของคุณที่สอดคล้องกับสูตร 

```csharp
ImportTableOptions opts = new ImportTableOptions();
opts.IsFormulas = new bool[] { false, false, true, true };
```

ในตัวอย่างนี้สองฟิลด์สุดท้ายมีสูตรซึ่งระบุด้วย `true`ในขณะที่สองฟิลด์แรกถูกตั้งค่าเป็น `false`-

## ขั้นตอนที่ 7: นำเข้าวัตถุที่กำหนดเอง

ตอนนี้ทุกอย่างตั้งค่าเสร็จเรียบร้อยแล้ว ให้เรานำเข้ารายการข้อมูลของเราเข้าสู่เวิร์กชีตกัน

```csharp
ws.Cells.ImportCustomObjects(dis, 0, 0, opts);
```

บรรทัดนี้จะนำเข้าข้อมูลเริ่มต้นจากเซลล์ A1 ได้อย่างมีประสิทธิภาพ

## ขั้นตอนที่ 8: คำนวณสูตร

เนื่องจากเราได้นำเข้าสูตรบางสูตร การคำนวณสูตรจึงมีความสำคัญมาก

```csharp
wb.CalculateFormula();
```

วิธีนี้จะช่วยให้แน่ใจว่าสูตรของคุณจะได้รับการประเมินตามการอ้างอิง

## ขั้นตอนที่ 9: ปรับคอลัมน์ให้พอดีอัตโนมัติ

เพื่อให้แน่ใจว่าข้อมูลของคุณแสดงผลได้ คุณสามารถปรับคอลัมน์ให้พอดีโดยอัตโนมัติตามเนื้อหาได้

```csharp
ws.AutoFitColumns();
```

ขั้นตอนนี้จะเพิ่มประสิทธิภาพเค้าโครงไฟล์ Excel 

## ขั้นตอนที่ 10: บันทึกไฟล์ Excel ของคุณ

ในที่สุด ก็ถึงเวลาบันทึกไฟล์ Excel ที่คุณสร้างใหม่แล้ว 

```csharp
wb.Save(outputDir + "outputSpecifyFormulaFieldsWhileImportingDataToWorksheet.xlsx");
```

ตรวจสอบให้แน่ใจว่าชื่อไฟล์เอาต์พุตของคุณมีความเกี่ยวข้องและอธิบายได้!

## ขั้นตอนที่ 11: การตรวจสอบการดำเนินการ

วิธีง่ายๆ ในการยืนยันว่าทุกอย่างทำงานถูกต้องคือพิมพ์ข้อความ

```csharp
Console.WriteLine("SpecifyFormulaFieldsWhileImportingDataToWorksheet executed successfully.");
```

วิธีนี้จะทำให้คุณได้รับผลตอบรับทันทีว่าโค้ดทำงานได้โดยไม่มีปัญหาใดๆ

## บทสรุป

และแล้วคุณก็ทำได้! คุณได้นำเข้าข้อมูลลงในแผ่นงาน Excel สำเร็จแล้วโดยใช้ Aspose.Cells สำหรับ .NET และฟิลด์สูตรที่ระบุ เมื่อทำตามขั้นตอนเหล่านี้แล้ว คุณจะสามารถใช้เทคนิคที่คล้ายกันเพื่อทำงานประมวลผลข้อมูลแบบอัตโนมัติตามความต้องการของคุณได้ ไม่ว่าคุณจะกำลังคำนวณตัวเลขสำหรับรายงานหรือเพียงแค่ดูแลข้อมูล การเชี่ยวชาญศิลปะการจัดการ Excel ด้วย Aspose ถือเป็นทักษะที่คุ้มค่า

## คำถามที่พบบ่อย

### Aspose.Cells คืออะไร?
Aspose.Cells คือไลบรารี .NET ที่ได้รับการออกแบบมาสำหรับการสร้าง จัดการ และแปลงไฟล์ Excel ด้วยโปรแกรม

### ฉันจะติดตั้ง Aspose.Cells สำหรับ .NET ได้อย่างไร?
คุณสามารถดาวน์โหลดได้จาก [การเปิดตัว Aspose](https://releases.aspose.com/cells/net/) และอ้างอิงในโครงการของคุณ

### ฉันสามารถใช้ Aspose.Cells ได้ฟรีหรือไม่?
ใช่ Aspose เสนอการทดลองใช้ฟรีที่ [ลิงค์นี้](https://releases-aspose.com/).

### ฉันสามารถหาตัวอย่างเพิ่มเติมได้ที่ไหน
ตัวอย่างเพิ่มเติมและเอกสารประกอบสามารถพบได้ที่ [หน้าเอกสาร Aspose](https://reference-aspose.com/cells/net/).

### จะเกิดอะไรขึ้นหากฉันประสบปัญหาขณะใช้ Aspose?
คุณสามารถขอความช่วยเหลือจากฟอรัมสนับสนุน Aspose ได้ [ที่นี่](https://forum-aspose.com/c/cells/9).
 

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}