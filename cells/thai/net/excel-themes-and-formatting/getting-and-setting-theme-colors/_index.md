---
title: การรับและการตั้งค่าสีธีมใน Excel
linktitle: การรับและการตั้งค่าสีธีมใน Excel
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีรับและตั้งค่าสีธีมใน Excel โดยใช้ Aspose.Cells สำหรับ .NET ด้วยบทช่วยสอนที่ทำตามได้ง่ายนี้ มีคู่มือทีละขั้นตอนฉบับสมบูรณ์และตัวอย่างโค้ดรวมอยู่ด้วย
weight: 11
url: /th/net/excel-themes-and-formatting/getting-and-setting-theme-colors/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# การรับและการตั้งค่าสีธีมใน Excel

## การแนะนำ
การปรับแต่งรูปลักษณ์ของเวิร์กบุ๊ก Excel สามารถสร้างความแตกต่างอย่างมากเมื่อนำเสนอข้อมูล ด้านที่สำคัญประการหนึ่งของการปรับแต่งคือการควบคุมสีธีมในไฟล์ Excel ของคุณ หากคุณทำงานกับ .NET Aspose.Cells เป็น API ที่มีประสิทธิภาพอย่างเหลือเชื่อที่ช่วยให้คุณจัดการไฟล์ Excel ด้วยโปรแกรมได้อย่างง่ายดาย และในบทช่วยสอนนี้ เราจะเจาะลึกถึงการรับและตั้งค่าสีธีมใน Excel โดยใช้ Aspose.Cells สำหรับ .NET
ฟังดูซับซ้อนไหม? ไม่ต้องกังวล เรามีวิธีแก้ไขให้คุณ! เราจะอธิบายทีละขั้นตอนเพื่อให้คุณสามารถปรับสีได้อย่างง่ายดายเมื่ออ่านคู่มือนี้จบ เริ่มกันเลย!
## ข้อกำหนดเบื้องต้น
ก่อนที่จะเจาะลึกโค้ด มาดูสิ่งที่คุณต้องมีเพื่อให้ทุกอย่างทำงานได้อย่างราบรื่นกันก่อน:
1. Aspose.Cells สำหรับ .NET – ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้งเวอร์ชันล่าสุดแล้ว หากยังไม่มี คุณสามารถทำได้[ดาวน์โหลดได้ที่นี่](https://releases.aspose.com/cells/net/).
2. สภาพแวดล้อมการพัฒนา .NET – คุณสามารถใช้ Visual Studio หรือ IDE อื่นๆ ตามต้องการ
3. ความรู้พื้นฐานเกี่ยวกับ C# – จะช่วยให้คุณติดตามตัวอย่างการเขียนโค้ดได้
4. ไฟล์ Excel – ไฟล์ Excel ตัวอย่างที่คุณต้องการจัดการ
 คุณยังสามารถรับได้[ใบอนุญาตชั่วคราว](https://purchase.aspose.com/temporary-license/) เพื่อสำรวจฟังก์ชันทั้งหมดของ Aspose.Cells ได้ฟรีก่อนที่จะตัดสินใจ
## การนำเข้าเนมสเปซ
ในการเริ่มต้น ให้แน่ใจว่าคุณได้นำเข้าเนมสเปซที่จำเป็นลงในโปรเจ็กต์ของคุณแล้ว ซึ่งจะช่วยให้คุณสามารถเข้าถึงคลาสและเมธอดทั้งหมดที่จำเป็นในการจัดการสีธีมของ Excel ได้
```csharp
using System.IO;
using Aspose.Cells;
using System.Drawing;
using System;
```
ตอนนี้เรามาเจาะลึกกระบวนการจริงในการรับและตั้งค่าสีธีมในเวิร์กบุ๊ก Excel กัน ฉันจะแบ่งโค้ดออกเป็นขั้นตอนง่ายๆ เพื่อความเข้าใจที่ดีขึ้น
## ขั้นตอนที่ 1: โหลดไฟล์ Excel ของคุณ
ขั้นแรก คุณต้องโหลดไฟล์ Excel ที่จะแก้ไข เราจะใช้คลาส Workbook เพื่อเปิดไฟล์ Excel ที่มีอยู่
คุณกำลังเริ่มต้นวัตถุเวิร์กบุ๊กใหม่และโหลดไฟล์ Excel ของคุณลงในนั้น วิธีนี้จะช่วยให้คุณทำการเปลี่ยนแปลงในเวิร์กบุ๊กได้
```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "Your Document Directory";
// สร้างอินสแตนซ์ของวัตถุเวิร์กบุ๊กเพื่อเปิดไฟล์ Excel ที่มีอยู่
Workbook workbook = new Workbook(dataDir + "book1.xlsx");
```
นี่คือจุดเริ่มต้นของเวทมนตร์ ตอนนี้เราได้เปิดไฟล์แล้ว และพร้อมที่จะเริ่มปรับแต่งสีธีมแล้ว
## ขั้นตอนที่ 2: รับสีธีมปัจจุบัน
ก่อนที่จะเปลี่ยนสีใดๆ เรามาตรวจสอบสีธีมปัจจุบันกันก่อน สำหรับตัวอย่างนี้ เราจะเน้นที่ Background1 และ Accent2
คุณกำลังใช้เมธอด GetThemeColor ในการดึงสีธีมปัจจุบันสำหรับทั้ง Background1 และ Accent2
```csharp
// รับธีมสี Background1
Color c = workbook.GetThemeColor(ThemeColorType.Background1);
// พิมพ์สี
Console.WriteLine("Theme color Background1: " + c);
// รับสีธีม Accent2
c = workbook.GetThemeColor(ThemeColorType.Accent2);
// พิมพ์สี
Console.WriteLine("Theme color Accent2: " + c);
```
เมื่อคุณรันโปรแกรมดังกล่าว โปรแกรมจะพิมพ์สีปัจจุบันที่ใช้ในธีม ซึ่งมีประโยชน์หากคุณต้องการทราบการตั้งค่าเริ่มต้นก่อนทำการเปลี่ยนแปลง
## ขั้นตอนที่ 3: ตั้งค่าสีธีมใหม่
ตอนนี้มาถึงส่วนสนุก ๆ แล้ว เราจะเปลี่ยนสีของ Background1 และ Accent2 มาเปลี่ยนสี Background1 เป็นสีแดงและ Accent2 เป็นสีน้ำเงิน วิธีนี้จะทำให้สมุดงานมีรูปลักษณ์ใหม่ที่โดดเด่น!
คุณกำลังใช้เมธอด SetThemeColor เพื่อปรับเปลี่ยนสีธีมสำหรับ Background1 และ Accent2
```csharp
// เปลี่ยนสีธีม Background1 ให้เป็นสีแดง
workbook.SetThemeColor(ThemeColorType.Background1, Color.Red);
// เปลี่ยนสีธีม Accent2 ให้เป็นสีน้ำเงิน
workbook.SetThemeColor(ThemeColorType.Accent2, Color.Blue);
```
ดูสิว่าเราทำอะไรลงไป เราแค่ใส่สีที่ต้องการลงไป แล้วปัง! ตอนนี้สีของธีมก็เปลี่ยนไปแล้ว แต่เดี๋ยวก่อน เราจะรู้ได้อย่างไรว่ามันได้ผลหรือไม่ ต่อไปเราจะมาดูกัน
## ขั้นตอนที่ 4: ตรวจสอบการเปลี่ยนแปลง
เราไม่ต้องการสันนิษฐานว่ามีการเปลี่ยนแปลงเกิดขึ้นเท่านั้น ให้เราตรวจสอบสีใหม่โดยรับสีใหม่มาอีกครั้งแล้วพิมพ์ออกมา
คุณกำลังดึงสีธีมที่อัปเดตโดยใช้เมธอด GetThemeColor อีกครั้งเพื่อยืนยันว่าการเปลี่ยนแปลงถูกนำไปใช้
```csharp
// รับธีมสี Background1 ที่อัปเดต
c = workbook.GetThemeColor(ThemeColorType.Background1);
// พิมพ์สีที่อัปเดตเพื่อยืนยัน
Console.WriteLine("Theme color Background1 changed to: " + c);
// รับสีธีม Accent2 ที่อัปเดต
c = workbook.GetThemeColor(ThemeColorType.Accent2);
// พิมพ์สีที่อัปเดตเพื่อยืนยัน
Console.WriteLine("Theme color Accent2 changed to: " + c);
```
วิธีนี้ช่วยให้คุณมั่นใจได้ว่าการปรับเปลี่ยนของคุณทำงานได้ตามที่คาดหวัง เมื่อคุณตรวจสอบแล้วว่าทุกอย่างเรียบร้อยดีแล้ว เราจะดำเนินการตามขั้นตอนสุดท้ายได้
## ขั้นตอนที่ 5: บันทึกไฟล์ Excel ที่ปรับเปลี่ยนแล้ว
หลังจากทำการเปลี่ยนแปลงที่น่าตื่นเต้นเหล่านี้แล้ว อย่าลืมบันทึกงานของคุณ! ขั้นตอนนี้จะช่วยให้มั่นใจว่าสีธีมที่อัปเดตจะนำไปใช้กับไฟล์ Excel ของคุณ
คุณกำลังใช้เมธอดบันทึกเพื่อบันทึกเวิร์กบุ๊กที่มีการเปลี่ยนแปลงที่คุณทำ
```csharp
// บันทึกไฟล์ที่อัปเดต
workbook.Save(dataDir + "output.out.xlsx");
```
และแล้วเสร็จ! คุณเพิ่งปรับเปลี่ยนสีธีมของไฟล์ Excel โดยใช้ Aspose.Cells สำหรับ .NET ได้สำเร็จแล้ว ขอแสดงความยินดีด้วย!
## บทสรุป
การเปลี่ยนสีของธีมในไฟล์ Excel โดยใช้ Aspose.Cells สำหรับ .NET เป็นเรื่องง่ายเมื่อคุณคุ้นเคยกับมันแล้ว ด้วยโค้ดเพียงไม่กี่บรรทัด คุณสามารถเปลี่ยนรูปลักษณ์และความรู้สึกของสมุดงานของคุณได้อย่างสมบูรณ์ ทำให้ดูเป็นมืออาชีพและปรับแต่งได้เอง ไม่ว่าคุณต้องการให้ตรงกับแบรนด์ของบริษัทหรือเพียงแค่ต้องการให้สเปรดชีตของคุณโดดเด่น Aspose.Cells มีเครื่องมือที่ช่วยให้คุณทำได้
## คำถามที่พบบ่อย
### ฉันสามารถตั้งค่าสีที่กำหนดเองนอกเหนือจากสีธีมที่กำหนดไว้ล่วงหน้าได้หรือไม่
ใช่ ด้วย Aspose.Cells คุณสามารถตั้งค่าสีที่กำหนดเองสำหรับส่วนใดๆ ในเวิร์กบุ๊ก Excel ของคุณได้ ไม่ใช่เฉพาะสีธีมที่กำหนดไว้ล่วงหน้าเท่านั้น
### ฉันต้องมีใบอนุญาตแบบชำระเงินเพื่อใช้ Aspose.Cells หรือไม่
 คุณสามารถเริ่มต้นด้วย[ทดลองใช้งานฟรี](https://releases.aspose.com/)หรือรับ[ใบอนุญาตชั่วคราว](https://purchase.aspose.com/temporary-license/)หากต้องการปลดล็อคฟังก์ชันการทำงานเต็มรูปแบบ ขอแนะนำให้ซื้อใบอนุญาตแบบชำระเงิน
### ฉันสามารถใช้สีธีมต่าง ๆ กับแผ่นงานแต่ละแผ่นได้หรือไม่
ใช่ คุณสามารถจัดการสีธีมของแผ่นงานแต่ละแผ่นภายในเวิร์กบุ๊กได้ โดยการโหลดแยกกันและใช้สีที่คุณต้องการ
### สามารถกลับไปใช้สีธีมเดิมได้ไหม?
ใช่ หากคุณต้องการกลับไปใช้สีธีมเริ่มต้น คุณสามารถดึงข้อมูลและรีเซ็ตได้โดยใช้เมธอด GetThemeColor และ SetThemeColor เหมือนเดิม
### ฉันสามารถทำให้กระบวนการนี้เป็นแบบอัตโนมัติสำหรับสมุดงานหลาย ๆ เล่มได้ไหม
แน่นอน! Aspose.Cells ช่วยให้คุณสามารถนำการเปลี่ยนแปลงธีมไปใช้กับสมุดงานหลาย ๆ เวิร์กบุ๊กในกระบวนการแบตช์ได้
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
