---
title: การแปลง JSON เป็น CSV ด้วยโปรแกรมใน .NET
linktitle: การแปลง JSON เป็น CSV ด้วยโปรแกรมใน .NET
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีการแปลง JSON เป็น CSV ด้วยโปรแกรมใน .NET โดยใช้ Aspose.Cells ปฏิบัติตามคำแนะนำทีละขั้นตอนของเราเพื่อให้แน่ใจว่าการแปลงข้อมูลจะราบรื่น
weight: 15
url: /th/net/converting-excel-files-to-other-formats/converting-json-to-csv/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# การแปลง JSON เป็น CSV ด้วยโปรแกรมใน .NET

## การแนะนำ
ในโลกดิจิทัลทุกวันนี้ การจัดการข้อมูลในรูปแบบต่างๆ กลายเป็นเรื่องธรรมดา และ JSON (JavaScript Object Notation) เป็นรูปแบบหนึ่งที่ใช้กันอย่างแพร่หลายที่สุดในการแลกเปลี่ยนข้อมูล แต่จะเกิดอะไรขึ้นเมื่อคุณต้องแปลง JSON ให้เป็นรูปแบบที่เข้าถึงได้ง่ายกว่าสำหรับการวิเคราะห์ เช่น CSV (Comma Separated Values) บทช่วยสอนนี้จะแนะนำคุณเกี่ยวกับขั้นตอนการแปลง JSON เป็น CSV โดยใช้โปรแกรม Aspose.Cells สำหรับ .NET ซึ่งเป็น API สำหรับการจัดการสเปรดชีตที่ใช้งานง่ายแต่ทรงพลัง 
## ข้อกำหนดเบื้องต้น
ก่อนที่เราจะเจาะลึกโค้ด สิ่งสำคัญคือต้องแน่ใจว่าคุณมีส่วนประกอบที่จำเป็นทั้งหมดและมีความเข้าใจพื้นฐานเกี่ยวกับเครื่องมือที่เราจะใช้ เรามาสรุปสิ่งที่คุณต้องการกัน:
-  Aspose.Cells สำหรับ .NET: นี่คือไลบรารีหลักที่เราจะใช้ในการแปลง JSON เป็น CSV คุณสามารถ[ดาวน์โหลดได้ที่นี่](https://releases.aspose.com/cells/net/).
- Visual Studio: คุณจะต้องมีสภาพแวดล้อมการพัฒนาแบบบูรณาการ (IDE) เช่น Visual Studio เพื่อเขียนและดำเนินการโค้ด .NET
- .NET Framework: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง .NET Framework แล้ว Aspose.Cells เข้ากันได้กับทั้ง .NET Core และ .NET Framework
- ความรู้พื้นฐานเกี่ยวกับ C#: แม้ว่าคู่มือนี้จะแบ่งโค้ดออกเป็นทุกส่วน แต่จะเป็นประโยชน์หากคุณคุ้นเคยกับ C# บ้าง
## แพ็คเกจนำเข้า
หากต้องการใช้ Aspose.Cells ในโปรเจ็กต์ .NET ก่อนอื่นคุณต้องติดตั้งไลบรารี ซึ่งทำได้โดยใช้ตัวจัดการแพ็กเกจ NuGet:
1. เปิด Visual Studio
2. ไปที่เครื่องมือ > ตัวจัดการแพ็กเกจ NuGet > จัดการแพ็กเกจ NuGet สำหรับโซลูชัน
3. ค้นหา Aspose.Cells และติดตั้งเวอร์ชันล่าสุด
เมื่อติดตั้งแล้ว โปรดแน่ใจว่าคุณรวมเนมสเปซต่อไปนี้ไว้ในโค้ดของคุณ:
```csharp
using Aspose.Cells.Utility;
using System;
using System.IO;
```
ตอนนี้ทุกอย่างตั้งค่าเสร็จเรียบร้อยแล้ว เรามาแบ่งโค้ดทีละขั้นตอนเพื่อให้คุณเห็นว่าการแปลงไฟล์ JSON เป็น CSV โดยใช้ Aspose.Cells ง่ายแค่ไหน
## ขั้นตอนที่ 1: อ่านไฟล์ JSON
 สิ่งแรกที่เราต้องทำคืออ่านข้อมูล JSON จากไฟล์ เราจะถือว่าคุณมีไฟล์ JSON อยู่แล้ว (เรียกว่า`SampleJson.json`) ที่เก็บไว้ในไดเร็กทอรีในระบบของคุณ
คุณสามารถใช้`File.ReadAllText()` วิธีการใน C# เพื่ออ่านเนื้อหาของไฟล์ JSON ลงในสตริง
```csharp
// ไดเรกทอรีแหล่งที่มา
string sourceDir = "Your Document Directory";
// อ่านไฟล์ JSON
string str = File.ReadAllText(sourceDir + "SampleJson.json");
```

ขั้นตอนนี้มีความสำคัญเนื่องจากคุณต้องใช้ข้อมูล JSON ดิบเพื่อเริ่มกระบวนการแปลง เมื่ออ่านข้อมูลเป็นสตริง แสดงว่าคุณกำลังเตรียมข้อมูลให้ Aspose.Cells ประมวลผล
## ขั้นตอนที่ 2: สร้างสมุดงานว่างเปล่า
Aspose.Cells ใช้งานบนเวิร์กบุ๊ก (ไฟล์ Excel) เป็นหลัก หากต้องการเริ่มนำเข้าข้อมูล JSON ก่อนอื่นคุณต้องสร้างเวิร์กบุ๊กว่างที่จะแทรกข้อมูลนี้ลงไป
```csharp
// สร้างสมุดงานเปล่า
Workbook workbook = new Workbook();
```
ในขั้นตอนนี้ คุณกำลังเริ่มต้นเวิร์กบุ๊กว่างเปล่าที่จะเก็บข้อมูลในรูปแบบ CSV เอาไว้ ลองนึกภาพว่าคุณกำลังสร้างสเปรดชีตว่างเปล่าใน Excel ที่จะถูกเติมด้วยข้อมูล JSON ของคุณในไม่ช้า
## ขั้นตอนที่ 3: เข้าถึงเซลล์ในเวิร์กบุ๊ก
 ตอนนี้เรามีเวิร์กบุ๊กว่างแล้ว เราจำเป็นต้องเข้าถึงเซลล์ของมัน`Cells` คอลเลกชันใน Aspose.Cells แสดงถึงเซลล์ทั้งหมดในเวิร์กชีต ซึ่งคุณจะวางข้อมูล JSON ของคุณไว้
```csharp
// รับเซลล์
Cells cells = workbook.Worksheets[0].Cells;
```
ตัวอย่างโค้ดนี้จะเลือกเวิร์กชีตแรก (เวิร์กชีตที่ดัชนี 0) และรับ`Cells` คอลเลกชัน เซลล์เหล่านี้เปรียบเสมือนตารางของสเปรดชีตที่ข้อมูลจะถูกเพิ่มเข้าไป
## ขั้นตอนที่ 4: ตั้งค่า JsonLayoutOptions
 Aspose.Cells มีตัวเลือกการปรับแต่งต่างๆ สำหรับวิธีนำเข้าข้อมูล JSON ของคุณ ที่นี่ เราจะกำหนด`JsonLayoutOptions` เพื่อระบุว่า Aspose ควรจัดการอาร์เรย์ ข้อมูลตัวเลข และชื่อของวัตถุอย่างไร
```csharp
// ตั้งค่า JsonLayoutOptions
JsonLayoutOptions importOptions = new JsonLayoutOptions();
importOptions.ConvertNumericOrDate = true;
importOptions.ArrayAsTable = true;
importOptions.IgnoreArrayTitle = true;
importOptions.IgnoreObjectTitle = true;
```

- ConvertNumericOrDate: แปลงค่าสตริงที่เป็นตัวเลขหรือค่าวันที่โดยอัตโนมัติ
- ArrayAsTable: ปฏิบัติต่ออาร์เรย์ใน JSON เป็นตารางในเวิร์กบุ๊ก
- IgnoreArrayTitle และ IgnoreObjectTitle: ตัวเลือกเหล่านี้จะไม่สนใจชื่อเรื่องของอาร์เรย์และอ็อบเจ็กต์ เพื่อให้แน่ใจว่าจะนำเข้าเฉพาะข้อมูลดิบเท่านั้น
## ขั้นตอนที่ 5: นำเข้าข้อมูล JSON
 เมื่อตั้งค่าตัวเลือกเค้าโครงแล้ว ก็ถึงเวลาที่จะนำข้อมูล JSON เข้ามา`JsonUtility.ImportData()` วิธีการนี้ทำงานหนักที่นี่ โดยแทรกข้อมูล JSON ลงในเซลล์ของเวิร์กบุ๊ก
```csharp
JsonUtility.ImportData(str, cells, 0, 0, importOptions);
```
วิธีการนี้ใช้พารามิเตอร์หลายตัว:
- `str`:สตริง JSON ที่เราอ่านในขั้นตอนที่ 1
- `cells`:กลุ่มเซลล์ที่จะเก็บข้อมูลไว้
- `0, 0`:นี่คือดัชนีแถวและคอลัมน์ที่ระบุว่าข้อมูลควรเริ่มต้นที่ใด (เช่น มุมบนซ้าย)
- `importOptions`:ตัวเลือกเค้าโครงที่เราตั้งค่าไว้ในขั้นตอนที่ 4
## ขั้นตอนที่ 6: บันทึกสมุดงานเป็น CSV
เมื่อข้อมูล JSON อยู่ในเวิร์กบุ๊กแล้ว เราสามารถบันทึกเวิร์กบุ๊กเป็นไฟล์ CSV ได้อย่างง่ายดาย CSV เป็นรูปแบบที่เรียบง่ายและน้ำหนักเบาสำหรับการจัดเก็บข้อมูลแบบตาราง ซึ่งทำให้เหมาะสำหรับการวิเคราะห์ข้อมูล
```csharp
// ไดเรกทอรีผลลัพธ์
string outputDir = "Your Document Directory";
// บันทึกสมุดงาน
workbook.Save(outputDir + @"SampleJson_out.csv");
```
ในขั้นตอนนี้ เราจะบันทึกเวิร์กบุ๊กเป็นไฟล์ CSV โดยระบุเส้นทางและชื่อไฟล์ (`SampleJson_out.csv`) โดยที่ CSV จะถูกบันทึก
## ขั้นตอนที่ 7: ยืนยันกระบวนการ
เพื่อให้แน่ใจว่าทุกอย่างทำงานตามที่คาดหวัง เราสามารถพิมพ์ข้อความยืนยันในคอนโซลได้
```csharp
Console.WriteLine("ConvertJsonToCsv executed successfully.");
```
ข้อความแจ้งความสำเร็จที่เรียบง่ายจะช่วยยืนยันว่ากระบวนการดำเนินไปอย่างราบรื่น
## บทสรุป
การแปลง JSON เป็น CSV โดยใช้ Aspose.Cells สำหรับ .NET เป็นกระบวนการที่ตรงไปตรงมาแต่ทรงพลัง ด้วยโค้ดเพียงไม่กี่บรรทัด คุณสามารถแปลงข้อมูล JSON ที่ซับซ้อนให้เป็นรูปแบบ CSV ที่เข้าถึงได้ง่ายขึ้น ไม่ว่าคุณจะจัดการกับอาร์เรย์ อ็อบเจ็กต์ หรือข้อมูลตัวเลข Aspose.Cells จะทำให้การกำหนดค่ากระบวนการแปลงให้เหมาะกับความต้องการของคุณเป็นเรื่องง่าย
## คำถามที่พบบ่อย
### Aspose.Cells สามารถจัดการไฟล์ JSON ขนาดใหญ่ได้หรือไม่
ใช่ Aspose.Cells ได้รับการออกแบบมาเพื่อจัดการกับชุดข้อมูลขนาดใหญ่ได้อย่างมีประสิทธิภาพ ทำให้เหมาะสำหรับการประมวลผลไฟล์ JSON ขนาดใหญ่โดยไม่มีปัญหาด้านประสิทธิภาพการทำงาน
### ฉันจะปรับแต่งเอาต์พุต CSV ได้อย่างไร?
 คุณสามารถปรับแต่งผลลัพธ์ CSV ได้โดยการปรับ`JsonLayoutOptions` หรือการจัดการการจัดรูปแบบของเวิร์กบุ๊กก่อนที่จะบันทึกเป็น CSV
### มีวิธีที่จะไม่รวมข้อมูลบางส่วนจาก JSON ในระหว่างการแปลงหรือไม่
ใช่ โดยการปรับแต่ง JSON หรือใช้ตรรกะของโค้ดที่กำหนดเองก่อนนำเข้า คุณสามารถยกเว้นหรือกรองฟิลด์ข้อมูลที่เจาะจงออกได้
### Aspose.Cells รองรับรูปแบบไฟล์อื่นนอกเหนือจาก CSV หรือไม่
แน่นอน! Aspose.Cells รองรับรูปแบบต่างๆ มากมาย รวมถึง Excel (XLS, XLSX), PDF, HTML และอื่นๆ อีกมากมาย
### ฉันจะทดลองใช้ Aspose.Cells ฟรีได้อย่างไร?
 คุณสามารถทำได้[ดาวน์โหลดรุ่นทดลองใช้ฟรีได้ที่นี่](https://releases.aspose.com/) เพื่อทดสอบคุณสมบัติทั้งหมดก่อนการซื้อ
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
