---
"description": "เรียนรู้วิธีการควบคุมทรัพยากรภายนอกใน Excel โดยใช้ Aspose.Cells สำหรับ .NET ด้วยบทช่วยสอนทีละขั้นตอนที่ครอบคลุมของเรา"
"linktitle": "ควบคุมทรัพยากรภายนอกโดยใช้การตั้งค่าเวิร์กบุ๊ก"
"second_title": "API การประมวลผล Excel ของ Aspose.Cells .NET"
"title": "ควบคุมทรัพยากรภายนอกโดยใช้การตั้งค่าเวิร์กบุ๊ก"
"url": "/th/net/workbook-settings/control-external-resources/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# ควบคุมทรัพยากรภายนอกโดยใช้การตั้งค่าเวิร์กบุ๊ก

## การแนะนำ
การจัดการทรัพยากรภายนอกอย่างมีประสิทธิภาพถือเป็นเครื่องมือสำคัญในการจัดการและนำเสนอข้อมูล หากคุณทำงานกับไฟล์ Excel และต้องการจัดการทรัพยากรภายนอกอย่างราบรื่นโดยใช้ Aspose.Cells สำหรับ .NET คุณมาถูกที่แล้ว! ในบทความนี้ เราจะเจาะลึกการควบคุมทรัพยากรภายนอกเมื่อทำงานกับเวิร์กบุ๊ก Excel เมื่ออ่านคู่มือนี้จบ คุณจะสามารถนำโซลูชันที่ปรับแต่งเองสำหรับการโหลดรูปภาพและข้อมูลจากแหล่งภายนอกมาใช้ได้อย่างง่ายดาย
## ข้อกำหนดเบื้องต้น
ก่อนที่เราจะเริ่มต้นเขียนโค้ด มีข้อกำหนดเบื้องต้นบางประการที่คุณต้องมี ตรวจสอบให้แน่ใจว่าคุณ:
1. มี Visual Studio: คุณจะต้องมี IDE เพื่อเขียนและทดสอบแอปพลิเคชัน .NET ของคุณ Visual Studio เป็นตัวเลือกที่แนะนำมากที่สุดเนื่องจากรองรับอย่างกว้างขวางและใช้งานง่าย
2. ดาวน์โหลด Aspose.Cells สำหรับ .NET: หากคุณยังไม่ได้ดาวน์โหลดไลบรารี Aspose.Cells จาก [ลิงค์ดาวน์โหลด](https://releases-aspose.com/cells/net/). 
3. ความเข้าใจพื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับแนวคิดของ C# และ .NET framework จะทำให้กระบวนการราบรื่นยิ่งขึ้นสำหรับคุณ
4. ตั้งค่าสภาพแวดล้อมของคุณ: ตรวจสอบให้แน่ใจว่าโครงการของคุณอ้างอิงไลบรารี Aspose.Cells คุณสามารถทำได้ผ่านตัวจัดการแพ็กเกจ NuGet ใน Visual Studio
5. ไฟล์ตัวอย่าง: เตรียมไฟล์ Excel ตัวอย่างที่รวมทรัพยากรภายนอก เช่น รูปภาพที่เชื่อมโยง ไฟล์นี้จะช่วยสาธิตฟังก์ชันการทำงานที่เราพูดถึง
เมื่อคุณตั้งค่าสิ่งเหล่านี้เรียบร้อยแล้ว คุณก็พร้อมที่จะควบคุมทรัพยากรภายนอกด้วย Aspose.Cells ได้
## แพ็คเกจนำเข้า
ในการเริ่มต้นเขียนโค้ด คุณจะต้องนำเข้าแพ็คเกจที่จำเป็นลงในไฟล์ C# ของคุณ นี่คือสิ่งที่คุณต้องการ:
```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using Aspose.Cells.Rendering;
using System.Drawing.Imaging;
```
เนมสเปซเหล่านี้ให้สิทธิ์ในการเข้าถึงฟังก์ชันการทำงานที่จำเป็นสำหรับการจัดการไฟล์ Excel และจัดการรูปภาพ
มาแบ่งมันออกเป็นขั้นตอนที่จัดการได้เพื่อช่วยคุณควบคุมทรัพยากรภายนอกโดยใช้ `Workbook Settings`เราจะแนะนำวิธีสร้างผู้ให้บริการสตรีมแบบกำหนดเอง การโหลดไฟล์ Excel และการเรนเดอร์เวิร์กชีตเป็นรูปภาพ โปรดติดตามตอนต่อไป!
## ขั้นตอนที่ 1: กำหนดไดเรกทอรีแหล่งที่มาและเอาต์พุต
ในการเริ่มต้น เราต้องระบุไดเรกทอรีที่เราจะอ่านไฟล์และที่ที่เราจะบันทึกเอาต์พุต สิ่งสำคัญคือต้องตั้งค่าเส้นทางที่ถูกต้องเพื่อหลีกเลี่ยงข้อผิดพลาดไม่พบไฟล์
```csharp
// ไดเรกทอรีแหล่งที่มา
static string sourceDir = "Your Document Directory";
// ไดเรกทอรีผลลัพธ์
static string outputDir = "Your Document Directory";
```
แทนที่ `"Your Document Directory"` ด้วยเส้นทางจริงที่ไฟล์ของคุณตั้งอยู่
## ขั้นตอนที่ 2: นำอินเทอร์เฟซ IStreamProvider มาใช้
ถัดไปเราจะสร้างคลาสแบบกำหนดเองที่ใช้งาน `IStreamProvider` อินเทอร์เฟซ คลาสนี้จะจัดการวิธีการเข้าถึงทรัพยากรภายนอก (เช่น รูปภาพ)
```csharp
class SP : IStreamProvider
{
    public void CloseStream(StreamProviderOptions options)
    {
        // ทำความสะอาดทรัพยากรใด ๆ หากจำเป็น
    }
    public void InitStream(StreamProviderOptions options)
    {
        // เปิดไฟล์สตรีมของทรัพยากรภายนอก
        FileStream fi = new FileStream(sourceDir + "sampleControlExternalResourcesUsingWorkbookSetting_StreamProvider.png", FileMode.OpenOrCreate, FileAccess.Read);
        options.Stream = fi;
    }
}
```
ใน `InitStream` วิธีการนี้เราเปิดไฟล์ที่ทำหน้าที่เป็นทรัพยากรภายนอกของเราและกำหนดให้กับ `Stream` คุณสมบัตินี้ช่วยให้เวิร์กบุ๊กสามารถเข้าถึงทรัพยากรได้เมื่อทำการเรนเดอร์
## ขั้นตอนที่ 3: โหลดไฟล์ Excel
ตอนนี้เรามีผู้ให้บริการสตรีมพร้อมแล้ว มาโหลดเวิร์กบุ๊ก Excel ที่มีทรัพยากรภายนอกกัน
```csharp
public static void Run()
{
    // โหลดไฟล์ตัวอย่าง Excel
    Workbook wb = new Workbook(sourceDir + "sampleControlExternalResourcesUsingWorkbookSetting_StreamProvider.xlsx");
    
    // จัดเตรียมการใช้งาน IStreamProvider ของคุณ
    wb.Settings.StreamProvider = new SP();
```
ในสไนปเป็ตนี้ เราโหลดไฟล์ Excel และกำหนดค่าที่กำหนดเองของเรา `StreamProvider` การนำไปปฏิบัติเพื่อจัดการทรัพยากรภายนอก
## ขั้นตอนที่ 4: เข้าถึงแผ่นงาน
หลังจากโหลดเวิร์กบุ๊กเสร็จแล้ว เราก็สามารถเข้าถึงเวิร์กชีตที่ต้องการได้อย่างง่ายดาย มาเริ่มที่เวิร์กชีตแรกกันเลย
```csharp
    // เข้าถึงแผ่นงานแรก
    Worksheet ws = wb.Worksheets[0];
```
ตรงไปตรงมาใช่ไหม? คุณสามารถเข้าถึงเวิร์กชีตใดๆ ได้โดยการระบุดัชนี
## ขั้นตอนที่ 5: กำหนดค่าตัวเลือกภาพหรือการพิมพ์
ตอนนี้เราจะกำหนดว่าเราต้องการให้รูปภาพเอาต์พุตมีลักษณะอย่างไร เราจะกำหนดค่าตัวเลือกต่างๆ เช่น ให้แน่ใจว่ามีหน้าเดียวสำหรับแต่ละชีต และระบุประเภทของรูปภาพเอาต์พุต
```csharp
    // ระบุตัวเลือกภาพหรือการพิมพ์
    ImageOrPrintOptions opts = new ImageOrPrintOptions();
    opts.OnePagePerSheet = true;
    opts.ImageType = Drawing.ImageType.Png;
```
การเลือกใช้ PNG เป็นรูปแบบผลลัพธ์จะช่วยให้มั่นใจได้ว่าคุณภาพจะยังคงคมชัด!
## ขั้นตอนที่ 6: เรนเดอร์แผ่นงานเป็นรูปภาพ
เมื่อตั้งค่าทุกอย่างเรียบร้อยแล้ว เรามาเรนเดอร์แผ่นงานที่เราเลือกเป็นไฟล์รูปภาพกันเลย! นี่คือส่วนที่น่าตื่นเต้น เพราะคุณจะเห็นแผ่นงาน Excel ของคุณถูกแปลงเป็นรูปภาพที่สวยงาม
```csharp
    // สร้างการเรนเดอร์แผ่นงานโดยส่งพารามิเตอร์ที่จำเป็น
    SheetRender sr = new SheetRender(ws, opts);
    // แปลงแผ่นงานทั้งหมดของคุณเป็นรูปภาพ png
    sr.ToImage(0, outputDir + "outputControlExternalResourcesUsingWorkbookSetting_StreamProvider.png");
    
    Console.WriteLine("ControlExternalResourcesUsingWorkbookSetting_StreamProvider executed successfully.");
}
```
การ `ToImage` ฟังก์ชันนี้จะทำหน้าที่ทั้งหมดโดยแปลงแผ่นงานเป็นรูปภาพ เมื่อขั้นตอนนี้เสร็จสิ้น คุณจะพบรูปภาพที่บันทึกไว้ในไดเร็กทอรีเอาต์พุตของคุณ
## บทสรุป
และแล้วคุณก็จะมีมัน! ตอนนี้คุณมีความรู้ในการควบคุมทรัพยากรภายนอกเมื่อทำงานกับไฟล์ Excel โดยใช้ Aspose.Cells ใน .NET ซึ่งไม่เพียงแต่จะช่วยเพิ่มความสามารถของแอปพลิเคชันของคุณเท่านั้น แต่ยังทำให้การจัดการชุดข้อมูลและการนำเสนอเป็นเรื่องง่ายอีกด้วย ด้วยการทำตามขั้นตอนที่ให้ไว้ คุณสามารถจำลองและปรับฟังก์ชันนี้ให้เหมาะกับความต้องการเฉพาะของโครงการของคุณได้อย่างง่ายดาย
## คำถามที่พบบ่อย
### Aspose.Cells คืออะไร?
Aspose.Cells เป็นไลบรารีอันทรงพลังที่ออกแบบมาสำหรับนักพัฒนา C# และ .NET เพื่อสร้าง จัดการ และจัดการไฟล์ Excel โดยไม่ต้องติดตั้ง Microsoft Excel
### ฉันจะดาวน์โหลด Aspose.Cells สำหรับ .NET ได้อย่างไร?
คุณสามารถดาวน์โหลดได้จาก [เว็บไซต์อาโพส](https://releases-aspose.com/cells/net/).
### มีการทดลองใช้ฟรีหรือไม่?
ใช่! คุณสามารถเข้าถึงรุ่นทดลองใช้งานฟรีของ Aspose.Cells ได้จาก [หน้าวางจำหน่าย](https://releases-aspose.com/).
### Aspose.Cells รองรับไฟล์ประเภทใดบ้าง
Aspose.Cells รองรับรูปแบบ Excel ต่างๆ รวมถึง XLS, XLSX, CSV และอื่นๆ
### ฉันสามารถค้นหาการสนับสนุนสำหรับ Aspose.Cells ได้ที่ไหน
คุณสามารถเยี่ยมชมฟอรั่มสนับสนุน Aspose ได้ที่ [ฟอรั่ม Aspose](https://forum.aspose.com/c/cells/9) เพื่อขอความช่วยเหลือ


{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}