---
title: เพิ่มความคิดเห็นพร้อมรูปภาพใน Excel
linktitle: เพิ่มความคิดเห็นพร้อมรูปภาพใน Excel
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีการเพิ่มคำอธิบายประกอบพร้อมรูปภาพใน Excel โดยใช้ Aspose.Cells สำหรับ .NET ปรับปรุงสเปรดชีตของคุณด้วยคำอธิบายประกอบแบบส่วนตัว
weight: 10
url: /th/net/excel-comment-annotation/add-comment-with-image-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# เพิ่มความคิดเห็นพร้อมรูปภาพใน Excel

## การแนะนำ
Excel เป็นเครื่องมือที่มีประสิทธิภาพสำหรับการจัดการและวิเคราะห์ข้อมูล แต่บางครั้งคุณจำเป็นต้องเพิ่มความเป็นส่วนตัวให้กับสเปรดชีตของคุณใช่หรือไม่ บางทีคุณอาจต้องการใส่คำอธิบายประกอบข้อมูล ให้ข้อเสนอแนะ หรือแม้แต่เพิ่มความสวยงามด้วยรูปภาพ นั่นคือจุดที่ความคิดเห็นมีประโยชน์! ในบทช่วยสอนนี้ เราจะมาสำรวจวิธีการเพิ่มความคิดเห็นพร้อมรูปภาพใน Excel โดยใช้ไลบรารี Aspose.Cells สำหรับ .NET แนวทางนี้อาจมีประโยชน์อย่างยิ่งสำหรับการสร้างสเปรดชีตที่โต้ตอบได้และดึงดูดสายตามากขึ้น
## ข้อกำหนดเบื้องต้น
ก่อนที่เราจะเจาะลึกรายละเอียดเกี่ยวกับการเพิ่มคำอธิบายพร้อมรูปภาพใน Excel เรามาตรวจสอบก่อนว่าคุณได้เตรียมทุกสิ่งที่จำเป็นสำหรับการเริ่มต้นแล้ว:
1. Visual Studio: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Visual Studio บนคอมพิวเตอร์ของคุณแล้ว นี่คือที่ที่คุณจะเขียนและรันโค้ดของคุณ
2.  Aspose.Cells สำหรับ .NET: คุณต้องมีไลบรารี Aspose.Cells หากคุณยังไม่ได้ติดตั้ง คุณสามารถดาวน์โหลดได้จาก[ที่นี่](https://releases.aspose.com/cells/net/).
3. ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับการเขียนโปรแกรม C# จะช่วยให้คุณเข้าใจชิ้นส่วนโค้ดได้ดีขึ้น
4. ไฟล์รูปภาพ: เตรียมไฟล์รูปภาพ (เช่น โลโก้) ที่คุณต้องการฝังในความคิดเห็น Excel ของคุณ สำหรับบทช่วยสอนนี้ เราจะถือว่าคุณมีไฟล์ชื่อ`logo.jpg`.
5. .NET Framework: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง .NET Framework แล้ว เนื่องจาก Aspose.Cells ต้องการให้ทำงานได้อย่างถูกต้อง
ตอนนี้เราได้ครอบคลุมข้อกำหนดเบื้องต้นแล้ว มาดูการเขียนโค้ดจริงกันเลย!
## แพ็คเกจนำเข้า
ขั้นแรก เราต้องนำเข้าแพ็คเกจที่จำเป็น ในโปรเจ็กต์ C# ของคุณ อย่าลืมเพิ่มการอ้างอิงไปยังไลบรารี Aspose.Cells คุณสามารถทำได้โดยใช้ตัวจัดการแพ็คเกจ NuGet ใน Visual Studio ดังต่อไปนี้:
1. เปิด Visual Studio
2. สร้างโครงการใหม่หรือเปิดโครงการที่มีอยู่
3. คลิกขวาที่โครงการของคุณใน Solution Explorer
4. เลือกจัดการแพ็คเกจ NuGet
5. ค้นหา Aspose.Cells และติดตั้ง

```csharp
using System.IO;
using Aspose.Cells;
using System.Drawing;
```

เมื่อคุณติดตั้งไลบรารีแล้ว คุณสามารถเริ่มเขียนโค้ดได้ ต่อไปนี้เป็นวิธีดำเนินการทีละขั้นตอน
## ขั้นตอนที่ 1: ตั้งค่าไดเรกทอรีเอกสารของคุณ
ในการเริ่มต้น เราต้องตั้งค่าไดเรกทอรีที่เราสามารถบันทึกไฟล์ Excel ได้ ซึ่งถือเป็นขั้นตอนสำคัญ เนื่องจากเราต้องการให้การทำงานของเราเป็นระเบียบ
```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "Your Document Directory";
// สร้างไดเร็กทอรีหากยังไม่มีอยู่
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
- dataDir: ตัวแปรนี้เก็บเส้นทางไปยังไดเร็กทอรีเอกสารของคุณ แทนที่`"Your Document Directory"` ด้วยเส้นทางจริงที่คุณต้องการบันทึกไฟล์ Excel ของคุณ
- Directory.Exists: ตรวจสอบว่าไดเร็กทอรีมีอยู่แล้วหรือไม่
- Directory.CreateDirectory: ถ้าไดเร็กทอรีไม่มีอยู่ การดำเนินการนี้จะสร้างมันขึ้นมา
## ขั้นตอนที่ 2: สร้างตัวอย่างสมุดงาน
 ถัดไปเราต้องสร้างอินสแตนซ์ของ`Workbook` คลาส คลาสนี้แสดงถึงเวิร์กบุ๊ก Excel ในหน่วยความจำ
```csharp
//สร้างตัวอย่างสมุดงาน
Workbook workbook = new Workbook();
```
- เวิร์กบุ๊ก: นี่คือคลาสหลักใน Aspose.Cells ที่ช่วยให้คุณสร้างและจัดการไฟล์ Excel ได้ การสร้างอินสแตนซ์ของคลาสนี้จะช่วยให้คุณสร้างเวิร์กบุ๊ก Excel ใหม่ได้
## ขั้นตอนที่ 3: รับคอลเลกชันความคิดเห็น
ตอนนี้เรามีสมุดงานแล้ว เรามาเข้าถึงคอลเลกชันความคิดเห็นของสมุดงานแรกกัน
```csharp
// รับข้อมูลอ้างอิงการรวบรวมความคิดเห็นด้วยแผ่นงานแรก
CommentCollection comments = workbook.Worksheets[0].Comments;
```
- ใบงาน[ 0]: การดำเนินการนี้จะเข้าถึงเวิร์กชีตแรกในเวิร์กบุ๊ก โปรดจำไว้ว่าดัชนีมีฐานเป็นศูนย์ ดังนั้น`[0]` หมายถึงแผ่นแรก
- ความคิดเห็น: คุณสมบัตินี้ช่วยให้เราสามารถเข้าถึงคอลเลกชันความคิดเห็นบนเวิร์กชีตนั้นได้
## ขั้นตอนที่ 4: เพิ่มความคิดเห็นลงในเซลล์
มาเพิ่มคำอธิบายในเซลล์ที่ต้องการกัน ในกรณีนี้ เราจะเพิ่มคำอธิบายในเซลล์ A1
```csharp
// เพิ่มความคิดเห็นลงในเซลล์ A1
int commentIndex = comments.Add(0, 0);
Comment comment = comments[commentIndex];
comment.Note = "First note.";
comment.Font.Name = "Times New Roman";
```
- comments.Add(0, 0): วิธีการนี้จะเพิ่มความคิดเห็นลงในเซลล์ A1 (แถว 0, คอลัมน์ 0)
- ความคิดเห็นหมายเหตุ: ที่นี่เราตั้งค่าข้อความของความคิดเห็น
- comment.Font.Name: ตั้งค่าแบบอักษรของข้อความแสดงความคิดเห็น
## ขั้นตอนที่ 5: โหลดภาพลงในสตรีม
 ตอนนี้ถึงเวลาโหลดภาพที่เราต้องการจะฝังลงในความคิดเห็นของเราแล้ว เราจะใช้`MemoryStream` เพื่อเก็บข้อมูลภาพ
```csharp
// โหลดภาพเข้าสู่สตรีม
Bitmap bmp = new Bitmap(dataDir + "logo.jpg");
MemoryStream ms = new MemoryStream();
bmp.Save(ms, System.Drawing.Imaging.ImageFormat.Png);
```
- บิตแมป: คลาสนี้ใช้สำหรับโหลดไฟล์รูปภาพ ตรวจสอบให้แน่ใจว่าเส้นทางถูกต้อง
- MemoryStream: นี่คือสตรีมที่เราจะใช้ในการบันทึกภาพลงในหน่วยความจำ
- bmp.Save: นี้จะบันทึกภาพบิตแมปลงในสตรีมหน่วยความจำในรูปแบบ PNG
## ขั้นตอนที่ 6: ตั้งค่าข้อมูลภาพเป็นรูปร่างความคิดเห็น
ตอนนี้เราต้องตั้งค่าข้อมูลภาพให้เป็นรูปร่างที่เชื่อมโยงกับความคิดเห็นที่เราสร้างไว้ก่อนหน้านี้
```csharp
// ตั้งค่าข้อมูลภาพให้เป็นรูปร่างที่สัมพันธ์กับความคิดเห็น
comment.CommentShape.Fill.ImageData = ms.ToArray();
```
- comment.CommentShape.Fill.ImageData: คุณสมบัตินี้ช่วยให้คุณตั้งค่ารูปภาพสำหรับรูปร่างของคำอธิบายประกอบ เราแปลง`MemoryStream` ไปยังอาร์เรย์ไบต์โดยใช้`ms.ToArray()`.
## ขั้นตอนที่ 7: บันทึกสมุดงาน
สุดท้ายนี้ เรามาบันทึกสมุดงานของเราโดยใส่ข้อคิดเห็นและรูปภาพไว้ด้วย
```csharp
// บันทึกสมุดงาน
workbook.Save(dataDir + "book1.out.xlsx", Aspose.Cells.SaveFormat.Xlsx);
```
- workbook.Save: วิธีการนี้จะบันทึกเวิร์กบุ๊กไปยังเส้นทางที่ระบุ โดยเราจะบันทึกเป็นไฟล์ XLSX
## บทสรุป
และแล้วคุณก็ทำได้! คุณได้เพิ่มความคิดเห็นพร้อมรูปภาพลงในไฟล์ Excel สำเร็จแล้วโดยใช้ Aspose.Cells สำหรับ .NET ฟีเจอร์นี้สามารถทำให้สเปรดชีตของคุณมีข้อมูลและน่าสนใจมากขึ้น ไม่ว่าคุณจะใส่คำอธิบายประกอบข้อมูล ให้ข้อเสนอแนะ หรือเพียงแค่เพิ่มความเป็นส่วนตัว ความคิดเห็นพร้อมรูปภาพสามารถปรับปรุงประสบการณ์ของผู้ใช้ได้อย่างมาก
## คำถามที่พบบ่อย
### ฉันสามารถเพิ่มความคิดเห็นหลาย ๆ รายการลงในเซลล์เดียวกันได้ไหม
ไม่ Excel ไม่อนุญาตให้แสดงความคิดเห็นหลายรายการในเซลล์เดียวกัน คุณสามารถแสดงความคิดเห็นได้เพียงรายการเดียวต่อเซลล์
### รองรับรูปแบบภาพอะไรบ้าง?
Aspose.Cells รองรับรูปแบบภาพต่างๆ รวมถึง PNG, JPEG และ BMP
### ฉันต้องมีใบอนุญาตเพื่อใช้ Aspose.Cells หรือไม่?
Aspose.Cells เสนอการทดลองใช้ฟรี แต่หากต้องการฟังก์ชันครบถ้วน คุณจะต้องซื้อใบอนุญาต
### ฉันสามารถปรับแต่งลักษณะที่ปรากฏของความคิดเห็นได้ไหม
ใช่ คุณสามารถปรับแต่งแบบอักษร ขนาด และสีของข้อความแสดงความคิดเห็นได้ และคุณยังสามารถเปลี่ยนรูปร่างและขนาดของความคิดเห็นได้อีกด้วย
### ฉันสามารถหาเอกสารเพิ่มเติมเกี่ยวกับ Aspose.Cells ได้จากที่ใด
 คุณสามารถค้นหาเอกสารประกอบที่ครอบคลุมเกี่ยวกับ Aspose.Cells ได้[ที่นี่](https://reference.aspose.com/cells/net/).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
