---
title: การตรวจสอบข้อมูลทศนิยมใน Excel
linktitle: การตรวจสอบข้อมูลทศนิยมใน Excel
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: ค้นพบวิธีการนำการตรวจสอบข้อมูลทศนิยมไปใช้ใน Excel โดยใช้ Aspose.Cells สำหรับ .NET ด้วยคู่มือที่ทำตามได้ง่ายของเรา ปรับปรุงความสมบูรณ์ของข้อมูลได้อย่างง่ายดาย
weight: 11
url: /th/net/excel-autofilter-validation/decimal-data-validation-in-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# การตรวจสอบข้อมูลทศนิยมใน Excel

## การแนะนำ

การสร้างสเปรดชีตที่มีข้อมูลที่แม่นยำถือเป็นสิ่งสำคัญสำหรับการสื่อสารที่ชัดเจนในธุรกิจใดๆ วิธีหนึ่งในการรับรองความถูกต้องของข้อมูลคือการใช้การตรวจสอบข้อมูลใน Excel ในบทช่วยสอนนี้ เราจะใช้ประโยชน์จากความสามารถของ Aspose.Cells สำหรับ .NET เพื่อสร้างกลไกการตรวจสอบข้อมูลทศนิยมที่ช่วยให้ข้อมูลของคุณเชื่อถือได้และสะอาด หากคุณกำลังมองหาวิธีปรับปรุง Excel คุณมาถูกที่แล้ว!

## ข้อกำหนดเบื้องต้น

ก่อนจะเจาะลึกโค้ด ให้แน่ใจว่าคุณได้ตั้งค่าทุกอย่างให้พร้อมเพื่อให้ใช้งานได้อย่างราบรื่น:

1. Visual Studio: ดาวน์โหลดและติดตั้ง Visual Studio หากคุณยังไม่ได้ทำ เป็นสภาพแวดล้อมที่สมบูรณ์แบบสำหรับการพัฒนาแอปพลิเคชัน .NET
2.  Aspose.Cells สำหรับ .NET: คุณจะต้องเพิ่มไลบรารี Aspose.Cells ลงในโปรเจ็กต์ของคุณ คุณสามารถดาวน์โหลดได้ทาง[ลิงค์นี้](https://releases.aspose.com/cells/net/).
3. ความรู้พื้นฐานเกี่ยวกับ C#: แม้ว่าเราจะอธิบายทุกอย่างทีละขั้นตอน แต่การมีความเข้าใจพื้นฐานเกี่ยวกับการเขียนโปรแกรม C# จะช่วยให้คุณเข้าใจแนวคิดต่างๆ ได้ดีขึ้น
4. .NET Framework: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง .NET Framework ที่จำเป็นและเข้ากันได้กับ Aspose.Cells แล้ว
5. ไลบรารี: อ้างอิงไลบรารี Aspose.Cells ในโปรเจ็กต์ของคุณเพื่อหลีกเลี่ยงข้อผิดพลาดในการคอมไพล์

ตอนนี้เราได้ครอบคลุมพื้นฐานแล้ว มาดูส่วนที่น่าตื่นเต้นกันเลย: การเขียนโค้ด

## แพ็คเกจนำเข้า

ในการเริ่มต้น คุณต้องนำเข้าแพ็คเกจที่จำเป็นลงในไฟล์ C# ของคุณ ซึ่งจะช่วยให้คุณสามารถเข้าถึงฟังก์ชันการทำงานของ Aspose.Cells ได้

```csharp
using System.IO;
using Aspose.Cells;
using System;
```

เมื่อคุณรวมบรรทัดนี้ไว้ที่ด้านบนของไฟล์ คุณกำลังแจ้งให้ C# มองหาฟังก์ชัน Aspose.Cells ที่ช่วยให้คุณสามารถจัดการไฟล์ Excel ได้

ตอนนี้เราได้เตรียมขั้นตอนเรียบร้อยแล้ว มาดูขั้นตอนที่จำเป็นในการสร้างการตรวจสอบข้อมูลทศนิยมในเวิร์กชีต Excel กัน

## ขั้นตอนที่ 1: ตั้งค่าไดเรกทอรีเอกสารของคุณ

ก่อนที่คุณจะบันทึกไฟล์ใดๆ คุณต้องแน่ใจว่าไดเร็กทอรีเอกสารของคุณได้รับการตั้งค่าอย่างถูกต้อง:

```csharp
string dataDir = "Your Document Directory";
```

 แทนที่`"Your Document Directory"` ด้วยเส้นทางที่คุณต้องการบันทึกไฟล์ Excel ของคุณ

## ขั้นตอนที่ 2: ตรวจสอบการมีอยู่ของไดเร็กทอรี

สไนปเป็ตนี้จะตรวจสอบว่าไดเร็กทอรีมีอยู่หรือไม่ และจะสร้างขึ้นใหม่ถ้าไม่มี:

```csharp
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```

ขั้นตอนนี้เปรียบเสมือนการตรวจสอบให้แน่ใจว่าพื้นที่ทำงานของคุณพร้อมแล้วก่อนเริ่มโปรเจ็กต์ใหม่ ไม่เลอะเทอะ ไม่เครียด!

## ขั้นตอนที่ 3: สร้างวัตถุเวิร์กบุ๊ก

ต่อไปเรามาสร้างวัตถุเวิร์กบุ๊กใหม่ซึ่งโดยพื้นฐานแล้วคือไฟล์ Excel:

```csharp
Workbook workbook = new Workbook();
```

ลองนึกถึงสมุดงานเป็นผืนผ้าใบเปล่าสำหรับข้อมูลของคุณ ณ จุดนี้ สมุดงานไม่มีเนื้อหาใดๆ แต่พร้อมที่จะวาดลงสีแล้ว

## ขั้นตอนที่ 4: สร้างและเข้าถึงเวิร์กชีต


ตอนนี้เรามาสร้างเวิร์กชีตและเข้าถึงแผ่นงานแรกในเวิร์กบุ๊กกัน:

```csharp
Worksheet ExcelWorkSheet = workbook.Worksheets[0];
```

เช่นเดียวกับหนังสือที่มีหลายหน้า สมุดงานสามารถมีแผ่นงานได้หลายแผ่น ในขณะนี้ เรากำลังเน้นที่แผ่นงานแรก

## ขั้นตอนที่ 5: รับคอลเลกชันการตรวจสอบ

ตอนนี้เรามาดึงคอลเลกชันการตรวจสอบจากเวิร์กชีตกัน เนื่องจากเราจะจัดการกฎการตรวจสอบข้อมูลที่นี่:

```csharp
ValidationCollection validations = ExcelWorkSheet.Validations;
```

ขั้นตอนนี้คล้ายกับการตรวจสอบกล่องเครื่องมือก่อนที่คุณจะเริ่มโครงการ

## ขั้นตอนที่ 6: กำหนดพื้นที่เซลล์สำหรับการตรวจสอบ

เราจำเป็นต้องกำหนดพื้นที่ที่จะใช้การตรวจสอบ:

```csharp
CellArea ca = new CellArea();
ca.StartRow = 0;
ca.EndRow = 0;
ca.StartColumn = 0;
ca.EndColumn = 0;
```

ที่นี่ เรากำลังกำหนดว่าการตรวจสอบข้อมูลจะนำไปใช้กับเซลล์เดียว โดยเฉพาะเซลล์แรกในเวิร์กชีต (A1)

## ขั้นตอนที่ 7: สร้างและเพิ่มการตรวจสอบ

มาสร้างวัตถุการตรวจสอบของเราและเพิ่มลงในคอลเล็กชันการตรวจสอบ:

```csharp
Validation validation = validations[validations.Add(ca)];
```

ตอนนี้เรามีวัตถุการตรวจสอบความถูกต้องซึ่งเราจะกำหนดค่าเพื่อบังคับใช้เงื่อนไขทศนิยมของเรา

## ขั้นตอนที่ 8: ตั้งค่าประเภทการตรวจสอบ

ต่อไปเราจะระบุประเภทการตรวจสอบที่เราต้องการ:

```csharp
validation.Type = ValidationType.Decimal;
```

การตั้งค่าประเภทเป็นทศนิยม เราจะสั่งให้ Excel คาดหวังค่าทศนิยมในเซลล์ที่ได้รับการตรวจสอบ

## ขั้นตอนที่ 9: ระบุผู้ดำเนินการ

ตอนนี้เราจะกำหนดเงื่อนไขสำหรับค่าที่อนุญาต เราต้องการให้แน่ใจว่าข้อมูลที่ป้อนเข้าไปนั้นอยู่ในช่วงสองช่วง:

```csharp
validation.Operator = OperatorType.Between;
```

ลองนึกภาพว่าคุณกำลังวาดเส้นแบ่งเขต ตัวเลขใด ๆ ที่อยู่นอกช่วงนั้นจะถูกปฏิเสธ ทำให้ข้อมูลของคุณสะอาด!

## ขั้นตอนที่ 10: กำหนดขีดจำกัดสำหรับการตรวจสอบ

ต่อไปเราจะกำหนดขีดจำกัดล่างและบนสำหรับการตรวจสอบของเรา:

```csharp
validation.Formula1 = Decimal.MinValue.ToString();
validation.Formula2 = Decimal.MaxValue.ToString();
```

ภายใต้ข้อจำกัดเหล่านี้ ตัวเลขทศนิยมทุกตัว ไม่ว่าจะมากหรือน้อยเพียงใด ก็ได้รับการยอมรับ ตราบใดที่ยังมีค่าถูกต้อง!

## ขั้นตอนที่ 11: การปรับแต่งข้อความแสดงข้อผิดพลาด

ให้แน่ใจว่าผู้ใช้ทราบว่าเหตุใดอินพุตของพวกเขาจึงถูกปฏิเสธโดยการเพิ่มข้อความแสดงข้อผิดพลาด:

```csharp
validation.ErrorMessage = "Please enter a valid integer or decimal number";
```

สิ่งนี้นำไปสู่ประสบการณ์ที่เป็นมิตรต่อผู้ใช้เนื่องจากให้คำแนะนำเกี่ยวกับสิ่งที่ควรป้อน

## ขั้นตอนที่ 12: กำหนดพื้นที่การตรวจสอบ

ต่อไปเรามาระบุเซลล์ที่จะรับการตรวจสอบนี้กัน:

```csharp
CellArea area;
area.StartRow = 0;
area.EndRow = 9;
area.StartColumn = 0;
area.EndColumn = 0;
```

ในการกำหนดค่านี้ เราจะบอกว่าการตรวจสอบใช้ได้ตั้งแต่เซลล์ A1 ถึง A10

## ขั้นตอนที่ 13: เพิ่มพื้นที่การตรวจสอบ

ตอนนี้เราได้กำหนดพื้นที่ตรวจสอบแล้ว มาลองใช้กัน:

```csharp
validation.AddArea(area);
```

ตอนนี้การตรวจสอบของคุณก็เสร็จสมบูรณ์แล้ว พร้อมที่จะตรวจจับข้อมูลที่ไม่เหมาะสมใดๆ!

## ขั้นตอนที่ 14: บันทึกสมุดงาน

สุดท้ายนี้ เรามาบันทึกเวิร์กบุ๊กโดยใช้การตรวจสอบข้อมูลทศนิยมของเรา:

```csharp
workbook.Save(dataDir + "output.out.xls");
```

และแล้วคุณก็ทำได้สำเร็จ! คุณได้สร้างเวิร์กบุ๊กที่มีการตรวจสอบข้อมูลทศนิยมโดยใช้ Aspose.Cells สำหรับ .NET สำเร็จแล้ว

## บทสรุป

การนำการตรวจสอบข้อมูลทศนิยมไปใช้ใน Excel โดยใช้ Aspose.Cells สำหรับ .NET เป็นเรื่องง่ายเมื่อคุณปฏิบัติตามขั้นตอนง่ายๆ เหล่านี้ คุณไม่เพียงแต่จะมั่นใจได้ว่าข้อมูลยังคงสะอาดและมีโครงสร้างที่ดีเท่านั้น แต่คุณยังปรับปรุงความสมบูรณ์ของข้อมูลโดยรวมในสเปรดชีตของคุณอีกด้วย ทำให้สเปรดชีตของคุณเชื่อถือได้และใช้งานง่าย
ไม่ว่าคุณจะทำงานด้านการเงิน การจัดการโครงการ หรือสาขาใดก็ตามที่ต้องใช้การรายงานข้อมูล การฝึกฝนทักษะเหล่านี้จะช่วยเพิ่มประสิทธิภาพการทำงานของคุณได้อย่างมาก ดังนั้น ลองทำดูสิ! สเปรดชีตของคุณจะขอบคุณคุณแน่นอน

## คำถามที่พบบ่อย

### การตรวจสอบข้อมูลใน Excel คืออะไร
การตรวจสอบข้อมูลใน Excel เป็นฟีเจอร์ที่จำกัดประเภทของข้อมูลที่สามารถป้อนในเซลล์หรือช่วงข้อมูลหนึ่งๆ เพื่อให้แน่ใจถึงความสมบูรณ์ของข้อมูล

### ฉันสามารถปรับแต่งข้อความแสดงข้อผิดพลาดในการตรวจสอบข้อมูลได้หรือไม่
ใช่! คุณสามารถกำหนดข้อความแสดงข้อผิดพลาดแบบกำหนดเองเพื่อแนะนำผู้ใช้เมื่อป้อนข้อมูลไม่ถูกต้อง

### การใช้ Aspose.Cells ฟรีหรือไม่?
 Aspose.Cells เสนอให้ทดลองใช้งานฟรี แต่คุณจะต้องมีใบอนุญาตเพื่อใช้งานในระยะยาว คุณสามารถดูข้อมูลเพิ่มเติมเกี่ยวกับการขอรับใบอนุญาตชั่วคราวได้[ที่นี่](https://purchase.aspose.com/temporary-license/).

### ฉันสามารถตรวจสอบชนิดข้อมูลใดได้บ้างใน Excel?
ด้วย Aspose.Cells คุณสามารถตรวจสอบประเภทข้อมูลต่างๆ ได้ เช่น จำนวนเต็ม ทศนิยม วันที่ รายการ และสูตรที่กำหนดเอง

### ฉันสามารถหาเอกสาร Aspose.Cells เพิ่มเติมได้ที่ไหน
 คุณสามารถสำรวจเอกสารประกอบที่ครอบคลุม[ที่นี่](https://reference.aspose.com/cells/net/).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
