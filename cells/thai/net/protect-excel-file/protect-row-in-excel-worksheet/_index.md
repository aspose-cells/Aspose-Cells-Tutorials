---
"description": "พบกับวิธีป้องกันแถวของสเปรดชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET ในบทช่วยสอนนี้ บทช่วยสอนทีละขั้นตอนใน C#"
"linktitle": "การป้องกันแถวในเวิร์กชีต Excel"
"second_title": "เอกสารอ้างอิง API Aspose.Cells สำหรับ .NET"
"title": "การป้องกันแถวในเวิร์กชีต Excel"
"url": "/th/net/protect-excel-file/protect-row-in-excel-worksheet/"
"weight": 60
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# การป้องกันแถวในเวิร์กชีต Excel

## การแนะนำ

เมื่อทำงานกับแผ่นงาน Excel มักจำเป็นต้องป้องกันแถวข้อมูลบางแถวเพื่อรักษาความสมบูรณ์ของข้อมูล ไม่ว่าคุณจะจัดการโครงการของทีม ดูแลรายงานทางการเงิน หรือแชร์เอกสาร การจำกัดการเข้าถึงแถวข้อมูลบางแถวสามารถป้องกันการเปลี่ยนแปลงที่ไม่ต้องการได้ ในบทช่วยสอนนี้ เราจะมาสำรวจวิธีใช้ประโยชน์จาก Aspose.Cells สำหรับ .NET เพื่อป้องกันแถวข้อมูลบางแถวในเวิร์กชีต Excel ดังนั้น สวมหมวกโค้ดของคุณแล้วมาดำดิ่งสู่โลกที่น่าตื่นเต้นของการจัดการ Excel ด้วย C# กันเถอะ!

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะลงมือทำจริง เรามาตรวจสอบก่อนว่าคุณได้ตั้งค่าทุกอย่างเรียบร้อยแล้ว ต่อไปนี้คือข้อกำหนดเบื้องต้น:

1. Aspose.Cells สำหรับ .NET: ดาวน์โหลดไลบรารีจาก [เว็บไซต์อาโพส](https://releases.aspose.com/cells/net/)ตรวจสอบให้แน่ใจว่าคุณมีเวอร์ชันล่าสุดสำหรับคุณสมบัติใหม่และการแก้ไขจุดบกพร่องทั้งหมด
2. Visual Studio: สภาพแวดล้อมการพัฒนาแบบบูรณาการ (IDE) เช่น Visual Studio (Community, Professional หรือ Enterprise) จะช่วยให้คุณคอมไพล์และรันโค้ด C# ได้อย่างมีประสิทธิภาพ
3. .NET Framework: คุณต้องมี .NET Framework เวอร์ชันที่เข้ากันได้ Aspose.Cells รองรับหลายเวอร์ชัน ดังนั้นโปรดตรวจสอบว่าเวอร์ชันของคุณเป็นเวอร์ชันล่าสุดแล้ว 
4. ความรู้พื้นฐานเกี่ยวกับ C#: ความเข้าใจพื้นฐานเกี่ยวกับ C# จะเป็นประโยชน์เมื่อเราเขียนโค้ดในคู่มือนี้
5. เอกสารอ้างอิง: ทำความคุ้นเคยกับ [เอกสาร Aspose.Cells สำหรับ .NET](https://reference.aspose.com/cells/net/) เพื่อรายละเอียดเพิ่มเติมเกี่ยวกับวิธีการและคลาสที่ใช้

## แพ็คเกจนำเข้า

ขั้นตอนแรกในการเดินทางของเราคือการนำเข้าแพ็คเกจที่จำเป็นลงในโปรเจ็กต์ C# ของเรา Aspose.Cells ทำงานผ่านชุดคลาสที่เราต้องรวมไว้:

```csharp
using System.IO;
using Aspose.Cells;
```

ตอนนี้เราได้นำเข้าแพ็คเกจที่จำเป็นแล้ว มาดูขั้นตอนในการสร้างเวิร์กบุ๊ก Excel และปกป้องแถวที่ระบุกัน 

## ขั้นตอนที่ 1: กำหนดไดเรกทอรี

ในขั้นตอนนี้ เราจะระบุตำแหน่งที่จะบันทึกไฟล์ Excel ของเรา สิ่งสำคัญคือต้องแน่ใจว่ามีไดเรกทอรีนี้อยู่ มิฉะนั้น เราจะสร้างไดเรกทอรีนี้ขึ้นเองตามโปรแกรมหากจำเป็น

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY"; // แทนที่ด้วยเส้นทางเอกสารของคุณ
bool IsExists = Directory.Exists(dataDir);
if (!IsExists)
{
    Directory.CreateDirectory(dataDir);
}
```
ในโค้ดนี้ให้แทนที่ `YOUR DOCUMENT DIRECTORY` ด้วยเส้นทางจริงที่คุณต้องการบันทึกไฟล์ Excel ของคุณ

## ขั้นตอนที่ 2: สร้างสมุดงานใหม่

ต่อไปเราจะสร้างเวิร์กบุ๊กใหม่ซึ่งการจัดการทั้งหมดจะเกิดขึ้น นี่เป็นขั้นตอนพื้นฐานเช่นเดียวกับการวางรากฐานก่อนสร้างบ้านในฝันของคุณ

```csharp
Workbook wb = new Workbook();
```
บรรทัดนี้จะเริ่มต้นอินสแตนซ์ใหม่ของ `Workbook` ชั้นเรียนกำลังสร้างเวิร์กชีตใหม่ให้เราได้ทำงาน

## ขั้นตอนที่ 3: เข้าถึงแผ่นงาน

เมื่อสร้างเวิร์กบุ๊กเสร็จแล้ว เรามาเริ่มสร้างเวิร์กชีตแรกกันเลย โปรดจำไว้ว่าไฟล์ Excel สามารถมีชีตได้หลายชีต ดังนั้นการเลือกชีตที่เหมาะสมจึงเป็นสิ่งสำคัญ

```csharp
Worksheet sheet = wb.Worksheets[0]; // การเข้าถึงแผ่นงานแรก
```

## ขั้นตอนที่ 4: ปลดล็อคคอลัมน์ทั้งหมด

ก่อนจะล็อกแถวใดแถวหนึ่ง ควรปลดล็อกคอลัมน์ทั้งหมดเสียก่อน วิธีนี้ช่วยให้เราควบคุมได้ว่าข้อมูลใดจะยังแก้ไขได้ในภายหลัง

```csharp
Style style;
StyleFlag flag;

// วนรอบคอลัมน์ทั้งหมดและปลดล็อคพวกมัน
for (int i = 0; i <= 255; i++)
{
    style = sheet.Cells.Columns[(byte)i].Style;
    style.IsLocked = false;
    flag = new StyleFlag();
    flag.Locked = true;
    sheet.Cells.Columns[(byte)i].ApplyStyle(style, flag);
}
```
ลูปนี้จะวนซ้ำผ่าน 256 คอลัมน์แรก โดยปลดล็อคแต่ละคอลัมน์เพื่อให้แน่ใจว่ามีสิทธิ์การแก้ไขเริ่มต้น

## ขั้นตอนที่ 5: การล็อคแถวที่เฉพาะเจาะจง

ตอนนี้ เราจะกำหนดเป้าหมายแถวแรกของเวิร์กชีตของเราสำหรับการล็อก ขั้นตอนนี้จะช่วยให้แน่ใจว่าผู้ใช้ไม่สามารถทำการเปลี่ยนแปลงข้อมูลสำคัญที่อยู่ในแถวนี้โดยไม่ได้รับอนุญาต

```csharp
style = sheet.Cells.Rows[0].Style; // รับสไตล์แถวแรก
style.IsLocked = true; // ล็อคแถว
flag = new StyleFlag();
flag.Locked = true; // ตั้งค่าการล็อคธง
sheet.Cells.ApplyRowStyle(0, style, flag); // ใช้สไตล์กับแถวแรก
```
ที่นี่ เราจะเรียกค้นสไตล์สำหรับแถวแรก ทำเครื่องหมายว่าถูกล็อก และใช้สไตล์การล็อก ซึ่งเปรียบได้กับการใส่กุญแจล็อกลิ้นชักสำคัญ ซึ่งจำเป็นต่อการรักษาความปลอดภัยของข้อมูลที่ละเอียดอ่อน!

## ขั้นตอนที่ 6: การปกป้องแผ่นงาน

เมื่อล็อกแถวแล้ว เรามาทำขั้นตอนเพิ่มเติมและปกป้องเวิร์กชีตให้สมบูรณ์ ซึ่งจะบังคับใช้การล็อกกับฟังก์ชันทั้งหมดที่กำหนดไว้ใน `ProtectionType`-

```csharp
sheet.Protect(ProtectionType.All); // ปกป้องแผ่นด้วยคุณสมบัติทั้งหมด
```
โดยการใช้การป้องกันนี้ ผู้ใช้จะไม่สามารถแก้ไขแถวที่ถูกล็อคหรือทำการเปลี่ยนแปลงใดๆ ที่อาจส่งผลต่อพื้นที่ที่ถูกล็อคได้

## ขั้นตอนที่ 7: การบันทึกสมุดงาน

ขั้นตอนสุดท้ายคือการบันทึกสมุดงาน นี่คือจุดที่ความพยายามอย่างหนักของเราได้รับผลตอบแทน และเราจะเห็นสเปรดชีตที่สวยงามและได้รับการปกป้องมีชีวิตขึ้นมา!

```csharp
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```
ตรวจสอบให้แน่ใจว่าชื่อและรูปแบบไฟล์ที่บันทึกนั้นตรงตามความต้องการของคุณ ในกรณีนี้ เราจะบันทึกเป็นรูปแบบ Excel รุ่นเก่า (Excel 97-2003)

## บทสรุป

และแล้วคุณก็ทำได้! คุณได้เรียนรู้วิธีการปกป้องแถวที่ระบุในเวิร์กชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET สำเร็จแล้ว ด้วยโค้ดเพียงไม่กี่บรรทัด คุณไม่เพียงแต่สร้างเวิร์กบุ๊กได้เท่านั้น แต่คุณยังสามารถจัดการรักษาความปลอดภัยของข้อมูลที่ละเอียดอ่อนได้อีกด้วย ทำให้มั่นใจได้ว่าไฟล์ Excel ของคุณยังคงสมบูรณ์และเชื่อถือได้ ไม่ว่าจะเป็นรายงานทางการเงิน แผ่นลงทะเบียน หรือแผนโครงการร่วมมือ การปกป้องข้อมูลสำคัญถือเป็นสิ่งสำคัญ 

## คำถามที่พบบ่อย

### Aspose.Cells คืออะไร?
Aspose.Cells เป็นไลบรารีอันทรงพลังสำหรับ .NET ที่อนุญาตให้ผู้ใช้สร้าง จัดการ และแปลงไฟล์ Excel โดยโปรแกรม

### ฉันสามารถปกป้องหลายแถวในครั้งเดียวด้วย Aspose.Cells ได้หรือไม่
ใช่ คุณสามารถขยายเทคนิคการล็อกได้โดยการวนซ้ำผ่านหลายแถวและใช้การเปลี่ยนแปลงรูปแบบที่คล้ายกันกับแต่ละแถว

### มีวิธีปลดล็อคแถวหลังจากการป้องกันหรือไม่
ใช่ คุณสามารถยกเลิกการป้องกันแผ่นงานก่อนแล้วจึงปรับแต่ง `IsLocked` คุณสมบัติของแถวที่ต้องการ จากนั้นจึงใช้การป้องกันอีกครั้ง

### Aspose.Cells รองรับรูปแบบอื่นนอกเหนือจาก Excel หรือไม่
แน่นอน! Aspose.Cells สามารถแปลงและบันทึกสมุดงานเป็นรูปแบบต่างๆ รวมถึง CSV, PDF และ HTML

### ฉันจะได้รับการสนับสนุนสำหรับ Aspose.Cells ได้จากที่ไหน
คุณสามารถเยี่ยมชม [ฟอรั่มสนับสนุน Aspose](https://forum.aspose.com/c/cells/9) เพื่อขอความช่วยเหลือและคำแนะนำชุมชน

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}