---
title: ปรับระดับการบีบอัดในเวิร์กบุ๊ก
linktitle: ปรับระดับการบีบอัดในเวิร์กบุ๊ก
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีปรับระดับการบีบอัดของเวิร์กบุ๊ก Excel โดยใช้ Aspose.Cells สำหรับ .NET ด้วยคู่มือทีละขั้นตอนนี้ เพิ่มประสิทธิภาพการจัดการไฟล์ของคุณ
weight: 14
url: /th/net/workbook-operations/adjust-compression-level/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# ปรับระดับการบีบอัดในเวิร์กบุ๊ก

## การแนะนำ
เมื่อต้องจัดการไฟล์ Excel ขนาดใหญ่ การบีบอัดถือเป็นตัวเปลี่ยนเกม เพราะไม่เพียงแต่ช่วยประหยัดพื้นที่จัดเก็บเท่านั้น แต่ยังทำให้การถ่ายโอนไฟล์เร็วขึ้นและมีประสิทธิภาพมากขึ้นด้วย หากคุณใช้ Aspose.Cells สำหรับ .NET คุณสามารถปรับระดับการบีบอัดของเวิร์กบุ๊กได้อย่างง่ายดาย ในคู่มือนี้ เราจะแนะนำคุณทีละขั้นตอนเพื่อให้แน่ใจว่าคุณเข้าใจแต่ละส่วนของโค้ดและวิธีการทำงานของโค้ด
## ข้อกำหนดเบื้องต้น
ก่อนที่จะเจาะลึกโค้ด มีข้อกำหนดเบื้องต้นบางประการที่คุณต้องมี:
1. ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับการเขียนโปรแกรม C# จะช่วยให้คุณเข้าใจชิ้นส่วนโค้ดได้ดีขึ้น
2.  ไลบรารี Aspose.Cells: คุณต้องติดตั้งไลบรารี Aspose.Cells คุณสามารถดาวน์โหลดได้จาก[ที่นี่](https://releases.aspose.com/cells/net/).
3. Visual Studio: จำเป็นต้องมีสภาพแวดล้อมการพัฒนาเช่น Visual Studio ในการรันโค้ด
4. .NET Framework: ตรวจสอบให้แน่ใจว่าโครงการของคุณได้รับการตั้งค่าด้วย .NET Framework เวอร์ชันที่เข้ากันได้
## แพ็คเกจนำเข้า
ในการเริ่มต้น คุณต้องนำเข้าแพ็คเกจที่จำเป็นลงในโปรเจ็กต์ C# ของคุณ โดยคุณสามารถทำได้ดังนี้:
```csharp
using Aspose.Cells.Rendering;
using Aspose.Cells.WebExtensions;
using System;
```
 แพ็คเกจเหล่านี้มีความจำเป็นสำหรับการทำงานกับไฟล์ Excel โดยใช้ไลบรารี Aspose.Cells`Aspose.Cells` เนมสเปซประกอบด้วยคลาสทั้งหมดที่คุณต้องการเพื่อจัดการไฟล์ Excel ในขณะที่`Aspose.Cells.Xlsb` ให้ตัวเลือกสำหรับการบันทึกไฟล์ในรูปแบบ XLSB
ตอนนี้ มาแบ่งกระบวนการปรับระดับการบีบอัดในเวิร์กบุ๊กออกเป็นขั้นตอนที่สามารถจัดการได้
## ขั้นตอนที่ 1: กำหนดไดเรกทอรีแหล่งที่มาและเอาต์พุต
ขั้นแรก คุณต้องระบุว่าไฟล์ต้นฉบับของคุณอยู่ที่ใดและคุณต้องการบันทึกไฟล์เอาต์พุตไว้ที่ใด ซึ่งเป็นสิ่งสำคัญเพื่อให้แน่ใจว่าโปรแกรมของคุณทราบว่าจะค้นหาไฟล์ที่ต้องการใช้งานจากที่ใด
```csharp
// ไดเรกทอรีแหล่งที่มา
string sourceDir = "Your Document Directory";
string outDir = "Your Document Directory";
```
 แทนที่`"Your Document Directory"` พร้อมเส้นทางไปยังไดเร็กทอรีของคุณ ซึ่งจะช่วยให้โปรแกรมค้นหาไฟล์ที่คุณต้องการบีบอัด
## ขั้นตอนที่ 2: โหลดเวิร์กบุ๊ก
ต่อไปคุณจะโหลดเวิร์กบุ๊กที่คุณต้องการบีบอัด นี่คือจุดที่ความมหัศจรรย์เริ่มต้นขึ้น!
```csharp
Workbook workbook = new Workbook(sourceDir + "LargeSampleFile.xlsx");
```
ในบรรทัดนี้ เราสร้างอินสแตนซ์ใหม่ของ`Workbook` สร้างคลาสและโหลดไฟล์ Excel ที่มีอยู่ ตรวจสอบให้แน่ใจว่าชื่อไฟล์ตรงกับชื่อที่คุณมีในไดเร็กทอรีต้นทาง
## ขั้นตอนที่ 3: ตั้งค่าตัวเลือกการบันทึก
ตอนนี้ถึงเวลากำหนดค่าตัวเลือกการบันทึกแล้ว เราจะตั้งค่าประเภทการบีบอัดสำหรับไฟล์เอาต์พุต 
```csharp
XlsbSaveOptions options = new XlsbSaveOptions();
```
 การ`XlsbSaveOptions` คลาสช่วยให้คุณสามารถระบุตัวเลือกต่าง ๆ ได้เมื่อบันทึกเวิร์กบุ๊กของคุณในรูปแบบ XLSB รวมถึงระดับการบีบอัด
## ขั้นตอนที่ 4: วัดเวลาการบีบอัดสำหรับระดับ 1
มาเริ่มกันที่ระดับการบีบอัดแรก เราจะวัดว่าต้องใช้เวลานานแค่ไหนในการบันทึกเวิร์กบุ๊กด้วยการบีบอัดระดับนี้
```csharp
options.CompressionType = OoxmlCompressionType.Level1;
var watch = Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_1_out.xlsb", options);
watch.Stop();
var elapsedMs = watch.ElapsedMilliseconds;
Console.WriteLine("Level 1 Elapsed Time: " + elapsedMs);
```
ที่นี่ เราตั้งค่าประเภทการบีบอัดเป็นระดับ 1 บันทึกเวิร์กบุ๊ก จากนั้นวัดเวลาที่ผ่านไป วิธีนี้ช่วยให้เราทราบว่ากระบวนการใช้เวลานานเท่าใด
## ขั้นตอนที่ 5: วัดเวลาการบีบอัดสำหรับระดับ 6
ต่อไปเรามาดูกันว่าการบีบอัดระดับ 6 ทำงานอย่างไร
```csharp
watch = Stopwatch.StartNew();
options.CompressionType = OoxmlCompressionType.Level6;
workbook.Save(outDir + "LargeSampleFile_level_6_out.xlsb", options);
watch.Stop();
elapsedMs = watch.ElapsedMilliseconds;
Console.WriteLine("Level 6 Elapsed Time: " + elapsedMs);
```
ขั้นตอนนี้จะคล้ายกับขั้นตอนก่อนหน้า แต่เราเปลี่ยนระดับการบีบอัดเป็นระดับ 6 คุณจะสังเกตเห็นว่าเวลาที่ใช้อาจแตกต่างกันไป ขึ้นอยู่กับความซับซ้อนของเวิร์กบุ๊ก
## ขั้นตอนที่ 6: วัดเวลาการบีบอัดสำหรับระดับ 9
สุดท้ายเรามาดูประสิทธิภาพที่มีระดับการบีบอัดสูงสุดกัน
```csharp
watch = Stopwatch.StartNew();
options.CompressionType = OoxmlCompressionType.Level9;
workbook.Save(outDir + "LargeSampleFile_level_9_out.xlsb", options);
watch.Stop();
elapsedMs = watch.ElapsedMilliseconds;
Console.WriteLine("Level 9 Elapsed Time: " + elapsedMs);
```
ในขั้นตอนนี้ เราตั้งค่าระดับการบีบอัดไว้ที่ระดับ 9 โดยปกติแล้วคุณจะเห็นขนาดไฟล์ลดลงอย่างเห็นได้ชัดในขั้นตอนนี้ แต่การประมวลผลอาจใช้เวลานานกว่าปกติ
## ขั้นตอนที่ 7: ผลลัพธ์ขั้นสุดท้าย
หลังจากรันระดับการบีบอัดทั้งหมดแล้ว คุณสามารถส่งข้อความแจ้งว่ากระบวนการเสร็จสมบูรณ์แล้ว
```csharp
Console.WriteLine("AdjustCompressionLevel executed successfully.");
```
บรรทัดโค้ดเรียบง่ายนี้ยืนยันว่าโปรแกรมของคุณได้ทำงานเสร็จสิ้นโดยไม่มีสะดุดใดๆ
## บทสรุป
การปรับระดับการบีบอัดของเวิร์กบุ๊กของคุณโดยใช้ Aspose.Cells สำหรับ .NET เป็นกระบวนการตรงไปตรงมาซึ่งสามารถนำไปสู่ประโยชน์อย่างมากในแง่ของขนาดไฟล์และประสิทธิภาพการทำงาน ด้วยการทำตามขั้นตอนที่ระบุไว้ในคู่มือนี้ คุณสามารถนำการบีบอัดไปใช้ในแอปพลิเคชันของคุณได้อย่างง่ายดายและปรับปรุงประสิทธิภาพการจัดการไฟล์ Excel ของคุณ
## คำถามที่พบบ่อย
### Aspose.Cells คืออะไร?  
Aspose.Cells เป็นไลบรารีอันทรงพลังสำหรับ .NET ที่ช่วยให้นักพัฒนาสามารถสร้าง จัดการ และแปลงไฟล์ Excel ได้โดยไม่ต้องใช้ Microsoft Excel
### ฉันจะติดตั้ง Aspose.Cells ได้อย่างไร?  
 คุณสามารถดาวน์โหลดและติดตั้ง Aspose.Cells ได้จาก[เว็บไซต์อาโพส](https://releases.aspose.com/cells/net/).
### ระดับการบีบอัดที่มีให้ใช้มีอะไรบ้าง?  
Aspose.Cells รองรับระดับการบีบอัดหลายระดับ ตั้งแต่ระดับ 1 (การบีบอัดต่ำสุด) ถึงระดับ 9 (การบีบอัดสูงสุด)
### ฉันสามารถทดสอบ Aspose.Cells ได้ฟรีหรือไม่?  
 ใช่! คุณสามารถทดลองใช้ Aspose.Cells ได้ฟรี[ที่นี่](https://releases.aspose.com/).
### ฉันสามารถค้นหาการสนับสนุนสำหรับ Aspose.Cells ได้ที่ไหน  
 หากมีคำถามหรือต้องการความช่วยเหลือใดๆ คุณสามารถเข้าไปที่ฟอรัมสนับสนุน Aspose ได้[ที่นี่](https://forum.aspose.com/c/cells/9).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
