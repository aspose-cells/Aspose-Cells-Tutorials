---
"description": "เรียนรู้วิธีอัปเดตสูตร Power Query ใน Excel ด้วย Aspose.Cells สำหรับ .NET ในคู่มือทีละขั้นตอนที่ครอบคลุมนี้"
"linktitle": "อัปเดตรายการสูตร Power Query ในเวิร์กบุ๊ก"
"second_title": "API การประมวลผล Excel ของ Aspose.Cells .NET"
"title": "อัปเดตรายการสูตร Power Query ในเวิร์กบุ๊ก"
"url": "/th/net/workbook-operations/update-power-query-formula-item/"
"weight": 27
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# อัปเดตรายการสูตร Power Query ในเวิร์กบุ๊ก

## การแนะนำ
การทำความเข้าใจเกี่ยวกับการจัดการข้อมูลอย่างมีประสิทธิภาพโดยใช้ Power Query ใน Excel ถือเป็นสิ่งสำคัญอย่างยิ่งสำหรับนักวิเคราะห์ข้อมูลหรือผู้ที่ชื่นชอบ Excel หากคุณเคยต้องอัปเดตรายการสูตรในเวิร์กบุ๊ก Power Query คุณมาถูกที่แล้ว คู่มือนี้ออกแบบมาเพื่อช่วยให้คุณเรียนรู้วิธีใช้ Aspose.Cells สำหรับ .NET เพื่ออัปเดตสูตร Power Query ในเวิร์กบุ๊ก Excel ได้อย่างราบรื่น ด้วยขั้นตอนง่ายๆ ไม่กี่ขั้นตอน คุณจะสามารถจัดการและปรับข้อมูลให้เหมาะสม ทำให้มั่นใจได้ว่าเวิร์กบุ๊กของคุณยังคงมีความคล่องตัวและรวมศูนย์
## ข้อกำหนดเบื้องต้น
ก่อนที่คุณจะเริ่มลงรายละเอียดในโค้ดตัวอย่างและขั้นตอน มาดูสิ่งที่คุณต้องการกันก่อน:
1. ความเข้าใจพื้นฐานเกี่ยวกับ C# และ .NET: ความคุ้นเคยกับแนวคิดการเขียนโปรแกรมใน C# จะเป็นประโยชน์เนื่องจากเราจะเขียนโค้ดบางส่วน
2. ติดตั้ง Aspose.Cells สำหรับ .NET: คุณต้องมีไลบรารี Aspose.Cells ที่รวมเข้ากับโครงการ .NET ของคุณ คุณสามารถดาวน์โหลดได้ [ที่นี่](https://releases-aspose.com/cells/net/).
3. ไฟล์ Excel ที่พร้อมสำหรับการแก้ไข: ตรวจสอบให้แน่ใจว่าคุณมีไฟล์ Excel ที่มี Power Query ที่คุณต้องการอัปเดต คุณต้องมีเวิร์กบุ๊กตัวอย่าง เช่น `SamplePowerQueryFormula.xlsx` ไว้คอยบริการของคุณ
## แพ็คเกจนำเข้า
ในการเริ่มต้น โปรดตรวจสอบให้แน่ใจว่าคุณมีเนมสเปซต่อไปนี้รวมอยู่ในไฟล์ C# ของคุณ:
```csharp
using Aspose.Cells.DigitalSignatures;
using Aspose.Cells.QueryTables;
using System;
using System.IO;
```
สิ่งนี้จะช่วยให้คุณสามารถเข้าถึงฟังก์ชันต่างๆ ที่ไลบรารี Aspose.Cells จัดเตรียมไว้ โดยเฉพาะการทำงานกับเวิร์กบุ๊กและข้อมูล Power Query
## ขั้นตอนที่ 1: ตั้งค่าไดเร็กทอรีการทำงานของคุณ
สิ่งแรกที่ต้องทำคือคุณต้องกำหนดว่าไฟล์ต้นฉบับและไฟล์เอาต์พุตของคุณอยู่ที่ใด 
```csharp
string SourceDir = "Your Document Directory";
string outputDir = "Your Document Directory";
```
ในขั้นตอนนี้คุณระบุเส้นทางไดเรกทอรี แทนที่ `"Your Document Directory"` พร้อมเส้นทางจริงที่บันทึกไฟล์ Excel ของคุณไว้ ซึ่งจะบอกให้โปรแกรมทราบว่าควรค้นหาไฟล์ต้นฉบับของคุณที่ใด และควรบันทึกไฟล์ที่อัปเดตที่ใด
## ขั้นตอนที่ 2: โหลดเวิร์กบุ๊ก
ตอนนี้คุณได้ตั้งค่าไดเร็กทอรีการทำงานแล้ว ขั้นตอนถัดไปคือโหลดไฟล์ Excel ของคุณลงในโปรแกรม
```csharp
Workbook workbook = new Workbook(SourceDir + "SamplePowerQueryFormula.xlsx");
```
ที่นี่คุณสร้าง `Workbook` วัตถุที่โหลดไฟล์ Excel ที่ระบุ `Workbook` คลาสเป็นส่วนหนึ่งของไลบรารี Aspose.Cells และมีความจำเป็นสำหรับการดำเนินการใดๆ ที่คุณจะทำกับไฟล์ Excel ดังกล่าว
## ขั้นตอนที่ 3: เข้าถึงข้อมูล Power Query
เมื่อโหลดเวิร์กบุ๊กเสร็จแล้ว ก็ถึงเวลาเข้าถึงสูตร Power Query ที่เก็บอยู่ในนั้น
```csharp
DataMashup mashupData = workbook.DataMashup;
```
ในบรรทัดนี้ `DataMashup` คุณสมบัตินี้ช่วยให้เข้าถึงโครงสร้างข้อมูลของ Power Query ภายในเวิร์กบุ๊กได้ คุณสมบัตินี้ทำให้คุณสามารถโต้ตอบกับข้อมูล Power Query ที่มีอยู่ในไฟล์ Excel ได้หลากหลายด้าน
## ขั้นตอนที่ 4: วนซ้ำสูตร Power Query
เมื่อสามารถเข้าถึงข้อมูล Power Query ได้ ขั้นตอนถัดไปคือการวนซ้ำผ่านสูตรต่างๆ ที่มีอยู่
```csharp
foreach (PowerQueryFormula formula in mashupData.PowerQueryFormulas)
{
    foreach (PowerQueryFormulaItem item in formula.PowerQueryFormulaItems)
    {
        if (item.Name == "Source")
        {
            item.Value = "Excel.Workbook(File.Contents(\"" + SourceDir + "SamplePowerQueryFormulaSource.xlsx\"), null, true)";
        }
    }
}
```
นี่คือจุดที่เวทมนตร์เกิดขึ้น เราวนซ้ำผ่านแต่ละ `PowerQueryFormula` แล้วผ่านไปแต่ละ `PowerQueryFormulaItem`. การ `if` คำสั่งนี้จะค้นหารายการสูตรที่มีชื่อว่า "Source" และอัปเดตค่าให้เป็นเส้นทางของไฟล์ต้นทางที่คุณต้องการให้ Power Query อ้างอิงถึง ซึ่งจะช่วยให้คุณเปลี่ยนไฟล์ที่ Power Query ดึงข้อมูลมาได้แบบไดนามิก
## ขั้นตอนที่ 5: บันทึกสมุดงานที่อัปเดต
หลังจากอัปเดตรายการสูตรที่จำเป็นแล้ว ขั้นตอนสุดท้ายของคุณคือการบันทึกเวิร์กบุ๊ก
```csharp
workbook.Save(outputDir + "SamplePowerQueryFormula_out.xlsx");
```
บรรทัดนี้จะบันทึกเวิร์กบุ๊กที่แก้ไขไปยังไฟล์ใหม่ โดยจะรักษาไฟล์ต้นฉบับเอาไว้ในขณะที่คุณสามารถทำงานกับเวอร์ชันที่อัปเดตได้
## ขั้นตอนที่ 6: ข้อความยืนยัน
สุดท้ายนี้ ถือเป็นการฝึกฝนที่ดีที่จะตรวจสอบว่าโค้ดของคุณทำงานได้อย่างถูกต้องหรือไม่
```csharp
Console.WriteLine("UpdatePowerQueryFormulaItem executed successfully.");
```
ข้อความง่ายๆ นี้จะยืนยันกับคุณในคอนโซลว่าการดำเนินการของคุณสำเร็จแล้ว ช่วยให้คุณสิ้นสุดกระบวนการได้อย่างสบายใจ
## บทสรุป
และแล้วคุณก็ทำได้! การอัปเดตรายการสูตร Power Query ใน Excel โดยใช้ Aspose.Cells สำหรับ .NET สามารถทำได้ง่ายๆ เพียงไม่กี่ขั้นตอน ด้วยการทำตามคำแนะนำนี้ คุณสามารถจัดการการเชื่อมต่อข้อมูล Excel ของคุณได้อย่างมีประสิทธิภาพและทำให้เวิร์กบุ๊กของคุณทำงานได้อย่างราบรื่น ไม่ว่าคุณจะเป็นผู้เชี่ยวชาญหรือเพิ่งเริ่มต้นในการจัดการข้อมูล Aspose.Cells มอบวิธีอันทรงพลังในการทำให้เวิร์กโฟลว์ของ Excel เป็นอัตโนมัติและปรับปรุงประสิทธิภาพ 
## คำถามที่พบบ่อย
### ฉันสามารถใช้ Aspose.Cells กับ .NET ทุกเวอร์ชันได้หรือไม่
Aspose.Cells เข้ากันได้กับ .NET หลายเวอร์ชัน รวมถึง .NET Framework และ .NET Core
### การใช้ Aspose.Cells ฟรีหรือไม่?
Aspose.Cells เสนอให้ทดลองใช้งานฟรี แต่หากต้องการใช้งานต่อเนื่อง จำเป็นต้องมีใบอนุญาต คุณสามารถขอรับใบอนุญาตชั่วคราวได้ [ที่นี่](https://purchase-aspose.com/temporary-license/).
### จะเกิดอะไรขึ้นหากไฟล์ Excel ที่มีอยู่ของฉันไม่มี Power Query
กระบวนการที่อธิบายไว้มุ่งเน้นที่การอัปเดตรายการ Power Query ดังนั้นหากไฟล์ของคุณไม่มีรายการเหล่านี้ คุณจะต้องรวม Power Query ไว้ก่อน
### ฉันสามารถหาข้อมูลเพิ่มเติมเกี่ยวกับ Aspose.Cells ได้จากที่ไหน
ตรวจสอบเอกสารเพื่อดูคำแนะนำและตัวอย่างโดยละเอียด เยี่ยมชม [เอกสารประกอบ](https://reference-aspose.com/cells/net/).
### ฉันจะรายงานจุดบกพร่องหรือปัญหาเกี่ยวกับ Aspose.Cells ได้อย่างไร
คุณสามารถเข้าถึงฟอรัมที่ได้รับการสนับสนุนเพื่อขอความช่วยเหลือเกี่ยวกับปัญหาใดๆ ที่คุณประสบ


{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}