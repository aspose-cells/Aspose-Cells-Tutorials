---
title: เพิ่มตัวควบคุมสี่เหลี่ยมผืนผ้าลงในเวิร์กชีตใน Excel
linktitle: เพิ่มตัวควบคุมสี่เหลี่ยมผืนผ้าลงในเวิร์กชีตใน Excel
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีการเพิ่มตัวควบคุมสี่เหลี่ยมผืนผ้าลงในเวิร์กชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET พร้อมคำแนะนำทีละขั้นตอนโดยละเอียด
weight: 25
url: /th/net/excel-shapes-controls/add-rectangle-control-to-worksheet-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# เพิ่มตัวควบคุมสี่เหลี่ยมผืนผ้าลงในเวิร์กชีตใน Excel

## การแนะนำ
เมื่อพูดถึงการทำให้งาน Excel เป็นอัตโนมัติ Aspose.Cells สำหรับ .NET เป็นเครื่องมือที่มีประสิทธิภาพที่จะช่วยให้คุณบรรลุเป้าหมายต่างๆ ได้มากมาย หนึ่งในนั้นคือการเพิ่มรูปร่าง เช่น สี่เหลี่ยมผืนผ้าลงในเวิร์กชีตของคุณ ในคู่มือนี้ เราจะมาสำรวจวิธีการเพิ่มตัวควบคุมสี่เหลี่ยมผืนผ้าลงในเวิร์กชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET เมื่ออ่านจบ คุณจะสามารถสร้าง ปรับแต่ง และบันทึกเวิร์กชีตที่มีตัวควบคุมสี่เหลี่ยมผืนผ้าฝังอยู่ในนั้นได้
แต่ก่อนจะเริ่มลงรายละเอียด เรามาพูดถึงข้อกำหนดเบื้องต้นกันก่อน
## ข้อกำหนดเบื้องต้น
หากต้องการปฏิบัติตามบทช่วยสอนนี้ โปรดแน่ใจว่าคุณมีข้อกำหนดเบื้องต้นดังต่อไปนี้:
1.  Aspose.Cells สำหรับไลบรารี .NET: หากคุณยังไม่ได้ทำ[ดาวน์โหลดห้องสมุด](https://releases.aspose.com/cells/net/) หรือติดตั้งโดยใช้ NuGet ใน Visual Studio
2. .NET Framework: คุณต้องมีการตั้งค่าสภาพแวดล้อมการพัฒนา .NET บนเครื่องของคุณ
3. ความรู้พื้นฐานเกี่ยวกับ C#: แม้ว่าเราจะแนะนำคุณทีละขั้นตอน แต่ความคุ้นเคยพื้นฐานเกี่ยวกับ C# และการเขียนโปรแกรมเชิงวัตถุก็เป็นประโยชน์
4.  ใบอนุญาต: การใช้ Aspose.Cells ในโหมดการประเมินผลนั้นเหมาะสำหรับงานพื้นฐาน แต่หากต้องการฟังก์ชันการทำงานเต็มรูปแบบ ควรพิจารณาซื้อ[ใบอนุญาตชั่วคราว](https://purchase.aspose.com/temporary-license/)หรือซื้อหนึ่งอันจาก[ที่นี่](https://purchase.aspose.com/buy).
ตอนนี้เรามาเจาะลึกโค้ดกัน!
## แพ็คเกจนำเข้า
หากต้องการเริ่มต้นใช้งาน Aspose.Cells โปรดตรวจสอบให้แน่ใจว่าคุณได้นำเข้าเนมสเปซที่จำเป็นไปยังโปรเจ็กต์ของคุณแล้ว การนำเข้าเหล่านี้จะช่วยให้เข้าถึงคลาสและวิธีการต่างๆ ที่คุณต้องการใช้ในการโต้ตอบกับไฟล์ Excel ได้
```csharp
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Drawing;
using System.Drawing;
```
บรรทัดเหล่านี้ช่วยให้แน่ใจว่าโครงการของคุณสามารถโต้ตอบกับไดเร็กทอรีไฟล์ได้ (`System.IO`), สมุดงาน Excel (`Aspose.Cells`), และการวาดรูปทรง (`Aspose.Cells.Drawing`-
ตอนนี้ มาแบ่งกระบวนการออกเป็นขั้นตอนง่าย ๆ เพื่อให้คุณปฏิบัติตามและทำซ้ำในโปรเจ็กต์ของคุณเองได้
## ขั้นตอนที่ 1: ตั้งค่าเส้นทางไดเร็กทอรี
สิ่งแรกที่คุณต้องทำคือกำหนดไดเรกทอรีที่จะบันทึกไฟล์ Excel ขั้นตอนนี้จะช่วยให้โปรเจ็กต์ของคุณทราบว่าควรสร้างและจัดเก็บไฟล์เอาต์พุตไว้ที่ใด
### การกำหนดไดเรกทอรีข้อมูล
```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "Your Document Directory";
```
 ที่นี่คุณระบุเส้นทางไดเรกทอรีที่จะเก็บไฟล์ Excel คุณสามารถแทนที่`"Your Document Directory"` โดยใช้เส้นทางจริงบนเครื่องของคุณหรือสร้างโฟลเดอร์แบบไดนามิกหากไม่มีอยู่
### การตรวจสอบและการสร้างไดเรกทอรี
```csharp
// สร้างไดเร็กทอรีหากยังไม่มีอยู่
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
บล็อกนี้จะตรวจสอบว่าไดเรกทอรีนั้นมีอยู่หรือไม่ หากไม่มี ไดเรกทอรีนั้นจะสร้างไดเรกทอรีขึ้นมาใหม่ ลองนึกถึงการเตรียมตู้เอกสารให้พร้อมก่อนที่จะจัดเก็บเอกสารใดๆ
## ขั้นตอนที่ 2: การสร้างเวิร์กบุ๊กใหม่
 ในขั้นตอนนี้ คุณจะสร้างเวิร์กบุ๊ก Excel ใหม่โดยใช้`Aspose.Cells.Workbook` คลาสนี้จะทำหน้าที่เป็นคอนเทนเนอร์สำหรับเวิร์กชีตและรูปร่างของคุณ
```csharp
// สร้างเวิร์กบุ๊กใหม่
Workbook excelbook = new Workbook();
```
 โดยการโทรหา`Workbook` ตัวสร้าง ตอนนี้คุณมีเวิร์กบุ๊ก Excel เปล่าที่พร้อมสำหรับการปรับแต่งแล้ว
## ขั้นตอนที่ 3: การเพิ่มตัวควบคุมสี่เหลี่ยมผืนผ้า
นี่คือจุดที่ความมหัศจรรย์เกิดขึ้น คุณจะเพิ่มรูปสี่เหลี่ยมผืนผ้าลงในเวิร์กชีตแรกของเวิร์กบุ๊กของคุณ
```csharp
// เพิ่มการควบคุมรูปสี่เหลี่ยมผืนผ้า
Aspose.Cells.Drawing.RectangleShape rectangle = excelbook.Worksheets[0].Shapes.AddRectangle(3, 0, 2, 0, 70, 130);
```
มาแยกส่วนนี้ออก:
- `excelbook.Worksheets[0]`:นี่เป็นการเข้าถึงแผ่นงานแรกในสมุดงานของคุณ
- `.Shapes.AddRectangle(3, 0, 2, 0, 70, 130)`: การดำเนินการนี้จะเพิ่มรูปร่างสี่เหลี่ยมผืนผ้าลงในเวิร์กชีต พารามิเตอร์ในที่นี้จะกำหนดตำแหน่ง (แถวและคอลัมน์) เช่นเดียวกับความกว้างและความสูงของสี่เหลี่ยมผืนผ้า
## ขั้นตอนที่ 4: ปรับแต่งรูปสี่เหลี่ยมผืนผ้า
การเพิ่มรูปสี่เหลี่ยมผืนผ้าเพียงอย่างเดียวไม่เพียงพอ คุณต้องปรับแต่งมันด้วย ในขั้นตอนนี้ เราจะกำหนดตำแหน่ง น้ำหนักเส้น และสไตล์เส้นประของรูปสี่เหลี่ยมผืนผ้า
### การกำหนดตำแหน่ง
```csharp
// กำหนดตำแหน่งของรูปสี่เหลี่ยมผืนผ้า
rectangle.Placement = PlacementType.FreeFloating;
```
นี่ระบุว่าสี่เหลี่ยมผืนผ้าเป็นแบบลอยอิสระ ซึ่งหมายความว่าจะไม่ถูกผูกไว้ด้วยขนาดของเซลล์
### การตั้งค่าน้ำหนักเส้น
```csharp
// ตั้งค่าน้ำหนักเส้น
rectangle.Line.Weight = 4;
```
ที่นี่เรากำหนดความหนาของเส้นสี่เหลี่ยมผืนผ้าเป็น 4 จุด ยิ่งตัวเลขสูงขึ้น เส้นก็จะยิ่งหนาขึ้น
### การตั้งค่าสไตล์ Dash
```csharp
// ตั้งค่ารูปแบบเส้นประของรูปสี่เหลี่ยมผืนผ้า
rectangle.Line.DashStyle = MsoLineDashStyle.Solid;
```
 เส้นนี้กำหนดรูปแบบเส้นประของเส้นขอบของสี่เหลี่ยมผืนผ้าให้เป็นสีทึบ คุณสามารถทดลองใช้รูปแบบต่างๆ เช่น`Dash` หรือ`Dot` ขึ้นอยู่กับความต้องการของคุณ
## ขั้นตอนที่ 5: การบันทึกสมุดงาน
เมื่อเพิ่มและปรับแต่งสี่เหลี่ยมผืนผ้าแล้ว ขั้นตอนสุดท้ายคือการบันทึกเวิร์กบุ๊กไปยังไดเร็กทอรีที่ระบุ
```csharp
// บันทึกไฟล์ Excel
excelbook.Save(dataDir + "book1.out.xls");
```
 การดำเนินการนี้จะบันทึกสมุดงานเป็น`.xls` ไฟล์ในโฟลเดอร์ที่คุณกำหนดไว้ก่อนหน้านี้ คุณสามารถปรับเปลี่ยนรูปแบบไฟล์ได้โดยการเปลี่ยนนามสกุล เช่น`.xlsx` หากคุณต้องการรูปแบบ Excel ใหม่กว่า
## บทสรุป
และแล้วคุณก็ทำได้! การเพิ่มตัวควบคุมรูปสี่เหลี่ยมผืนผ้าลงในเวิร์กชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET เป็นกระบวนการที่ตรงไปตรงมาเมื่อคุณแบ่งกระบวนการออกเป็นขั้นตอน ไม่ว่าคุณจะต้องการเพิ่มรูปร่างเพื่อให้ดูสวยงาม เน้นส่วนต่างๆ ของข้อมูล หรือปรับแต่งรายงานของคุณ Aspose.Cells จะให้ความยืดหยุ่นแก่คุณในการทำสิ่งเหล่านี้ด้วยโปรแกรม
คู่มือนี้จะช่วยให้คุณมีความรู้ทั้งหมดที่จำเป็นในการเพิ่มรูปทรง เช่น สี่เหลี่ยมผืนผ้า ลงในแผ่นงาน Excel ของคุณด้วย Aspose.Cells ตอนนี้ถึงเวลาทดลองและดูว่าคุณสามารถทำอะไรได้อีกบ้างด้วยไลบรารีอันทรงพลังนี้!
## คำถามที่พบบ่อย
### ฉันสามารถเพิ่มรูปร่างอื่นๆ เช่น วงกลมหรือเส้นโดยใช้ Aspose.Cells สำหรับ .NET ได้หรือไม่  
ใช่ Aspose.Cells ช่วยให้คุณสามารถเพิ่มรูปทรงต่างๆ ได้มากมาย รวมถึงวงกลม เส้น ลูกศร และอื่นๆ อีกมากมาย
### ฉันสามารถตั้งค่าคุณสมบัติอื่นใดให้กับการควบคุมรูปสี่เหลี่ยมผืนผ้าได้บ้าง  
คุณสามารถปรับแต่งสีเติม สีเส้น ความโปร่งใส และแม้แต่เพิ่มข้อความภายในสี่เหลี่ยมผืนผ้าได้
### Aspose.Cells เข้ากันได้กับ .NET Core ได้หรือไม่  
ใช่ Aspose.Cells รองรับ .NET Core เช่นเดียวกับ .NET Framework และแพลตฟอร์มอื่นๆ ที่ใช้ .NET
### ฉันสามารถวางตำแหน่งสี่เหลี่ยมสัมพันธ์กับเซลล์เฉพาะได้หรือไม่  
 ใช่ คุณสามารถวางสี่เหลี่ยมผืนผ้าไว้ในแถวและคอลัมน์ที่ระบุ หรือใช้`PlacementType` เพื่อควบคุมวิธีการยึดให้แน่น
### มีรุ่นทดลองใช้งานฟรีสำหรับ Aspose.Cells หรือไม่  
 ใช่ คุณสามารถรับได้[ทดลองใช้งานฟรี](https://releases.aspose.com/) จากเว็บไซต์เพื่อทดสอบคุณลักษณะของห้องสมุดก่อนการซื้อ
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
