---
"description": "เรียนรู้วิธีการเพิ่มรูปวงรีในเวิร์กชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET คำแนะนำทีละขั้นตอนพร้อมคำอธิบายโค้ดโดยละเอียด"
"linktitle": "เพิ่มวงรีลงในเวิร์กชีตใน Excel"
"second_title": "API การประมวลผล Excel ของ Aspose.Cells .NET"
"title": "เพิ่มวงรีลงในเวิร์กชีตใน Excel"
"url": "/th/net/excel-shapes-controls/add-oval-to-worksheet-excel/"
"weight": 17
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# เพิ่มวงรีลงในเวิร์กชีตใน Excel

## การแนะนำ
การสร้างไฟล์ Excel ที่สวยงามและโต้ตอบได้นั้นอาจเกี่ยวข้องกับมากกว่าแค่ตัวเลขและสูตร รูปร่างเช่นวงรีสามารถเพิ่มความสวยงามหรือเพิ่มองค์ประกอบที่ใช้งานได้จริงในเวิร์กชีตของคุณได้ ในบทช่วยสอนนี้ เราจะมาสำรวจวิธีใช้ Aspose.Cells สำหรับ .NET เพื่อเพิ่มวงรีในเวิร์กชีต Excel ด้วยโปรแกรม ไม่ว่าคุณต้องการเพิ่มความโดดเด่นหรือฟังก์ชันการทำงาน เราก็มีคำแนะนำทีละขั้นตอนที่อธิบายทุกอย่างให้คุณทราบ
## ข้อกำหนดเบื้องต้น
ก่อนที่จะเจาะลึกโค้ด มีบางสิ่งที่คุณต้องมี:
1. Aspose.Cells สำหรับไลบรารี .NET: คุณสามารถดาวน์โหลดได้จาก [ที่นี่](https://releases.aspose.com/cells/net/) หรือติดตั้งโดยใช้ NuGet ใน Visual Studio
2. สภาพแวดล้อมการพัฒนา: AC# IDE เช่น Visual Studio
3. ความเข้าใจพื้นฐานเกี่ยวกับ C#: คุณควรมีความคุ้นเคยกับแนวคิดการเขียนโค้ดพื้นฐานใน C#
นอกจากนี้ อย่าลืมตั้งค่าโครงการของคุณโดยติดตั้งไลบรารี Aspose.Cells สำหรับ .NET หากคุณยังไม่มีใบอนุญาต คุณสามารถสมัครได้ [ใบอนุญาตชั่วคราว](https://purchase.aspose.com/temporary-license/) หรือใช้ [ทดลองใช้งานฟรี](https://releases.aspose.com/) เวอร์ชัน
## แพ็คเกจนำเข้า
ก่อนเขียนโค้ดใดๆ ให้แน่ใจว่าคุณได้ใส่เนมสเปซที่จำเป็นแล้ว นี่คือตัวอย่างโค้ด C# เพื่อให้แน่ใจว่าคุณกำลังใช้ไลบรารีที่ถูกต้อง:
```csharp
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Drawing;
using System.Drawing;
```
## ขั้นตอนที่ 1: ตั้งค่าไดเร็กทอรีของคุณ
ขั้นตอนแรกในการเพิ่มวงรีในแผ่นงาน Excel คือระบุตำแหน่งที่จะบันทึกไฟล์ Excel ของคุณ ให้เรากำหนดเส้นทางไดเรกทอรีและตรวจสอบให้แน่ใจว่าไดเรกทอรีนั้นมีอยู่ก่อนจะบันทึกงานของเรา

เราจะสร้างเส้นทางไดเรกทอรีและตรวจสอบว่ามีอยู่หรือไม่ ถ้าไม่มีโฟลเดอร์นั้น ระบบจะสร้างโฟลเดอร์นั้นขึ้นมา
```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "Your Document Directory";
// สร้างไดเร็กทอรีหากยังไม่มีอยู่
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
ขั้นตอนนี้มีความสำคัญมาก เนื่องจากจะช่วยให้แน่ใจว่าไฟล์ของคุณถูกบันทึกไว้ในตำแหน่งที่เหมาะสม และคุณจะไม่เจอปัญหาเกี่ยวกับเส้นทางไฟล์ในภายหลัง
## ขั้นตอนที่ 2: เริ่มต้นเวิร์กบุ๊กใหม่
ขั้นต่อไป เราต้องสร้างเวิร์กบุ๊กใหม่ซึ่งเราจะเพิ่มรูปทรงวงรีลงไป เวิร์กบุ๊กนี้แสดงไฟล์ Excel และเราสามารถเพิ่มเนื้อหาหรือรูปทรงลงไปได้

ในขั้นตอนนี้ เราจะสร้างอินสแตนซ์ใหม่ `Workbook` วัตถุที่จะใช้เป็นคอนเทนเนอร์ไฟล์ Excel ของเรา
```csharp
// สร้างเวิร์กบุ๊กใหม่
Workbook excelbook = new Workbook();
```
## ขั้นตอนที่ 3: เพิ่มรูปวงรีแรก
ตอนนี้มาถึงส่วนที่สนุกแล้ว นั่นคือการเพิ่มรูปวงรีลงในเวิร์กชีต รูปวงรีนี้สามารถแสดงถึงองค์ประกอบที่มองเห็นได้ เช่น ปุ่มหรือไฮไลต์ เราจะเริ่มต้นด้วยการเพิ่มรูปวงรีรูปแรกลงในเวิร์กชีตแรกของเวิร์กบุ๊กของเรา

ที่นี่เราใช้ `Shapes.AddOval()` วิธีการสร้างวงรีบนเวิร์กชีตที่แถวและคอลัมน์ที่ระบุ
```csharp
// เพิ่มรูปทรงวงรี
Aspose.Cells.Drawing.Oval oval1 = excelbook.Worksheets[0].Shapes.AddOval(2, 0, 2, 0, 130, 160);
```
พารามิเตอร์ภายใน `AddOval()` มีดังนี้:
- ตัวเลขสองตัวแรกแสดงถึงแถวและคอลัมน์สำหรับมุมบนซ้ายของวงรี
- ตัวเลขสองตัวถัดไปแสดงถึงความสูงและความกว้างของวงรี
## ขั้นตอนที่ 4: กำหนดตำแหน่งและรูปแบบของวงรี
เมื่อสร้างวงรีแล้ว เราสามารถตั้งค่าตำแหน่ง น้ำหนักเส้น และสไตล์เส้นประได้ `Placement` คุณสมบัติกำหนดว่าวงรีจะมีพฤติกรรมอย่างไรเมื่อคุณปรับขนาดหรือย้ายเซลล์ในเวิร์กชีต

เราสร้างรูปวงรีให้ลอยอิสระและปรับแต่งรูปลักษณ์ของมัน
```csharp
// ตั้งค่าตำแหน่งของวงรี
oval1.Placement = PlacementType.FreeFloating;
// ตั้งค่าน้ำหนักเส้น
oval1.Line.Weight = 1;
// ตั้งค่ารูปแบบเส้นประของวงรี
oval1.Line.DashStyle = MsoLineDashStyle.Solid;
```
การดำเนินการนี้ช่วยให้วงรีสามารถเคลื่อนที่ได้อย่างอิสระภายในเวิร์กชีต และน้ำหนักเส้นและรูปแบบของวงรีจะถูกตั้งค่าเพื่อความสอดคล้องทางภาพ
## ขั้นตอนที่ 5: เพิ่มรูปวงรี (วงกลม) อีกอันหนึ่ง
เหตุใดจึงต้องหยุดอยู่แค่ที่หนึ่ง ในขั้นตอนนี้ เราจะเพิ่มรูปวงรีอีกรูป โดยคราวนี้จะสร้างวงกลมที่สมบูรณ์แบบโดยทำให้ความสูงและความกว้างเท่ากัน

เราสร้างรูปวงรีอีกอัน วางไว้ในตำแหน่งอื่น และตรวจสอบให้แน่ใจว่าเป็นรูปวงกลมโดยกำหนดความสูงและความกว้างเท่ากัน
```csharp
// เพิ่มรูปวงรี (วงกลม) อีกอันหนึ่ง
Aspose.Cells.Drawing.Oval oval2 = excelbook.Worksheets[0].Shapes.AddOval(9, 0, 2, 15, 130, 130);
```
## ขั้นตอนที่ 6: จัดแต่งทรงวงรีที่ 2
เช่นเดียวกับก่อนหน้านี้ เราจะปรับตำแหน่ง น้ำหนัก และสไตล์เส้นประของวงรี (หรือวงกลม) ที่สองนี้

เราใช้คุณสมบัติที่คล้ายคลึงกันกับรูปวงรีที่สองเพื่อให้ตรงกับสไตล์ของรูปวงรีแรก
```csharp
// ตั้งค่าตำแหน่งของวงรี
oval2.Placement = PlacementType.FreeFloating;
// ตั้งค่าน้ำหนักเส้น
oval2.Line.Weight = 1;
// ตั้งค่ารูปแบบเส้นประของวงรี
oval2.Line.DashStyle = MsoLineDashStyle.Solid;
```
## ขั้นตอนที่ 7: บันทึกสมุดงาน
สุดท้ายนี้ เราจำเป็นต้องบันทึกเวิร์กบุ๊กด้วยรูปวงรีที่เราเพิ่งเพิ่มเข้าไป การบันทึกไฟล์จะช่วยให้มั่นใจได้ว่าการเปลี่ยนแปลงทั้งหมดของเราจะถูกเก็บไว้

เราบันทึกเวิร์กบุ๊กไปที่เส้นทางไดเร็กทอรีที่เรากำหนดไว้ก่อนหน้านี้
```csharp
// บันทึกไฟล์ Excel
excelbook.Save(dataDir + "book1.out.xls");
```
และเสร็จเรียบร้อย! คุณได้เพิ่มรูปวงรีลงในเวิร์กชีต Excel และบันทึกไฟล์เรียบร้อยแล้ว
## บทสรุป
การเพิ่มรูปทรง เช่น วงรี ลงในแผ่นงาน Excel โดยใช้ Aspose.Cells สำหรับ .NET ไม่เพียงแต่จะตรงไปตรงมาเท่านั้น แต่ยังเป็นวิธีที่สนุกสนานในการปรับปรุงสเปรดชีตของคุณด้วยองค์ประกอบภาพเพิ่มเติม ไม่ว่าจะเพื่อจุดประสงค์ในการออกแบบหรือการเพิ่มองค์ประกอบที่คลิกได้ รูปทรงสามารถมีบทบาทสำคัญต่อลักษณะและการทำงานของไฟล์ Excel ของคุณ ดังนั้น ครั้งต่อไปที่คุณทำงานในโปรเจ็กต์ที่ต้องใช้แผ่นงาน Excel ที่มีการโต้ตอบหรือดึงดูดสายตา คุณจะรู้ดีว่าต้องเพิ่มวงรีที่สมบูรณ์แบบเหล่านั้นอย่างไร!
## คำถามที่พบบ่อย
### ฉันสามารถเพิ่มรูปร่างอื่นๆ เช่น สี่เหลี่ยมผืนผ้าหรือเส้นโดยใช้ Aspose.Cells สำหรับ .NET ได้หรือไม่
ใช่ คุณสามารถเพิ่มรูปทรงต่างๆ เช่น สี่เหลี่ยมผืนผ้า เส้น และลูกศรได้โดยใช้ `Shapes` คอลเลกชันใน Aspose.Cells
### สามารถปรับขนาดวงรีหลังจากเพิ่มเข้าไปได้หรือไม่
แน่นอน! คุณสามารถปรับเปลี่ยนคุณสมบัติความสูงและความกว้างของรูปวงรีได้หลังจากเพิ่มเข้าไปแล้ว
### ฉันสามารถบันทึกเวิร์กบุ๊กในรูปแบบไฟล์ใดได้บ้างนอกเหนือจาก XLS?
Aspose.Cells รองรับหลายรูปแบบ เช่น XLSX, CSV และ PDF เป็นต้น
### ฉันสามารถปรับสีเส้นขอบของวงรีได้ไหม?
ใช่ คุณสามารถเปลี่ยนสีเส้นวงรีได้โดยใช้ `Line.Color` คุณสมบัติ.
### จำเป็นต้องมีใบอนุญาตสำหรับ Aspose.Cells หรือไม่?
ในขณะที่คุณสามารถทดลองใช้ Aspose.Cells ได้ด้วยการทดลองใช้ฟรี คุณจะต้องมี [ใบอนุญาต](https://purchase.aspose.com/buy) เพื่อการใช้งานในระยะยาวหรือสำหรับการเข้าถึงคุณสมบัติขั้นสูง

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}