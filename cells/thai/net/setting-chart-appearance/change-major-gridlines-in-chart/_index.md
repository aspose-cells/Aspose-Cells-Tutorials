---
title: การเปลี่ยนเส้นตารางหลักในแผนภูมิ
linktitle: การเปลี่ยนเส้นตารางหลักในแผนภูมิ
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีการเปลี่ยนเส้นตารางหลักในแผนภูมิ Excel โดยใช้ Aspose.Cells สำหรับ .NET ด้วยคู่มือทีละขั้นตอนโดยละเอียดของเรา
weight: 11
url: /th/net/setting-chart-appearance/change-major-gridlines-in-chart/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# การเปลี่ยนเส้นตารางหลักในแผนภูมิ

## การแนะนำ

การสร้างแผนภูมิที่ดึงดูดสายตาใน Excel ถือเป็นสิ่งสำคัญสำหรับการนำเสนอข้อมูลอย่างมีประสิทธิภาพ ไม่ว่าคุณจะเป็นนักวิเคราะห์ข้อมูล ผู้จัดการโครงการ หรือเพียงแค่ผู้ที่สนใจในการแสดงข้อมูล การทำความเข้าใจเกี่ยวกับการปรับแต่งแผนภูมิสามารถปรับปรุงรายงานของคุณได้อย่างมาก ในบทความนี้ เราจะเรียนรู้วิธีการเปลี่ยนเส้นตารางหลักในแผนภูมิ Excel โดยใช้ไลบรารี Aspose.Cells สำหรับ .NET

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเริ่มต้น มีบางสิ่งบางอย่างที่คุณจะต้องมีเพื่อให้แน่ใจว่าจะได้รับประสบการณ์ราบรื่นในขณะที่ทำงานกับ Aspose.Cells:

- Visual Studio: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Visual Studio บนคอมพิวเตอร์ของคุณแล้ว นี่คือที่ที่คุณจะเขียนและรันโค้ดของคุณ
-  Aspose.Cells สำหรับ .NET: คุณสามารถดาวน์โหลด Aspose.Cells เวอร์ชันล่าสุดได้จาก[เว็บไซต์](https://releases.aspose.com/cells/net/) หากคุณต้องการทดลองใช้ก่อนซื้อ คุณอาจลองสมัครใช้งาน[ทดลองใช้งานฟรี](https://releases.aspose.com/).
- ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับการเขียนโปรแกรม C# จะทำให้ทำตามตัวอย่างในบทช่วยสอนนี้ได้ง่ายขึ้น

เมื่อคุณตั้งค่าทุกอย่างเสร็จเรียบร้อยแล้ว เราก็สามารถเริ่มเขียนโค้ดได้!

## แพ็คเกจนำเข้า

ในการใช้งาน Aspose.Cells ขั้นตอนแรกคือการนำเข้าแพ็คเกจที่จำเป็นในโปรเจ็กต์ C# ของคุณ เปิดโปรเจ็กต์ Visual Studio ของคุณแล้วใส่คำสั่ง using ต่อไปนี้ไว้ที่ด้านบนของไฟล์ C#:

```csharp
using Aspose.Cells;
using Aspose.Cells.Charts;
using System.Drawing;
```

แพ็คเกจเหล่านี้ช่วยให้คุณเข้าถึงคลาสและวิธีการที่คุณต้องการในการสร้างและปรับเปลี่ยนเวิร์กบุ๊กและแผนภูมิ Excel

ตอนนี้เรามาแบ่งกระบวนการออกเป็นขั้นตอนโดยละเอียดและทำตามได้ง่าย เราจะสร้างแผนภูมิแบบง่าย ๆ ที่มีข้อมูลบางส่วน จากนั้นเปลี่ยนสีของเส้นตารางหลัก

## ขั้นตอนที่ 1: ตั้งค่าไดเรกทอรีผลลัพธ์ของคุณ

สิ่งแรกที่คุณต้องทำคือกำหนดตำแหน่งที่จะบันทึกไฟล์ Excel เอาต์พุต โดยระบุเส้นทางไดเรกทอรีในโค้ดของคุณ:

```csharp
// ไดเรกทอรีผลลัพธ์
string outputDir = "Your Output Directory"; // อัปเดตตามเส้นทางที่คุณต้องการ
```

 แทนที่`"Your Output Directory"` ด้วยเส้นทางจริงที่คุณต้องการบันทึกไฟล์ของคุณ

## ขั้นตอนที่ 2: สร้างอินสแตนซ์ของวัตถุเวิร์กบุ๊ก

 ต่อไปคุณต้องสร้างอินสแตนซ์ใหม่ของ`Workbook` คลาส วัตถุนี้จะแสดงไฟล์ Excel ของคุณ ทำให้คุณสามารถจัดการเนื้อหาได้

```csharp
// การสร้างอินสแตนซ์ของวัตถุเวิร์กบุ๊ก
Workbook workbook = new Workbook();
```

บรรทัดโค้ดนี้จะเริ่มต้นเวิร์กบุ๊กใหม่ซึ่งจะให้พื้นที่ว่างสำหรับเวิร์กชีตและแผนภูมิของเรา

## ขั้นตอนที่ 3: เข้าถึงแผ่นงาน

 หลังจากสร้างเวิร์กบุ๊กแล้ว คุณสามารถเข้าถึงเวิร์กชีตเริ่มต้นได้ เวิร์กชีตใน Aspose เซลล์จะมีดัชนี ดังนั้น หากคุณต้องการเวิร์กชีตแรก ให้อ้างอิงตามดัชนี`0`.

```csharp
// การรับการอ้างอิงของเวิร์กชีตที่เพิ่มใหม่โดยส่งดัชนีชีตของมัน
Worksheet worksheet = workbook.Worksheets[0];
```

## ขั้นตอนที่ 4: เติมข้อมูลตัวอย่างลงในเวิร์กชีต

มาเพิ่มค่าตัวอย่างบางค่าลงในเซลล์เวิร์กชีต ซึ่งจะใช้เป็นข้อมูลสำหรับแผนภูมิของเรา ซึ่งถือเป็นเรื่องสำคัญเนื่องจากแผนภูมิจะอ้างอิงข้อมูลเหล่านี้

```csharp
// การเพิ่มค่าตัวอย่างลงในเซลล์
worksheet.Cells["A1"].PutValue(50);
worksheet.Cells["A2"].PutValue(100);
worksheet.Cells["A3"].PutValue(150);
worksheet.Cells["B1"].PutValue(60);
worksheet.Cells["B2"].PutValue(32);
worksheet.Cells["B3"].PutValue(50);
```

ที่นี่ เราป้อนค่าตัวเลขหลายค่าลงในเซลล์เฉพาะ คอลัมน์ "A" และ "B" มีจุดข้อมูลที่เราจะแสดงภาพ

## ขั้นตอนที่ 5: เพิ่มแผนภูมิลงในเวิร์กชีต

เมื่อมีข้อมูลพร้อมแล้ว ก็ถึงเวลาสร้างแผนภูมิ เราจะเพิ่มแผนภูมิคอลัมน์ที่แสดงชุดข้อมูลของเรา

```csharp
// การเพิ่มแผนภูมิลงในเวิร์กชีต
int chartIndex = worksheet.Charts.Add(Aspose.Cells.Charts.ChartType.Column, 5, 0, 25, 10);
```

ในโค้ดนี้ เราจะระบุประเภทของแผนภูมิ (ในกรณีนี้คือแผนภูมิคอลัมน์) และตำแหน่งที่เราต้องการวางไว้

## ขั้นตอนที่ 6: เข้าถึงอินสแตนซ์แผนภูมิ

 เมื่อเราสร้างแผนภูมิแล้ว เราจำเป็นต้องเข้าถึงอินสแตนซ์ของแผนภูมิเพื่อปรับเปลี่ยนคุณสมบัติ ซึ่งทำได้โดยการดึงข้อมูลผ่าน`Charts`ของสะสม.

```csharp
// การเข้าถึงอินสแตนซ์ของแผนภูมิที่เพิ่มใหม่
Aspose.Cells.Charts.Chart chart = worksheet.Charts[chartIndex];
```

## ขั้นตอนที่ 7: เพิ่มชุดข้อมูลลงในแผนภูมิ

ตอนนี้เราต้องผูกข้อมูลของเราเข้ากับแผนภูมิ ซึ่งต้องระบุเซลล์เป็นแหล่งข้อมูลสำหรับแผนภูมิ

```csharp
// การเพิ่ม SeriesCollection (แหล่งข้อมูลแผนภูมิ) ลงในแผนภูมิตั้งแต่เซลล์ "A1" ถึง "B3"
chart.NSeries.Add("A1:B3", true);
```

ในขั้นตอนนี้ เราจะแจ้งให้แผนภูมิทราบถึงช่วงข้อมูลที่ควรจะแสดง

## ขั้นตอนที่ 8: ปรับแต่งลักษณะแผนภูมิ

มาทำให้แผนภูมิของเราดูดีขึ้นสักหน่อยด้วยการเปลี่ยนสีของพื้นที่พล็อต พื้นที่แผนภูมิ และคอลเล็กชันซีรีส์ การทำเช่นนี้จะช่วยให้แผนภูมิของเราโดดเด่นและสวยงามขึ้น

```csharp
// การกำหนดสีพื้นหน้าของพื้นที่พล็อต
chart.PlotArea.Area.ForegroundColor = Color.Blue;

// การตั้งค่าสีพื้นหน้าของพื้นที่แผนภูมิ
chart.ChartArea.Area.ForegroundColor = Color.Yellow;

// การตั้งค่าสีพื้นหน้าของพื้นที่ SeriesCollection แรก
chart.NSeries[0].Area.ForegroundColor = Color.Red;

// การกำหนดสีพื้นหน้าของพื้นที่จุดรวบรวมซีรี่ส์ที่ 1
chart.NSeries[0].Points[0].Area.ForegroundColor = Color.Cyan;

// การเติมพื้นที่ของ 2nd SeriesCollection ด้วยการไล่ระดับสี
chart.NSeries[1].Area.FillFormat.SetOneColorGradient(Color.Lime, 1, Aspose.Cells.Drawing.GradientStyleType.Horizontal, 1);
```

ในโค้ดนี้ เราตั้งค่าสีต่างๆ ให้กับส่วนต่างๆ ของแผนภูมิ การปรับแต่งลักษณะที่ปรากฏสามารถทำให้ข้อมูลของคุณน่าสนใจยิ่งขึ้น!

## ขั้นตอนที่ 9: เปลี่ยนสีเส้นตารางหลัก

ตอนนี้มาถึงกิจกรรมหลักแล้ว! เพื่อเพิ่มความสามารถในการอ่าน เราจะเปลี่ยนสีของเส้นตารางหลักตามแกนทั้งสองของแผนภูมิของเรา

```csharp
// การตั้งค่าสีของเส้นตารางหลักของแกนหมวดหมู่เป็นสีเงิน
chart.CategoryAxis.MajorGridLines.Color = Color.Silver;

// การตั้งค่าสีของเส้นตารางหลักของแกนค่าเป็นสีแดง
chart.ValueAxis.MajorGridLines.Color = Color.Red;
```

คำสั่งเหล่านี้จะกำหนดเส้นตารางหลักสำหรับแกนหมวดหมู่และแกนค่าเป็นสีเงินและสีแดงตามลำดับ การแยกความแตกต่างนี้ช่วยให้ผู้ชมสามารถติดตามเส้นตารางทั่วทั้งแผนภูมิได้อย่างง่ายดาย

## ขั้นตอนที่ 10: บันทึกสมุดงาน

หลังจากทำการปรับเปลี่ยนทั้งหมดแล้ว ก็ถึงเวลาบันทึกเวิร์กบุ๊ก นี่คือขั้นตอนสุดท้ายที่จะทำให้ความพยายามของคุณประสบผลสำเร็จ

```csharp
// การบันทึกไฟล์ Excel
workbook.Save(outputDir + "outputChangingMajorGridlinesInChart.xlsx");
```

บรรทัดนี้จะบันทึกไฟล์ Excel ที่คุณเพิ่งสร้างไปยังไดเร็กทอรีเอาต์พุตที่ระบุโดยมีชื่อที่สะท้อนถึงวัตถุประสงค์ของไฟล์นั้น

## ขั้นตอนที่ 11: ข้อความยืนยัน

สุดท้ายนี้เรามาเพิ่มข้อความเพื่อยืนยันว่างานของเราสำเร็จแล้ว:

```csharp
Console.WriteLine("Changing Major Gridlines in Chart executed successfully.");
```

เอาท์พุตคอนโซลที่เรียบง่ายนี้จะแจ้งให้คุณทราบว่าโปรแกรมของคุณทำงานได้อย่างถูกต้องโดยไม่มีสะดุดใดๆ

## บทสรุป

และแล้วคุณก็ทำได้! คุณได้เรียนรู้วิธีการเปลี่ยนเส้นตารางหลักในแผนภูมิโดยใช้ Aspose.Cells สำหรับ .NET สำเร็จแล้ว โดยทำตามคำแนะนำทีละขั้นตอนนี้ คุณไม่เพียงแต่จะจัดการไฟล์ Excel ด้วยโปรแกรมเท่านั้น แต่ยังปรับปรุงความสวยงามของภาพด้วยการปรับแต่งสีอีกด้วย อย่าลังเลที่จะทดลองใช้ Aspose.Cells เพิ่มเติมเพื่อพัฒนาทักษะการนำเสนอข้อมูลของคุณและทำให้แผนภูมิของคุณมีชีวิตชีวามากยิ่งขึ้น!

## คำถามที่พบบ่อย

### Aspose.Cells คืออะไร?  
Aspose.Cells คือไลบรารี .NET ที่ได้รับการออกแบบมาสำหรับการสร้าง จัดการ และจัดการไฟล์ Excel ด้วยโปรแกรม

### ฉันสามารถทดลองใช้ Aspose.Cells ฟรีได้หรือไม่?  
 ใช่ คุณสามารถสมัครทดลองใช้งานฟรีได้[ที่นี่](https://releases.aspose.com/).

### ฉันจะเปลี่ยนแปลงองค์ประกอบอื่นในแผนภูมิโดยใช้ Aspose.Cells ได้อย่างไร  
 คุณสามารถปรับแต่งคุณสมบัติแผนภูมิต่างๆ ได้ในลักษณะเดียวกันโดยเข้าถึงองค์ประกอบแผนภูมิผ่านทาง`Chart` คลาส เช่น ชื่อ คำอธิบาย และป้ายข้อมูล

### Aspose.Cells รองรับรูปแบบไฟล์อะไรบ้าง?  
Aspose.Cells รองรับรูปแบบไฟล์หลายรูปแบบ รวมถึง XLSX, XLS, CSV และอื่นๆ

### ฉันสามารถหาเอกสารสำหรับ Aspose.Cells ได้ที่ไหน  
 คุณสามารถดูเอกสารรายละเอียดได้ที่[เอกสารประกอบ Aspose.Cells](https://reference.aspose.com/cells/net/).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
