---
"description": "เรียนรู้วิธีการคำนวณสีที่เลือกโดย MS Excel โดยใช้ Aspose.Cells สำหรับ .NET ปฏิบัติตามคำแนะนำทีละขั้นตอนนี้เพื่อเข้าถึงโปรแกรมการจัดรูปแบบตามเงื่อนไขสีของ Excel"
"linktitle": "คำนวณสีที่เลือกโดยโปรแกรม MS Excel"
"second_title": "API การประมวลผล Excel ของ Aspose.Cells .NET"
"title": "คำนวณสีที่เลือกโดยโปรแกรม MS Excel"
"url": "/th/net/color-settings-and-customization-in-excel/compute-color-chosen-by-ms-excel/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# คำนวณสีที่เลือกโดยโปรแกรม MS Excel

## การแนะนำ
คุณเคยทำงานกับไฟล์ Excel และสงสัยหรือไม่ว่าสีบางสีจะถูกเลือกโดยอัตโนมัติเพื่อจัดรูปแบบอย่างไร คุณไม่ได้เป็นคนเดียว การจัดรูปแบบตามเงื่อนไขของ Excel อาจเป็นปริศนาเล็กน้อย โดยเฉพาะอย่างยิ่งเมื่อพยายามแยกสีที่แน่นอนที่ Excel กำหนด แต่ไม่ต้องกังวล เรามีคำตอบให้คุณ! ในบทช่วยสอนนี้ เราจะเจาะลึกถึงวิธีคำนวณสีที่เลือกโดย MS Excel โดยใช้ Aspose.Cells สำหรับ .NET เราจะอธิบายทีละขั้นตอนเพื่อให้คุณทำตามและนำไปใช้กับโปรเจ็กต์ของคุณเองได้อย่างง่ายดาย มาเริ่มกันเลย!
## ข้อกำหนดเบื้องต้น
ก่อนที่จะเจาะลึกโค้ด มาดูสิ่งที่คุณจะต้องปฏิบัติตามบทช่วยสอนนี้กันก่อน:
- ติดตั้ง Aspose.Cells สำหรับ .NET แล้ว หากคุณยังไม่มี คุณสามารถทำได้ [ดาวน์โหลดได้ที่นี่](https://releases-aspose.com/cells/net/).
- ความรู้ในการใช้งาน C# และ .NET framework
- ไฟล์ Excel ตัวอย่าง (Book1.xlsx) พร้อมการจัดรูปแบบตามเงื่อนไข
คุณสามารถทดลองใช้ Aspose.Cells สำหรับ .NET รุ่นทดลองใช้งานฟรีได้หากคุณยังไม่มีใบอนุญาต ดาวน์โหลดเวอร์ชันทดลองใช้งาน [ที่นี่](https://releases-aspose.com/).
## แพ็คเกจนำเข้า
ก่อนที่เราจะเริ่มเขียนโค้ด เราจะต้องนำเข้าแพ็คเกจที่จำเป็นเพื่อให้แน่ใจว่าทุกอย่างทำงานได้อย่างราบรื่น ตรวจสอบให้แน่ใจว่าคุณได้รวมเนมสเปซต่อไปนี้ไว้ในโปรเจ็กต์ของคุณ:
```csharp
using System.IO;
using Aspose.Cells;
using System.Drawing;
using System;
```
การนำเข้าเหล่านี้ช่วยให้สามารถเข้าถึงคลาส Aspose.Cells หลักและไลบรารีการวาดระบบดั้งเดิมของ .NET เพื่อการจัดการสี

ตอนนี้เรามีทุกอย่างลงตัวแล้ว มาแบ่งงานนี้เป็นขั้นตอนย่อยๆ กันดังนี้:
## ขั้นตอนที่ 1: ตั้งค่าวัตถุเวิร์กบุ๊ก
สิ่งแรกที่เราต้องทำคือสร้างตัวอย่าง `Workbook` วัตถุและโหลดไฟล์ Excel ที่เราต้องการใช้ นี่คือจุดเริ่มต้นของการเดินทาง!
```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "Your Document Directory";
// สร้างอินสแตนซ์ของวัตถุเวิร์กบุ๊กและเปิดไฟล์เทมเพลต
Workbook workbook = new Workbook(dataDir + "Book1.xlsx");
```
ในขั้นตอนนี้ เรากำลังสร้างอินสแตนซ์ใหม่ของ `Workbook` คลาสจาก Aspose.Cells `Workbook` คลาสนี้แสดงถึงไฟล์ Excel และด้วยการระบุเส้นทางไปยังไฟล์ของเรา เราก็สามารถโหลดเพื่อการจัดการเพิ่มเติมได้อย่างง่ายดาย
## ขั้นตอนที่ 2: เข้าถึงแผ่นงานแรก
เมื่อโหลดเวิร์กบุ๊กแล้ว เราจำเป็นต้องเข้าถึงเวิร์กชีตที่ต้องการแยกสี ในตัวอย่างนี้ เราจะทำงานกับชีตแรก
```csharp
// รับแผ่นงานแรก
Worksheet worksheet = workbook.Worksheets[0];
```
ที่นี่เรากำลังดึงเวิร์กชีตแรกในเวิร์กบุ๊กโดยใช้ `Worksheets[0]` ดัชนี Aspose.Cells ช่วยให้คุณสามารถเข้าถึงเวิร์กชีตใดๆ ในไฟล์ Excel ได้โดยใช้ดัชนีหรือชื่อ
## ขั้นตอนที่ 3: เลือกเซลล์ที่สนใจ
ต่อไปเราจะเลือกเซลล์เฉพาะในเวิร์กชีต สำหรับบทช่วยสอนนี้ เราจะเน้นที่เซลล์ "A1" แต่คุณสามารถเลือกเซลล์ใดก็ได้โดยใช้การจัดรูปแบบตามเงื่อนไข
```csharp
// รับเซลล์ A1
Cell a1 = worksheet.Cells["A1"];
```
เราใช้ `Cells` คุณสมบัติในการอ้างอิงเซลล์เฉพาะตามที่อยู่ ในกรณีนี้ เราเลือกเซลล์ "A1" เพราะเราต้องการแยกผลลัพธ์การจัดรูปแบบตามเงื่อนไขที่ใช้กับเซลล์นี้
## ขั้นตอนที่ 4: ดึงผลลัพธ์การจัดรูปแบบตามเงื่อนไข
นี่คือจุดที่เวทมนตร์เกิดขึ้น! เราจะใช้ Aspose.Cells เพื่อดึงผลลัพธ์การจัดรูปแบบตามเงื่อนไขสำหรับเซลล์ที่เลือก นี่คือวิธีที่ Excel คำนวณการจัดรูปแบบแบบไดนามิก รวมถึงสี
```csharp
// รับวัตถุผลลัพธ์การจัดรูปแบบตามเงื่อนไข
ConditionalFormattingResult cfr1 = a1.GetConditionalFormattingResult();
```
การ `GetConditionalFormattingResult()` วิธีการนี้มีความสำคัญอย่างยิ่งในขั้นตอนนี้ โดยจะส่งคืนอ็อบเจ็กต์ที่มีผลลัพธ์ของการจัดรูปแบบตามเงื่อนไขที่นำไปใช้กับเซลล์ นี่คือจุดที่เราเริ่มแตะข้อมูลสีที่ Excel กำลังใช้
## ขั้นตอนที่ 5: เข้าถึง ColorScaleResult
เมื่อเราได้รับผลลัพธ์การจัดรูปแบบตามเงื่อนไขแล้ว เราสามารถเจาะลึกและเข้าถึงมาตราส่วนสีที่ Excel ใช้สำหรับเซลล์นี้โดยเฉพาะได้
```csharp
// รับวัตถุสีผลลัพธ์ ColorScale
Color c = cfr1.ColorScaleResult;
```
การจัดรูปแบบตามเงื่อนไขใน Excel มักจะใช้มาตราส่วนสี บรรทัดนี้ช่วยให้เราสามารถแยกสีที่ได้ซึ่งใช้ตามกฎการจัดรูปแบบตามเงื่อนไขได้
## ขั้นตอนที่ 6: ส่งออกข้อมูลสี
สุดท้ายนี้ เราต้องการดูสีที่ Excel ใช้ ให้พิมพ์รายละเอียดสีในรูปแบบที่เข้าใจง่าย รวมทั้งค่า ARGB และชื่อสี
```csharp
// อ่านสี
Console.WriteLine(c.ToArgb().ToString());
Console.WriteLine(c.Name);
```
การ `ToArgb()` วิธีการนี้ทำให้เราได้สีในรูปแบบ ARGB (อัลฟ่า, แดง, เขียว, น้ำเงิน) ในขณะที่ `Name` คุณสมบัตินี้ให้ชื่อสีในรูปแบบที่มนุษย์สามารถอ่านได้ง่ายขึ้น คุณสามารถใช้รายละเอียดสีเหล่านี้เพื่อจับคู่กับสีในแอปพลิเคชันอื่นหรือปรับเปลี่ยนไฟล์ Excel ของคุณโดยใช้โปรแกรม

## บทสรุป
และแล้วคุณก็ทำได้! ด้วยการทำตามขั้นตอนเหล่านี้ คุณจะได้เรียนรู้วิธีการคำนวณสีที่เลือกโดยโปรแกรม MS Excel โดยใช้ Aspose.Cells สำหรับ .NET แนวทางนี้สามารถเป็นประโยชน์อย่างยิ่งในการทำงานอัตโนมัติของงานที่ใช้ Excel โดยเฉพาะอย่างยิ่งเมื่อต้องจัดการกับการจัดรูปแบบตามเงื่อนไขที่ซับซ้อน ครั้งต่อไปที่คุณพบสีลึกลับใน Excel คุณจะรู้ทันทีว่าจะเปิดเผยความลับของสีเหล่านั้นอย่างไร
## คำถามที่พบบ่อย
### ฉันสามารถใช้การจัดรูปแบบตามเงื่อนไขในการเขียนโปรแกรมโดยใช้ Aspose.Cells ได้หรือไม่
ใช่ Aspose.Cells ช่วยให้คุณสามารถใช้ แก้ไข และแม้แต่ลบการจัดรูปแบบตามเงื่อนไขในไฟล์ Excel ได้โดยโปรแกรม
### Aspose.Cells รองรับ Excel ทุกเวอร์ชันหรือไม่
แน่นอน! Aspose.Cells รองรับ Excel 97-2003 (XLS), Excel 2007-2019/365 (XLSX) และรูปแบบอื่นๆ อีกมากมาย รวมถึง PDF, HTML และ CSV
### Aspose.Cells สามารถใช้ได้กับแพลตฟอร์มอื่นนอกเหนือจาก .NET หรือไม่
ใช่ Aspose.Cells พร้อมใช้งานสำหรับแพลตฟอร์มต่างๆ รวมถึง Java, C++ และ Android ผ่าน Java
### ฉันจะได้รับทดลองใช้ Aspose.Cells ฟรีได้อย่างไร?
คุณสามารถดาวน์โหลดรุ่นทดลองใช้งานฟรีของ Aspose.Cells สำหรับ .NET ได้จาก [ที่นี่](https://releases-aspose.com/).
### ฉันจะจัดการไฟล์ Excel ขนาดใหญ่ด้วย Aspose.Cells ได้อย่างไร
Aspose.Cells ได้รับการปรับให้เหมาะสมเพื่อประสิทธิภาพการทำงาน แม้จะจัดการกับไฟล์ขนาดใหญ่ คุณสามารถใช้ API สตรีมมิ่งเพื่อจัดการข้อมูลขนาดใหญ่ได้อย่างมีประสิทธิภาพ

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}