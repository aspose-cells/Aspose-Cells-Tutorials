---
"description": "ทำให้งาน Excel ของคุณเป็นแบบอัตโนมัติด้วย Aspose.Cells สำหรับ .NET เรียนรู้การคำนวณสูตรด้วยโปรแกรมในบทช่วยสอนที่ครอบคลุมนี้"
"linktitle": "การคำนวณสูตรในโปรแกรม Excel"
"second_title": "API การประมวลผล Excel ของ Aspose.Cells .NET"
"title": "การคำนวณสูตรในโปรแกรม Excel"
"url": "/th/net/excel-formulas-and-calculation-options/calculating-formulas/"
"weight": 11
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# การคำนวณสูตรในโปรแกรม Excel

## การแนะนำ
ในโลกปัจจุบันที่ข้อมูลเป็นปัจจัยสำคัญ การทำให้การทำงานอัตโนมัติสามารถประหยัดเวลาและเพิ่มประสิทธิภาพได้ โดยเฉพาะเมื่อต้องจัดการกับสเปรดชีต หากคุณเคยใช้สูตรที่ซับซ้อนใน Excel มาก่อน คุณคงทราบดีว่าการใช้สูตรให้ถูกต้องนั้นสำคัญเพียงใด ด้วยการใช้ Aspose.Cells สำหรับ .NET คุณสามารถคำนวณสูตรและจัดการไฟล์ Excel ได้อย่างง่ายดายด้วยโปรแกรม ในบทช่วยสอนนี้ เราจะแนะนำแต่ละขั้นตอนที่เกี่ยวข้องกับการสร้างไฟล์ Excel การเพิ่มค่าและสูตร และการคำนวณสูตรเหล่านั้นด้วย C# เล็กน้อย มาเริ่มกันเลย!
## ข้อกำหนดเบื้องต้น
ก่อนที่เราจะเริ่ม คุณจะต้องตรวจสอบให้แน่ใจว่าคุณมีบางสิ่งที่เตรียมไว้แล้ว:
1. สภาพแวดล้อมการพัฒนา: ตรวจสอบให้แน่ใจว่าคุณมี Visual Studio หรือสภาพแวดล้อม C# อื่นๆ ที่คุณสามารถรันแอปพลิเคชัน .NET ได้
2. Aspose.Cells สำหรับ .NET: ดาวน์โหลดและติดตั้งไลบรารี Aspose.Cells คุณสามารถรับได้จาก [เว็บไซต์อาโพส](https://releases-aspose.com/cells/net/).
3. ความเข้าใจพื้นฐานเกี่ยวกับ C#: ความรู้พื้นฐานเกี่ยวกับ C# จะช่วยให้คุณเข้าใจแนวคิดและตัวอย่างโค้ดที่เราจะใช้
4. .NET Framework: ตรวจสอบให้แน่ใจว่าได้ติดตั้ง .NET Framework เวอร์ชันที่เหมาะสมบนเครื่องของคุณ
5. ใบอนุญาต Aspose.Cells: หากคุณต้องการใช้เกินกว่าช่วงทดลองใช้งานฟรี โปรดพิจารณารับ [ใบอนุญาตชั่วคราว](https://purchase-aspose.com/temporary-license/).
ตอนนี้เรามีทุกอย่างพร้อมแล้ว มาดูโค้ดและแยกรายละเอียดทีละขั้นตอนกัน!
## แพ็คเกจนำเข้า
ก่อนที่จะเขียนโค้ดใดๆ ให้แน่ใจว่าคุณได้นำเข้าเนมสเปซที่จำเป็นสำหรับ Aspose.Cells ในไฟล์ C# ของคุณแล้ว:
```csharp
using System.IO;
using Aspose.Cells;
```
สิ่งนี้ช่วยให้คุณเข้าถึงฟังก์ชันต่างๆ ที่ไลบรารี Aspose.Cells จัดเตรียมไว้เพื่อจัดการไฟล์ Excel ได้
## ขั้นตอนที่ 1: ตั้งค่าไดเรกทอรีเอกสาร
เริ่มต้นด้วยการกำหนดเส้นทางที่คุณต้องการบันทึกเอกสาร Excel ของคุณ สิ่งสำคัญคือต้องแน่ใจว่ามีไดเรกทอรีนี้อยู่ หรือสร้างขึ้นใหม่หากไม่มี
```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "Your Document Directory";
// สร้างไดเรกทอรีหากยังไม่มีอยู่
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
ในขั้นตอนนี้ คุณกำลังตรวจสอบว่าไดเรกทอรีมีอยู่หรือไม่ หากไม่มี คุณกำลังสร้างไดเรกทอรีนั้นขึ้นมา ขั้นตอนง่ายๆ นี้จะช่วยหลีกเลี่ยงข้อผิดพลาดเมื่อคุณพยายามบันทึกไฟล์ Excel ในภายหลัง
## ขั้นตอนที่ 2: สร้างอินสแตนซ์ของวัตถุเวิร์กบุ๊ก
## การสร้างสมุดงานใหม่
ตอนนี้ไดเรกทอรีของคุณได้รับการตั้งค่าแล้ว มาสร้างวัตถุเวิร์กบุ๊กที่แสดงไฟล์ Excel ของคุณกัน:
```csharp
// การสร้างอินสแตนซ์ของวัตถุเวิร์กบุ๊ก
Workbook workbook = new Workbook();
```
บรรทัดนี้จะสร้างเวิร์กบุ๊กใหม่ในหน่วยความจำ ลองนึกภาพว่ากำลังเปิดไฟล์ Excel เปล่าๆ ขึ้นมาเพื่อเริ่มเพิ่มข้อมูลและสูตรต่างๆ
## ขั้นตอนที่ 3: เพิ่มเวิร์กชีตใหม่
## การทำงานกับแผ่นงาน
ในเวิร์กบุ๊กของเรา เราต้องการเพิ่มเวิร์กชีตใหม่ที่เราสามารถจัดการข้อมูลได้ โดยทำได้ดังนี้:
```csharp
// การเพิ่มเวิร์กชีตใหม่ลงในวัตถุ Excel
int sheetIndex = workbook.Worksheets.Add();
// การรับข้อมูลอ้างอิงของเวิร์กชีตที่เพิ่มใหม่โดยส่งดัชนีชีตของมัน
Worksheet worksheet = workbook.Worksheets[sheetIndex];
```
ขั้นแรก คุณเพิ่มเวิร์กชีตใหม่ ซึ่งจะแสดงดัชนีของชีตนั้นโดยอัตโนมัติ ขั้นต่อไป คุณจะเรียกค้นเวิร์กชีตนั้นโดยใช้ดัชนี ซึ่งก็เหมือนกับการเปิดแท็บใหม่ในเวิร์กบุ๊ก Excel ของคุณนั่นเอง!
## ขั้นตอนที่ 4: แทรกค่าลงในเซลล์
## การเติมข้อมูล
ตอนนี้เราได้สร้างเวิร์กชีตแล้ว เราต้องเพิ่มข้อมูลบางอย่างลงไป:
```csharp
// การเพิ่มค่าลงในเซลล์ "A1"
worksheet.Cells["A1"].PutValue(1);
// การเพิ่มค่าลงในเซลล์ "A2"
worksheet.Cells["A2"].PutValue(2);
// การเพิ่มค่าลงในเซลล์ "A3"
worksheet.Cells["A3"].PutValue(3);
```
ในขั้นตอนนี้ คุณจะแทรกค่าลงในเซลล์สามเซลล์แรก (A1, A2, A3) ของเวิร์กชีต การดำเนินการนี้จะคล้ายกับการพิมพ์ค่าลงในแผ่นงาน Excel โดยตรง 
## ขั้นตอนที่ 5: เพิ่มสูตร
## การรวมค่า
หลังจากป้อนค่าแล้ว ก็ถึงเวลาเพิ่มสูตรที่คำนวณผลรวมของเซลล์เหล่านี้ วิธีการมีดังนี้:
```csharp
// การเพิ่มสูตร SUM ลงในเซลล์ "A4"
worksheet.Cells["A4"].Formula = "=SUM(A1:A3)";
```
โค้ดบรรทัดนี้จะผนวกสูตร SUM ลงในเซลล์ A4 ซึ่งจะรวมค่าตั้งแต่ A1 ถึง A3 เหมือนกับการเขียนสูตรใน Excel แต่ใช้การเขียนโปรแกรม!
## ขั้นตอนที่ 6: คำนวณสูตร
## การดำเนินการคำนวณ
ตอนนี้มาถึงช่วงเวลาแห่งความจริงแล้ว! เราจำเป็นต้องคำนวณผลลัพธ์จากสูตรที่เราป้อนเข้าไป:
```csharp
// การคำนวณผลลัพธ์ของสูตร
workbook.CalculateFormula();
```
โดยการโทร `CalculateFormula()`คุณกำลังสั่งให้เวิร์กบุ๊กประมวลผลสูตรทั้งหมดในนั้น ซึ่งก็คล้ายกับการกด "Enter" หลังจากพิมพ์สูตรในเซลล์ Excel
## ขั้นตอนที่ 7: ดึงค่าที่คำนวณได้
## การอ่านผลลัพธ์
เมื่อคำนวณสูตรแล้ว เราสามารถดึงค่าจาก A4 ได้:
```csharp
// รับค่าที่คำนวณได้ของเซลล์
string value = worksheet.Cells["A4"].Value.ToString();
```
ในขั้นตอนนี้ คุณจะได้รับผลลัพธ์จากสูตร SUM ซึ่งจะได้ผลรวม 1 + 2 + 3 ซึ่งก็คือ 6!
## ขั้นตอนที่ 8: บันทึกไฟล์ Excel
## การเขียนลงดิสก์
สุดท้าย ให้บันทึกสมุดงานไปยังไดเร็กทอรีที่ระบุ เพื่อให้คุณสามารถเข้าถึงได้ในภายหลัง:
```csharp
// การบันทึกไฟล์ Excel
workbook.Save(dataDir + "output.xls");
```
รหัสนี้จะบันทึกไฟล์ Excel ของคุณด้วยชื่อ "output.xls" ในไดเรกทอรีที่คุณระบุ เหมือนกับการคลิก "บันทึกเป็น" ใน Excel และเลือกตำแหน่งที่จะเก็บไฟล์ของคุณ
## บทสรุป
ในบทช่วยสอนนี้ เราได้กล่าวถึงวิธีการสร้างไฟล์ Excel ด้วยโปรแกรมโดยใช้ Aspose.Cells สำหรับ .NET ตั้งแต่การเพิ่มค่าและสูตรไปจนถึงการคำนวณและบันทึกผลลัพธ์สุดท้าย เราได้อธิบายขั้นตอนสำคัญแต่ละขั้นตอนเพื่อให้แน่ใจว่าคุณมีพื้นฐานที่มั่นคงสำหรับการทำงานอัตโนมัติในอนาคต
## คำถามที่พบบ่อย
### Aspose.Cells สำหรับ .NET คืออะไร?
Aspose.Cells สำหรับ .NET เป็นไลบรารีที่ช่วยให้นักพัฒนาสามารถจัดการเอกสาร Excel ในโปรแกรมแอปพลิเคชัน .NET ได้
### ฉันสามารถประเมินสูตรใน Excel โดยใช้ Aspose.Cells ได้หรือไม่
ใช่! คุณสามารถใช้ Aspose.Cells เพื่อคำนวณและประเมินสูตรได้เช่นเดียวกับที่คุณทำใน Excel
### มีรุ่นทดลองใช้งานฟรีสำหรับ Aspose.Cells หรือไม่
แน่นอน! คุณสามารถทดลองใช้งานฟรีได้ [ที่นี่](https://releases-aspose.com/).
### ฉันสามารถจัดการไฟล์ Excel ที่มีอยู่ด้วย Aspose.Cells ได้หรือไม่
ใช่ Aspose.Cells ช่วยให้คุณโหลดไฟล์ Excel ที่มีอยู่และปรับเปลี่ยนตามต้องการได้
### ฉันสามารถหาเอกสารเพิ่มเติมเกี่ยวกับ Aspose.Cells สำหรับ .NET ได้จากที่ใด
คุณสามารถค้นหาเอกสารประกอบที่ครอบคลุมได้ [ที่นี่](https://reference-aspose.com/cells/net/).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}