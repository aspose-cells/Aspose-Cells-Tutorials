---
"description": "เรียนรู้วิธีขัดจังหวะการคำนวณสูตร Excel โดยใช้ Aspose.Cells สำหรับ .NET ในคู่มือทีละขั้นตอนโดยละเอียดนี้"
"linktitle": "การขัดจังหวะหรือยกเลิกการคำนวณสูตรของสมุดงาน"
"second_title": "API การประมวลผล Excel ของ Aspose.Cells .NET"
"title": "การขัดจังหวะหรือยกเลิกการคำนวณสูตรของสมุดงาน"
"url": "/th/net/excel-formulas-and-calculation-options/interrupt-or-cancel-formula-calculation-of-workbook/"
"weight": 15
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# การขัดจังหวะหรือยกเลิกการคำนวณสูตรของสมุดงาน

## การแนะนำ
คุณเบื่อกับการคำนวณ Excel ของคุณที่ใช้เวลานานกว่าที่ควรหรือไม่ บางครั้งคุณอาจต้องการหยุดหรือขัดจังหวะการคำนวณสูตรที่ยาวนานในสมุดงานของคุณ ไม่ว่าคุณจะกำลังจัดการกับชุดข้อมูลขนาดใหญ่หรือสูตรที่ซับซ้อน การรู้วิธีควบคุมกระบวนการนี้สามารถประหยัดเวลาและความยุ่งยากของคุณได้มาก ในบทความนี้ เราจะแนะนำวิธีการใช้ Aspose.Cells สำหรับ .NET เพื่อขัดจังหวะหรือยกเลิกการคำนวณสูตรในสมุดงาน Excel ของคุณอย่างมีประสิทธิภาพ 
## ข้อกำหนดเบื้องต้น
ก่อนที่จะเริ่มบทช่วยสอน เรามาตรวจสอบกันก่อนว่าคุณได้ตั้งค่าทุกอย่างเรียบร้อยแล้ว:
1. Visual Studio: คุณต้องติดตั้ง Visual Studio ไว้ในเครื่องของคุณ เวอร์ชันใดก็ได้ที่รองรับการพัฒนา .NET ก็ใช้ได้
2. Aspose.Cells สำหรับ .NET: ดาวน์โหลดและติดตั้งไลบรารี Aspose.Cells จาก [ที่นี่](https://releases-aspose.com/cells/net/).
3. ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับภาษาการเขียนโปรแกรม C# จะเป็นประโยชน์เนื่องจากเราจะได้เขียนโค้ดสั้นๆ ร่วมกัน
4. ไฟล์ Excel: สำหรับบทช่วยสอนนี้ เราจะอ้างอิงไฟล์ Excel ตัวอย่างชื่อ `sampleCalculationMonitor.xlsx`. ตรวจสอบให้แน่ใจว่าคุณมีมันอยู่ในไดเร็กทอรีการบ้านของคุณ
เมื่อคุณมีสิ่งเหล่านี้ทั้งหมดแล้ว เราก็สามารถเริ่มเขียนโค้ดได้ทันที!
## แพ็คเกจนำเข้า
ในโปรเจ็กต์ Visual Studio ของคุณ คุณจะต้องนำเข้าเนมสเปซหลายรายการที่เกี่ยวข้องกับ Aspose.Cells ต่อไปนี้คือแพ็คเกจที่คุณต้องการรวมไว้ที่ด้านบนของไฟล์โค้ด:
```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```
โดยการรวมเนมสเปซเหล่านี้ คุณจะสามารถเข้าถึงคลาสและวิธีการที่จำเป็นในการจัดการเวิร์กบุ๊ก Excel ได้
ตอนนี้คุณได้เตรียมข้อกำหนดเบื้องต้นและแพ็คเกจต่างๆ ไว้เรียบร้อยแล้ว เรามาแบ่งงานออกเป็นขั้นตอนที่จัดการได้ แต่ละขั้นตอนจะมีหัวข้อและคำอธิบายสั้นๆ
## ขั้นตอนที่ 1: การตั้งค่าสมุดงานของคุณ
ขั้นแรก คุณต้องโหลดเวิร์กบุ๊กของคุณ นี่คือไฟล์ที่ประกอบด้วยการคำนวณที่คุณอาจต้องการขัดจังหวะ ดังต่อไปนี้:
```csharp
// ไดเรกทอรีแหล่งที่มา
string sourceDir = "Your Document Directory"; // อัปเดตด้วยเส้นทางไดเร็กทอรีจริงของคุณ
Workbook wb = new Workbook(sourceDir + "sampleCalculationMonitor.xlsx");
```
ในขั้นตอนนี้เราจะสร้าง `Workbook` โดยชี้ไปที่ไฟล์ Excel ของเรา การดำเนินการดังกล่าวจะเริ่มต้นขึ้นทันที
## ขั้นตอนที่ 2: สร้างตัวเลือกการคำนวณ
ต่อไปเราจะสร้างตัวเลือกการคำนวณและจับคู่กับคลาสมอนิเตอร์การคำนวณ ซึ่งเป็นสิ่งสำคัญสำหรับการควบคุมวิธีการทำงานการคำนวณของเรา
```csharp
CalculationOptions opts = new CalculationOptions();
opts.CalculationMonitor = new clsCalculationMonitor();
```
ที่นี่เราจะสร้างตัวอย่าง `CalculationOptions` และมอบหมาย `clsCalculationMonitor` — คลาสแบบกำหนดเองที่เราจะกำหนดต่อไป ซึ่งจะช่วยให้เราตรวจสอบการคำนวณและใช้การขัดจังหวะได้
## ขั้นตอนที่ 3: การนำ Calculation Monitor มาใช้
ตอนนี้เรามาสร้างของเรากัน `clsCalculationMonitor` คลาส คลาสนี้จะสืบทอดมาจาก `AbstractCalculationMonitor` และจะบรรจุตรรกะของเราไว้เพื่อขัดขวางการคำนวณ
```csharp
class clsCalculationMonitor : AbstractCalculationMonitor
{
    public override void BeforeCalculate(int sheetIndex, int rowIndex, int colIndex)
    {
        // ค้นหาชื่อเซลล์
        string cellName = CellsHelper.CellIndexToName(rowIndex, colIndex);
        // พิมพ์ดัชนีแผ่นงาน แถว และคอลัมน์ รวมถึงชื่อเซลล์
        System.Diagnostics.Debug.WriteLine(sheetIndex + "----" + rowIndex + "----" + colIndex + "----" + cellName);
        // ถ้าชื่อเซลล์คือ B8 ให้ขัดจังหวะ/ยกเลิกการคำนวณสูตร
        ถ้า (cellName == "B8")
        {
            this.Interrupt("Interrupt/Cancel the formula calculation");
        } // if
    } // ก่อนการคำนวณ
} // cls คำนวณมอนิเตอร์
```
ในคลาสนี้เราจะแทนที่ `BeforeCalculate` วิธีการนี้จะถูกเรียกใช้ก่อนการคำนวณเซลล์ใดๆ เราจะตรวจสอบว่าเซลล์ปัจจุบัน `B8`. ถ้าใช่เราก็เรียก `this.Interrupt()` เพื่อหยุดการคำนวณ
## ขั้นตอนที่ 4: คำนวณสูตรด้วยตัวเลือก
เมื่อมีตัวเลือกและจอภาพพร้อมแล้ว ก็ถึงเวลาทำการคำนวณ:
```csharp
wb.CalculateFormula(opts);
```
คำสั่งนี้จะดำเนินการคำนวณในขณะที่ตรวจสอบการขัดจังหวะ หากการคำนวณถึง B8 การคำนวณจะหยุดลงตามตรรกะก่อนหน้าของเรา
## บทสรุป
ขอแสดงความยินดีด้วย! คุณเพิ่งเรียนรู้วิธีการหยุดการคำนวณสูตรในสมุดงาน Excel โดยใช้ Aspose.Cells สำหรับ .NET ขั้นตอนนี้ช่วยให้คุณควบคุมการคำนวณของคุณได้ดีขึ้น ทำให้มั่นใจได้ว่าการคำนวณจะไม่ลากยาวโดยไม่จำเป็น 
ไม่ว่าคุณจะกำลังพัฒนาโมเดลทางการเงินที่ซับซ้อนหรือกำลังวิเคราะห์ชุดข้อมูลขนาดใหญ่ การจัดการการคำนวณของคุณจะช่วยเพิ่มประสิทธิภาพและการใช้งานได้อย่างมาก ฉันหวังว่าบทช่วยสอนนี้จะเป็นประโยชน์และช่วยให้เข้าใจหัวข้อนี้ได้ดีขึ้น อย่าลืมศึกษาเพิ่มเติมในเอกสาร Aspose.Cells เพื่อค้นพบความสามารถเพิ่มเติม
## คำถามที่พบบ่อย
### ฉันสามารถใช้ Aspose.Cells ได้ฟรีหรือไม่?
ใช่! คุณสามารถเริ่มต้นด้วยการทดลองใช้ Aspose ฟรีได้ พบเซลล์ [ที่นี่](https://releases-aspose.com/).
### ฉันสามารถพัฒนาแอปพลิเคชันประเภทใดได้บ้างโดยใช้ Aspose.Cells?
คุณสามารถสร้างแอปพลิเคชันได้หลากหลาย รวมถึงการวิเคราะห์ข้อมูล เครื่องมือสร้างรายงาน และยูทิลิตี้ประมวลผล Excel อัตโนมัติ
### การนำ Aspose.Cells มาใช้ในแอปพลิเคชัน .NET ของฉันเป็นเรื่องยากหรือไม่
ไม่เลย! Aspose.Cells มีเอกสารประกอบและตัวอย่างที่ยอดเยี่ยมเพื่อช่วยให้คุณผสานเข้ากับแอปพลิเคชันของคุณได้อย่างราบรื่น
### ฉันสามารถคำนวณสูตรโดยมีเงื่อนไขด้วย Aspose.Cells ได้หรือไม่
ใช่! คุณสามารถใช้ตรรกะและการคำนวณต่างๆ ตามความต้องการของแอปพลิเคชันของคุณ รวมถึงเงื่อนไขในการหยุดการคำนวณตามที่แสดงในบทช่วยสอนนี้
### ฉันสามารถค้นหาการสนับสนุนสำหรับ Aspose.Cells ได้ที่ไหน
คุณสามารถรับการสนับสนุนผ่านฟอรั่ม Aspose ได้ [ที่นี่](https://forum-aspose.com/c/cells/9).


{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}