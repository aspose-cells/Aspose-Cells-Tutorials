---
title: อ่านและเขียนตารางพร้อมสอบถามแหล่งข้อมูล
linktitle: อ่านและเขียนตารางพร้อมสอบถามแหล่งข้อมูล
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: ปลดล็อกพลังของ Aspose.Cells สำหรับ .NET เรียนรู้การอ่านและเขียนตารางด้วยแหล่งข้อมูลแบบสอบถามในคู่มือทีละขั้นตอนโดยละเอียดนี้
weight: 15
url: /th/net/tables-and-lists/reading-and-writing-table-with-query-data-source/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# อ่านและเขียนตารางพร้อมสอบถามแหล่งข้อมูล

## การแนะนำ
ในโลกที่ขับเคลื่อนด้วยเทคโนโลยีในปัจจุบัน ความสามารถในการจัดการและปรับเปลี่ยนข้อมูลอย่างมีประสิทธิภาพถือเป็นทักษะที่สำคัญ ไม่ว่าคุณจะกำลังพัฒนาแอปพลิเคชันหรือจัดการฐานข้อมูล การมีเครื่องมือที่ดีจะช่วยให้การทำงานของคุณราบรื่นขึ้นได้ หนึ่งในเครื่องมือที่ยอดเยี่ยมดังกล่าวคือ Aspose.Cells สำหรับ .NET ซึ่งช่วยให้นักพัฒนาสามารถทำงานกับไฟล์ Excel ได้อย่างราบรื่น ในบทช่วยสอนนี้ เราจะมาสำรวจวิธีการอ่านและเขียนตารางโดยใช้แหล่งข้อมูลแบบสอบถามใน Aspose.Cells
## ข้อกำหนดเบื้องต้น
ก่อนที่เราจะเริ่มดำเนินการจัดการข้อมูลนี้ เรามาตรวจสอบกันก่อนว่าคุณมีทุกสิ่งที่จำเป็นในการปฏิบัติตาม:
1. ความรู้พื้นฐานเกี่ยวกับ .NET  
   คุณควรคุ้นเคยกับสภาพแวดล้อม .NET หากคุณเพิ่งเริ่มต้น ไม่ต้องกังวล! ความรู้พื้นฐานเพียงเล็กน้อยก็เพียงพอแล้วในการเข้าใจแนวคิดต่างๆ
2. Aspose.Cells สำหรับ .NET  
    ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้งไลบรารี Aspose.Cells ไว้ในโปรเจ็กต์ของคุณแล้ว คุณสามารถดาวน์โหลดได้[ที่นี่](https://releases.aspose.com/cells/net/).
3. วิชวลสตูดิโอ  
   การตั้งค่า Visual Studio จะเป็นประโยชน์ต่อการเขียนและทดสอบโค้ดของคุณ เนื่องจากสามารถบูรณาการกับโปรเจ็กต์ .NET ได้อย่างสวยงาม
4. ไฟล์ Excel ตัวอย่าง  
   คุณจะต้องมีไฟล์ Excel ตัวอย่างที่มีตารางที่เชื่อมโยงกับแหล่งข้อมูลแบบสอบถาม คุณสามารถสร้างไฟล์พื้นฐานหรือขอรับไฟล์ตัวอย่างจากแหล่งข้อมูลอื่นได้
5. ตัวแก้ไขโค้ด  
   แม้ว่า Visual Studio ก็เพียงพอแล้ว แต่ IDE หรือตัวแก้ไขข้อความใด ๆ ที่รองรับ C# ก็จะทำงานได้อย่างสมบูรณ์แบบ
เมื่อคุณแน่ใจว่าคุณมีข้อกำหนดเบื้องต้นเหล่านี้แล้ว คุณก็พร้อมที่จะเริ่มการผจญภัยพร้อมกับเครื่องมือที่ถูกต้องเพื่อพิชิตการจัดการข้อมูล!
## แพ็คเกจนำเข้า
ในการเริ่มต้น ให้ทำการอิมพอร์ตแพ็คเกจที่จำเป็น ซึ่งถือเป็นสิ่งสำคัญในการใช้ฟีเจอร์ที่ Aspose.Cells จัดเตรียมไว้ให้ โดยทำได้ดังนี้:
```csharp
using System;
using Aspose.Cells.Tables;
```
โค้ดบรรทัดเรียบง่ายเหล่านี้โหลดไลบรารี Aspose.Cells และคลาสที่เกี่ยวข้องกับตารางซึ่งคุณจะใช้ตลอดทั้งบทช่วยสอนนี้
มาแบ่งตัวอย่างที่คุณให้มาเป็นขั้นตอนที่จัดการได้ วิธีนี้จะช่วยให้คุณทำตามได้ง่ายโดยไม่รู้สึกเครียด!
## ขั้นตอนที่ 1: กำหนดเส้นทางสำหรับไฟล์ของคุณ
สิ่งแรกที่คุณต้องทำคือกำหนดเส้นทางสำหรับไฟล์อินพุตและเอาต์พุตของคุณ 
```csharp
string sourceDir = "Your Document Directory";
string outputDir = "Your Document Directory";
```
ที่นี่ คุณจะตั้งค่าไดเร็กทอรีเอกสารของคุณว่าไฟล์ต้นฉบับของคุณ (ไฟล์ Excel อินพุต) อยู่ที่ไหน และไฟล์เอาท์พุตจะถูกบันทึกที่ไหนหลังจากประมวลผลแล้ว ตรวจสอบให้แน่ใจเสมอว่าได้ตั้งค่าเส้นทางอย่างถูกต้อง มิฉะนั้น คุณจะประสบปัญหา "ไม่พบไฟล์"
## ขั้นตอนที่ 2: โหลดเวิร์กบุ๊ก
ขั้นตอนต่อไปคือการโหลดเวิร์กบุ๊ก Excel ที่คุณจะใช้งาน
```csharp
Workbook workbook = new Workbook(sourceDir + "SampleTableWithQueryTable.xls");
```
 บรรทัดนี้จะสร้างอินสแตนซ์ของ`Workbook`คลาสซึ่งโดยพื้นฐานแล้วคือไฟล์ Excel ของคุณในรูปแบบโค้ด! แทนที่`"SampleTableWithQueryTable.xls"` ด้วยชื่อไฟล์จริง ตรวจสอบให้แน่ใจว่าชื่อไฟล์ถูกต้องและไฟล์มีอยู่ในไดเร็กทอรีที่ระบุ
## ขั้นตอนที่ 3: เข้าถึงแผ่นงาน
เมื่อโหลดเวิร์กบุ๊กแล้ว คุณต้องเข้าถึงเวิร์กชีตเฉพาะที่คุณต้องการจัดการ
```csharp
Worksheet worksheet = workbook.Worksheets[0];
```
การดำเนินการนี้จะดึงเวิร์กชีตแรกในเวิร์กบุ๊กของคุณ หากข้อมูลของคุณอยู่ในเวิร์กชีตอื่น ให้ปรับดัชนีให้เหมาะสม (ดัชนีฐานศูนย์)
## ขั้นตอนที่ 4: เข้าถึงตาราง
ตอนนี้คุณมีเวิร์กชีตแล้ว คุณจะต้องการคว้าตารางที่ประกอบด้วยข้อมูลแบบสอบถาม
```csharp
ListObject table = worksheet.ListObjects[0];
```
 การ`ListObjects` คอลเลกชันเก็บตารางทั้งหมดภายในเวิร์กชีต และโดยการระบุ`[0]`คุณกำลังเลือกตารางแรก หากเวิร์กชีตของคุณมีหลายตาราง ให้ชี้ไปที่ดัชนีที่ถูกต้อง
## ขั้นตอนที่ 5: ตรวจสอบประเภทแหล่งข้อมูล
ก่อนที่เราจะทำการปรับเปลี่ยนใดๆ ควรตรวจสอบก่อนว่าตารางกำลังใช้แหล่งข้อมูลประเภทใด
```csharp
if (table.DataSourceType == TableDataSourceType.QueryTable)
{
    table.ShowTotals = true;
}
```
ที่นี่ เรากำลังตรวจสอบว่าแหล่งข้อมูลสำหรับตารางเป็นตารางแบบสอบถามหรือไม่ หากใช่ เราจะเปิดใช้งานการแสดงผลรวม ซึ่งมีประโยชน์มากสำหรับรายงานหรือสรุปข้อมูลที่คุณต้องการดูค่ารวมทั้งหมดในครั้งเดียว
## ขั้นตอนที่ 6: บันทึกสมุดงาน
เมื่อมีการเปลี่ยนแปลงเกิดขึ้น ก็ถึงเวลาที่จะบันทึกงานของคุณแล้ว!
```csharp
workbook.Save(outputDir + "SampleTableWithQueryTable_out.xls");
```
บรรทัดนี้จะบันทึกเวิร์กบุ๊กที่คุณแก้ไขในไดเร็กทอรีเอาต์พุตที่ระบุ ตรวจสอบให้แน่ใจว่าได้ตั้งชื่อหรือเส้นทางอื่น เพื่อไม่ให้ไฟล์ต้นฉบับของคุณถูกเขียนทับ
## ขั้นตอนที่ 7: ยืนยันการดำเนินการสำเร็จ
สุดท้ายนี้ การปฏิบัติตัวให้ดีอยู่เสมอคือการยืนยันว่าโค้ดของคุณทำงานได้สำเร็จ
```csharp
Console.WriteLine("ReadAndWriteTableWithQueryTableDataSource executed successfully.");
```
บรรทัดนี้จะพิมพ์ข้อความไปยังคอนโซลเพื่อแจ้งให้คุณทราบว่างานของคุณเสร็จสมบูรณ์แล้ว โดยทำหน้าที่เป็นจุดยืนยันเพื่อให้แน่ใจว่าทุกอย่างดำเนินไปอย่างราบรื่น
## บทสรุป
ขอแสดงความยินดี! คุณได้เรียนรู้วิธีการอ่านและเขียนตารางโดยใช้แหล่งข้อมูลแบบสอบถามด้วย Aspose.Cells สำหรับ .NET สำเร็จแล้ว ทักษะนี้จะช่วยให้คุณจัดการและแก้ไขไฟล์ Excel ในโปรเจ็กต์ของคุณได้อย่างมีประสิทธิภาพ ไม่ว่าคุณจะกำลังสร้างรายงาน ประมวลผลข้อมูล หรือเพียงแค่แก้ไขสเปรดชีต ตอนนี้คุณก็มีความรู้ในการทำงานเหล่านี้ได้อย่างมืออาชีพแล้ว!
## คำถามที่พบบ่อย
### Aspose.Cells คืออะไร?  
Aspose.Cells เป็นไลบรารี .NET อันทรงพลังที่ออกแบบมาเพื่อสร้าง อ่าน และจัดการไฟล์ Excel โดยไม่จำเป็นต้องติดตั้ง Microsoft Excel
### ฉันสามารถใช้ Aspose.Cells เพื่อจัดการรูปแบบไฟล์อื่นได้หรือไม่  
แม้ว่า Aspose.Cells จะเชี่ยวชาญด้านไฟล์ Excel แต่ Aspose ยังมีไลบรารีอื่นๆ อีกมากมายสำหรับรูปแบบที่แตกต่างกัน (เช่น PDF, Word)
### ฉันต้องมีใบอนุญาตสำหรับ Aspose.Cells หรือไม่?  
 มีใบอนุญาตชั่วคราว[ที่นี่](https://purchase.aspose.com/temporary-license/) และคุณยังสามารถลองใช้งานฟรีได้ผ่านทาง[ทดลองใช้งานฟรี](https://releases.aspose.com/).
### ฉันสามารถค้นหาเอกสารสำหรับ Aspose.Cells ได้ที่ไหน  
 คุณสามารถค้นหาเอกสารฉบับสมบูรณ์ได้[ที่นี่](https://reference.aspose.com/cells/net/).
### ฉันสามารถขอรับการสนับสนุนสำหรับ Aspose.Cells ได้อย่างไร?  
 หากมีคำถามหรือปัญหาใดๆ คุณสามารถเยี่ยมชมฟอรัมสนับสนุน Aspose ได้[ที่นี่](https://forum.aspose.com/c/cells/9).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
