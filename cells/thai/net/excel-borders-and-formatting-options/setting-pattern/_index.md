---
title: การกำหนดรูปแบบตามโปรแกรมใน Excel
linktitle: การกำหนดรูปแบบตามโปรแกรมใน Excel
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีการตั้งค่ารูปแบบโดยโปรแกรมใน Excel โดยใช้ Aspose.Cells สำหรับ .NET ด้วยบทช่วยสอนทีละขั้นตอนนี้
weight: 12
url: /th/net/excel-borders-and-formatting-options/setting-pattern/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# การกำหนดรูปแบบตามโปรแกรมใน Excel

## การแนะนำ
คุณเคยพบว่าตัวเองต้องดิ้นรนกับตัวเลือกการจัดรูปแบบของ Excel และหวังว่าจะทำให้กระบวนการเป็นอัตโนมัติได้หรือไม่ ไม่ว่าคุณจะเป็นนักพัฒนาที่ต้องการสร้างสเปรดชีตที่สวยงามหรือใครก็ตามที่ต้องการเพียงแค่ทำให้การนำเสนอข้อมูลของคุณดูมีชีวิตชีวาขึ้น Aspose.Cells สำหรับ .NET คืออาวุธลับของคุณ ในบทช่วยสอนนี้ เราจะเจาะลึกถึงวิธีการตั้งค่ารูปแบบใน Excel โดยใช้ Aspose.Cells เราจะอธิบายทีละขั้นตอนเพื่อให้แน่ใจว่าคุณจะเข้าใจแนวคิดแต่ละอย่างเหมือนมืออาชีพ หยิบเครื่องดื่มที่คุณชอบแล้วเริ่มกันเลย!
## ข้อกำหนดเบื้องต้น
ก่อนที่เราจะเริ่มออกเดินทาง เรามาแน่ใจก่อนว่าคุณมีทุกสิ่งที่จำเป็นต่อความสำเร็จ:
1. Visual Studio: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Visual Studio ไว้ในเครื่องของคุณแล้ว เพราะนี่คือจุดที่ความมหัศจรรย์จะเกิดขึ้น!
2.  Aspose.Cells สำหรับ .NET: คุณจะต้องตั้งค่าไลบรารี Aspose.Cells ไว้ในโปรเจ็กต์ของคุณ คุณสามารถดาวน์โหลดได้จาก[ที่นี่](https://releases.aspose.com/cells/net/).
3. ความรู้พื้นฐานเกี่ยวกับ C#: ความเข้าใจพื้นฐานเกี่ยวกับการเขียนโปรแกรม C# จะช่วยให้คุณนำทางผ่านโค้ดได้อย่างราบรื่น
4. .NET Framework: ตรวจสอบให้แน่ใจว่าคุณกำลังใช้ .NET Framework เวอร์ชันที่เข้ากันได้ซึ่งรองรับ Aspose.Cells
เมื่อคุณได้ตรวจสอบข้อกำหนดเบื้องต้นเหล่านี้แล้ว คุณก็พร้อมที่จะก้าวไปข้างหน้า!
## แพ็คเกจนำเข้า
ในการเริ่มต้น คุณต้องนำเข้าเนมสเปซ Aspose.Cells ที่จำเป็นลงในโปรเจ็กต์ของคุณ โดยดำเนินการได้ดังนี้:
```csharp
using System.IO;
using Aspose.Cells;
using System.Drawing;
```
เนมสเปซเหล่านี้จะช่วยให้คุณเข้าถึงฟังก์ชันต่างๆ ที่จำเป็นสำหรับการดำเนินการ Excel ของเราได้ ตอนนี้เรามีแพ็คเกจต่างๆ ไว้แล้ว มาดูคู่มือทีละขั้นตอนกันเลย!
## ขั้นตอนที่ 1: ตั้งค่าสภาพแวดล้อมของคุณ
ก่อนที่เราจะเริ่มเขียนโค้ด เรามาตั้งค่าสภาพแวดล้อมกันก่อน ซึ่งรวมถึงการสร้างโปรเจ็กต์ใหม่ใน Visual Studio และเพิ่มการอ้างอิงไปยังไลบรารี Aspose.Cells
1. สร้างโปรเจ็กต์ใหม่: เปิด Visual Studio และสร้างโปรเจ็กต์แอปพลิเคชันคอนโซล C# ใหม่
2. เพิ่มการอ้างอิง Aspose.Cells: คลิกขวาที่โปรเจ็กต์ของคุณใน Solution Explorer เลือก “จัดการแพ็คเกจ NuGet” และค้นหา Aspose.Cells ติดตั้งเวอร์ชันล่าสุด
ตอนนี้คุณก็พร้อมที่จะเขียนโค้ดแล้ว!
## ขั้นตอนที่ 2: เริ่มต้นเวิร์กบุ๊ก
 ขั้นตอนแรกในการสร้างไฟล์ Excel ของเราคือการเริ่มต้น`Workbook` วัตถุ วัตถุนี้จะแสดงถึงเวิร์กบุ๊ก Excel ของคุณ
```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "Your Document Directory";
// การสร้างอินสแตนซ์ของวัตถุเวิร์กบุ๊ก
Workbook workbook = new Workbook();
Worksheet sheet = workbook.Worksheets[0];
```
 ในสคริปท์นี้ ให้แทนที่`"Your Document Directory"` ด้วยเส้นทางที่คุณต้องการบันทึกไฟล์ Excel ของคุณ`Workbook` วัตถุถูกสร้างขึ้นแล้ว และเราอ้างอิงเวิร์กชีตแรกซึ่งจะเป็นสนามเด็กเล่นของเรา
## ขั้นตอนที่ 3: เพิ่มการจัดรูปแบบตามเงื่อนไข
ตอนนี้ มาเพิ่มความเก๋ไก๋ให้กับเวิร์กชีตของเราด้วยการใช้การจัดรูปแบบตามเงื่อนไข วิธีนี้ช่วยให้เราเปลี่ยนรูปลักษณ์ของเซลล์ตามค่าต่างๆ ได้
```csharp
// เพิ่มการจัดรูปแบบเงื่อนไขแบบว่างเปล่า
int index = sheet.ConditionalFormattings.Add();
FormatConditionCollection fcs = sheet.ConditionalFormattings[index];
```
ที่นี่ เราจะเพิ่มคอลเลกชันการจัดรูปแบบตามเงื่อนไขที่ว่างเปล่าลงในเวิร์กชีตของเรา นี่คือจุดที่เราจะระบุกฎสำหรับการจัดรูปแบบ
## ขั้นตอนที่ 4: กำหนดช่วงสำหรับการจัดรูปแบบตามเงื่อนไข
ถัดไป เราต้องกำหนดช่วงของเซลล์ที่จะได้รับผลกระทบจากกฎการจัดรูปแบบตามเงื่อนไขของเรา
```csharp
// กำหนดช่วงรูปแบบตามเงื่อนไข
CellArea ca = new CellArea();
ca.StartRow = 0;
ca.EndRow = 5;
ca.StartColumn = 0;
ca.EndColumn = 3;
fcs.AddArea(ca);
```
ในตัวอย่างนี้ เราตั้งค่าการจัดรูปแบบตามเงื่อนไขเพื่อใช้กับเซลล์ตั้งแต่ A1 (0,0) ถึง D6 (5,3) ปรับค่าเหล่านี้เพื่อกำหนดเป้าหมายเซลล์ต่างๆ ตามความต้องการของคุณ
## ขั้นตอนที่ 5: เพิ่มเงื่อนไขการจัดรูปแบบตามเงื่อนไข
ตอนนี้เราได้กำหนดช่วงแล้ว ถึงเวลาที่จะกำหนดเงื่อนไขในการจัดรูปแบบ ในกรณีนี้ เราจะจัดรูปแบบเซลล์ด้วยค่าระหว่าง 50 ถึง 100
```csharp
// เพิ่มเงื่อนไข.
int conditionIndex = fcs.AddCondition(FormatConditionType.CellValue, OperatorType.Between, "50", "100");
FormatCondition fc = fcs[conditionIndex];
```
สไนปเป็ตนี้จะสร้างเงื่อนไขใหม่ที่ตรวจสอบว่าค่าของเซลล์อยู่ระหว่าง 50 ถึง 100 หรือไม่ หากเป็นเช่นนั้น การจัดรูปแบบที่เราจะกำหนดต่อไปนี้จะนำไปใช้
## ขั้นตอนที่ 6: กำหนดรูปแบบสำหรับการจัดรูปแบบตามเงื่อนไข
เมื่อกำหนดเงื่อนไขแล้ว เราสามารถกำหนดสไตล์ที่จะใช้กับเซลล์ที่ตรงตามเงื่อนไขได้
```csharp
fc.Style.Pattern = BackgroundType.ReverseDiagonalStripe;
fc.Style.ForegroundColor = Color.FromArgb(255, 255, 0);
fc.Style.BackgroundColor = Color.FromArgb(0, 255, 255);
```
ในตัวอย่างนี้ เราจะใช้รูปแบบแถบทแยงมุมย้อนกลับกับเซลล์ โดยสีพื้นหน้าจะถูกตั้งค่าเป็นสีเหลือง และสีพื้นหลังจะถูกตั้งค่าเป็นสีฟ้าอมเขียว คุณสามารถปรับแต่งสีและรูปแบบเหล่านี้ให้ตรงกับธีมของสเปรดชีตของคุณได้ตามใจชอบ!
## ขั้นตอนที่ 7: บันทึกสมุดงาน
หลังจากใช้การจัดรูปแบบแล้ว ก็ถึงเวลาบันทึกผลงานชิ้นเอกของเรา ซึ่งจะสร้างไฟล์ Excel ที่ใช้การจัดรูปแบบตามเงื่อนไขที่ระบุ
```csharp
workbook.Save(dataDir + "output.xlsx");
```
อย่าลืมปรับเปลี่ยนชื่อไฟล์และเส้นทางไดเรกทอรีตามต้องการ เรียกใช้แอปพลิเคชันของคุณ แล้วไฟล์ Excel ที่จัดรูปแบบของคุณก็พร้อมใช้งานแล้ว
## บทสรุป
ขอแสดงความยินดี! คุณได้กำหนดรูปแบบใน Excel โดยใช้ Aspose.Cells สำหรับ .NET สำเร็จแล้ว ด้วยความสามารถในการจัดรูปแบบอัตโนมัติ คุณสามารถประหยัดเวลาได้มาก และรับรองความสม่ำเสมอในสเปรดชีตของคุณ ไม่ว่าคุณจะกำลังสร้างรายงาน วิเคราะห์ข้อมูล หรือเพียงแค่พยายามสร้างความประทับใจให้กับเจ้านาย ทักษะนี้ถือเป็นส่วนเสริมอันมีค่าสำหรับชุดเครื่องมือของคุณ 
## คำถามที่พบบ่อย
### Aspose.Cells คืออะไร?
Aspose.Cells เป็นไลบรารีอันทรงพลังสำหรับ .NET ที่ช่วยให้นักพัฒนาสามารถสร้าง จัดการ และแปลงไฟล์ Excel ได้โดยไม่ต้องติดตั้ง Microsoft Excel
### ฉันสามารถใช้ Aspose.Cells ได้ฟรีหรือไม่?
 ใช่ Aspose.Cells เสนอการทดลองใช้ฟรี ช่วยให้คุณสำรวจฟีเจอร์ต่างๆ ของมันได้ ลองดูสิ[ที่นี่](https://releases.aspose.com/).
### ฉันสามารถสร้างไฟล์ Excel ประเภทใดได้บ้าง?
คุณสามารถสร้างและจัดการรูปแบบ Excel ต่างๆ รวมถึง XLS, XLSX, CSV และอื่นๆ โดยใช้ Aspose.Cells
### มีวิธีรับการสนับสนุนสำหรับ Aspose.Cells หรือไม่
 แน่นอน! หากคุณประสบปัญหาใดๆ คุณสามารถขอความช่วยเหลือจากชุมชน Aspose ได้[ที่นี่](https://forum.aspose.com/c/cells/9).
### ฉันจะนำรูปแบบที่แตกต่างกันไปใช้กับช่วงเซลล์ต่างๆ ได้อย่างไร
 คุณสามารถกำหนดได้หลาย`CellArea` วัตถุและใช้กฎการจัดรูปแบบตามเงื่อนไขและรูปแบบที่แตกต่างกันไปในแต่ละพื้นที่ตามความจำเป็น
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
