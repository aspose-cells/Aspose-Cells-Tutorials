---
title: การค้นหาและการรีเฟรชตารางสรุปข้อมูลแบบซ้อนหรือแบบย่อยใน .NET
linktitle: การค้นหาและการรีเฟรชตารางสรุปข้อมูลแบบซ้อนหรือแบบย่อยใน .NET
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีค้นหาและรีเฟรชตารางสรุปข้อมูลแบบซ้อนในไฟล์ Excel โดยใช้ Aspose.Cells สำหรับ .NET มีขั้นตอนที่ชัดเจนและเคล็ดลับที่เป็นประโยชน์รวมอยู่ด้วย
weight: 27
url: /th/net/creating-and-configuring-pivot-tables/finding-and-refreshing-nested-or-children-pivot-tables/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# การค้นหาและการรีเฟรชตารางสรุปข้อมูลแบบซ้อนหรือแบบย่อยใน .NET

## การแนะนำ
ในโลกแห่งการวิเคราะห์ข้อมูลและการรายงาน ตารางสรุปข้อมูลถือเป็นเครื่องมือเปลี่ยนเกมอย่างแท้จริง ตารางสรุปข้อมูลช่วยให้เราแปลงข้อมูลดิบของเราให้กลายเป็นข้อมูลเชิงลึกที่สวยงามและเข้าใจง่าย แต่จะเกิดอะไรขึ้นหากเวิร์กบุ๊ก Excel ของคุณมีตารางสรุปข้อมูลแบบซ้อนหรือแบบย่อย ในบทความนี้ เราจะแนะนำวิธีค้นหาและรีเฟรชตารางสรุปข้อมูลแบบซ้อนเหล่านี้โดยใช้ Aspose.Cells สำหรับ .NET ลองนึกภาพว่าคุณกำลังพยายามค้นหาสมบัติที่ซ่อนอยู่ในเขาวงกต ตารางสรุปข้อมูลแบบซ้อนแต่ละตารางเปรียบเสมือนหีบสมบัติที่ซ่อนอยู่ซึ่งคุณต้องค้นหา ขั้นตอนที่เราจะดำเนินการนี้จะนำคุณผ่านเขาวงกตของแผ่นงาน Excel ของคุณ ทำให้คุณไม่เพียงแต่ค้นหาตารางสรุปข้อมูลแบบซ้อนได้เท่านั้น แต่ยังอัปเดตข้อมูลให้เป็นปัจจุบันด้วย
## ข้อกำหนดเบื้องต้น
ก่อนที่เราจะเริ่มต้นการเขียนโค้ดอย่างสนุกสนาน มีข้อกำหนดเบื้องต้นบางประการที่คุณจะต้องมี:
1. Visual Studio: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Visual Studio บนคอมพิวเตอร์ของคุณแล้ว นี่คือที่ที่คุณจะเขียนและดำเนินการโค้ด C#
2.  Aspose.Cells สำหรับ .NET: คุณต้องติดตั้ง Aspose.Cells สำหรับ .NET คุณสามารถดาวน์โหลดเวอร์ชันล่าสุดได้จาก[หน้าวางจำหน่าย Aspose](https://releases.aspose.com/cells/net/) . หากคุณยังไม่พร้อมที่จะซื้อ คุณยังสามารถเริ่มต้นด้วย[ทดลองใช้งานฟรี](https://releases.aspose.com/).
3. ความรู้พื้นฐานเกี่ยวกับ C#: การมีความคุ้นเคยกับการเขียนโปรแกรม C# เล็กน้อยจะทำให้กระบวนการนี้ราบรื่นยิ่งขึ้นสำหรับคุณ
4. สมุดงาน Excel พร้อมตารางสรุปข้อมูล: คุณจะต้องมีไฟล์ Excel ตัวอย่างที่มีตารางสรุปข้อมูล คุณสามารถใช้ตัวอย่างที่ให้มาหรือสร้างไฟล์ของคุณเองก็ได้
เมื่อคุณตรวจสอบรายการเหล่านี้แล้ว คุณก็พร้อมแล้ว! ตอนนี้มาเริ่มลงมือเขียนโค้ดกันเลย
## แพ็คเกจนำเข้า
ก่อนที่เราจะเริ่มเขียนโค้ด เราจะต้องนำเข้าแพ็คเกจที่จำเป็น ในกรอบงาน .NET เราทำสิ่งนี้โดยเพิ่มคำสั่ง using ที่ด้านบนของไฟล์ C# แพ็คเกจหลักที่คุณจะใช้คือ Aspose.Cells ต่อไปนี้เป็นวิธีการนำเข้า:
```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Aspose.Cells;
using Aspose.Cells.Pivot;
```
การเพิ่มบรรทัดนี้แสดงว่าคุณกำลังแจ้งให้ C# รวมฟังก์ชันการทำงานทั้งหมดที่ Aspose.Cells จัดทำไว้ ซึ่งทำให้การสร้างและจัดการไฟล์ Excel ของคุณง่ายยิ่งขึ้น
## ขั้นตอนที่ 1: กำหนดไดเรกทอรีแหล่งที่มาของคุณ
ขั้นตอนแรกคือระบุไดเรกทอรีที่จัดเก็บไฟล์ Excel ของคุณ คุณสามารถทำได้ดังนี้:
```csharp
string sourceDir = "Your Document Directory";
```
 แทนที่`"Your Document Directory"` โดยใช้เส้นทางจริงของไฟล์ Excel ของคุณ นี่คือที่ที่โค้ดของคุณจะค้นหาเวิร์กบุ๊กที่ต้องการ ลองคิดดูเหมือนกับการบอกเพื่อนว่าคุณซ่อนสมบัติไว้ที่ไหน!
## ขั้นตอนที่ 2: โหลดสมุดงาน Excel
 จากนั้นคุณต้องโหลดไฟล์ Excel ของคุณลงใน`Workbook` วัตถุที่ช่วยให้คุณสามารถจัดการมันด้วยโปรแกรมได้ วิธีทำมีดังนี้:
```csharp
Workbook wb = new Workbook(sourceDir + "sampleFindAndRefreshNestedOrChildrenPivotTables.xlsx");
```
 ในบรรทัดนี้ คุณกำลังสร้างอินสแตนซ์ใหม่ของ`Workbook` และโหลดไฟล์ของคุณลงไป โดยการผนวกชื่อไฟล์เข้าใน`sourceDir`คุณกำลังนำหนังสือแบบฝึกหัดไปยังหีบสมบัติ
## ขั้นตอนที่ 3: เข้าถึงแผ่นงาน
เมื่อโหลดเวิร์กบุ๊กของคุณแล้ว คุณต้องเข้าถึงเวิร์กชีตเฉพาะที่ประกอบด้วยตารางสรุปข้อมูล มาเข้าถึงเวิร์กชีตแรกกัน:
```csharp
Worksheet ws = wb.Worksheets[0];
```
บรรทัดนี้จะดึงข้อมูลเวิร์กชีตแรกในเวิร์กบุ๊กของคุณ หากตารางสรุปข้อมูลของคุณถูกซ่อนอยู่ในชีตอื่น คุณเพียงแค่ปรับดัชนี (โดยคำนึงไว้ว่าดัชนีนี้เป็นแบบฐานศูนย์!)

## ขั้นตอนที่ 4: เข้าถึงตารางสรุปข้อมูลที่ต้องการ
ต่อไปเราจะเข้าถึงตารางสรุปข้อมูลหลักที่เก็บข้อมูลย่อย สำหรับตัวอย่างนี้ เราจะหยิบตารางสรุปข้อมูลที่สาม:
```csharp
PivotTable ptParent = ws.PivotTables[2];
```
ตรงนี้ คุณกำลังดูตำแหน่งที่สามของอาร์เรย์ตารางสรุปข้อมูล เช่นเดียวกับการเอื้อมมือไปหยิบแท่งช็อกโกแลตบนชั้นบนสุด เรากำลังเอื้อมมือไปหยิบตารางที่ถูกต้อง
## ขั้นตอนที่ 5: รับข้อมูลลูกจากตารางสรุปข้อมูลผู้ปกครอง
ตอนนี้เราได้ระบุตำแหน่งตารางสรุปข้อมูลของผู้ปกครองแล้ว ถึงเวลาที่จะเจาะลึกและค้นหาตารางสรุปข้อมูลย่อย:
```csharp
PivotTable[] ptChildren = ptParent.GetChildren();
```
 ในขั้นตอนนี้เราใช้`GetChildren()` วิธีการเรียกค้นอาร์เรย์ของตารางสรุปข้อมูลย่อย สิ่งเหล่านี้เปรียบเสมือนสมบัติชิ้นเล็กๆ ที่ซ่อนอยู่ใต้หีบสมบัติขนาดใหญ่!
## ขั้นตอนที่ 6: รีเฟรชตารางสรุปข้อมูลย่อยแต่ละรายการ
ถึงเวลาที่จะรักษาสมบัติเหล่านี้ให้แวววาวและอัปเดตอยู่เสมอ! เราต้องวนซ้ำผ่านตารางสรุปข้อมูลย่อยแต่ละตารางและรีเฟรชข้อมูลของตารางเหล่านั้น มาทำสิ่งนี้โดยใช้ลูป for แบบง่ายๆ กัน:
```csharp
int count = ptChildren.Length;
for (int idx =0; idx < count; idx++)
{
 // เข้าถึงตารางสรุปข้อมูลของเด็ก
 PivotTable ptChild = ptChildren[idx];
 // รีเฟรชตารางสรุปข้อมูลย่อย
 ptChild.RefreshData();
 ptChild.CalculateData();
}
```
-  เราจะกำหนดว่ามีตารางสรุปข้อมูลย่อยจำนวนเท่าใดโดยใช้`ptChildren.Length`.
- จากนั้นสำหรับแต่ละตารางสรุปข้อมูลย่อย เราจะรีเฟรชข้อมูลด้วย`RefreshData()` ตามด้วย`CalculateData()`ลองคิดดูว่านี่เป็นการขัดเงาให้เด็กแต่ละคนอย่างรวดเร็วเพื่อให้พวกเขาเงางาม!
## บทสรุป
และแล้วคุณก็จะได้มัน! เพียงไม่กี่ขั้นตอนง่ายๆ คุณจะได้เรียนรู้วิธีค้นหาและรีเฟรชตารางสรุปแบบซ้อนกันในไฟล์ Excel โดยใช้ Aspose.Cells สำหรับ .NET ไม่ว่าคุณจะกำลังสร้างรายงานหรือวิเคราะห์ข้อมูล การอัปเดตตารางสรุปของคุณจะช่วยให้คุณมีข้อมูลเชิงลึกที่แม่นยำอยู่ในมือ
## คำถามที่พบบ่อย
### Aspose.Cells สำหรับ .NET คืออะไร?
Aspose.Cells สำหรับ .NET เป็นไลบรารีอันทรงพลังสำหรับการจัดการไฟล์ Excel ช่วยให้คุณสามารถอ่าน เขียน และจัดการสเปรดชีตได้อย่างง่ายดาย
### ฉันจำเป็นต้องซื้อ Aspose.Cells ล่วงหน้าหรือไม่?
คุณสามารถเริ่มต้นด้วยการทดลองใช้ฟรีจากเว็บไซต์ของพวกเขาก่อนตัดสินใจซื้อ
### ฉันสามารถทำงานกับคุณลักษณะอื่นๆ ของ Excel โดยใช้ไลบรารีนี้ได้หรือไม่
แน่นอน! นอกเหนือจากตารางสรุปข้อมูลแล้ว คุณยังสามารถจัดการแผนภูมิ สูตร และการจัดรูปแบบ รวมถึงฟีเจอร์อื่นๆ ได้อีกด้วย
### จำเป็นต้องมีความรู้ในการเขียนโค้ดเพื่อใช้ Aspose.Cells หรือไม่
ความรู้พื้นฐานเกี่ยวกับ C# หรือ .NET จะเป็นประโยชน์ต่อการใช้ Aspose.Cells ได้อย่างมีประสิทธิภาพ
### ฉันจะได้รับความช่วยเหลือได้อย่างไรหากประสบปัญหา?
 คุณสามารถตรวจสอบได้[ฟอรั่มสนับสนุน Aspose](https://forum.aspose.com/c/cells/9) เพื่อขอความช่วยเหลือจากชุมชนหรือการสนับสนุน
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
