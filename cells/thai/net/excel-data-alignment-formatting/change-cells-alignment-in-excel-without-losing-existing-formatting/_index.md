---
title: เปลี่ยนการจัดตำแหน่งเซลล์ Excel โดยไม่สูญเสียการจัดรูปแบบ
linktitle: เปลี่ยนการจัดตำแหน่งเซลล์ Excel โดยไม่สูญเสียการจัดรูปแบบ
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีเปลี่ยนการจัดตำแหน่งเซลล์ Excel โดยไม่สูญเสียการจัดรูปแบบโดยใช้ Aspose.Cells สำหรับ .NET ปฏิบัติตามคำแนะนำทีละขั้นตอนอย่างครอบคลุมของเราเพื่อการควบคุมที่ราบรื่น
weight: 10
url: /th/net/excel-data-alignment-formatting/change-cells-alignment-in-excel-without-losing-existing-formatting/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# เปลี่ยนการจัดตำแหน่งเซลล์ Excel โดยไม่สูญเสียการจัดรูปแบบ

## การแนะนำ

การจัดการไฟล์ Excel บางครั้งอาจรู้สึกเหมือนกับการเดินไปตามเขาวงกต โดยเฉพาะอย่างยิ่งเมื่อต้องรักษาการจัดรูปแบบขณะทำการปรับเปลี่ยนที่จำเป็น เช่น การเปลี่ยนการจัดตำแหน่งเซลล์ หากคุณเคยพยายามปรับการจัดตำแหน่งเซลล์ใน Excel แต่พบว่าการจัดรูปแบบถูกรบกวน คุณไม่ได้เป็นคนเดียวที่คิดเช่นนั้น ในบทช่วยสอนนี้ เราจะเจาะลึกถึงวิธีการเปลี่ยนการจัดตำแหน่งเซลล์ Excel โดยไม่สูญเสียการจัดรูปแบบใดๆ โดยใช้ Aspose.Cells สำหรับ .NET มาเริ่มกันเลย!

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะลงลึกในการเขียนโค้ดจริง สิ่งสำคัญคือต้องแน่ใจว่าคุณได้ตั้งค่าทุกอย่างอย่างถูกต้องแล้ว นี่คือสิ่งที่คุณต้องการ:

1. Visual Studio: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Visual Studio (เวอร์ชันใดก็ได้ที่รองรับ .NET) บนคอมพิวเตอร์ของคุณแล้ว
2. Aspose.Cells สำหรับ .NET: ดาวน์โหลดและติดตั้งไลบรารี Aspose.Cells จาก[เว็บไซต์ของ Aspose](https://releases.aspose.com/cells/net/).
3. ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับการเขียนโปรแกรม C# เพียงเล็กน้อยจะเป็นประโยชน์เนื่องจากเราจะทำงานภายในบริบทของ C#
4.  ตัวอย่างไฟล์ Excel: สำหรับการสาธิต ให้เตรียมไฟล์ Excel ตัวอย่างไว้ (เช่น`sampleChangeCellsAlignmentAndKeepExistingFormatting.xlsx`) ซึ่งมีการจัดรูปแบบเซลล์เริ่มต้นบางอย่าง

## แพ็คเกจนำเข้า

ขั้นตอนแรกในการใช้ Aspose.Cells สำหรับ .NET คือการรวมเนมสเปซที่จำเป็นไว้ในโปรเจ็กต์ของคุณ ดังต่อไปนี้:

### เปิดโครงการของคุณ

เปิด Visual Studio และสร้างโครงการ C# ใหม่ (แอปพลิเคชันคอนโซลจะทำงานได้ดี)

### เพิ่มการอ้างอิงถึง Aspose.Cells

- คลิกขวาที่โครงการของคุณใน Solution Explorer
- เลือก "จัดการแพ็คเกจ NuGet"
-  ค้นหา`Aspose.Cells` และติดตั้งมัน

### นำเข้าเนมสเปซที่จำเป็น

ที่ด้านบนของไฟล์ C# ของคุณ เพิ่ม using directives ดังต่อไปนี้:

```csharp
using Aspose.Cells;
using Aspose.Cells.Drawing;
using Aspose.Cells.Tables;
```

สิ่งนี้จะช่วยให้คุณสามารถใช้งานคลาสและวิธีการที่ไลบรารี Aspose.Cells จัดทำไว้ได้อย่างราบรื่น

ตอนนี้เราได้จัดเรียงข้อกำหนดเบื้องต้นและนำเข้าแพ็คเกจแล้ว มาแยกขั้นตอนการเปลี่ยนแปลงการจัดเรียงเซลล์ทีละขั้นตอนกัน

## ขั้นตอนที่ 1: ตั้งค่าไดเรกทอรีต้นทางและปลายทาง

ในการเริ่มต้น คุณต้องกำหนดว่าจัดเก็บไฟล์ Excel ของคุณไว้ที่ใด และต้องการบันทึกที่ใดหลังจากประมวลผล

```csharp
// ไดเรกทอรีแหล่งที่มา
string sourceDir = "Your Document Directory\\"; // แทนที่ด้วยไดเร็กทอรีจริงของคุณ

// ไดเรกทอรีผลลัพธ์
string outputDir = "Your Document Directory\\"; // แทนที่ด้วยไดเร็กทอรีจริงของคุณ
```

 โค้ดนี้จะตั้งค่าเส้นทางสำหรับไฟล์อินพุตและเอาต์พุต อย่าลืมเปลี่ยน`"Your Document Directory\\"` ด้วยเส้นทางจริงบนคอมพิวเตอร์ของคุณ

## ขั้นตอนที่ 2: โหลดไฟล์ตัวอย่าง Excel

จากนั้นคุณจะต้องโหลดไฟล์ Excel ตัวอย่างของคุณลงในแอปพลิเคชัน

```csharp
// โหลดไฟล์ Excel ตัวอย่างที่ประกอบด้วยเซลล์ที่มีการจัดรูปแบบ
Workbook wb = new Workbook(sourceDir + "sampleChangeCellsAlignmentAndKeepExistingFormatting.xlsx");
```

บรรทัดโค้ดนี้ใช้คลาส Workbook เพื่อโหลดไฟล์ Excel ที่มีอยู่ของคุณเพื่อที่เราจะสามารถจัดการเนื้อหาของไฟล์นั้นได้

## ขั้นตอนที่ 3: เข้าถึงแผ่นงานที่ต้องการ

หลังจากโหลดเวิร์กบุ๊กแล้ว ให้เข้าถึงเวิร์กชีตที่คุณต้องการจัดการ ไฟล์ Excel สามารถมีชีตได้หลายชีต ดังนั้นโปรดตรวจสอบให้แน่ใจว่าคุณเลือกชีตที่ถูกต้อง

```csharp
// เข้าถึงแผ่นงานแรก
Worksheet ws = wb.Worksheets[0];
```

ตัวอย่างนี้จะเข้าถึงเวิร์กชีตแรก หากข้อมูลของคุณอยู่ในชีตอื่น ให้ปรับดัชนีให้เหมาะสม

## ขั้นตอนที่ 4: สร้างช่วงของเซลล์

กำหนดว่าคุณต้องการเปลี่ยนแปลงเซลล์ใดโดยการสร้างช่วง การเลือกนี้จะเน้นที่ช่วงที่ระบุ เช่น “B2:D7”

```csharp
//สร้างช่วงเซลล์
Range rng = ws.Cells.CreateRange("B2:D7");
```

ช่วงนี้จะทำให้เราสามารถนำการตั้งค่าการจัดตำแหน่งใหม่ไปใช้กับเซลล์เหล่านั้นได้โดยตรง

## ขั้นตอนที่ 5: สร้างและปรับแต่งวัตถุสไตล์

ตอนนี้เราต้องกำหนดรูปแบบการจัดตำแหน่งที่เราต้องการใช้

```csharp
// สร้างวัตถุสไตล์
Style st = wb.CreateStyle();

// ตั้งค่าการจัดตำแหน่งแนวนอนและแนวตั้งให้อยู่กึ่งกลาง
st.HorizontalAlignment = TextAlignmentType.Center;
st.VerticalAlignment = TextAlignmentType.Center;
```

ที่นี่ วัตถุ Style ใหม่จะถูกสร้างขึ้น และเราตั้งค่าการจัดแนวทั้งแนวนอนและแนวตั้งให้อยู่กึ่งกลาง นี่คือสิ่งที่จะช่วยให้จัดแนวข้อความภายในเซลล์ที่เลือกได้อย่างแม่นยำ

## ขั้นตอนที่ 6: ตั้งค่าแฟล็กสไตล์

การตั้งค่าแฟล็กสไตล์มีบทบาทสำคัญในการทำให้แน่ใจว่าการเปลี่ยนแปลงสไตล์ของคุณถูกนำไปใช้ 

```csharp
// สร้างวัตถุธงสไตล์
StyleFlag flag = new StyleFlag();

// ตั้งค่าการจัดตำแหน่งธงสไตล์ให้ถูกต้อง เป็นคำชี้แจงที่สำคัญ
flag.Alignments = true;
```

 โดยการตั้งค่า`Alignments` คุณสมบัติของ StyleFlag`true`คุณแจ้ง Aspose.Cells ให้ใช้รูปแบบการจัดตำแหน่งอย่างถูกต้อง

## ขั้นตอนที่ 7: นำสไตล์ไปใช้กับช่วงเซลล์

เมื่อคุณมีรูปแบบและแฟล็กแล้ว ก็ถึงเวลาที่จะนำรูปแบบเหล่านั้นไปใช้กับช่วงของเซลล์:

```csharp
//ใช้สไตล์กับช่วงของเซลล์
rng.ApplyStyle(st, flag);
```

ขั้นตอนนี้จะเปลี่ยนการจัดตำแหน่งของเซลล์ทั้งหมดภายในช่วงนั้นอย่างมีประสิทธิภาพโดยยังคงรักษาการจัดรูปแบบที่มีอยู่ไว้

## ขั้นตอนที่ 8: บันทึกสมุดงาน

สุดท้ายคุณจะต้องการบันทึกการเปลี่ยนแปลงของคุณไปยังไฟล์ใหม่เพื่อให้ไฟล์ต้นฉบับยังคงไม่บุบสลาย

```csharp
// บันทึกสมุดงานในรูปแบบ XLSX
wb.Save(outputDir + "outputChangeCellsAlignmentAndKeepExistingFormatting.xlsx", SaveFormat.Xlsx);
```

บรรทัดนี้จะบันทึกเวิร์กบุ๊กพร้อมการเปลี่ยนแปลงการจัดตำแหน่งในไดเร็กทอรีเอาต์พุตที่ระบุไว้ก่อนหน้านี้

## ขั้นตอนที่ 9: แจ้งความสำเร็จ

หลังจากบันทึกไฟล์แล้ว เป็นการดีที่จะให้ข้อเสนอแนะว่าทุกอย่างทำงานตามที่คาดหวัง!

```csharp
Console.WriteLine("ChangeCellsAlignmentAndKeepExistingFormatting executed successfully.");
```

ข้อความนี้จะปรากฏในคอนโซลถ้าการดำเนินการของคุณเสร็จสมบูรณ์โดยไม่มีปัญหา

## บทสรุป

การเปลี่ยนการจัดตำแหน่งเซลล์ใน Excel โดยยังคงรูปแบบเดิมไว้เป็นกระบวนการที่ราบรื่นด้วย Aspose.Cells สำหรับ .NET เมื่อทำตามขั้นตอนเหล่านี้ คุณจะสามารถลดความซับซ้อนในการจัดการ Excel ในแอปพลิเคชันของคุณได้ และหลีกเลี่ยงความปวดหัวจากการสูญเสียรูปแบบที่มีค่า ไม่ว่าคุณจะกำลังสร้างรายงานหรือจัดการฟีดข้อมูล การเชี่ยวชาญทักษะนี้สามารถเปลี่ยนเกมได้!

## คำถามที่พบบ่อย

### Aspose.Cells จัดการไฟล์ Excel ขนาดใหญ่ได้หรือไม่
แน่นอน! ได้รับการปรับให้เหมาะสมเพื่อประสิทธิภาพการทำงานและสามารถประมวลผลไฟล์ขนาดใหญ่ได้อย่างมีประสิทธิภาพ

### มีเวอร์ชันทดลองใช้สำหรับ Aspose.Cells หรือไม่
 ใช่! คุณสามารถดาวน์โหลดรุ่นทดลองใช้งานฟรีได้จากเว็บไซต์[ทดลองใช้งานฟรี](https://releases.aspose.com/).

### Aspose.Cells รองรับภาษาโปรแกรมอะไรบ้าง?
Aspose.Cells รองรับ .NET, Java และภาษาอื่นๆ หลายภาษาเป็นหลักผ่านทางไลบรารีที่เกี่ยวข้อง

### ฉันจะได้รับการสนับสนุนสำหรับ Aspose.Cells ได้อย่างไร?
 หากมีข้อสงสัยหรือต้องการความช่วยเหลือ โปรดไปที่[ฟอรั่มสนับสนุน](https://forum.aspose.com/c/cells/9).

### ฉันสามารถใช้หลายสไตล์ในครั้งเดียวได้ไหม?
ใช่ คุณสามารถสร้างวัตถุสไตล์หลายรายการและนำไปใช้ตามลำดับหรือตามเงื่อนไขตามต้องการ
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
