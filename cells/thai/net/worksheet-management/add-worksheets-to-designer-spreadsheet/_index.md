---
title: เพิ่มเวิร์กชีตลงในสเปรดชีตของนักออกแบบโดยใช้ Aspose.Cells
linktitle: เพิ่มเวิร์กชีตลงในสเปรดชีตของนักออกแบบโดยใช้ Aspose.Cells
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีเพิ่มเวิร์กชีตใหม่ลงในไฟล์ Excel ที่มีอยู่โดยใช้ Aspose.Cells สำหรับ .NET คำแนะนำทีละขั้นตอนพร้อมตัวอย่าง คำถามที่พบบ่อย และอื่นๆ เพื่อลดความซับซ้อนของงานเขียนโค้ดของคุณ
weight: 11
url: /th/net/worksheet-management/add-worksheets-to-designer-spreadsheet/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# เพิ่มเวิร์กชีตลงในสเปรดชีตของนักออกแบบโดยใช้ Aspose.Cells

## การแนะนำ
การจัดการไฟล์ Excel ด้วยโปรแกรมถือเป็นการเปลี่ยนแปลงครั้งสำคัญเมื่อต้องทำงานอัตโนมัติ ลดความซับซ้อนในการป้อนข้อมูล และจัดทำรายงานแบบกำหนดเอง หนึ่งในเครื่องมืออันทรงพลังในพื้นที่ .NET คือ Aspose.Cells สำหรับ .NET ซึ่งให้ฟังก์ชันมากมายสำหรับการสร้าง แก้ไข และจัดการไฟล์ Excel โดยไม่ต้องพึ่งพา Microsoft Excel เอง ในบทช่วยสอนนี้ เราจะสำรวจวิธีการเพิ่มเวิร์กชีตใหม่ลงในสเปรดชีตสำหรับนักออกแบบโดยใช้ Aspose.Cells สำหรับ .NET ทีละขั้นตอน
## ข้อกำหนดเบื้องต้น
ก่อนที่จะเจาะลึกโค้ด นี่คือสิ่งที่คุณต้องมี:
1.  ไลบรารี Aspose.Cells สำหรับ .NET – ดาวน์โหลด[Aspose.Cells สำหรับไลบรารี .NET](https://releases.aspose.com/cells/net/) และเพิ่มลงในโครงการของคุณ Aspose นำเสนอเวอร์ชันทดลองใช้งานฟรี แต่คุณยังสามารถรับเวอร์ชันทดลองใช้งานฟรีได้[ใบอนุญาตชั่วคราว](https://purchase.aspose.com/temporary-license/) เพื่อการเข้าถึงคุณสมบัติเต็มรูปแบบในระหว่างขั้นตอนการพัฒนาของคุณ
2. ความรู้พื้นฐานเกี่ยวกับ C# – เนื่องจากเราใช้ .NET คุณจึงควรคุ้นเคยกับรูปแบบภาษา C#
3. Visual Studio หรือ IDE ที่เข้ากันได้ – คุณจะต้องมีสภาพแวดล้อมการพัฒนาแบบบูรณาการ (IDE) ที่เข้ากันได้กับ .NET เช่น Visual Studio เพื่อดำเนินการและทดสอบโค้ด
## แพ็คเกจนำเข้า
ในการเริ่มต้น คุณจะต้องนำเข้าเนมสเปซ Aspose.Cells เข้าสู่โปรเจ็กต์ของคุณ ซึ่งจะทำให้สามารถเข้าถึงคลาสและวิธีการที่จำเป็นในการทำงานกับไฟล์ Excel ใน .NET ได้
```csharp
using System.IO;
using Aspose.Cells;
using System;
```
ตอนนี้คุณมีข้อกำหนดเบื้องต้นแล้ว มาแยกส่วนแต่ละส่วนของโค้ดเพื่อทำความเข้าใจว่าจะเพิ่มเวิร์กชีตลงในสเปรดชีตที่มีอยู่ได้อย่างไร
## ขั้นตอนที่ 1: ตั้งค่าเส้นทางไปยังไดเรกทอรีเอกสารของคุณ
ก่อนอื่น เรามากำหนดเส้นทางของไฟล์ที่เก็บเอกสาร Excel กันก่อน นี่คือจุดที่ Aspose.Cells จะค้นหาไฟล์ที่มีอยู่
```csharp
string dataDir = "Your Document Directory";
string inputPath = dataDir + "book1.xlsx";
```
ในชิ้นส่วนโค้ดนี้:
- `dataDir` แสดงเส้นทางโฟลเดอร์สำหรับไฟล์ของคุณ
- `inputPath` เป็นเส้นทางเต็มไปยังไฟล์ Excel ที่มีอยู่ของคุณ (`book1.xlsx` ในกรณีนี้).
## ขั้นตอนที่ 2: เปิดไฟล์ Excel เป็นสตรีมไฟล์
 ในการทำงานกับไฟล์ Excel ให้สร้าง`FileStream`การดำเนินการนี้จะเปิดไฟล์ในลักษณะที่ให้ Aspose.Cells สามารถอ่านและจัดการเนื้อหาได้
```csharp
FileStream fstream = new FileStream(inputPath, FileMode.Open);
```
ที่นี่:
-  เรากำลังเปิด`inputPath` โดยใช้`FileStream` ใน`Open`โหมดซึ่งให้สิทธิ์การเข้าถึงไฟล์แบบอ่าน-เขียน
## ขั้นตอนที่ 3: เริ่มต้นวัตถุเวิร์กบุ๊ก
 เมื่อเปิดสตรีมไฟล์แล้ว เราสามารถเริ่มต้นได้`Workbook` วัตถุ วัตถุนี้แสดงถึงไฟล์ Excel และเป็นจุดเข้าสำหรับการดำเนินการทั้งหมดที่เกี่ยวข้องกับไฟล์
```csharp
Workbook workbook = new Workbook(fstream);
```
ในขั้นตอนนี้:
-  เรากำลังสร้าง`Workbook` วัตถุที่มีชื่อว่า`workbook` และผ่านเข้ามา`fstream` เพื่อให้ Aspose.Cells สามารถเข้าถึงไฟล์ Excel ที่เปิดอยู่ได้
## ขั้นตอนที่ 4: เพิ่มเวิร์กชีตใหม่
 ตอนนี้เรามาเพิ่มเวิร์กชีตลงในเวิร์กบุ๊กของเรากัน Aspose.Cells มีวิธีการที่สะดวกที่เรียกว่า`Add()` เพื่อจุดประสงค์นี้
```csharp
int i = workbook.Worksheets.Add();
```
นี่คือสิ่งที่เกิดขึ้น:
- `Add()` ผนวกแผ่นงานใหม่ไปที่ตอนท้ายของสมุดงาน
- `int i` เก็บดัชนีของเวิร์กชีตใหม่ ซึ่งมีประโยชน์เมื่อเราจำเป็นต้องอ้างอิงถึงเวิร์กชีตนั้น
## ขั้นตอนที่ 5: รับการอ้างอิงถึงเวิร์กชีตใหม่
เมื่อเพิ่มเวิร์กชีตแล้ว คุณต้องได้รับข้อมูลอ้างอิงถึงเวิร์กชีตนั้น ซึ่งจะทำให้การจัดการหรือปรับแต่งเวิร์กชีตใหม่ง่ายขึ้น
```csharp
Worksheet worksheet = workbook.Worksheets[i];
```
คำอธิบาย:
- `workbook.Worksheets[i]` ดึงแผ่นงานที่เพิ่มใหม่ตามดัชนี และเรากำหนดให้กับ`worksheet` ตัวแปร.
## ขั้นตอนที่ 6: ตั้งชื่อให้กับเวิร์กชีตใหม่
หากต้องการให้เวิร์กบุ๊กของคุณอ่านง่ายขึ้น โปรดตั้งชื่อเวิร์กชีตใหม่ให้มีความหมาย
```csharp
worksheet.Name = "My Worksheet";
```
ในขั้นตอนนี้:
-  เรากำลังกำหนดชื่อ`"My Worksheet"`ไปที่แผ่นงานที่เราสร้างขึ้นใหม่โดยใช้`Name` คุณสมบัติ.
## ขั้นตอนที่ 7: บันทึกสมุดงานที่อัปเดต
สุดท้าย ให้บันทึกการเปลี่ยนแปลงของคุณไปยังไฟล์ Excel ใหม่ วิธีนี้จะทำให้ไฟล์ต้นฉบับไม่เปลี่ยนแปลง และเวอร์ชันที่อัปเดตจะรวมเวิร์กชีตที่คุณเพิ่มเข้าไปด้วย
```csharp
workbook.Save(dataDir + "output.xlsx");
```
คำอธิบาย:
- `workbook.Save()` บันทึกสมุดงานและ`dataDir + "output.xlsx"` ระบุเส้นทางและชื่อไฟล์สำหรับไฟล์เอาต์พุต
## ขั้นตอนที่ 8: ปิดสตรีมไฟล์
เพื่อแนวทางปฏิบัติที่ดีที่สุด ให้ปิดสตรีมไฟล์เมื่อดำเนินการเสร็จเพื่อปลดปล่อยทรัพยากรระบบ
```csharp
fstream.Close();
```
ในขั้นตอนนี้:
- `fstream.Close()` ช่วยให้แน่ใจว่าสตรีมไฟล์ของเราถูกปิดอย่างถูกต้อง ซึ่งเป็นสิ่งสำคัญเพื่อหลีกเลี่ยงการล็อคไฟล์
เพียงเท่านี้ก็เสร็จเรียบร้อย! คุณได้เพิ่มเวิร์กชีตใหม่ลงในไฟล์ Excel ที่มีอยู่แล้วโดยใช้ Aspose.Cells สำหรับ .NET สำเร็จแล้ว
## บทสรุป
การใช้ Aspose.Cells สำหรับ .NET เพื่อเพิ่มเวิร์กชีตลงในไฟล์ Excel ด้วยโปรแกรมนั้นเป็นเรื่องง่าย แต่ทรงพลังอย่างยิ่ง ด้วยทักษะนี้ คุณสามารถสร้างสเปรดชีตที่กำหนดเองได้แบบไดนามิก ป้อนข้อมูลซ้ำๆ โดยอัตโนมัติ และจัดโครงสร้างรายงานตามต้องการได้อย่างแม่นยำ ตั้งแต่การเพิ่มเวิร์กชีต การตั้งชื่อ และการบันทึกผลลัพธ์สุดท้าย บทช่วยสอนนี้ครอบคลุมสิ่งสำคัญทั้งหมด
## คำถามที่พบบ่อย
### 1. ฉันสามารถเพิ่มเวิร์กชีตหลายแผ่นในครั้งเดียวได้ไหม
 ใช่ เพียงโทรไปที่`Add()` วิธีการนี้ทำซ้ำหลายครั้งเพื่อเพิ่มเวิร์กชีตได้มากเท่าที่จำเป็น
### 2. ฉันจะตรวจสอบจำนวนเวิร์กชีทในเวิร์กบุ๊กได้อย่างไร
 คุณสามารถใช้`workbook.Worksheets.Count` เพื่อรับจำนวนแผ่นงานทั้งหมดในสมุดงาน
### 3. สามารถเพิ่มแผ่นงานในตำแหน่งที่ต้องการได้ไหม?
 ใช่ คุณสามารถระบุตำแหน่งได้โดยใช้`Insert` วิธีการมากกว่า`Add()`.
### 4. ฉันสามารถเปลี่ยนชื่อเวิร์กชีตหลังจากเพิ่มแล้วได้หรือไม่
 แน่นอน! เพียงตั้งค่า`Name` ทรัพย์สินของ`Worksheet` คัดค้านชื่อใหม่
### 5. Aspose.Cells จำเป็นต้องติดตั้ง Microsoft Excel หรือไม่
ไม่ Aspose.Cells เป็นไลบรารีแบบสแตนด์อโลน ดังนั้นไม่จำเป็นต้องติดตั้ง Excel บนเครื่องของคุณ

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
