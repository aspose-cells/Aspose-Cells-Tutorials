---
title: แทรกภาพในส่วนหัว ส่วนท้าย ของเวิร์กชีต
linktitle: แทรกภาพในส่วนหัว ส่วนท้าย ของเวิร์กชีต
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีการแทรกภาพลงในส่วนหัว/ส่วนท้ายได้อย่างง่ายดายโดยใช้ Aspose.Cells สำหรับ .NET ในคู่มือที่ครอบคลุมนี้
weight: 15
url: /th/net/worksheet-page-setup-features/insert-image-in-header-footer/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# แทรกภาพในส่วนหัว ส่วนท้าย ของเวิร์กชีต

## การแนะนำ
เมื่อต้องสร้างสเปรดชีต Excel ที่ดูเป็นมืออาชีพ รายละเอียดเล็กๆ น้อยๆ สามารถสร้างความแตกต่างได้อย่างมาก รายละเอียดหนึ่งก็คือการเพิ่มรูปภาพลงในส่วนหัวหรือส่วนท้ายของเวิร์กชีตของคุณ วิธีนี้เป็นวิธีที่แน่นอนในการสร้างแบรนด์เอกสารและเพิ่มความเป็นมืออาชีพให้กับเอกสารของคุณ แม้ว่าวิธีนี้อาจฟังดูซับซ้อน โดยเฉพาะอย่างยิ่งหากคุณไม่ใช่ผู้เชี่ยวชาญด้านเทคโนโลยี แต่การใช้ Aspose.Cells สำหรับ .NET ช่วยลดความยุ่งยากของกระบวนการได้อย่างมาก ดังนั้น มาดูวิธีทำทีละขั้นตอนกันเลย!
## ข้อกำหนดเบื้องต้น
ก่อนที่คุณจะเริ่มต้นการแทรกภาพลงในส่วนหัวและส่วนท้าย โปรดตรวจสอบให้แน่ใจว่าคุณมีสิ่งต่างๆ บางอย่างพร้อมแล้ว:
1. Visual Studio: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Visual Studio บนคอมพิวเตอร์ของคุณแล้ว IDE นี้เป็นขุมพลังสำหรับการพัฒนา .NET
2.  Aspose.Cells สำหรับ .NET: คุณสามารถทดลองใช้งานฟรีหรือซื้อได้หากคุณจริงจังกับการเพิ่มประสิทธิภาพความสามารถของ Excel ของคุณ ดาวน์โหลด[ที่นี่](https://releases.aspose.com/cells/net/).
3. ความรู้พื้นฐานเกี่ยวกับ C#: ความเข้าใจพื้นฐานเกี่ยวกับ C# และวิธีรันแอปพลิเคชัน .NET จะเป็นประโยชน์
4. ไฟล์รูปภาพ: เตรียมไฟล์รูปภาพ เช่น โลโก้บริษัท ในตัวอย่างนี้ เราจะเรียกว่า`aspose-logo.jpg`.
## แพ็คเกจนำเข้า
หากต้องการเริ่มต้นการเขียนโค้ด โปรดตรวจสอบให้แน่ใจว่าคุณได้นำแพ็คเกจที่จำเป็นเข้าสู่โปรเจ็กต์ C# ของคุณแล้ว คุณต้องมีเนมสเปซ Aspose.Cells ซึ่งประกอบด้วยคลาสและเมธอดทั้งหมดที่คุณจะใช้งาน
วิธีรวมไว้ในโค้ดของคุณมีดังนี้:
```csharp
using System.IO;
using Aspose.Cells;
using System;
```
ตอนนี้เราได้ตั้งค่าทุกอย่างเรียบร้อยแล้ว มาดูขั้นตอนต่างๆ กันโดยมีขั้นตอนที่ทำตามได้ง่าย
## ขั้นตอนที่ 1: ตั้งค่าไดเร็กทอรีของคุณ
กำหนดว่าไฟล์ของคุณจะถูกจัดเก็บไว้ที่ไหน
 ก่อนอื่น เราต้องระบุเส้นทางไปยังไดเร็กทอรีเอกสารซึ่งไฟล์ Excel และรูปภาพตั้งอยู่ คุณสามารถตั้งค่าเส้นทางใดก็ได้ เพียงแทนที่`"Your Document Directory"` ด้วยเส้นทางไดเร็กทอรีจริงของคุณ
```csharp
string dataDir = "Your Document Directory";
```
## ขั้นตอนที่ 2: สร้างวัตถุเวิร์กบุ๊ก
สร้างอินสแตนซ์ของเวิร์กบุ๊ก Excel ของคุณ
เมื่อตั้งค่าเส้นทางแล้ว ตอนนี้เราจะต้องสร้างอินสแตนซ์ใหม่ของเวิร์กชีตที่เราจะแทรกภาพ 
```csharp
Workbook workbook = new Workbook();
```
## ขั้นตอนที่ 3: โหลดภาพของคุณ
เปิดและอ่านไฟล์รูปภาพแล้วแปลงให้เป็นอาร์เรย์ไบต์เพื่อประมวลผล
ต่อไปเราจะกำหนดเส้นทางสำหรับภาพของเรา (โลโก้ในกรณีนี้) และกำหนดค่าเริ่มต้น`FileStream` วัตถุที่จะอ่านภาพ วิธีการทำมีดังนี้
```csharp
string logo_url = dataDir + "aspose-logo.jpg";
// การประกาศวัตถุ FileStream
FileStream inFile;
byte[] binaryData;
// การสร้างอินสแตนซ์ของวัตถุ FileStream
inFile = new FileStream(logo_url, FileMode.Open, FileAccess.Read);
```
## ขั้นตอนที่ 4: อ่านภาพลงในอาร์เรย์ไบต์
แปลงข้อมูลไฟล์รูปภาพให้เป็นอาร์เรย์ไบต์
ในการทำงานกับรูปภาพ เราจำเป็นต้องอ่านข้อมูลลงในอาร์เรย์ไบต์ ซึ่งถือเป็นสิ่งสำคัญ เพราะช่วยให้เราจัดการรูปภาพภายในแอปพลิเคชันได้
```csharp
// การสร้างอินสแตนซ์ของอาร์เรย์ไบต์ของขนาดของวัตถุ FileStream
binaryData = new byte[inFile.Length];
// อ่านบล็อกไบต์จากสตรีมและเขียนข้อมูลลงในบัฟเฟอร์ที่กำหนดของอาร์เรย์ไบต์
long bytesRead = inFile.Read(binaryData, 0, (int)inFile.Length);
```
## ขั้นตอนที่ 5: กำหนดค่าการตั้งค่าหน้าสำหรับส่วนหัว/ส่วนท้าย
เข้าถึงวัตถุ PageSetup เพื่อจัดการส่วนหัวและส่วนท้าย
ในการแทรกภาพ เราจำเป็นต้องกำหนดค่าอ็อบเจ็กต์การตั้งค่าหน้า ซึ่งจะช่วยให้เราปรับแต่งส่วนหัวของเวิร์กชีตได้:
```csharp
PageSetup pageSetup = workbook.Worksheets[0].PageSetup;
```
## ขั้นตอนที่ 6: แทรกโลโก้ลงในส่วนหัว
ฝังรูปภาพลงในส่วนหัวของเวิร์กชีต
นี่คือช่วงเวลาอันมหัศจรรย์! เราจะแทรกโลโก้ของเราลงในส่วนตรงกลางของส่วนหัว:
```csharp
// ตั้งค่าโลโก้/รูปภาพในส่วนกลางของส่วนหัวของหน้า
pageSetup.SetHeaderPicture(1, binaryData);
// ตั้งค่าสคริปต์สำหรับโลโก้/รูปภาพ
pageSetup.SetHeader(1, "&G");
// ตั้งชื่อชีตในส่วนด้านขวาของส่วนหัวของหน้าด้วยสคริปต์
pageSetup.SetHeader(2, "&A");
```
## ขั้นตอนที่ 7: บันทึกสมุดงานของคุณ
บันทึกการเปลี่ยนแปลงของคุณลงในไฟล์ Excel ใหม่
หลังจากกำหนดค่าทุกอย่างเสร็จแล้ว ก็ถึงเวลาบันทึกเวิร์กบุ๊กของเรา โปรดอย่าลืมตั้งชื่อไฟล์เอาต์พุตใหม่:
```csharp
workbook.Save(dataDir + "InsertImageInHeaderFooter_out.xls");
```
## ขั้นตอนที่ 8: ทำความสะอาดทรัพยากร
ปิด FileStream เพื่อปล่อยทรัพยากร
 สุดท้ายนี้ หลังจากการจัดการทั้งหมดแล้ว อย่าลืมที่จะทำความสะอาดโดยการปิด`FileStream`-
```csharp
inFile.Close();
```
## บทสรุป
และแล้วคุณก็ทำได้! คุณได้แทรกภาพลงในส่วนหัว/ส่วนท้ายของเวิร์กชีต Excel สำเร็จแล้วโดยใช้ Aspose.Cells สำหรับ .NET ง่ายใช่ไหม? เมื่อคุณเข้าใจขั้นตอนต่างๆ แล้ว คุณสามารถปรับแต่งเพิ่มเติมเพื่อให้เหมาะกับความต้องการเฉพาะของคุณได้ ไม่ว่าคุณต้องการสร้างรายงานสำหรับธุรกิจของคุณหรือเพียงแค่เพิ่มสัมผัสส่วนตัว เทคนิคนี้ก็มีประโยชน์อย่างยิ่ง 
## คำถามที่พบบ่อย
### ฉันสามารถใช้รูปแบบรูปภาพใดก็ได้หรือไม่?
ใช่ Aspose.Cells รองรับรูปแบบภาพต่างๆ รวมถึง JPEG, PNG และ BMP สำหรับภาพส่วนหัวและส่วนท้าย
### การใช้ Aspose.Cells ฟรีหรือไม่?
 Aspose.Cells เสนอให้ทดลองใช้งานฟรี แต่หากต้องการใช้งานต่อ คุณจะต้องซื้อใบอนุญาต ดูข้อมูลเพิ่มเติมเกี่ยวกับราคา[ที่นี่](https://purchase.aspose.com/buy).
### ฉันจะเข้าถึงเอกสาร Aspose.Cells ได้อย่างไร
 คุณสามารถเจาะลึกคุณลักษณะและฟังก์ชันของ Aspose.Cells ได้โดยเข้าไปที่[เอกสารประกอบ](https://reference.aspose.com/cells/net/).
### ฉันสามารถใช้ Aspose.Cells โดยไม่ใช้ Visual Studio ได้หรือไม่
ใช่ ตราบใดที่คุณมีสภาพแวดล้อมรันไทม์ .NET คุณสามารถใช้ Aspose.Cells ในสภาพแวดล้อมการพัฒนาที่เข้ากันได้กับ .NET ได้
### ฉันควรทำอย่างไรหากพบปัญหา?
 หากคุณประสบปัญหาใดๆ หรือต้องการความช่วยเหลือ โปรดตรวจสอบ[ฟอรั่มสนับสนุน Aspose](https://forum.aspose.com/c/cells/9) เพื่อขอความช่วยเหลือจากชุมชนและนักพัฒนา
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
