---
title: ลบการตั้งค่าเครื่องพิมพ์ที่มีอยู่จากเวิร์กชีต
linktitle: ลบการตั้งค่าเครื่องพิมพ์ที่มีอยู่จากเวิร์กชีต
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีการลบการตั้งค่าเครื่องพิมพ์ที่มีอยู่จากเวิร์กชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET ในคู่มือทีละขั้นตอนโดยละเอียดนี้
weight: 19
url: /th/net/worksheet-page-setup-features/remove-existing-printer-settings/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# ลบการตั้งค่าเครื่องพิมพ์ที่มีอยู่จากเวิร์กชีต

## การแนะนำ
หากคุณเคยทำงานกับไฟล์ Excel คุณจะทราบดีว่าการตั้งค่าเอกสารให้ถูกต้องนั้นสำคัญเพียงใด โดยเฉพาะอย่างยิ่งเมื่อต้องพิมพ์ คุณทราบหรือไม่ว่าการตั้งค่าเครื่องพิมพ์บางครั้งอาจส่งต่อจากเวิร์กชีตหนึ่งไปยังอีกเวิร์กชีตหนึ่ง ซึ่งอาจส่งผลต่อรูปแบบการพิมพ์ของคุณได้ ในบทช่วยสอนนี้ เราจะเจาะลึกถึงวิธีการลบการตั้งค่าเครื่องพิมพ์ที่มีอยู่แล้วออกจากเวิร์กชีตได้อย่างง่ายดายโดยใช้ไลบรารี Aspose.Cells อันทรงพลังสำหรับ .NET ไม่ว่าคุณจะเป็นนักพัฒนาที่มีประสบการณ์หรือเพิ่งเริ่มต้น บทความนี้ได้รับการออกแบบมาเพื่อแนะนำคุณในแต่ละขั้นตอน มาเริ่มกันเลย!
## ข้อกำหนดเบื้องต้น
ก่อนที่เราจะเจาะลึกลงไปในความมหัศจรรย์ของการเขียนโค้ด มีบางสิ่งที่คุณจะต้องตั้งค่า:
1. Visual Studio: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Visual Studio บนเครื่องของคุณแล้ว
2. Aspose.Cells สำหรับไลบรารี .NET: คุณสามารถดาวน์โหลดไลบรารี Aspose.Cells ได้จาก[ที่นี่](https://releases.aspose.com/cells/net/).
3. ความเข้าใจพื้นฐานเกี่ยวกับ C#: เนื่องจากบทช่วยสอนนี้เกี่ยวข้องกับการเขียนโค้ดใน C# การมีความเข้าใจพื้นฐานเกี่ยวกับภาษาจึงจะเป็นประโยชน์
4. ไฟล์ Excel ตัวอย่าง: คุณจะต้องมีไฟล์ Excel ที่มีอยู่ซึ่งมีการตั้งค่าเครื่องพิมพ์ที่คุณต้องการลบออก คุณสามารถสร้างไฟล์ตัวอย่างหรือใช้เอกสารที่มีอยู่ก็ได้
เมื่อคุณตั้งค่าสภาพแวดล้อมของคุณเสร็จแล้ว เราก็สามารถเริ่มคลี่คลายโค้ดได้
## แพ็คเกจนำเข้า
ก่อนที่เราจะเริ่มต้นเขียนโค้ดสำหรับการลบการตั้งค่าเครื่องพิมพ์ เราต้องแน่ใจก่อนว่าเราได้นำแพ็คเกจที่ถูกต้องเข้ามาในโครงการ C# แล้ว นี่คือสิ่งที่คุณต้องการในไฟล์โค้ดของคุณ:
```csharp
using System.IO;
using Aspose.Cells;
using System;
```
ตอนนี้เรามีทุกสิ่งที่ต้องการแล้ว มาดูรายละเอียดของโค้ดกัน
## ขั้นตอนที่ 1: กำหนดไดเรกทอรีแหล่งที่มาและเอาต์พุตของคุณ
ขั้นตอนแรกคือการระบุว่าเอกสาร Excel ต้นฉบับของคุณอยู่ที่ไหนและคุณต้องการบันทึกเวอร์ชันที่แก้ไขไว้ที่ใด
```csharp
// ไดเรกทอรีแหล่งที่มา
string sourceDir = "Your Document Directory\\";
// ไดเรกทอรีผลลัพธ์
string outputDir = "Your Document Directory\\";
```
 อย่าลืมเปลี่ยน`"Your Document Directory\\"` พร้อมเส้นทางจริงไปยังเอกสารของคุณ
## ขั้นตอนที่ 2: โหลดไฟล์ Excel ต้นฉบับ
ต่อไปให้โหลดเวิร์กบุ๊ก (ไฟล์ Excel) ที่มีการตั้งค่าเครื่องพิมพ์ คุณต้องตรวจสอบให้แน่ใจว่าเส้นทางของไฟล์ถูกต้อง
```csharp
// โหลดไฟล์ Excel ต้นฉบับ
Workbook wb = new Workbook(sourceDir + "sampleRemoveExistingPrinterSettingsOfWorksheets.xlsx");
```
 ที่นี่ เรากำลังโหลดไฟล์ Excel ที่ระบุลงใน`Workbook` วัตถุที่มีชื่อว่า`wb`.
## ขั้นตอนที่ 3: รับจำนวนแผ่นงาน
เราจำเป็นต้องทราบว่ามีเวิร์กชีตจำนวนเท่าใดในเวิร์กบุ๊ก เพื่อที่จะสามารถทำซ้ำและตรวจสอบการตั้งค่าเครื่องพิมพ์ได้
```csharp
// รับจำนวนแผ่นงานของสมุดงาน
int sheetCount = wb.Worksheets.Count;
```
บรรทัดโค้ดนี้จะดึงจำนวนเวิร์กชีตที่มีอยู่ในเวิร์กบุ๊ก
## ขั้นตอนที่ 4: ทำซ้ำผ่านเวิร์กชีตทั้งหมด
ตอนนี้เรามาตั้งค่าขั้นตอนในการวนซ้ำผ่านเวิร์กชีตแต่ละแผ่นในเวิร์กบุ๊กกัน เราจะตรวจสอบว่ามีการตั้งค่าเครื่องพิมพ์สำหรับเวิร์กชีตแต่ละแผ่นหรือไม่
```csharp
// ทำซ้ำแผ่นงานทั้งหมด
for (int i = 0; i < sheetCount; i++)
{
    // เข้าถึงแผ่นงานที่ i
    Worksheet ws = wb.Worksheets[i];
```
## ขั้นตอนที่ 5: เข้าถึงการตั้งค่าหน้าเวิร์กชีต
เวิร์กชีตแต่ละแผ่นจะมีคุณสมบัติการตั้งค่าหน้า ซึ่งรวมถึงการตั้งค่าเครื่องพิมพ์ที่เราต้องการตรวจสอบและอาจลบออก
```csharp
    // การตั้งค่าหน้าเวิร์กชีตการเข้าถึง
    PageSetup ps = ws.PageSetup;
```
## ขั้นตอนที่ 6: ตรวจสอบการตั้งค่าเครื่องพิมพ์ที่มีอยู่
ถึงเวลาตรวจสอบแล้วว่าการตั้งค่าเครื่องพิมพ์สำหรับเวิร์กชีตปัจจุบันมีหรือไม่ หากมี เราจะพิมพ์ข้อความและดำเนินการลบการตั้งค่าดังกล่าว
```csharp
    // ตรวจสอบว่ามีการตั้งค่าเครื่องพิมพ์สำหรับเวิร์กชีตนี้หรือไม่
    if (ps.PrinterSettings != null)
    {
        Console.WriteLine("PrinterSettings of this worksheet exist.");
```
## ขั้นตอนที่ 7: พิมพ์รายละเอียดแผ่นงาน
หากพบการตั้งค่าเครื่องพิมพ์ จะแสดงข้อมูลที่เป็นประโยชน์เกี่ยวกับเวิร์กชีตและการตั้งค่าเครื่องพิมพ์
```csharp
        Console.WriteLine("Sheet Name: " + ws.Name);
        Console.WriteLine("Paper Size: " + ps.PaperSize);
```
วิธีนี้จะช่วยให้เราตรวจสอบได้ว่าแผ่นงานใดมีการตั้งค่าเครื่องพิมพ์ไว้
## ขั้นตอนที่ 8: ลบการตั้งค่าเครื่องพิมพ์
 ตอนนี้มาถึงขั้นตอนหลักแล้ว! เราจะลบการตั้งค่าเครื่องพิมพ์ที่มีอยู่โดยกำหนด`null` ไปที่`PrinterSettings` คุณสมบัติ.
```csharp
        // ลบการตั้งค่าเครื่องพิมพ์โดยตั้งค่าเป็นค่าว่าง
        ps.PrinterSettings = null;
        Console.WriteLine("Printer settings of this worksheet are now removed by setting it null.");
        Console.WriteLine("");
    }
}
```
## ขั้นตอนที่ 9: บันทึกสมุดงานที่แก้ไขแล้ว
สุดท้ายนี้ ให้เราบันทึกสมุดงานหลังจากทำการเปลี่ยนแปลงที่จำเป็นทั้งหมดแล้ว
```csharp
// บันทึกสมุดงาน
wb.Save(outputDir + "outputRemoveExistingPrinterSettingsOfWorksheets.xlsx");
```
## บทสรุป
และแล้วคุณก็รู้แล้ว! คุณเพิ่งเรียนรู้วิธีการลบการตั้งค่าเครื่องพิมพ์ที่มีอยู่จากเวิร์กชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET ด้วยขั้นตอนง่ายๆ นี้ คุณสามารถช่วยให้แน่ใจได้ว่าเอกสารของคุณจะพิมพ์ออกมาตามที่ต้องการโดยไม่มีการตั้งค่าเก่าๆ ที่น่ารำคาญหลงเหลืออยู่ ดังนั้น ครั้งต่อไปที่คุณประสบปัญหาเกี่ยวกับการตั้งค่าเครื่องพิมพ์ คุณจะรู้ว่าต้องทำอย่างไร!
## คำถามที่พบบ่อย
### Aspose.Cells คืออะไร?
Aspose.Cells คือไลบรารี .NET ที่ช่วยให้นักพัฒนาสามารถทำงานกับไฟล์ Excel ได้อย่างราบรื่นโดยไม่จำเป็นต้องติดตั้ง Microsoft Excel
### ฉันจำเป็นต้องซื้อ Aspose.Cells เพื่อใช้งานหรือไม่?
 คุณสามารถเริ่มต้นด้วยการทดลองใช้ฟรี แต่หากต้องการใช้ในระยะยาว คุณจะต้องซื้อใบอนุญาต ตรวจสอบ[ที่นี่](https://purchase.aspose.com/buy) สำหรับตัวเลือก
### ฉันสามารถลบการตั้งค่าเครื่องพิมพ์สำหรับเวิร์คชีตทั้งหมดพร้อมกันได้ไหม
ใช่! ตามที่เราได้สาธิตไว้ในบทช่วยสอน คุณสามารถวนซ้ำผ่านแต่ละเวิร์กชีตเพื่อลบการตั้งค่าได้
### มีความเสี่ยงที่จะสูญเสียข้อมูลเมื่อแก้ไขการตั้งค่าเครื่องพิมพ์หรือไม่?
ไม่ การลบการตั้งค่าเครื่องพิมพ์จะไม่ส่งผลต่อข้อมูลจริงในเวิร์กชีตของคุณ
### ฉันสามารถหาความช่วยเหลือเกี่ยวกับ Aspose.Cells ได้ที่ไหน
 คุณสามารถค้นหาการสนับสนุนและทรัพยากรชุมชนได้ที่[ฟอรั่ม Aspose](https://forum.aspose.com/c/cells/9).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
