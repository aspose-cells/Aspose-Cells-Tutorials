---
title: การนำส่วนหัวและส่วนท้ายไปใช้ในเวิร์กชีต
linktitle: การนำส่วนหัวและส่วนท้ายไปใช้ในเวิร์กชีต
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีการตั้งค่าส่วนหัวและส่วนท้ายในเวิร์กชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET พร้อมด้วยบทช่วยสอนทีละขั้นตอน ตัวอย่างเชิงปฏิบัติ และเคล็ดลับที่เป็นประโยชน์
weight: 22
url: /th/net/worksheet-page-setup-features/implement-header-and-footer/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# การนำส่วนหัวและส่วนท้ายไปใช้ในเวิร์กชีต

## การแนะนำ

เมื่อทำงานกับสเปรดชีต Excel ส่วนหัวและส่วนท้ายมีบทบาทสำคัญในการส่งมอบข้อมูลบริบทที่สำคัญ เช่น ชื่อไฟล์ วันที่ หรือหมายเลขหน้า ให้กับผู้ชมของคุณ ไม่ว่าคุณจะกำลังสร้างรายงานอัตโนมัติหรือสร้างไฟล์แบบไดนามิก Aspose.Cells สำหรับ .NET จะทำให้การปรับแต่งส่วนหัวและส่วนท้ายในเวิร์กชีตทำได้ง่ายขึ้นด้วยโปรแกรม คู่มือนี้จะอธิบายวิธีการแบบทีละขั้นตอนที่ครอบคลุมในการเพิ่มส่วนหัวและส่วนท้ายด้วย Aspose.Cells สำหรับ .NET ซึ่งจะทำให้ไฟล์ Excel ของคุณดูสวยงามและเป็นมืออาชีพยิ่งขึ้น

## ข้อกำหนดเบื้องต้น

ก่อนที่คุณจะเริ่มต้น โปรดตรวจสอบให้แน่ใจว่าคุณมีสิ่งต่อไปนี้:

1.  Aspose.Cells สำหรับ .NET: คุณจะต้องติดตั้ง Aspose.Cells สำหรับ .NET[ดาวน์โหลดได้ที่นี่](https://releases.aspose.com/cells/net/).
2. การตั้งค่า IDE: Visual Studio (หรือ IDE ที่คุณต้องการ) ที่ติดตั้ง .NET framework
3.  ใบอนุญาต: ในขณะที่คุณสามารถเริ่มต้นด้วยการทดลองใช้ฟรี การได้รับใบอนุญาตเต็มรูปแบบหรือชั่วคราวจะช่วยปลดล็อกศักยภาพทั้งหมดของ Aspose.Cells[การขอใบอนุญาตชั่วคราว](https://purchase.aspose.com/temporary-license/).

เอกสารประกอบสำหรับ Aspose.Cells เป็นแหล่งข้อมูลที่มีประโยชน์สำหรับการอ้างอิงตลอดกระบวนการนี้ คุณสามารถค้นหาได้[ที่นี่](https://reference.aspose.com/cells/net/).

## การนำเข้าแพ็คเกจ

ในโครงการของคุณ นำเข้าเนมสเปซที่จำเป็น:

```csharp
using System.IO;
using Aspose.Cells;
using System;
```

เมื่อนำเข้าแพ็คเกจนี้ คุณจะสามารถเข้าถึงคลาสและวิธีการที่จำเป็นในการทำงานกับส่วนหัว ส่วนท้าย และฟังก์ชัน Excel อื่นๆ ภายใน Aspose.Cells ได้

ในคู่มือนี้ เราจะแยกรายละเอียดแต่ละขั้นตอนเพื่อให้คุณปฏิบัติตามได้อย่างง่ายดาย แม้ว่าคุณจะเป็นผู้ใช้ใหม่ของ Aspose.Cells หรือ .NET ก็ตาม

## ขั้นตอนที่ 1: ตั้งค่าสมุดงานและการตั้งค่าหน้าของคุณ

สิ่งแรกที่ต้องทำ: สร้างเวิร์กบุ๊กใหม่และเข้าถึงการตั้งค่าหน้าของเวิร์กชีต วิธีนี้จะช่วยให้คุณมีเครื่องมือที่จำเป็นในการปรับเปลี่ยนส่วนหัวและส่วนท้ายของเวิร์กชีต

```csharp
// กำหนดเส้นทางที่จะบันทึกเอกสารของคุณ
string dataDir = "Your Document Directory";

// สร้างอินสแตนซ์ของวัตถุเวิร์กบุ๊ก
Workbook excel = new Workbook();
```

 เราสร้างสิ่งนี้ไว้ที่นี่`Workbook` วัตถุซึ่งแสดงถึงไฟล์ Excel ของเรา`PageSetup` ของเวิร์กชีตเป็นที่ที่เราสามารถปรับเปลี่ยนตัวเลือกส่วนหัวและส่วนท้ายได้


## ขั้นตอนที่ 2: เข้าถึงคุณสมบัติเวิร์กชีตและการตั้งค่าหน้า

 ใน Aspose.Cells เวิร์กชีตแต่ละแผ่นจะมี`PageSetup`คุณสมบัติที่ควบคุมคุณลักษณะเค้าโครง รวมถึงส่วนหัวและส่วนท้าย มาดู`PageSetup` วัตถุสำหรับแผ่นงานของเรา

```csharp
// รับการอ้างอิงถึง PageSetup ของเวิร์กชีตแรก
PageSetup pageSetup = excel.Worksheets[0].PageSetup;
```

 ด้วยเหตุนี้`pageSetup` ตอนนี้มีการตั้งค่าทั้งหมดที่จำเป็นสำหรับการปรับแต่งส่วนหัวและส่วนท้ายแล้ว


## ขั้นตอนที่ 3: ตั้งค่าส่วนซ้ายของส่วนหัว

ส่วนหัวใน Excel แบ่งออกเป็น 3 ส่วน ได้แก่ ด้านซ้าย ตรงกลาง และด้านขวา เริ่มต้นด้วยการตั้งค่าส่วนด้านซ้ายเพื่อแสดงชื่อเวิร์กชีต

```csharp
// ตั้งชื่อเวิร์กชีตที่ส่วนซ้ายของส่วนหัว
pageSetup.SetHeader(0, "&A");
```

 โดยใช้`&A` ช่วยให้คุณสามารถแสดงชื่อเวิร์กชีตแบบไดนามิกได้ ซึ่งมีประโยชน์อย่างยิ่งหากคุณมีชีตหลายแผ่นในเวิร์กบุ๊กและต้องการให้ส่วนหัวแต่ละแผ่นแสดงชื่อชีตของชีตนั้นๆ


## ขั้นตอนที่ 4: เพิ่มวันที่และเวลาลงตรงกลางส่วนหัว

ต่อไป เราจะเพิ่มวันที่และเวลาปัจจุบันลงในส่วนตรงกลางของส่วนหัว นอกจากนี้ เราจะใช้แบบอักษรที่กำหนดเองสำหรับการจัดรูปแบบ

```csharp
// ตั้งค่าวันที่และเวลาในส่วนตรงกลางของส่วนหัวด้วยแบบอักษรตัวหนา
pageSetup.SetHeader(1, "&\"Times New Roman,Bold\"&D-&T");
```

ในโค้ดนี้:
- `&D`แทรกวันที่ปัจจุบัน
- `&T` แทรกเวลาปัจจุบัน
- `"Times New Roman,Bold"` ใช้ตัวอักษร Times New Roman เป็นตัวหนากับองค์ประกอบเหล่านี้


## ขั้นตอนที่ 5: แสดงชื่อไฟล์ในส่วนด้านขวาของส่วนหัว

เพื่อทำให้ส่วนหัวเสร็จสมบูรณ์ ให้เราแสดงชื่อไฟล์ทางด้านขวา พร้อมปรับแต่งแบบอักษรด้วย

```csharp
// แสดงชื่อไฟล์ในส่วนด้านขวาของส่วนหัวด้วยขนาดตัวอักษรที่กำหนดเอง
pageSetup.SetHeader(2, "&\"Times New Roman,Bold\"&12&F");
```

- `&F` แสดงชื่อไฟล์ ทำให้ชัดเจนว่าหน้าที่พิมพ์นั้นเป็นของไฟล์ใด
- `&12` เปลี่ยนขนาดตัวอักษรเป็น 12 สำหรับส่วนนี้


## ขั้นตอนที่ 6: เพิ่มข้อความด้วยแบบอักษรที่กำหนดเองในส่วนท้ายด้านซ้าย

ไปที่ส่วนท้าย! เราจะเริ่มต้นด้วยการตั้งค่าส่วนท้ายด้านซ้ายด้วยข้อความที่กำหนดเองและแบบอักษรที่ระบุ

```csharp
// เพิ่มข้อความแบบกำหนดเองพร้อมรูปแบบแบบอักษรที่ส่วนซ้ายของส่วนท้าย
pageSetup.SetFooter(0, "Hello World! &\"Courier New\"&14 123");
```

 การ`&\"Courier New\"&14` การตั้งค่าในโค้ดด้านบนใช้แบบอักษร "Courier New" ขนาด 14 กับข้อความที่ระบุ (`123`) ข้อความที่เหลือจะยังคงเป็นแบบอักษรส่วนท้ายแบบเริ่มต้น


## ขั้นตอนที่ 7: แทรกหมายเลขหน้าไว้ตรงกลางส่วนท้าย

การใส่หมายเลขหน้าไว้ในส่วนท้ายเป็นวิธีที่ดีในการช่วยให้ผู้อ่านติดตามเอกสารหลายหน้าได้

```csharp
// แทรกหมายเลขหน้าในส่วนตรงกลางของส่วนท้าย
pageSetup.SetFooter(1, "&P");
```

 ที่นี่,`&P` เพิ่มหมายเลขหน้าปัจจุบันลงในส่วนกลางของส่วนท้าย แม้จะเป็นเพียงรายละเอียดเล็กๆ น้อยๆ แต่มีความสำคัญสำหรับเอกสารที่ดูเป็นมืออาชีพ


## ขั้นตอนที่ 8: แสดงจำนวนหน้าทั้งหมดในส่วนท้ายด้านขวา

สุดท้ายเรามาทำให้ส่วนท้ายกระดาษเสร็จสมบูรณ์โดยแสดงจำนวนหน้าทั้งหมดในส่วนที่ถูกต้อง

```csharp
// แสดงจำนวนหน้าทั้งหมดในส่วนขวาของส่วนท้าย
pageSetup.SetFooter(2, "&N");
```

- `&N` แสดงจำนวนหน้าทั้งหมด เพื่อให้ผู้อ่านทราบว่าเอกสารมีความยาวเท่าใด


## ขั้นตอนที่ 9: บันทึกสมุดงาน

เมื่อคุณตั้งค่าส่วนหัวและส่วนท้ายเรียบร้อยแล้ว ก็ถึงเวลาบันทึกเวิร์กบุ๊ก นี่คือขั้นตอนสุดท้ายในการสร้างไฟล์ Excel ที่มีส่วนหัวและส่วนท้ายที่ปรับแต่งได้อย่างสมบูรณ์

```csharp
// บันทึกสมุดงาน
excel.Save(dataDir + "SetHeadersAndFooters_out.xls");
```

บรรทัดนี้จะบันทึกไฟล์ไปยังไดเร็กทอรีที่คุณกำหนดโดยมีส่วนหัวและส่วนท้ายแบบกำหนดเองอยู่


## บทสรุป

การเพิ่มส่วนหัวและส่วนท้ายในเวิร์กชีต Excel เป็นทักษะที่มีค่าสำหรับการสร้างเอกสารที่เป็นระเบียบและเป็นมืออาชีพ ด้วย Aspose.Cells สำหรับ .NET คุณสามารถควบคุมส่วนหัวและส่วนท้ายของไฟล์ Excel ได้อย่างสมบูรณ์ ตั้งแต่การแสดงชื่อเวิร์กชีตไปจนถึงการแทรกข้อความที่กำหนดเอง วันที่ เวลา และแม้แต่หมายเลขหน้าแบบไดนามิก ตอนนี้ คุณได้เห็นแต่ละขั้นตอนในการดำเนินการแล้ว คุณสามารถยกระดับการทำงานอัตโนมัติของ Excel ของคุณไปสู่อีกระดับหนึ่งได้

## คำถามที่พบบ่อย

### ฉันสามารถใช้แบบอักษรที่แตกต่างกันสำหรับส่วนหัวและส่วนท้ายต่างๆ ได้หรือไม่  
ใช่ Aspose.Cells สำหรับ .NET อนุญาตให้คุณระบุแบบอักษรสำหรับแต่ละส่วนของส่วนหัวและส่วนท้ายโดยใช้แท็กแบบอักษรที่เฉพาะเจาะจง

### ฉันจะลบส่วนหัวและส่วนท้ายได้อย่างไร  
 คุณสามารถล้างส่วนหัวและส่วนท้ายได้โดยตั้งค่าข้อความส่วนหัวหรือส่วนท้ายให้เป็นสตริงว่างด้วย`SetHeader` หรือ`SetFooter`.

### ฉันสามารถแทรกภาพลงในส่วนหัวหรือส่วนท้ายด้วย Aspose.Cells สำหรับ .NET ได้หรือไม่  
ปัจจุบัน Aspose.Cells รองรับข้อความในส่วนหัวและส่วนท้ายเป็นหลัก รูปภาพอาจต้องมีการแก้ปัญหาชั่วคราว เช่น การแทรกภาพลงในเวิร์กชีตเอง

### Aspose.Cells รองรับข้อมูลแบบไดนามิกในส่วนหัวและส่วนท้ายหรือไม่  
 ใช่ คุณสามารถใช้โค้ดไดนามิกต่างๆ ได้ (เช่น`&D` สำหรับวันที่หรือ`&P` สำหรับหมายเลขหน้า) เพื่อเพิ่มเนื้อหาแบบไดนามิก

### ฉันจะปรับความสูงของส่วนหัวและส่วนท้ายได้อย่างไร  
 Aspose.Cells มีตัวเลือกภายใน`PageSetup` คลาสที่จะปรับระยะขอบส่วนหัวและส่วนท้าย ทำให้คุณสามารถควบคุมระยะห่างได้
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
