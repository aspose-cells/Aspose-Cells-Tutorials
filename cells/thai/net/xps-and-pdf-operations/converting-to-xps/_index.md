---
title: การแปลงเป็น XPS ใน .NET
linktitle: การแปลงเป็น XPS ใน .NET
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีแปลงไฟล์ Excel เป็นรูปแบบ XPS โดยใช้ Aspose.Cells สำหรับ .NET ในขั้นตอนง่ายๆ เพียงไม่กี่ขั้นตอน พร้อมด้วยตัวอย่างโค้ดปฏิบัติจริง
weight: 10
url: /th/net/xps-and-pdf-operations/converting-to-xps/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# การแปลงเป็น XPS ใน .NET

## การแนะนำ
เมื่อต้องแปลงไฟล์ Excel เป็นรูปแบบ XPS คุณอาจรู้สึกว่าตัวเองไม่ค่อยมีความรู้ โดยเฉพาะถ้าคุณเพิ่งเริ่มเขียนโปรแกรมหรือเพิ่งเริ่มพัฒนา .NET แต่ไม่ต้องกังวล ในคู่มือนี้ เราจะอธิบายขั้นตอนการใช้ Aspose.Cells สำหรับ .NET แบบมืออาชีพ เมื่อคุณอ่านจบ คุณจะไม่เพียงเข้าใจอย่างชัดเจนว่าต้องทำอย่างไรเท่านั้น แต่ยังได้รับข้อมูลเชิงลึกที่เป็นประโยชน์ซึ่งจะช่วยยกระดับทักษะการเขียนโค้ดของคุณอีกด้วย เริ่มกันเลย!
## ข้อกำหนดเบื้องต้น
ก่อนที่คุณจะเริ่มลงรายละเอียดเกี่ยวกับการแปลงข้อมูล เรามาตรวจสอบกันก่อนว่าคุณมีทุกสิ่งที่คุณต้องการ นี่คือสิ่งที่คุณต้องการ:
1. Visual Studio: นี่คือ IDE ที่คุณจะเขียนโค้ด โปรดแน่ใจว่าคุณได้ติดตั้งไว้แล้ว
2.  ไลบรารี Aspose.Cells: คุณต้องมีไลบรารีนี้เพื่อจัดการไฟล์ Excel อย่างมีประสิทธิภาพ คุณสามารถดาวน์โหลดได้จาก[ที่นี่](https://releases.aspose.com/cells/net/).
3. ความรู้พื้นฐานเกี่ยวกับ .NET: ความคุ้นเคยกับ C# หรือ VB.NET จะช่วยให้คุณเข้าใจตัวอย่างของเราได้ดีขึ้น
4. ไฟล์ Excel: เตรียมไฟล์ Excel ตัวอย่าง (สำหรับบทช่วยสอนนี้ เราจะใช้ "Book1.xls") ไว้ในไดเร็กทอรีการทำงานของคุณ

## แพ็คเกจนำเข้า
ตอนนี้เราได้ครอบคลุมข้อกำหนดเบื้องต้นแล้ว เรามาเริ่มนำเข้าแพ็คเกจที่จำเป็นกันเลย การนำเข้าเนมสเปซที่ถูกต้องนั้นมีความสำคัญมาก เนื่องจากจะแจ้งให้คอมไพเลอร์ทราบว่าจะค้นหาคลาสและเมธอดที่จะใช้ได้จากที่ใด
### ตั้งค่าโครงการของคุณ
สิ่งแรกที่ต้องทำคือ เปิด Visual Studio และสร้างโปรเจ็กต์ใหม่ เลือกแอปพลิเคชันคอนโซลเนื่องจากใช้งานง่ายและเหมาะกับงานประเภทนี้
### เพิ่ม Aspose.Cells ลงในโปรเจ็กต์ของคุณ
หากต้องการเริ่มต้นใช้งาน Aspose.Cells คุณต้องเพิ่มไลบรารี โดยทำดังนี้:
1. คลิกขวาที่โครงการของคุณใน Solution Explorer
2. คลิกที่ “จัดการแพ็คเกจ NuGet”
3. ค้นหา “Aspose.Cells” และคลิก “ติดตั้ง”
### นำเข้าเนมสเปซที่จำเป็น
ในตอนต้นของไฟล์ C# คุณจะต้องนำเข้า Aspose.Cells ซึ่งเกี่ยวข้องกับการเพิ่ม using directives ต่อไปนี้:
```csharp
using System.IO;
using Aspose.Cells;
```
มาแบ่งขั้นตอนการแปลงไฟล์ Excel เป็นรูปแบบ XPS ให้เป็นขั้นตอนง่าย ๆ ที่จัดการได้ 
## ขั้นตอนที่ 1: กำหนดไดเรกทอรีเอกสารของคุณ
คุณสามารถระบุเส้นทางที่ไฟล์ Excel ของคุณอยู่ได้ที่นี่ ซึ่งเป็นสิ่งสำคัญมาก เนื่องจากโค้ดจะต้องทราบว่าจะค้นหาไฟล์ได้จากที่ใด
```csharp
string dataDir = "Your Document Directory"; // ให้แน่ใจว่าได้แทนที่ด้วยเส้นทางจริงของคุณ
```
## ขั้นตอนที่ 2: เปิดไฟล์ Excel
ตอนนี้ให้โหลดไฟล์ Excel ของคุณลงในอ็อบเจ็กต์ Aspose Workbook การดำเนินการนี้จะทำให้โปรแกรมของคุณเข้าถึงข้อมูลภายในไฟล์ Excel ได้
```csharp
Workbook workbook = new Workbook(dataDir + "Book1.xls");
```
 ที่นี่เรากำลังสร้างอินสแตนซ์ใหม่ของ`Workbook` คลาสและโหลด "Book1.xls" ลงไป
## ขั้นตอนที่ 3: เข้าถึงแผ่นงานแรก
ขั้นต่อไป เราต้องหาแผ่นงานที่เราต้องการใช้ เนื่องจากเราใช้แผ่นงานแรก โค้ดของเราจึงมีลักษณะดังนี้:
```csharp
Worksheet sheet = workbook.Worksheets[0]; // การเข้าถึงแผ่นงานแรก
```
บรรทัดโค้ดนี้ช่วยให้คุณสามารถเข้าถึงเวิร์กชีตแรกสำหรับคำสั่งเพิ่มเติมได้
## ขั้นตอนที่ 4: กำหนดค่าตัวเลือกภาพและการพิมพ์
 ตอนนี้เราต้องกำหนดว่าเราต้องการเรนเดอร์ผลลัพธ์อย่างไร ซึ่งเกี่ยวข้องกับการสร้างอินสแตนซ์ของ`ImageOrPrintOptions` และตั้งค่ารูปแบบผลลัพธ์ที่ต้องการ
```csharp
Aspose.Cells.Rendering.ImageOrPrintOptions options = new Aspose.Cells.Rendering.ImageOrPrintOptions();
options.SaveFormat = SaveFormat.Xps; // การตั้งค่ารูปแบบเอาท์พุตเป็น XPS
```
ขั้นตอนนี้แจ้งให้ Aspose ทราบว่าเราต้องการแปลงเนื้อหา Excel เป็นรูปแบบ XPS
## ขั้นตอนที่ 5: เรนเดอร์แผ่นงาน
เมื่อตั้งค่าตัวเลือกแล้ว ก็ถึงเวลาเรนเดอร์แผ่นงานที่ต้องการ:
```csharp
Aspose.Cells.Rendering.SheetRender sr = new Aspose.Cells.Rendering.SheetRender(sheet, options);
sr.ToImage(0, dataDir + "out_printingxps.out.xps");
```
 เราสร้างสิ่งนี้ไว้ที่นี่`SheetRender` วัตถุที่ดูแลกระบวนการเรนเดอร์ วิธีการ`ToImage` จัดการการแปลงจริงและบันทึกผลลัพธ์ที่เรนเดอร์เป็น "out_printingxps.out.xps"
## ขั้นตอนที่ 6: ส่งออกเวิร์กบุ๊กทั้งหมดไปยัง XPS
หากคุณต้องการแปลงเวิร์กบุ๊กทั้งหมดแทนที่จะเป็นเพียงแผ่นงานเดียว คุณสามารถทำตามขั้นตอนเพิ่มเติมนี้:
```csharp
WorkbookRender wr = new WorkbookRender(workbook, options);
wr.ToImage(dataDir + "out_whole_printingxps.out.xps");
```
โค้ดสั้นๆ นี้ทำให้คุณสามารถส่งออกเวิร์กบุ๊กทั้งหมดในครั้งเดียว ทำให้มีประสิทธิภาพหากคุณมีเวิร์กชีตหลายแผ่นที่ต้องแปลง
## บทสรุป
ขอแสดงความยินดี! คุณได้แปลงไฟล์ Excel เป็นรูปแบบ XPS โดยใช้ไลบรารี Aspose.Cells ใน .NET สำเร็จแล้ว ขั้นตอนต่างๆ อาจดูยุ่งยาก แต่แต่ละขั้นตอนก็มีบทบาทสำคัญในกระบวนการนี้ ด้วยความรู้ดังกล่าว คุณจะสามารถจัดการไฟล์ Excel ในแอปพลิเคชันและปรับให้เหมาะสมสำหรับรูปแบบต่างๆ ได้เป็นอย่างดี ดังนั้น ครั้งต่อไปที่ใครถามคุณว่าจะแปลงสเปรดชีตที่น่ารำคาญเหล่านั้นได้อย่างไร คุณจะรู้ทันทีว่าต้องทำอย่างไร!
## คำถามที่พบบ่อย
### รูปแบบ XPS คืออะไร?
XPS (XML Paper Specification) เป็นรูปแบบเอกสารคงที่ที่ยังคงเค้าโครงและรูปลักษณ์ของเอกสารไว้
### ฉันจำเป็นต้องซื้อ Aspose.Cells เพื่อใช้งานหรือไม่?
 คุณสามารถทดลองใช้ Aspose.Cells ได้ฟรี[ที่นี่](https://releases.aspose.com/)หลังจากนั้นคุณอาจต้องซื้อใบอนุญาตเพื่อใช้ฟังก์ชันเต็มรูปแบบ
### ฉันสามารถแปลงไฟล์ Excel หลายไฟล์ในครั้งเดียวได้ไหม?
ใช่ คุณสามารถปรับเปลี่ยนโค้ดเพื่อวนซ้ำผ่านไฟล์หลายไฟล์ในไดเร็กทอรีและใช้ตรรกะการแปลงแบบเดียวกันสำหรับไฟล์แต่ละไฟล์ได้
### จะเกิดอะไรขึ้นหากฉันต้องการแปลงเฉพาะแผ่นงานบางแผ่น?
 คุณสามารถระบุดัชนีของชีตที่คุณต้องการได้ใน`SheetRender` วัตถุตามที่แสดงในขั้นตอนของเรา
### ฉันสามารถหาข้อมูลเพิ่มเติมเกี่ยวกับ Aspose.Cells ได้จากที่ไหน
 คุณสามารถสำรวจได้[เอกสารประกอบ](https://reference.aspose.com/cells/net/) สำหรับคุณสมบัติและตัวเลือกขั้นสูงเพิ่มเติมที่มีอยู่ในไลบรารี
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
