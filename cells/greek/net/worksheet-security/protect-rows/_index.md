---
"description": "Μάθετε πώς να προστατεύετε γραμμές σε ένα φύλλο εργασίας του Excel χρησιμοποιώντας το Aspose.Cells για .NET. Ασφαλίστε τα δεδομένα σας με προστασία σε επίπεδο γραμμών και αποτρέψτε τυχαίες αλλαγές."
"linktitle": "Προστασία γραμμών σε φύλλο εργασίας χρησιμοποιώντας Aspose.Cells"
"second_title": "API επεξεργασίας Excel Aspose.Cells .NET"
"title": "Προστασία γραμμών σε φύλλο εργασίας χρησιμοποιώντας Aspose.Cells"
"url": "/el/net/worksheet-security/protect-rows/"
"weight": 18
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Προστασία γραμμών σε φύλλο εργασίας χρησιμοποιώντας Aspose.Cells

## Εισαγωγή
Η προγραμματιστική εργασία με αρχεία Excel είναι συχνά μια εργασία που απαιτεί όχι μόνο χειρισμό δεδομένων αλλά και προστασία δεδομένων. Είτε χρειάζεται να προστατεύσετε ευαίσθητα δεδομένα είτε να αποτρέψετε τυχαία επεξεργασία, η προστασία γραμμών σε ένα φύλλο εργασίας μπορεί να είναι ένα κρίσιμο βήμα. Σε αυτό το σεμινάριο, θα εμβαθύνουμε στον τρόπο προστασίας συγκεκριμένων γραμμών σε ένα φύλλο εργασίας Excel χρησιμοποιώντας το Aspose.Cells για .NET. Θα αναλύσουμε όλα τα απαραίτητα βήματα, από την προετοιμασία του περιβάλλοντός σας έως την εφαρμογή των λειτουργιών προστασίας με έναν απλό και εύχρηστο τρόπο.
## Προαπαιτούμενα
Πριν ξεκινήσετε την προστασία γραμμών σε ένα φύλλο εργασίας, υπάρχουν ορισμένα πράγματα που θα πρέπει να έχετε στη διάθεσή σας:
1. Aspose.Cells για .NET: Βεβαιωθείτε ότι έχετε εγκαταστήσει το Aspose.Cells για .NET στον υπολογιστή ανάπτυξης. Εάν δεν το έχετε κάνει ήδη, μπορείτε εύκολα να το κατεβάσετε από το [Σελίδα λήψης Aspose Cells](https://releases.aspose.com/cells/net/).
2. Visual Studio ή οποιοδήποτε .NET IDE: Για να υλοποιήσετε τη λύση, πρέπει να έχετε ρυθμίσει ένα περιβάλλον ανάπτυξης. Το Visual Studio είναι μια εξαιρετική επιλογή, αλλά οποιοδήποτε .NET IDE είναι συμβατό.
3. Βασικές γνώσεις C#: Η κατανόηση των βασικών στοιχείων του προγραμματισμού C# θα σας βοηθήσει να παρακολουθήσετε το σεμινάριο και να τροποποιήσετε τον κώδικα-παράδειγμα ώστε να ταιριάζει στις ανάγκες σας.
4. Τεκμηρίωση Aspose.Cells API: Εξοικειωθείτε με το [Aspose.Cells για τεκμηρίωση .NET](https://reference.aspose.com/cells/net/) για να έχετε μια επισκόπηση της δομής της κλάσης και των μεθόδων που χρησιμοποιούνται στη βιβλιοθήκη.
Αν έχετε όλες τις απαραίτητες προϋποθέσεις, μπορούμε να προχωρήσουμε κατευθείαν στην υλοποίηση.
## Εισαγωγή πακέτων
Για να ξεκινήσετε, πρέπει να εισαγάγετε τα απαιτούμενα πακέτα. Αυτές οι βιβλιοθήκες είναι κρίσιμες για την αλληλεπίδραση με αρχεία Excel στο έργο σας σε C#.
```csharp
using System.IO;
using Aspose.Cells;
```
Μόλις εισαγάγετε τα απαραίτητα πακέτα, μπορείτε να ξεκινήσετε την κωδικοποίηση. 
Τώρα, ας χωρίσουμε τη διαδικασία σε μικρότερα βήματα για να σας διευκολύνουμε να την παρακολουθήσετε. Κάθε βήμα θα εστιάζει σε ένα συγκεκριμένο μέρος της υλοποίησης, διασφαλίζοντας ότι μπορείτε να την κατανοήσετε και να την εφαρμόσετε γρήγορα. 
## Βήμα 1: Δημιουργία νέου βιβλίου εργασίας και φύλλου εργασίας
Πριν εφαρμόσετε οποιεσδήποτε ρυθμίσεις προστασίας, πρέπει να δημιουργήσετε ένα νέο βιβλίο εργασίας και να επιλέξετε το φύλλο εργασίας με το οποίο θέλετε να εργαστείτε. Αυτό θα είναι το έγγραφο εργασίας σας.
```csharp
// Η διαδρομή προς τον κατάλογο εγγράφων.
string dataDir = "Your Document Directory";
// Δημιουργήστε έναν κατάλογο εάν δεν υπάρχει ήδη.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
	System.IO.Directory.CreateDirectory(dataDir);
// Δημιουργήστε ένα νέο βιβλίο εργασίας.
Workbook wb = new Workbook();
// Δημιουργήστε ένα αντικείμενο φύλλου εργασίας και αποκτήστε το πρώτο φύλλο.
Worksheet sheet = wb.Worksheets[0];
```
Σε αυτό το παράδειγμα, δημιουργούμε ένα νέο βιβλίο εργασίας με ένα μόνο φύλλο εργασίας (η οποία είναι η προεπιλεγμένη ρύθμιση όταν δημιουργείτε ένα νέο βιβλίο εργασίας χρησιμοποιώντας το Aspose.Cells). Στη συνέχεια, επιλέγουμε το πρώτο φύλλο εργασίας στο βιβλίο εργασίας, το οποίο θα είναι ο στόχος για την προστασία γραμμών μας.
## Βήμα 2: Ορισμός αντικειμένων στυλ και σημαίας στυλ
Το επόμενο βήμα είναι ο ορισμός των αντικειμένων στυλ και σημαίας στυλ. Αυτά τα αντικείμενα σάς επιτρέπουν να τροποποιήσετε τις ιδιότητες του κελιού, όπως το αν είναι κλειδωμένο ή ξεκλείδωτο.
```csharp
// Ορίστε το αντικείμενο στυλ.
Style style;
// Ορίστε το αντικείμενο styleflag.
StyleFlag flag;
```
Θα χρησιμοποιήσετε αυτά τα αντικείμενα σε επόμενα βήματα για να προσαρμόσετε τις ιδιότητες των κελιών και να τις εφαρμόσετε στο φύλλο εργασίας σας.
## Βήμα 3: Ξεκλείδωμα όλων των στηλών στο φύλλο εργασίας
Από προεπιλογή, όλα τα κελιά σε ένα φύλλο εργασίας του Excel είναι κλειδωμένα. Ωστόσο, όταν προστατεύετε ένα φύλλο εργασίας, επιβάλλεται η κατάσταση κλειδώματος. Για να διασφαλίσετε ότι προστατεύονται μόνο συγκεκριμένες γραμμές ή κελιά, μπορείτε να ξεκλειδώσετε πρώτα όλες τις στήλες. Αυτό το βήμα είναι απαραίτητο εάν θέλετε να προστατεύσετε μόνο συγκεκριμένες γραμμές.
```csharp
// Περιηγηθείτε σε όλες τις στήλες του φύλλου εργασίας και ξεκλειδώστε τις.
for (int i = 0; i <= 255; i++)
{
    style = sheet.Cells.Columns[(byte)i].Style;
    style.IsLocked = false;
    flag = new StyleFlag();
    flag.Locked = true;
    sheet.Cells.Columns[(byte)i].ApplyStyle(style, flag);
}
```
Σε αυτόν τον κώδικα, κάνουμε επανάληψη και στις 256 στήλες του φύλλου εργασίας (τα φύλλα εργασίας του Excel έχουν μέγιστο αριθμό 256 στηλών, με ευρετήριο από 0 έως 255) και ορίζουμε τις τιμές τους. `IsLocked` ιδιοκτησία σε `false`Αυτή η ενέργεια διασφαλίζει ότι όλες οι στήλες είναι ξεκλείδωτες, αλλά θα κλειδώσουμε συγκεκριμένες γραμμές αργότερα.
## Βήμα 4: Κλείδωμα της πρώτης σειράς
Μόλις ξεκλειδώσετε τις στήλες, το επόμενο βήμα είναι να κλειδώσετε συγκεκριμένες γραμμές που θέλετε να προστατεύσετε. Σε αυτό το παράδειγμα, θα κλειδώσουμε την πρώτη γραμμή. Αυτό διασφαλίζει ότι οι χρήστες δεν μπορούν να την τροποποιήσουν όσο οι άλλες γραμμές παραμένουν ξεκλείδωτες.
```csharp
// Αποκτήστε το στυλ της πρώτης γραμμής.
style = sheet.Cells.Rows[0].Style;
// Κλείδωσέ το.
style.IsLocked = true;
// Δημιουργήστε μια πρώτη εικόνα της σημαίας.
flag = new StyleFlag();
// Ορίστε τη ρύθμιση κλειδώματος.
flag.Locked = true;
// Εφαρμόστε το στυλ στην πρώτη σειρά.
sheet.Cells.ApplyRowStyle(0, style, flag);
```
Εδώ, έχουμε πρόσβαση στο στυλ της πρώτης γραμμής και ορίζουμε το `IsLocked` ιδιοκτησία σε `true`Μετά από αυτό, χρησιμοποιούμε το `ApplyRowStyle()` μέθοδος για την εφαρμογή του στυλ κλειδώματος σε ολόκληρη τη γραμμή. Μπορείτε να επαναλάβετε αυτό το βήμα για να κλειδώσετε οποιεσδήποτε άλλες γραμμές θέλετε να προστατεύσετε.
## Βήμα 5: Προστατέψτε το φύλλο
Τώρα που έχουμε ξεκλειδώσει και κλειδώσει τις απαραίτητες γραμμές, ήρθε η ώρα να προστατεύσουμε το φύλλο εργασίας. Η προστασία διασφαλίζει ότι κανείς δεν μπορεί να τροποποιήσει τις κλειδωμένες γραμμές ή κελιά, εκτός εάν καταργήσει τον κωδικό πρόσβασης προστασίας (εάν παρέχεται).
```csharp
// Προστατέψτε το φύλλο.
sheet.Protect(ProtectionType.All);
```
Σε αυτό το βήμα, εφαρμόζουμε προστασία σε ολόκληρο το φύλλο χρησιμοποιώντας `ProtectionType.All`Αυτός ο τύπος προστασίας σημαίνει ότι όλες οι πτυχές του φύλλου, συμπεριλαμβανομένων των κλειδωμένων γραμμών και κελιών, προστατεύονται. Μπορείτε επίσης να προσαρμόσετε αυτήν την προστασία καθορίζοντας διαφορετικούς τύπους προστασίας, εάν χρειάζεται.
## Βήμα 6: Αποθήκευση του βιβλίου εργασίας
Τέλος, πρέπει να αποθηκεύσουμε το βιβλίο εργασίας αφού εφαρμόσουμε τα απαραίτητα στυλ και προστασία. Το βιβλίο εργασίας μπορεί να αποθηκευτεί σε διάφορες μορφές, όπως Excel 97-2003, Excel 2010, κ.λπ.
```csharp
// Αποθηκεύστε το αρχείο Excel.
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```
Αυτή η γραμμή κώδικα αποθηκεύει το βιβλίο εργασίας στη μορφή Excel 97-2003 με τις αλλαγές που έχουν εφαρμοστεί. Μπορείτε να αλλάξετε τη μορφή αρχείου ανάλογα με τις ανάγκες σας επιλέγοντας από μια ποικιλία `SaveFormat` επιλογές.
## Σύναψη
Και να το! Μάθατε με επιτυχία πώς να προστατεύετε γραμμές σε ένα φύλλο εργασίας χρησιμοποιώντας το Aspose.Cells για .NET. Ακολουθώντας τα παραπάνω βήματα, μπορείτε να ξεκλειδώσετε ή να κλειδώσετε οποιεσδήποτε γραμμές ή στήλες, όπως απαιτείται, και να εφαρμόσετε προστασία για να διασφαλίσετε την ακεραιότητα των δεδομένων σας.
## Συχνές ερωτήσεις
### Πώς μπορώ να προστατεύσω πολλές σειρές ταυτόχρονα;  
Μπορείτε να κάνετε επανάληψη σε πολλές σειρές και να εφαρμόσετε το στυλ κλειδώματος σε κάθε μία ξεχωριστά. Απλώς αντικαταστήστε `0` με τον δείκτη γραμμής που θέλετε να κλειδώσετε.
### Μπορώ να ορίσω κωδικό πρόσβασης για την προστασία του φύλλου;  
Ναι! Μπορείτε να μεταβιβάσετε έναν κωδικό πρόσβασης στο `sheet.Protect()` μέθοδος για την επιβολή προστασίας με κωδικό πρόσβασης.
### Μπορώ να ξεκλειδώσω κελιά αντί για ολόκληρες στήλες;  
Ναι! Αντί να ξεκλειδώνετε στήλες, μπορείτε να ξεκλειδώσετε μεμονωμένα κελιά τροποποιώντας τις ιδιότητες στυλ τους.
### Τι συμβαίνει εάν προσπαθήσω να επεξεργαστώ μια προστατευμένη γραμμή;  
Όταν μια γραμμή προστατεύεται, το Excel θα αποτρέψει τυχόν επεξεργασίες στα κλειδωμένα κελιά, εκτός εάν καταργήσετε την προστασία του φύλλου.
### Μπορώ να προστατεύσω συγκεκριμένα εύρη σε μια σειρά;  
Ναι! Μπορείτε να κλειδώσετε μεμονωμένα εύρη σε μια σειρά ορίζοντας το `IsLocked` ιδιότητα για συγκεκριμένα κελιά εντός του εύρους.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}