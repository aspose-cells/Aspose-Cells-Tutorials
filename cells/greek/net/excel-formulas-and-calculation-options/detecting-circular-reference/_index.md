---
"description": "Εντοπίστε εύκολα κυκλικές αναφορές στο Excel χρησιμοποιώντας το Aspose.Cells για .NET. Ακολουθήστε τον αναλυτικό οδηγό μας για να διασφαλίσετε ακριβείς υπολογισμούς στα υπολογιστικά σας φύλλα."
"linktitle": "Εντοπισμός κυκλικής αναφοράς στο Excel μέσω προγραμματισμού"
"second_title": "API επεξεργασίας Excel Aspose.Cells .NET"
"title": "Εντοπισμός κυκλικής αναφοράς στο Excel μέσω προγραμματισμού"
"url": "/el/net/excel-formulas-and-calculation-options/detecting-circular-reference/"
"weight": 13
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Εντοπισμός κυκλικής αναφοράς στο Excel μέσω προγραμματισμού

## Εισαγωγή
Όταν πρόκειται για την εργασία με αρχεία Excel, ένα από τα πιο ενοχλητικά προβλήματα που μπορεί να αντιμετωπίσετε είναι μια κυκλική αναφορά. Αυτό συμβαίνει όταν ένας τύπος αναφέρεται στο δικό του κελί, είτε άμεσα είτε έμμεσα, δημιουργώντας έναν βρόχο που μπορεί να προκαλέσει σύγχυση στη μηχανή υπολογισμών του Excel. Αλλά μην ανησυχείτε! Με το Aspose.Cells για .NET, μπορείτε να εντοπίσετε μέσω προγραμματισμού αυτές τις ενοχλητικές κυκλικές αναφορές, διασφαλίζοντας ότι τα υπολογιστικά φύλλα σας παραμένουν λειτουργικά και ακριβή. Σε αυτόν τον οδηγό, θα σας καθοδηγήσουμε στη διαδικασία βήμα προς βήμα, κάνοντάς την τόσο απλή.
## Προαπαιτούμενα
Πριν εμβαθύνουμε στις λεπτομέρειες της ανίχνευσης κυκλικών αναφορών, ας βεβαιωθούμε ότι έχετε όλα όσα χρειάζεστε για να ξεκινήσετε:
1. Visual Studio: Βεβαιωθείτε ότι έχετε εγκατεστημένο το Visual Studio στον υπολογιστή σας. Αυτό θα είναι το περιβάλλον ανάπτυξής σας.
2. .NET Framework: Βεβαιωθείτε ότι χρησιμοποιείτε μια συμβατή έκδοση του .NET Framework (τουλάχιστον .NET Framework 4.0).
3. Βιβλιοθήκη Aspose.Cells: Χρειάζεται να έχετε τη βιβλιοθήκη Aspose.Cells. Μπορείτε να την κατεβάσετε από το [Ιστότοπος Aspose](https://releases.aspose.com/cells/net/).
4. Βασικές γνώσεις C#: Η εξοικείωση με τον προγραμματισμό C# θα είναι ωφέλιμη, καθώς θα γράφουμε κώδικα σε αυτήν τη γλώσσα.
5. Αρχείο Excel: Να έχετε έτοιμο ένα αρχείο Excel που περιέχει κυκλικές αναφορές για δοκιμές. Μπορείτε να δημιουργήσετε ένα απλό ή να κατεβάσετε ένα δείγμα.
Τώρα που έχουμε τις προϋποθέσεις μας στη θέση τους, ας προχωρήσουμε στο διασκεδαστικό κομμάτι!
## Εισαγωγή πακέτων
Πριν ξεκινήσετε την κωδικοποίηση, πρέπει να εισαγάγετε τα απαραίτητα πακέτα. Δείτε πώς μπορείτε να το κάνετε:
### Δημιουργία νέου έργου
- Ανοίξτε το Visual Studio και δημιουργήστε ένα νέο έργο εφαρμογής κονσόλας C#.
### Προσθήκη αναφοράς Aspose.Cells
- Κάντε δεξί κλικ στο έργο σας στην Εξερεύνηση λύσεων.
- Επιλέξτε "Διαχείριση πακέτων NuGet".
- Αναζητήστε το "Aspose.Cells" και εγκαταστήστε την πιο πρόσφατη έκδοση.
### Εισαγωγή απαιτούμενων χώρων ονομάτων
Στην κορυφή του `Program.cs` αρχείο, εισαγάγετε τους απαραίτητους χώρους ονομάτων:
```csharp
using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```

Τώρα που έχουμε ρυθμίσει τα πάντα, ας εμβαθύνουμε στον κώδικα για την ανίχνευση κυκλικών αναφορών σε ένα αρχείο Excel.
## Βήμα 1: Ορισμός του καταλόγου εισόδου
Αρχικά, πρέπει να καθορίσετε τον κατάλογο όπου βρίσκεται το αρχείο Excel. Εδώ θα φορτώσετε το αρχείο Excel.
```csharp
// Κατάλογος εισαγωγής
string sourceDir = "Your Document Directory";
```
Αντικαθιστώ `"Your Document Directory"` με την πραγματική διαδρομή προς το αρχείο Excel σας.
## Βήμα 2: Φόρτωση του βιβλίου εργασίας με το LoadOptions
Στη συνέχεια, θα φορτώσετε το βιβλίο εργασίας του Excel. Εδώ ξεκινά η μαγεία!
```csharp
LoadOptions loadOptions = new LoadOptions();
var objWB = new Aspose.Cells.Workbook(sourceDir + "Circular Formulas.xls", loadOptions);
```
Εδώ, δημιουργούμε μια νέα παρουσία του `LoadOptions` και φορτώνοντας το βιβλίο εργασίας από την καθορισμένη διαδρομή. Βεβαιωθείτε ότι το όνομα του αρχείου Excel σας ταιριάζει!
## Βήμα 3: Ενεργοποίηση ρυθμίσεων επανάληψης
Για να επιτρέψετε κυκλικές αναφορές, πρέπει να ενεργοποιήσετε τις ρυθμίσεις επανάληψης στο βιβλίο εργασίας.
```csharp
objWB.Settings.Iteration = true;
```
Αυτό υποδεικνύει στο Aspose.Cells να επιτρέπει κυκλικές αναφορές κατά τον υπολογισμό.
## Βήμα 4: Δημιουργία επιλογών υπολογισμού και κυκλικής παρακολούθησης
Τώρα, ας δημιουργήσουμε τις επιλογές υπολογισμού και την προσαρμοσμένη κυκλική οθόνη μας.
```csharp
CalculationOptions copts = new CalculationOptions();
CircularMonitor cm = new CircularMonitor();
copts.CalculationMonitor = cm;
```
Εδώ, δημιουργούμε μια παρουσία του `CalculationOptions` και ένα έθιμο `CircularMonitor`Αυτή η οθόνη θα βοηθήσει στην παρακολούθηση τυχόν κυκλικών αναφορών που εντοπίζονται κατά τους υπολογισμούς.
## Βήμα 5: Υπολογίστε τους τύπους
Τώρα, ήρθε η ώρα να υπολογίσετε τους τύπους στο βιβλίο εργασίας σας.
```csharp
objWB.CalculateFormula(copts);
```
Αυτή η γραμμή εκτελεί τον υπολογισμό και ελέγχει για κυκλικές αναφορές.
## Βήμα 6: Καταμέτρηση κυκλικών αναφορών
Μετά τον υπολογισμό, μπορείτε να μετρήσετε πόσες κυκλικές αναφορές βρέθηκαν.
```csharp
long lngCircularRef = cm.circulars.Count;
Console.WriteLine("Circular References found - " + lngCircularRef);
```
Αυτό θα εμφανίσει τον αριθμό των κυκλικών αναφορών που εντοπίστηκαν στο αρχείο Excel σας.
## Βήμα 7: Εμφάνιση αποτελεσμάτων
Τέλος, ας εμφανίσουμε τα αποτελέσματα και ας επιβεβαιώσουμε ότι η μέθοδός μας εκτελέστηκε με επιτυχία.
```csharp
Console.WriteLine("DetectCircularReference executed successfully.\r\n");
```
## Βήμα 8: Υλοποίηση της κλάσης CircularMonitor
Για να ολοκληρώσετε τη διαδικασία, θα χρειαστεί να εφαρμόσετε το `CircularMonitor` κλάση. Αυτή η κλάση θα κληρονομήσει από `AbstractCalculationMonitor` και χειρίζονται την ανίχνευση κυκλικών αναφορών.
```csharp
public class CircularMonitor : AbstractCalculationMonitor
{
    public ArrayList circulars = new ArrayList();
    public ArrayList Circulars { get { return circulars; } }
    public override bool OnCircular(IEnumerator circularCellsData)
    {
        CalculationCell cc = null;
        ArrayList cur = new ArrayList();
        while (circularCellsData.MoveNext())
        {
            cc = (CalculationCell)circularCellsData.Current;
            cur.Add(cc.Worksheet.Name + "!" + CellsHelper.CellIndexToName(cc.CellRow, cc.CellColumn));
        }
        circulars.Add(cur);
        return true;
    }
}
```
Αυτή η κλάση καταγράφει τις λεπτομέρειες κάθε κυκλικής αναφοράς που βρέθηκε, συμπεριλαμβανομένου του ονόματος του φύλλου εργασίας και του ευρετηρίου κελιών.
## Σύναψη
Η ανίχνευση κυκλικών αναφορών στο Excel χρησιμοποιώντας το Aspose.Cells για .NET είναι μια απλή διαδικασία, αρκεί να την αναλύσετε σε διαχειρίσιμα βήματα. Ακολουθώντας αυτόν τον οδηγό, μπορείτε εύκολα να εντοπίσετε και να διαχειριστείτε κυκλικές αναφορές στα υπολογιστικά σας φύλλα, διασφαλίζοντας ότι οι υπολογισμοί σας παραμένουν ακριβείς και αξιόπιστοι. Είτε είστε έμπειρος προγραμματιστής είτε μόλις ξεκινάτε, το Aspose.Cells παρέχει ισχυρά εργαλεία για να βελτιώσετε τις δυνατότητες χειρισμού του Excel. 
## Συχνές ερωτήσεις
### Τι είναι μια κυκλική αναφορά στο Excel;
Μια κυκλική αναφορά συμβαίνει όταν ένας τύπος αναφέρεται στο δικό του κελί, προκαλώντας έναν ατέρμονα βρόχο στους υπολογισμούς.
### Πώς μπορώ να εντοπίσω κυκλικές αναφορές μέσω προγραμματισμού;
Μπορείτε να χρησιμοποιήσετε τη βιβλιοθήκη Aspose.Cells στο .NET για να εντοπίσετε μέσω προγραμματισμού κυκλικές αναφορές, εφαρμόζοντας μια προσαρμοσμένη οθόνη υπολογισμών.
### Ποιες είναι οι προϋποθέσεις για τη χρήση του Aspose.Cells;
Χρειάζεστε εγκατεστημένο το Visual Studio, το .NET Framework και τη βιβλιοθήκη Aspose.Cells.
### Μπορώ να χρησιμοποιήσω το Aspose.Cells δωρεάν;
Ναι, το Aspose.Cells προσφέρει μια δωρεάν δοκιμαστική έκδοση που μπορείτε να χρησιμοποιήσετε για να εξερευνήσετε τις δυνατότητές του.
### Πού μπορώ να βρω περισσότερες πληροφορίες σχετικά με το Aspose.Cells;
Μπορείτε να επισκεφθείτε το [Τεκμηρίωση Aspose.Cells](https://reference.aspose.com/cells/net/) για λεπτομερείς πληροφορίες και παραδείγματα.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}