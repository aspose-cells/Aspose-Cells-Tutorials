---
category: general
date: 2026-02-15
description: Πώς να δημιουργήσετε βιβλίο εργασίας, να μετατρέψετε συμβολοσειρά σε
  ημερομηνία και να μορφοποιήσετε το κελί ως ημερομηνία με το Aspose.Cells. Μάθετε
  πώς να ορίσετε τη μορφή αριθμού του κελιού και να διαβάζετε εύκολα ημερομηνίες από
  το Excel.
draft: false
keywords:
- how to create workbook
- convert string to date
- format cell as date
- set cell number format
- read excel date
language: el
og_description: Πώς να δημιουργήσετε βιβλίο εργασίας, να μετατρέψετε μια συμβολοσειρά
  σε ημερομηνία και να μορφοποιήσετε το κελί ως ημερομηνία. Πλήρης οδηγός βήμα‑προς‑βήμα
  για την ανάγνωση ημερομηνιών Excel.
og_title: Πώς να δημιουργήσετε βιβλίο εργασίας και να μετατρέψετε τη συμβολοσειρά
  σε ημερομηνία στο C#
tags:
- C#
- Aspose.Cells
- Excel automation
title: Πώς να δημιουργήσετε βιβλίο εργασίας και να μετατρέψετε συμβολοσειρά σε ημερομηνία
  στο C#
url: /el/net/excel-custom-number-date-formatting/how-to-create-workbook-and-convert-string-to-date-in-c/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Πώς να δημιουργήσετε βιβλίο εργασίας και να μετατρέψετε συμβολοσειρά σε ημερομηνία σε C#

Έχετε αναρωτηθεί ποτέ **πώς να δημιουργήσετε βιβλίο εργασίας** που μετατρέπει ένα απλό κείμενο όπως `"R3-04-01"` σε μια πραγματική τιμή `DateTime`; Δεν είστε ο μόνος—πολλοί προγραμματιστές αντιμετωπίζουν αυτό το πρόβλημα όταν εξάγουν δεδομένα από παλαιά συστήματα ή εισροές χρηστών. Τα καλά νέα; Με λίγες γραμμές C# και Aspose.Cells μπορείτε να το κάνετε αμέσως, χωρίς χειροκίνητη ανάλυση.

Σε αυτό το tutorial θα περάσουμε από όλη τη διαδικασία: δημιουργία βιβλίου εργασίας, εισαγωγή συμβολοσειράς ημερομηνίας, εφαρμογή σωστής **format cell as date**, εξαναγκασμός της μηχανής να **set cell number format**, και τέλος **read excel date** πίσω ως `DateTime`. Στο τέλος θα έχετε ένα εκτελέσιμο απόσπασμα που μπορείτε να ενσωματώσετε σε οποιοδήποτε έργο .NET.

## Προαπαιτούμενα

- .NET 6+ (ή .NET Framework 4.7.2+)
- **Aspose.Cells for .NET** πακέτο NuGet (`Install-Package Aspose.Cells`)
- Βασική κατανόηση της σύνταξης C#
- Ένα IDE όπως το Visual Studio ή το VS Code (οποιοδήποτε είναι εντάξει)

Δεν απαιτείται επιπλέον διαμόρφωση—το Aspose.Cells διαχειρίζεται όλη τη βαριά δουλειά εσωτερικά.

## Βήμα 1: Πώς να δημιουργήσετε βιβλίο εργασίας – αρχικοποίηση του αρχείου Excel

Αρχικά, χρειαζόμαστε ένα νέο αντικείμενο workbook. Σκεφτείτε το ως ένα κενό σημειωματάριο όπου κάθε φύλλο εργασίας είναι μια σελίδα.

```csharp
using Aspose.Cells;

 // Step 1: Create a new workbook
 var workbook = new Workbook();          // Empty workbook with one default sheet
```

*Γιατί είναι σημαντικό:* Η δημιουργία του workbook μας παρέχει ένα δοχείο για κελιά, στυλ και τύπους. Χωρίς αυτό, δεν υπάρχει που να τοποθετήσουμε τη συμβολοσειρά ημερομηνίας.

## Βήμα 2: Μετατροπή συμβολοσειράς σε ημερομηνία – εισαγωγή ακατέργαστου κειμένου

Τώρα τοποθετούμε τη ακατέργαστη συμβολοσειρά ημερομηνίας στο κελί **A1** του πρώτου φύλλου εργασίας. Η συμβολοσειρά χρησιμοποιεί προσαρμοσμένη μορφή (`R3-04-01`) που το Excel δεν αναγνωρίζει αυτόματα.

```csharp
 // Step 2: Insert a date string into cell A1 of the first worksheet
 var targetCell = workbook.Worksheets[0].Cells["A1"];
 targetCell.PutValue("R3-04-01");        // Raw text, not yet a date
```

*Γιατί το κάνουμε:* Η `PutValue` αποθηκεύει το κυριολεκτικό κείμενο. Αν προσπαθούσαμε να ορίσουμε άμεσα ένα `DateTime`, η προσαρμοσμένη μορφή θα χάνονταν. Διατηρώντας το ως κείμενο, μας επιτρέπει αργότερα να εφαρμόσουμε ένα **set cell number format** που λέει στο Excel πώς να το ερμηνεύσει.

## Βήμα 3: Μορφοποίηση κελιού ως ημερομηνία – εφαρμογή στυλ αριθμού 14

Το ενσωματωμένο στυλ ημερομηνίας 14 του Excel αντιστοιχεί σε `mm-dd-yy`. Αναθέτοντας αυτό το στυλ, λέμε στη μηχανή: «Θεώρησε το περιεχόμενο αυτού του κελιού ως ημερομηνία».

```csharp
 // Step 3: Apply a date number format (style number 14) to the cell
 targetCell.SetStyle(new Style { Number = 14 });
```

*Τι συμβαίνει στο παρασκήνιο:* Η ιδιότητα `Number` αντιστοιχεί στα εσωτερικά IDs μορφής αριθμού του Excel. Όταν το workbook επαναϋπολογίζει, το Excel θα προσπαθήσει να μετατρέψει το κείμενο σε σειριακή ημερομηνία χρησιμοποιώντας τη δοθείσα μορφή.

## Βήμα 4: Ορισμός μορφής αριθμού κελιού – εξαναγκασμός επαναϋπολογισμού

Το Excel δεν θα μετατρέψει το κείμενο μαγικά μέχρι να του ζητήσουμε να αξιολογήσει τύπους (ή, σε αυτήν την περίπτωση, να επανερμηνεύσει το κελί). Η κλήση της `CalculateFormula` ενεργοποιεί αυτή τη μετατροπή.

```csharp
 // Step 4: Recalculate any formulas so the cell value is interpreted as a date
 workbook.CalculateFormula();
```

*Συμβουλή:* Αν εργάζεστε με πολλά κελιά, μπορείτε να καλέσετε τη `CalculateFormula` μία φορά μετά την ολοκλήρωση όλων των μορφοποιήσεων—αυτό εξοικονομεί μερικά χιλιοστά του δευτερολέπτου.

## Βήμα 5: Ανάγνωση ημερομηνίας Excel – λήψη της τιμής DateTime

Τέλος, εξάγουμε την αναπαράσταση `DateTime` από το κελί. Το Aspose.Cells το εκθέτει μέσω του `DateTimeValue`.

```csharp
 // Step 5: Retrieve the DateTime representation and display it
 Console.WriteLine(targetCell.DateTimeValue);
```

**Αναμενόμενο αποτέλεσμα (υπό την προϋπόθεση του προεπιλεγμένου Γρηγοριανού ημερολογίου):**

```
2023-04-01 00:00:00
```

Παρατηρήστε πώς το πρόθεμα `"R3-"` αγνοείται επειδή ο αναλυτής ημερομηνίας του Excel εστιάζει στο αριθμητικό τμήμα όταν το στυλ είναι ημερομηνία. Αν οι συμβολοσειρές σας περιέχουν άλλα προθέματα, ίσως χρειαστεί να τις προεπεξεργαστείτε, αλλά για πολλές παλαιές μορφές αυτή η προσέγγιση λειτουργεί τέλεια.

## Πλήρες Παράδειγμα Λειτουργίας

Συνδυάζοντας όλα τα παραπάνω, εδώ είναι το πλήρες, έτοιμο‑για‑εκτέλεση πρόγραμμα:

```csharp
using System;
using Aspose.Cells;

class Program
{
    static void Main()
    {
        // Step 1: Create a new workbook
        var workbook = new Workbook();

        // Step 2: Insert a date string into cell A1 of the first worksheet
        var targetCell = workbook.Worksheets[0].Cells["A1"];
        targetCell.PutValue("R3-04-01");

        // Step 3: Apply a date number format (style number 14) to the cell
        targetCell.SetStyle(new Style { Number = 14 });

        // Step 4: Recalculate any formulas so the cell value is interpreted as a date
        workbook.CalculateFormula();

        // Step 5: Retrieve the DateTime representation and display it
        Console.WriteLine(targetCell.DateTimeValue);
    }
}
```

Αποθηκεύστε το ως `Program.cs`, επαναφέρετε το πακέτο Aspose.Cells, και εκτελέστε `dotnet run`. Θα πρέπει να δείτε το μορφοποιημένο `DateTime` να εκτυπώνεται στην κονσόλα.

## Κοινές Παραλλαγές & Ακραίες Περιπτώσεις

### Διαφορετικές συμβολοσειρές ημερομηνίας

Αν τα δεδομένα προέλευσης σας μοιάζουν με `"2023/04/01"` ή `"01‑Apr‑2023"`, μπορείτε ακόμη να βασιστείτε στην ίδια ροή εργασίας—απλώς αλλάξτε την ιδιότητα **Number** σε μια μορφή που ταιριάζει στο μοτίβο (π.χ., `Number = 15` για `d-mmm-yy`).  

### Μορφές ειδικές για τοπική ρύθμιση

Το Excel σέβεται τις ρυθμίσεις τοπικής γλώσσας του workbook. Για να εξαναγκάσετε την ανάλυση τύπου US, ορίστε την πολιτισμική ρύθμιση του workbook:

```csharp
workbook.Settings.CultureInfo = new System.Globalization.CultureInfo("en-US");
```

### Όταν η συμβολοσειρά δεν αναγνωρίζεται

Μερικές φορές το Excel δεν μπορεί να ερμηνεύσει μια ημερομηνία (π.χ., `"R3-13-40"`). Σε αυτές τις περιπτώσεις, προεπεξεργαστείτε τη συμβολοσειρά:

```csharp
string raw = "R3-04-01";
string cleaned = raw.Replace("R3-", "");   // Remove the prefix
targetCell.PutValue(cleaned);
```

Στη συνέχεια εφαρμόστε την ίδια μορφή αριθμού.

## Επαγγελματικές Συμβουλές & Πιθανά Προβλήματα

- **Συμβουλή:** Χρησιμοποιήστε το `StyleFlag` για να τροποποιήσετε μόνο τη μορφή αριθμού, αφήνοντας τα άλλα χαρακτηριστικά στυλ αμετάβλητα.  
  ```csharp
  var style = targetCell.GetStyle();
  style.Number = 14;
  var flag = new StyleFlag { Number = true };
  targetCell.SetStyle(style, flag);
  ```
- **Προσοχή:** Η υπεργραφή υπαρχόντων στυλ σε ένα κελί που ήδη έχει περιγράμματα ή γραμματοσειρές. Η προσέγγιση `StyleFlag` το αποτρέπει.
- **Σημείωση απόδοσης:** Αν επεξεργάζεστε χιλιάδες γραμμές, ομαδοποιήστε την κλήση `CalculateFormula` μετά την ολοκλήρωση όλων των ενημερώσεων· η κλήση ανά γραμμή προσθέτει περιττό κόστος.

## Συμπέρασμα

Τώρα γνωρίζετε **πώς να δημιουργήσετε βιβλίο εργασίας**, **πώς να μετατρέψετε συμβολοσειρά σε ημερομηνία**, **πώς να μορφοποιήσετε κελί ως ημερομηνία**, **πώς να ορίσετε μορφή αριθμού κελιού**, και τέλος **πώς να διαβάσετε την ημερομηνία Excel** πίσω σε ένα `DateTime`. Το μοτίβο είναι απλό: εισάγετε ακατέργαστο κείμενο, εφαρμόζετε στυλ ημερομηνίας, εξαναγκάζετε επαναϋπολογισμό, και στη συνέχεια διαβάζετε την τιμή.

Από εδώ μπορείτε να επεκτείνετε τη λογική σε ολόκληρες στήλες, να εισάγετε δεδομένα CSV, ή ακόμη και να δημιουργήσετε αναφορές που αυτόματα μετατρέπουν παλαιές συμβολοσειρές ημερομηνίας σε σωστές ημερομηνίες Excel.

Έτοιμοι να προχωρήσετε στο επόμενο επίπεδο; Δοκιμάστε να εφαρμόσετε μια προσαρμοσμένη μορφή αριθμού (`Number = 22`) για να εμφανίσετε ημερομηνίες ως `yyyy-mm-dd`, ή εξερευνήστε τα εργαλεία `DateTimeConversion` του Aspose.Cells για πιο σύνθετα σενάρια.

Καλός κώδικας! 🚀

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}