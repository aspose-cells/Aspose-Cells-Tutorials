---
category: general
date: 2026-02-15
description: Πώς να χρησιμοποιήσετε το WRAPCOLS για να δημιουργήσετε διάταξη δύο στηλών,
  να προσθέσετε τύπο και να δημιουργήσετε έναν πίνακα ακολουθίας σε φύλλα εργασίας
  C# – οδηγός βήμα‑βήμα.
draft: false
keywords:
- how to use wrapcols
- create two column layout
- how to add formula
- how to create columns
- generate sequence array
language: el
og_description: Πώς να χρησιμοποιήσετε το WRAPCOLS για να δημιουργήσετε διάταξη δύο
  στηλών, να προσθέσετε τύπους και να δημιουργήσετε έναν πίνακα ακολουθίας σε φύλλο
  εργασίας C# – πλήρης οδηγός.
og_title: 'Πώς να χρησιμοποιήσετε το WRAPCOLS: Διάταξη δύο στηλών σε C#'
tags:
- CSharp
- ExcelAutomation
- WorksheetFormula
title: 'Πώς να χρησιμοποιήσετε το WRAPCOLS: Δημιουργία διάταξης δύο στηλών σε C#'
url: /el/net/row-and-column-management/how-to-use-wrapcols-create-a-two-column-layout-in-c/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Πώς να Χρησιμοποιήσετε το WRAPCOLS: Δημιουργία Διάταξης Δύο Στηλών σε C#

Έχετε αναρωτηθεί ποτέ **πώς να χρησιμοποιήσετε το WRAPCOLS** όταν χρειάζεστε μια γρήγορη προβολή δύο στηλών μέσα σε ένα φύλλο εργασίας τύπου Excel; Δεν είστε μόνοι. Πολλοί προγραμματιστές συναντούν δυσκολίες όταν προσπαθούν να χωρίσουν μια παραγόμενη λίστα σε τακτικές στήλες χωρίς να γράψουν βρόχο για κάθε κελί. Τα καλά νέα; Με τη συνάρτηση `WRAPCOLS` μπορείτε να τοποθετήσετε μια μοναδική φόρμουλα στο `A1` και να αφήσετε το Excel (ή μια συμβατή μηχανή) να κάνει το σκληρό έργο.

Σε αυτό το tutorial θα περάσουμε βήμα-βήμα **πώς να προσθέσετε φόρμουλα** που δημιουργεί μια **διάταξη δύο στηλών**, θα σας δείξουμε **πώς να δημιουργείτε στήλες** δυναμικά, και ακόμη **να δημιουργήσετε πίνακα ακολουθίας** τιμών επί τόπου. Στο τέλος θα έχετε ένα πλήρως εκτελέσιμο απόσπασμα C# που μπορείτε να επικολλήσετε στο έργο σας, να το τρέξετε και να δείτε αμέσως ένα τακτοποιημένο μπλοκ δύο στηλών.

## Τι Θα Μάθετε

- Ο σκοπός της `WRAPCOLS` και γιατί αποτελεί καλύτερη εναλλακτική από το χειροκίνητο βρόχο.  
- Πώς να **προσθέσετε φόρμουλα** σε ένα κελί φύλλου εργασίας χρησιμοποιώντας C#.  
- Πώς να δημιουργήσετε έναν πίνακα ακολουθίας με `SEQUENCE` και να τον περάσετε στη `WRAPCOLS`.  
- Συμβουλές για τον επανυπολογισμό του φύλλου ώστε η φόρμουλα να επιλύεται αμέσως.  
- Διαχείριση περιπτώσεων άκρων (π.χ., κενά φύλλα εργασίας, προσαρμοσμένοι αριθμοί στηλών).

Δεν απαιτούνται εξωτερικές βιβλιοθήκες πέρα από ένα τυπικό πακέτο επεξεργασίας Excel – θα χρησιμοποιήσουμε το **ClosedXML** για το απλό του API, αλλά οι έννοιες μεταφέρονται σε EPPlus, SpreadsheetGear ή ακόμη και στο Google Sheets μέσω του API του.

---

## Προαπαιτούμενα

- .NET 6.0 ή νεότερο (ο κώδικας μεταγλωττίζεται σε .NET Core και .NET Framework).  
- Μια αναφορά στο **ClosedXML** (`dotnet add package ClosedXML`).  
- Βασικές γνώσεις C# – πρέπει να είστε άνετοι με τις δηλώσεις `using` και την αρχικοποίηση αντικειμένων.

Αν έχετε ήδη ανοίξει ένα βιβλίο εργασίας, μπορείτε να παραλείψετε το τμήμα δημιουργίας αρχείου και να μεταβείτε απευθείας στην ενότητα της φόρμουλας.

---

## Βήμα 1: Ρύθμιση του Φύλλου Εργασίας (Πώς να Δημιουργήσετε Στήλες)

Αρχικά χρειαζόμαστε ένα αντικείμενο `Worksheet` για να εργαστούμε. Στο ClosedXML το λαμβάνετε από ένα `XLWorkbook`. Το παρακάτω απόσπασμα δημιουργεί ένα νέο βιβλίο εργασίας, προσθέτει ένα φύλλο με όνομα *Demo* και παίρνει μια αναφορά με όνομα `worksheet` για σαφήνεια.

```csharp
using ClosedXML.Excel;

namespace WrapColsDemo
{
    class Program
    {
        static void Main()
        {
            // Create a fresh workbook and add a worksheet named "Demo"
            using var workbook = new XLWorkbook();
            var ws = workbook.Worksheets.Add("Demo");

            // Rename for clarity – this is the worksheet we’ll manipulate
            var worksheet = ws;   // <-- same object, just a clearer name

            // --------------------------------------------------------------
            // Next step: write the WRAPCOLS formula
            // --------------------------------------------------------------
```

> **Γιατί η μετονομασία;**  
> Η διατήρηση του ονόματος της μεταβλητής σύντομης (`worksheet`) κάνει τον επόμενο κώδικα πιο ευανάγνωστο, ειδικά όταν αλυσίδετε πολλαπλές λειτουργίες. Επίσης αντικατοπτρίζει το στυλ ονοματοδοσίας που θα δείτε στα περισσότερα τεκμηριωμένα, μειώνοντας το γνωστικό φορτίο.

---

## Βήμα 2: Γράψτε τη Φόρμουλα (Πώς να Προσθέσετε Φόρμουλα + Δημιουργήσετε Πίνακα Ακολουθίας)

Τώρα έρχεται η μαγική γραμμή. Θα τοποθετήσουμε μια φόρμουλα στο κελί **A1** που κάνει δύο πράγματα:

1. **Δημιουργήστε έναν πίνακα ακολουθίας** έξι αριθμών (`SEQUENCE(6)` → 1,2,3,4,5,6).  
2. **Τυλίξτε αυτούς τους αριθμούς σε δύο στήλες** (`WRAPCOLS(..., 2)`).

```csharp
            // Write the WRAPCOLS formula into A1
            worksheet.Cell("A1").FormulaA1 = "=WRAPCOLS(SEQUENCE(6), 2)";

            // --------------------------------------------------------------
            // Finally, force the engine to evaluate the formula
            // --------------------------------------------------------------
```

> **Τι συμβαίνει;**  
> Η `SEQUENCE(6)` δημιουργεί έναν κάθετο πίνακα `{1;2;3;4;5;6}`. Η `WRAPCOLS` στη συνέχεια παίρνει αυτόν τον πίνακα και τον «τυλίγει» στον καθορισμένο αριθμό στηλών — σε αυτήν την περίπτωση **2**. Το αποτέλεσμα είναι ένα μπλοκ 3‑γραμμών × 2‑στηλών που φαίνεται ως εξής:

| A | B |
|---|---|
| 1 | 4 |
| 2 | 5 |
| 3 | 6 |

Αν αλλάξετε το δεύτερο όρισμα σε **3**, θα έχετε μια διάταξη τριών στηλών. Αυτό είναι το βασικό στοιχείο του **πώς να δημιουργείτε στήλες** επί τόπου χωρίς χειροκίνητους βρόχους.

---

## Βήμα 3: Επανυπολογισμός του Φύλλου Εργασίας (Διασφάλιση της Αξιολόγησης της Φόρμουλας)

Το ClosedXML δεν αξιολογεί αυτόματα τις φόρμουλες όταν τις γράφετε. Πρέπει να καλέσετε `Calculate()` στο βιβλίο εργασίας (ή στο συγκεκριμένο φύλλο) για να εξαναγκάσετε την αξιολόγηση.

```csharp
            // Recalculate so the formula is evaluated immediately
            worksheet.Calculate();

            // Optional: save the workbook to inspect the result
            workbook.SaveAs("WrapColsDemo.xlsx");
        }
    }
}
```

> **Συμβουλή επαγγελματία:** Αν εργάζεστε με μεγάλα βιβλία εργασίας, καλέστε `Calculate()` μόνο στα φύλλα που πραγματικά άλλαξαν. Αυτό εξοικονομεί μνήμη και επιταχύνει την επεξεργασία.

Όταν ανοίξετε το `WrapColsDemo.xlsx` θα δείτε τη διάταξη δύο στηλών να έχει γεμίσει τακτοποιημένα στο **A1:B3**. Δεν απαιτήθηκε επιπλέον κώδικας για βρόχο στις γραμμές ή στήλες – το `WRAPCOLS` διαχειρίστηκε τα πάντα.

---

## Βήμα 4: Επαλήθευση του Αποτελέσματος (Τι να Περιμένετε)

Μετά την εκτέλεση του προγράμματος, ανοίξτε το παραγόμενο αρχείο. Θα πρέπει να δείτε:

| A | B |
|---|---|
| 1 | 4 |
| 2 | 5 |
| 3 | 6 |

Αν οι αριθμοί εμφανίζονται κάθετα (δηλαδή, όλα στη στήλη A), ελέγξτε ξανά ότι καλέσατε `worksheet.Calculate()` **μετά** την τοποθέτηση της φόρμουλας. Κάποιες μηχανές χρειάζονται επίσης `workbook.Calculate()`· το παραπάνω απόσπασμα λειτουργεί με τον ενσωματωμένο αξιολογητή του ClosedXML.

---

## Συνηθισμένες Παραλλαγές & Περιπτώσεις Άκρων

### Αλλαγή του Αριθμού Στηλών

Για να **δημιουργήσετε διάταξη δύο στηλών** με διαφορετικό αριθμό γραμμών, απλώς προσαρμόστε το μέγεθος του `SEQUENCE` ή το δεύτερο όρισμα της `WRAPCOLS`:

```csharp
worksheet.Cell("A1").FormulaA1 = "=WRAPCOLS(SEQUENCE(12), 3)";
```

Αυτό παράγει ένα μπλοκ 4‑γραμμών × 3‑στηλών (12 αριθμοί χωρισμένοι σε τρεις στήλες).

### Χρήση Δυναμικού Αριθμού Στηλών

Αν ο αριθμός των στηλών προέρχεται από μια μεταβλητή, ενσωματώστε το με διασύνδεση συμβολοσειράς:

```csharp
int colCount = 4;
worksheet.Cell("A1").FormulaA1 = $"=WRAPCOLS(SEQUENCE(8), {colCount})";
```

Τώρα έχετε **πώς να προσθέσετε φόρμουλα** που προσαρμόζεται κατά την εκτέλεση.

### Κενά Φύλλα Εργασίας

Αν το φύλλο εργασίας είναι κενό, το `Calculate()` λειτουργεί ακόμη – η φόρμουλα θα γεμίσει τα κελιά ξεκινώντας από το A1. Ωστόσο, αν αργότερα διαγράψετε γραμμές/στήλες που διασταυρώνονται με την περιοχή εξόδου, μπορεί να εμφανιστούν σφάλματα `#REF!`. Για να το αποφύγετε, καθαρίστε πρώτα την περιοχή στόχου:

```csharp
worksheet.Range("A1:Z100").Clear(); // wipes any leftovers
```

### Συμβατότητα

Οι `WRAPCOLS` και `SEQUENCE` αποτελούν μέρος των λειτουργιών **Δυναμικού Πίνακα** του Excel, που εισήχθησαν στο Office 365. Αν στοχεύετε σε παλαιότερες εκδόσεις του Excel, οι λειτουργίες δεν θα υπάρχουν και θα χρειαστείτε χειροκίνητο βρόχο. Ο αξιολογητής του ClosedXML αντικατοπτρίζει τη σύγχρονη συμπεριφορά του Excel, οπότε είναι ασφαλής για σύγχρονα περιβάλλοντα.

---

## Πλήρες Παράδειγμα Εργασίας (Έτοιμο για Αντιγραφή‑Επικόλληση)

```csharp
using ClosedXML.Excel;

namespace WrapColsDemo
{
    class Program
    {
        static void Main()
        {
            // 1️⃣ Create workbook & worksheet
            using var workbook = new XLWorkbook();
            var ws = workbook.Worksheets.Add("Demo");
            var worksheet = ws;   // clearer name

            // 2️⃣ Write WRAPCOLS formula that generates a sequence array
            worksheet.Cell("A1").FormulaA1 = "=WRAPCOLS(SEQUENCE(6), 2)";

            // 3️⃣ Force calculation so the formula resolves immediately
            worksheet.Calculate();

            // 4️⃣ Save the file (optional, but handy for verification)
            workbook.SaveAs("WrapColsDemo.xlsx");
        }
    }
}
```

**Αναμενόμενο αποτέλεσμα:** Το άνοιγμα του *WrapColsDemo.xlsx* εμφανίζει μια τακτοποιημένη διάταξη δύο στηλών με τους αριθμούς 1‑6 όπως περιγράφηκε παραπάνω.

---

## Συμπέρασμα

Καλύψαμε **πώς να χρησιμοποιήσετε το WRAPCOLS** για **να δημιουργήσετε διάταξη δύο στηλών**, δείξαμε **πώς να προσθέσετε φόρμουλα** προγραμματιστικά, και είδαμε πώς η `SEQUENCE` σας επιτρέπει να **δημιουργήσετε πίνακα ακολουθίας** τιμών χωρίς βρόχο. Εκμεταλλευόμενοι τις λειτουργίες δυναμικού πίνακα του Excel από το C#, μπορείτε να διατηρήσετε τον κώδικά σας συνοπτικό, ευανάγνωστο και συντηρήσιμο.

Στη συνέχεια, μπορείτε να εξερευνήσετε:

- **Δημιουργία δυναμικών αριθμών γραμμών** με `ROWS` ή `COUNTA`.  
- **Στυλιζάρισμα της εξόδου** (περιγράμματα, μορφές αριθμών) χρησιμοποιώντας το API στυλ του ClosedXML.  
- **Εξαγωγή σε CSV** μετά την κατασκευή της διάταξης, για επεξεργασία downstream.

Δοκιμάστε το, τροποποιήστε τον αριθμό των στηλών και δείτε πόσο γρήγορα μπορείτε να δημιουργήσετε πρωτότυπα σύνθετων λογιστικών φύλλων. Καλή προγραμματιστική!

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}