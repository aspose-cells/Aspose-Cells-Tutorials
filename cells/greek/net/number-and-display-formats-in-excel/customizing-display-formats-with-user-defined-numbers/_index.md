---
title: Προσαρμογή μορφών εμφάνισης με αριθμούς που καθορίζονται από το χρήστη
linktitle: Προσαρμογή μορφών εμφάνισης με αριθμούς που καθορίζονται από το χρήστη
second_title: Aspose.Cells .NET Excel Processing API
description: Μάθετε πώς να προσαρμόζετε τις μορφές εμφάνισης με το Aspose.Cells για .NET. Μορφοποιήστε ημερομηνίες, ποσοστά και νόμισμα χρησιμοποιώντας αυτόν τον οδηγό βήμα προς βήμα.
weight: 11
url: /el/net/number-and-display-formats-in-excel/customizing-display-formats-with-user-defined-numbers/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Προσαρμογή μορφών εμφάνισης με αριθμούς που καθορίζονται από το χρήστη

## Εισαγωγή
Η εργασία με αρχεία Excel απαιτεί συχνά προσαρμοσμένη μορφοποίηση κελιών για την παρουσίαση δεδομένων με πιο ουσιαστικό και φιλικό προς το χρήστη τρόπο. Φανταστείτε ότι δημιουργείτε ένα αρχείο Excel για μια αναφορά. Δεν θέλετε μόνο ακατέργαστους αριθμούς. Θέλετε οι ημερομηνίες, τα ποσοστά και τα νομίσματα να φαίνονται κομψά και επαγγελματικά, σωστά; Εκεί μπαίνουν στο παιχνίδι προσαρμοσμένες μορφές εμφάνισης. Σε αυτό το σεμινάριο, βουτάμε βαθιά στο Aspose.Cells για .NET για να σας δείξουμε πώς να προσαρμόσετε τη μορφή εμφάνισης των αριθμών χρησιμοποιώντας ρυθμίσεις που καθορίζονται από το χρήστη.
## Προαπαιτούμενα
Πριν ξεκινήσετε, βεβαιωθείτε ότι έχετε τα πάντα έτοιμα για να ακολουθήσετε μαζί με αυτό το σεμινάριο. Εδώ είναι τι θα χρειαστείτε:
-  Εγκαταστάθηκαν Aspose.Cells για .NET.[Κατεβάστε το εδώ](https://releases.aspose.com/cells/net/).
- Βασικές γνώσεις C# και .NET Framework.
-  Μια έγκυρη άδεια χρήσης για το Aspose.Cells. Εάν δεν έχετε, πιάστε ένα[δωρεάν δοκιμή](https://releases.aspose.com/) ή ζητήστε α[προσωρινή άδεια](https://purchase.aspose.com/temporary-license/).
- Ένα IDE σαν το Visual Studio.
- .NET Framework 4.0 ή νεότερη έκδοση.
 Αν σας λείπει κάτι, μην ανησυχείτε. Μπορείτε πάντα να επισκέπτεστε ξανά αυτούς τους συνδέσμους για να κάνετε λήψη των απαραίτητων αρχείων ή να ζητήσετε βοήθεια από το[Aspose forum υποστήριξης](https://forum.aspose.com/c/cells/9).
## Εισαγωγή χώρων ονομάτων
Πριν μεταβείτε στον κώδικα, πρέπει να εισαγάγετε τους απαιτούμενους χώρους ονομάτων για πρόσβαση σε όλες τις απαραίτητες λειτουργίες Aspose.Cells.
```csharp
using System.IO;
using Aspose.Cells;
using System;
```
Αυτοί οι δύο χώροι ονομάτων θα είναι τα βασικά σας εργαλεία σε αυτό το σεμινάριο. Τώρα, ας περάσουμε στο διασκεδαστικό μέρος:
## Βήμα 1: Ρύθμιση του καταλόγου έργου
Πρώτον, χρειάζεστε ένα μέρος για να αποθηκεύσετε τα αρχεία σας, σωστά; Ας δημιουργήσουμε έναν κατάλογο για να αποθηκεύσουμε το αρχείο εξόδου Excel. Σε αυτό το βήμα, θα βεβαιωθούμε επίσης ότι ο κατάλογος υπάρχει πριν αποθηκεύσουμε οτιδήποτε.
```csharp
// Η διαδρομή προς τον κατάλογο εγγράφων.
string dataDir = "Your Document Directory";
// Δημιουργήστε κατάλογο εάν δεν υπάρχει ήδη.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
-  Ορίζουμε α`dataDir` μεταβλητή για αποθήκευση της διαδρομής όπου θα πάει το αρχείο εξόδου Excel.
-  Στη συνέχεια ελέγχουμε εάν ο κατάλογος υπάρχει χρησιμοποιώντας`System.IO.Directory.Exists()`.
-  Εάν ο κατάλογος δεν υπάρχει, θα δημιουργηθεί χρησιμοποιώντας`System.IO.Directory.CreateDirectory()`.
## Βήμα 2: Δημιουργήστε ένα νέο βιβλίο εργασίας και προσθέστε ένα φύλλο εργασίας
Τώρα που έχουμε τον κατάλογό μας, ας δημιουργήσουμε ένα νέο βιβλίο εργασίας του Excel και ας προσθέσουμε ένα φύλλο εργασίας σε αυτό.
```csharp
// Δημιουργία αντικειμένου βιβλίου εργασίας
Workbook workbook = new Workbook();
// Προσθήκη νέου φύλλου εργασίας στο αντικείμενο Excel
int i = workbook.Worksheets.Add();
// Λήψη της αναφοράς του νέου φύλλου εργασίας που προστέθηκε περνώντας το ευρετήριο φύλλου του
Worksheet worksheet = workbook.Worksheets[i];
```
-  Αρχικά, δημιουργούμε ένα νέο`Workbook` αντικείμενο. Σκεφτείτε το ως το αρχείο σας Excel.
-  Προσθέτουμε ένα νέο φύλλο εργασίας σε αυτό το βιβλίο εργασίας χρησιμοποιώντας το`Add()`μέθοδο και αποθηκεύστε το ευρετήριο σε μεταβλητή`i`.
-  Αναφέρουμε αυτό το φύλλο εργασίας χρησιμοποιώντας το`workbook.Worksheets[i]`.
## Βήμα 3: Προσθήκη ημερομηνίας σε ένα κελί και προσαρμογή της μορφής του
 Τώρα, ας εισαγάγουμε την τρέχουσα ημερομηνία σε ένα κελί και ας τη μορφοποιήσουμε ώστε να εμφανίζεται με προσαρμοσμένο τρόπο. Αντί για την προεπιλεγμένη μορφή ημερομηνίας, θα ορίσουμε μια προσαρμοσμένη μορφή όπως`d-mmm-yy`.
```csharp
// Προσθήκη της τρέχουσας ημερομηνίας συστήματος στο κελί "A1".
worksheet.Cells["A1"].PutValue(DateTime.Now);
// Αποκτώντας το στυλ του κελιού Α1
Style style = worksheet.Cells["A1"].GetStyle();
// Ρύθμιση της προσαρμοσμένης μορφής εμφάνισης για εμφάνιση της ημερομηνίας ως "η-μμμ-εε"
style.Custom = "d-mmm-yy";
// Εφαρμογή του στυλ στο κελί Α1
worksheet.Cells["A1"].SetStyle(style);
```
-  Προσθέτουμε την τρέχουσα ημερομηνία συστήματος στο κελί`A1` χρησιμοποιώντας`PutValue(DateTime.Now)`.
-  Ανακτούμε το τρέχον στυλ κελιού`A1` χρησιμοποιώντας`GetStyle()`.
-  Τροποποιούμε το στυλ του κελιού με ρύθμιση`style.Custom = "d-mmm-yy"`, το οποίο μορφοποιεί την ημερομηνία για να εμφανίζει την ημέρα, συντομευμένο μήνα και έτος.
-  Τέλος, εφαρμόζουμε το νέο στυλ στο κελί με`SetStyle()`.
## Βήμα 4: Μορφοποίηση κελιού ως ποσοστό
 Στη συνέχεια, ας δουλέψουμε με αριθμούς. Θα προσθέσουμε μια αριθμητική τιμή σε ένα άλλο κελί, ας πούμε`A2`, και μορφοποιήστε το ως ποσοστό.
```csharp
//Προσθήκη αριθμητικής τιμής στο κελί "A2".
worksheet.Cells["A2"].PutValue(20);
// Αποκτώντας το στυλ του κελιού Α2
style = worksheet.Cells["A2"].GetStyle();
// Ρύθμιση της προσαρμοσμένης μορφής εμφάνισης ώστε να εμφανίζεται η τιμή ως ποσοστό
style.Custom = "0.0%";
// Εφαρμογή του στυλ σε κελί Α2
worksheet.Cells["A2"].SetStyle(style);
```
-  Προσθέτουμε την αξία`20` στο κελί`A2`.
-  Ανακτούμε το στυλ του κελιού`A2` και ορίστε την προσαρμοσμένη μορφή σε`0.0%` για να εμφανίσετε την τιμή ως ποσοστό (δηλ. 20%).
-  Τέλος, εφαρμόζουμε το στυλ στο κελί χρησιμοποιώντας`SetStyle()`.
## Βήμα 5: Μορφοποίηση κελιού ως νομίσματος
 Ας προσθέσουμε μια άλλη τιμή, ας πούμε στο κελί`A3`και μορφοποιήστε το ώστε να εμφανίζεται ως νόμισμα. Για να κάνουμε τα πράγματα πιο ενδιαφέροντα, θα χρησιμοποιήσουμε μια μορφή που εμφανίζει θετικές τιμές ως νόμισμα σε λίρες και αρνητικές τιμές σε δολάρια.
```csharp
// Προσθήκη αριθμητικής τιμής στο κελί "A3".
worksheet.Cells["A3"].PutValue(2546);
// Αποκτώντας το στυλ του κελιού Α3
style = worksheet.Cells["A3"].GetStyle();
// Ρύθμιση της προσαρμοσμένης μορφής εμφάνισης ώστε να εμφανίζεται η αξία ως νόμισμα
style.Custom = "£#,##0;[Red]$-#,##0";
// Εφαρμογή του στυλ σε κελί Α3
worksheet.Cells["A3"].SetStyle(style);
```
-  Προσθέτουμε την αξία`2546` στο κελί`A3`.
-  Ορίσαμε μια προσαρμοσμένη μορφή`£#,##0;[Red]$-#,##0`, που εμφανίζει θετικές τιμές με πρόσημο λίρας και αρνητικές τιμές με κόκκινο με σύμβολο δολαρίου.
- Εφαρμόζουμε το στυλ στο κελί χρησιμοποιώντας`SetStyle()`.
## Βήμα 6: Αποθήκευση του βιβλίου εργασίας
Το τελευταίο βήμα είναι να αποθηκεύσετε το βιβλίο εργασίας ως αρχείο Excel. Θα χρησιμοποιήσουμε τη μορφή Excel 97-2003 για αυτό το σεμινάριο.
```csharp
// Αποθήκευση του αρχείου Excel
workbook.Save(dataDir + "book1.out.xls", SaveFormat.Excel97To2003);
```
-  Ο`Save()` μέθοδος αποθηκεύει το βιβλίο εργασίας στον καθορισμένο κατάλογο.
-  Επιλέγουμε`SaveFormat.Excel97To2003` για να διασφαλιστεί η συμβατότητα με παλαιότερες εκδόσεις του Excel.
## Σύναψη
Ορίστε το! Μόλις δημιουργήσαμε ένα αρχείο Excel, προσθέσαμε προσαρμοσμένες μορφές ημερομηνίας, ποσοστού και νομίσματος σε συγκεκριμένα κελιά χρησιμοποιώντας το Aspose.Cells για .NET και αποθηκεύσαμε το αρχείο. Η προσαρμοσμένη μορφοποίηση κάνει τα αρχεία Excel σας πολύ πιο ευανάγνωστα και επαγγελματικά. Μην ξεχάσετε να εξερευνήσετε άλλες επιλογές μορφοποίησης στο Aspose.Cells, όπως η μορφοποίηση υπό όρους, για ακόμη περισσότερο έλεγχο της εμφάνισης των δεδομένων σας.
## Συχνές ερωτήσεις
### Πώς μπορώ να εφαρμόσω πιο σύνθετες επιλογές μορφοποίησης στο Aspose.Cells;
Μπορείτε να συνδυάσετε διαφορετικά στυλ μορφοποίησης, όπως χρώμα γραμματοσειράς, περιγράμματα και χρώματα φόντου, με προσαρμοσμένες μορφές αριθμών.
### Μπορώ να εφαρμόσω μια προσαρμοσμένη μορφή αριθμού σε μια σειρά κελιών;
Ναι, το Aspose.Cells σάς επιτρέπει να εφαρμόσετε ένα στυλ σε μια σειρά κελιών χρησιμοποιώντας το`Range.SetStyle()` μέθοδος.
### Σε ποιες άλλες μορφές αρχείων μπορώ να αποθηκεύσω το βιβλίο εργασίας;
 Το Aspose.Cells υποστηρίζει πολλές μορφές, συμπεριλαμβανομένων των XLSX, CSV και PDF. Απλώς αλλάξτε το`SaveFormat` στο`Save()` μέθοδος.
### Μπορώ να μορφοποιήσω διαφορετικά τους αρνητικούς αριθμούς;
Απολύτως! Μπορείτε να χρησιμοποιήσετε προσαρμοσμένες μορφές αριθμών για να εμφανίσετε αρνητικούς αριθμούς με διαφορετικά χρώματα ή σύμβολα.
### Είναι δωρεάν το Aspose.Cells για .NET;
 Το Aspose.Cells προσφέρει μια δωρεάν δοκιμή, αλλά για πλήρη λειτουργικότητα, θα χρειαστείτε μια έγκυρη άδεια χρήσης. Μπορείτε να πάρετε ένα[προσωρινή άδεια εδώ](https://purchase.aspose.com/temporary-license/).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
