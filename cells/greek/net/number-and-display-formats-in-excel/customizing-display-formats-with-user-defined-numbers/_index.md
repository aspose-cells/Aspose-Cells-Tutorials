---
"description": "Μάθετε πώς να προσαρμόζετε τις μορφές εμφάνισης με το Aspose.Cells για .NET. Μορφοποιήστε ημερομηνίες, ποσοστά και νομίσματα χρησιμοποιώντας αυτόν τον αναλυτικό οδηγό."
"linktitle": "Προσαρμογή μορφών εμφάνισης με αριθμούς που ορίζονται από τον χρήστη"
"second_title": "API επεξεργασίας Excel Aspose.Cells .NET"
"title": "Προσαρμογή μορφών εμφάνισης με αριθμούς που ορίζονται από τον χρήστη"
"url": "/el/net/number-and-display-formats-in-excel/customizing-display-formats-with-user-defined-numbers/"
"weight": 11
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Προσαρμογή μορφών εμφάνισης με αριθμούς που ορίζονται από τον χρήστη

## Εισαγωγή
Η εργασία με αρχεία Excel συχνά απαιτεί προσαρμοσμένη μορφοποίηση κελιών για την παρουσίαση των δεδομένων με πιο ουσιαστικό και φιλικό προς το χρήστη τρόπο. Φανταστείτε ότι δημιουργείτε ένα αρχείο Excel για μια αναφορά. Δεν θέλετε απλώς ακατέργαστους αριθμούς. Θέλετε οι ημερομηνίες, τα ποσοστά και τα νομίσματα να φαίνονται κομψά και επαγγελματικά, σωστά; Εδώ μπαίνουν στο παιχνίδι οι προσαρμοσμένες μορφές εμφάνισης. Σε αυτό το σεμινάριο, εμβαθύνουμε στο Aspose.Cells για .NET για να σας δείξουμε πώς να προσαρμόσετε τη μορφή εμφάνισης των αριθμών χρησιμοποιώντας ρυθμίσεις που ορίζονται από τον χρήστη.
## Προαπαιτούμενα
Πριν ξεκινήσετε, βεβαιωθείτε ότι έχετε όλα τα απαραίτητα για να παρακολουθήσετε αυτό το σεμινάριο. Δείτε τι θα χρειαστείτε:
- Εγκατεστημένο το Aspose.Cells για .NET. [Κατεβάστε το εδώ](https://releases.aspose.com/cells/net/).
- Βασική γνώση C# και .NET framework.
- Μια έγκυρη άδεια χρήσης για το Aspose.Cells. Εάν δεν έχετε, αποκτήστε μια [δωρεάν δοκιμή](https://releases.aspose.com/) ή να ζητήσετε ένα [προσωρινή άδεια](https://purchase.aspose.com/temporary-license/).
- Ένα IDE όπως το Visual Studio.
- .NET Framework 4.0 ή νεότερη έκδοση.
Αν σας λείπει κάτι, μην ανησυχείτε. Μπορείτε πάντα να επισκεφθείτε ξανά αυτούς τους συνδέσμους για να κατεβάσετε τα απαραίτητα αρχεία ή να ζητήσετε βοήθεια από το [Φόρουμ υποστήριξης Aspose](https://forum.aspose.com/c/cells/9).
## Εισαγωγή χώρων ονομάτων
Πριν ξεκινήσετε τον κώδικα, πρέπει να εισαγάγετε τους απαιτούμενους χώρους ονομάτων για να αποκτήσετε πρόσβαση σε όλες τις απαραίτητες λειτουργίες του Aspose.Cells.
```csharp
using System.IO;
using Aspose.Cells;
using System;
```
Αυτοί οι δύο χώροι ονομάτων θα είναι τα βασικά σας εργαλεία σε αυτό το σεμινάριο. Τώρα, ας προχωρήσουμε στο διασκεδαστικό μέρος:
## Βήμα 1: Ρύθμιση του καταλόγου έργου
Αρχικά, χρειάζεστε ένα μέρος για να αποθηκεύσετε τα αρχεία σας, σωστά; Ας δημιουργήσουμε έναν κατάλογο για να αποθηκεύσουμε το αρχείο Excel που θα προκύψει. Σε αυτό το βήμα, θα βεβαιωθούμε επίσης ότι ο κατάλογος υπάρχει πριν αποθηκεύσουμε οτιδήποτε.
```csharp
// Η διαδρομή προς τον κατάλογο εγγράφων.
string dataDir = "Your Document Directory";
// Δημιουργήστε έναν κατάλογο εάν δεν υπάρχει ήδη.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
- Ορίζουμε ένα `dataDir` μεταβλητή για την αποθήκευση της διαδρομής όπου θα μεταφερθεί το αρχείο Excel εξόδου.
- Στη συνέχεια, ελέγχουμε αν ο κατάλογος υπάρχει χρησιμοποιώντας `System.IO.Directory.Exists()`.
- Εάν ο κατάλογος δεν υπάρχει, θα δημιουργηθεί χρησιμοποιώντας `System.IO.Directory.CreateDirectory()`.
## Βήμα 2: Δημιουργήστε ένα νέο βιβλίο εργασίας και προσθέστε ένα φύλλο εργασίας
Τώρα που έχουμε τον κατάλογό μας, ας δημιουργήσουμε ένα νέο βιβλίο εργασίας του Excel και ας προσθέσουμε ένα φύλλο εργασίας σε αυτό.
```csharp
// Δημιουργία στιγμιαίου αντικειμένου βιβλίου εργασίας
Workbook workbook = new Workbook();
// Προσθήκη νέου φύλλου εργασίας στο αντικείμενο του Excel
int i = workbook.Worksheets.Add();
// Λήψη της αναφοράς του νέου φύλλου εργασίας που προστέθηκε μέσω της διαβίβασης του ευρετηρίου του φύλλου εργασίας
Worksheet worksheet = workbook.Worksheets[i];
```
- Αρχικά, δημιουργούμε ένα νέο `Workbook` αντικείμενο. Σκεφτείτε το ως το αρχείο Excel σας.
- Προσθέτουμε ένα νέο φύλλο εργασίας σε αυτό το βιβλίο εργασίας χρησιμοποιώντας το `Add()` μέθοδος και αποθηκεύστε τον δείκτη σε μεταβλητή `i`.
- Αναφερόμαστε σε αυτό το φύλλο εργασίας χρησιμοποιώντας το `workbook.Worksheets[i]`.
## Βήμα 3: Προσθήκη ημερομηνίας σε ένα κελί και προσαρμογή της μορφής του
Τώρα, ας εισαγάγουμε την τρέχουσα ημερομηνία σε ένα κελί και ας τη μορφοποιήσουμε ώστε να εμφανίζεται με προσαρμοσμένο τρόπο. Αντί για την προεπιλεγμένη μορφή ημερομηνίας, θα ορίσουμε μια προσαρμοσμένη μορφή όπως `d-mmm-yy`.
```csharp
// Προσθήκη της τρέχουσας ημερομηνίας συστήματος στο κελί "A1"
worksheet.Cells["A1"].PutValue(DateTime.Now);
// Λήψη του στυλ του κελιού A1
Style style = worksheet.Cells["A1"].GetStyle();
// Ρύθμιση της προσαρμοσμένης μορφής εμφάνισης για εμφάνιση ημερομηνίας ως "η-μμμ-εε"
style.Custom = "d-mmm-yy";
// Εφαρμογή του στυλ σε κελί A1
worksheet.Cells["A1"].SetStyle(style);
```
- Προσθέτουμε την τρέχουσα ημερομηνία συστήματος στο κελί `A1` χρησιμοποιώντας `PutValue(DateTime.Now)`.
- Ανακτούμε το τρέχον στυλ του κελιού `A1` χρησιμοποιώντας `GetStyle()`.
- Τροποποιούμε το στυλ του κελιού ορίζοντας `style.Custom = "d-mmm-yy"`, το οποίο μορφοποιεί την ημερομηνία ώστε να εμφανίζει την ημέρα, τον συντομευμένο μήνα και το έτος.
- Τέλος, εφαρμόζουμε το νέο στυλ στο κελί με `SetStyle()`.
## Βήμα 4: Μορφοποίηση κελιού ως ποσοστό
Στη συνέχεια, ας εργαστούμε με αριθμούς. Θα προσθέσουμε μια αριθμητική τιμή σε ένα άλλο κελί, ας πούμε `A2`και μορφοποιήστε το ως ποσοστό.
```csharp
// Προσθήκη αριθμητικής τιμής στο κελί "A2"
worksheet.Cells["A2"].PutValue(20);
// Λήψη του στυλ του κελιού A2
style = worksheet.Cells["A2"].GetStyle();
// Ρύθμιση της προσαρμοσμένης μορφής εμφάνισης για εμφάνιση τιμής ως ποσοστό
style.Custom = "0.0%";
// Εφαρμογή του στυλ σε κελί A2
worksheet.Cells["A2"].SetStyle(style);
```
- Προσθέτουμε την αξία `20` σε κελί `A2`.
- Ανακτούμε το στυλ του κελιού `A2` και ορίστε την προσαρμοσμένη μορφή σε `0.0%` για να εμφανίσετε την τιμή ως ποσοστό (δηλαδή, 20%).
- Τέλος, εφαρμόζουμε το στυλ στο κελί χρησιμοποιώντας `SetStyle()`.
## Βήμα 5: Μορφοποίηση κελιού ως νομισματικής μονάδας
Ας προσθέσουμε μια άλλη τιμή, ας πούμε στο κελί `A3`και να το μορφοποιήσουμε ώστε να εμφανίζεται ως νόμισμα. Για να κάνουμε τα πράγματα πιο ενδιαφέροντα, θα χρησιμοποιήσουμε μια μορφή που εμφανίζει θετικές τιμές ως νόμισμα σε λίρες και αρνητικές τιμές σε δολάρια.
```csharp
// Προσθήκη αριθμητικής τιμής σε κελί "A3"
worksheet.Cells["A3"].PutValue(2546);
// Λήψη του στυλ κελιού A3
style = worksheet.Cells["A3"].GetStyle();
// Ρύθμιση της προσαρμοσμένης μορφής εμφάνισης για εμφάνιση της αξίας ως νομίσματος
style.Custom = "£#,##0;[Red]$-#,##0";
// Εφαρμογή του στυλ σε κελί A3
worksheet.Cells["A3"].SetStyle(style);
```
- Προσθέτουμε την αξία `2546` σε κελί `A3`.
- Ορίζουμε μια προσαρμοσμένη μορφή `£#,##0;[Red]$-#,##0`, το οποίο εμφανίζει θετικές τιμές με σύμβολο λίρας και αρνητικές τιμές με κόκκινο χρώμα με σύμβολο δολαρίου.
- Εφαρμόζουμε το στυλ στο κελί χρησιμοποιώντας `SetStyle()`.
## Βήμα 6: Αποθήκευση του βιβλίου εργασίας
Το τελευταίο βήμα είναι να αποθηκεύσετε το βιβλίο εργασίας ως αρχείο Excel. Θα χρησιμοποιήσουμε τη μορφή Excel 97-2003 για αυτό το σεμινάριο.
```csharp
// Αποθήκευση του αρχείου Excel
workbook.Save(dataDir + "book1.out.xls", SaveFormat.Excel97To2003);
```
- Ο `Save()` Η μέθοδος αποθηκεύει το βιβλίο εργασίας στον καθορισμένο κατάλογο.
- Επιλέγουμε `SaveFormat.Excel97To2003` για να διασφαλιστεί η συμβατότητα με παλαιότερες εκδόσεις του Excel.
## Σύναψη
Ορίστε! Μόλις δημιουργήσαμε ένα αρχείο Excel, προσθέσαμε προσαρμοσμένες μορφές ημερομηνίας, ποσοστού και νομίσματος σε συγκεκριμένα κελιά χρησιμοποιώντας το Aspose.Cells για .NET και αποθηκεύσαμε το αρχείο. Η προσαρμοσμένη μορφοποίηση κάνει τα αρχεία Excel σας πολύ πιο ευανάγνωστα και επαγγελματικά. Μην ξεχάσετε να εξερευνήσετε άλλες επιλογές μορφοποίησης στο Aspose.Cells, όπως η μορφοποίηση υπό όρους, για ακόμη μεγαλύτερο έλεγχο της εμφάνισης των δεδομένων σας.
## Συχνές ερωτήσεις
### Πώς μπορώ να εφαρμόσω πιο σύνθετες επιλογές μορφοποίησης στο Aspose.Cells;
Μπορείτε να συνδυάσετε διαφορετικά στυλ μορφοποίησης, όπως χρώμα γραμματοσειράς, περιγράμματα και χρώματα φόντου, με προσαρμοσμένες μορφές αριθμών.
### Μπορώ να εφαρμόσω μια προσαρμοσμένη μορφή αριθμού σε μια περιοχή κελιών;
Ναι, το Aspose.Cells σάς επιτρέπει να εφαρμόσετε ένα στυλ σε μια περιοχή κελιών χρησιμοποιώντας το `Range.SetStyle()` μέθοδος.
### Σε ποιες άλλες μορφές αρχείων μπορώ να αποθηκεύσω το βιβλίο εργασίας;
Το Aspose.Cells υποστηρίζει πολλές μορφές, όπως XLSX, CSV και PDF. Απλώς αλλάξτε το `SaveFormat` στο `Save()` μέθοδος.
### Μπορώ να μορφοποιήσω τους αρνητικούς αριθμούς με διαφορετικό τρόπο;
Απολύτως! Μπορείτε να χρησιμοποιήσετε προσαρμοσμένες μορφές αριθμών για να εμφανίσετε αρνητικούς αριθμούς με διαφορετικά χρώματα ή σύμβολα.
### Είναι το Aspose.Cells για .NET δωρεάν;
Το Aspose.Cells προσφέρει μια δωρεάν δοκιμαστική περίοδο, αλλά για πλήρη λειτουργικότητα, θα χρειαστείτε μια έγκυρη άδεια χρήσης. Μπορείτε να αποκτήσετε μια [προσωρινή άδεια εδώ](https://purchase.aspose.com/temporary-license/).


{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}