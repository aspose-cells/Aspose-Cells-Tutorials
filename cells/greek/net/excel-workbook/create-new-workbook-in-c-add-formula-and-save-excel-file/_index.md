---
category: general
date: 2026-02-23
description: Δημιουργήστε νέο βιβλίο εργασίας προγραμματιστικά σε C# και προσθέστε
  τύπο σε ένα κελί. Μάθετε πώς να χρησιμοποιείτε το EXPAND, στη συνέχεια αποθηκεύστε
  το βιβλίο εργασίας Excel χωρίς κόπο.
draft: false
keywords:
- create new workbook
- add formula to cell
- save excel workbook
- how to use expand
- create excel file programmatically
language: el
og_description: Δημιουργήστε νέο βιβλίο εργασίας προγραμματιστικά σε C#. Προσθέστε
  έναν τύπο σε ένα κελί, μάθετε πώς να χρησιμοποιείτε το EXPAND και αποθηκεύστε το
  βιβλίο εργασίας Excel σε δευτερόλεπτα.
og_title: Δημιουργία νέου βιβλίου εργασίας σε C# – Προσθήκη τύπου και αποθήκευση αρχείου
  Excel
tags:
- C#
- Excel Automation
- Aspose.Cells
title: Δημιουργία νέου βιβλίου εργασίας σε C# – Προσθήκη τύπου και αποθήκευση αρχείου
  Excel
url: /el/net/excel-workbook/create-new-workbook-in-c-add-formula-and-save-excel-file/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Δημιουργία Νέου Φύλλου Εργασίας σε C# – Προσθήκη Τύπου και Αποθήκευση Αρχείου Excel

Έχετε αναρωτηθεί ποτέ πώς να **δημιουργήσετε νέα αντικείμενα workbook** από κώδικα χωρίς ποτέ να ανοίξετε το Excel; Δεν είστε οι μόνοι. Πολλοί προγραμματιστές συναντούν εμπόδιο όταν πρέπει να δημιουργήσουν ένα υπολογιστικό φύλλο επί τόπου — ίσως για μια αναφορά, μια εξαγωγή ή μια γρήγορη αποθήκευση δεδομένων.

Τα καλά νέα; Σε αυτόν τον οδηγό θα δείτε ακριβώς πώς να **δημιουργήσετε νέο workbook**, να προσθέσετε μια **προσθήκη τύπου σε κελί**, και στη συνέχεια να **αποθηκεύσετε το excel workbook** με λίγες μόνο γραμμές C#. Θα εμβαθύνουμε επίσης στο **πώς να χρησιμοποιήσετε το expand** ώστε να δημιουργείτε δυναμικούς πίνακες χωρίς χειροκίνητη αντιγραφή. Στο τέλος, θα μπορείτε να **δημιουργήσετε αρχείο excel προγραμματιστικά** και να το στείλετε σε χρήστες ή downstream υπηρεσίες.

## Προαπαιτούμενα

- .NET 6.0 ή νεότερο (οποιοδήποτε πρόσφατο .NET runtime λειτουργεί)
- Aspose.Cells for .NET (δωρεάν δοκιμή ή έκδοση με άδεια) – αυτή η βιβλιοθήκη μας παρέχει τις κλάσεις `Workbook` και `Worksheet` που χρησιμοποιούνται παρακάτω.
- Βασική κατανόηση της σύνταξης C# — δεν απαιτείται βαθιά γνώση του Excel.

Αν τα έχετε ήδη, τέλεια! Αν όχι, κατεβάστε το Aspose.Cells από το NuGet (`Install-Package Aspose.Cells`) και θα είστε έτοιμοι.

---

## Βήμα 1: Δημιουργία Νέου Workbook – Η Βάση

Για να ξεκινήσουμε, πρέπει να δημιουργήσουμε ένα φρέσκο αντικείμενο workbook. Σκεφτείτε το ως το άνοιγμα ενός ολοκαίνουργιου αρχείου Excel που είναι εντελώς κενό.

```csharp
using Aspose.Cells;

public class ExcelGenerator
{
    public void Generate()
    {
        // Step 1: Create a new workbook (this is the core of create new workbook)
        Workbook workbook = new Workbook();
```

> **Γιατί είναι σημαντικό:** Η κλάση `Workbook` είναι το σημείο εισόδου για οποιαδήποτε επεξεργασία Excel. Δημιουργώντας μια νέα παρουσία, δεσμεύουμε μνήμη για φύλλα, στυλ και τύπους — όλα χωρίς να αγγίξουμε το σύστημα αρχείων.

---

## Βήμα 2: Πρόσβαση στο Πρώτο Worksheet

Κάθε νέο workbook περιλαμβάνει ένα προεπιλεγμένο worksheet (με όνομα *Sheet1*). Θα το πιάσουμε ώστε να τοποθετήσουμε δεδομένα και τύπους.

```csharp
        // Step 2: Access the first worksheet
        Worksheet worksheet = workbook.Worksheets[0];
```

> **Pro tip:** Αν χρειάζεστε πολλαπλά φύλλα, απλώς καλέστε `workbook.Worksheets.Add("MySheet")` και δουλέψτε με το αντικείμενο `Worksheet` που επιστρέφεται.

---

## Βήμα 3: Προσθήκη Τύπου σε Κελί – Χρήση του EXPAND

Τώρα το διασκεδαστικό μέρος: η εισαγωγή ενός τύπου. Η συνάρτηση `EXPAND` είναι ιδανική όταν θέλετε να μετατρέψετε έναν στατικό πίνακα σε μεγαλύτερη, αυτόματα γεμάτη περιοχή.

```csharp
        // Step 3: Add formula to cell A1 using EXPAND
        // This creates a 5‑row array from the constant {1,2,3}
        worksheet.Cells["A1"].Formula = "EXPAND({1,2,3},5,1)";
```

### Πώς Λειτουργεί ο Τύπος EXPAND

| Όρισμα | Σημασία |
|----------|---------|
| `{1,2,3}` | Ο πηγαίος πίνακας (μια οριζόντια λίστα τριών αριθμών) |
| `5`       | Επιθυμητός αριθμός γραμμών στο αποτέλεσμα |
| `1`       | Επιθυμητός αριθμός στηλών (κρατήστε το 1 για κατακόρυφο αποτέλεσμα) |

Όταν το Excel αξιολογήσει αυτό, παράγει μια **κατακόρυφη** λίστα:

```
A1: 1
A2: 2
A3: 3
A4: 0   (filled with zeros)
A5: 0
```

> **Γιατί να χρησιμοποιήσετε το EXPAND;** Αφαιρεί την ανάγκη για χειροκίνητη αντιγραφή ή βρόχους VBA. Η συνάρτηση διαμορφώνει δυναμικά τα δεδομένα, κάνοντας τα υπολογιστικά σας φύλλα πιο ανθεκτικά και εύκολα στη συντήρηση.

---

## Βήμα 4: Αποθήκευση Excel Workbook – Εξαγωγή του Αποτελέσματος

Με τον τύπο στη θέση του, το τελευταίο βήμα είναι η εγγραφή του workbook στο δίσκο. Μπορείτε να επιλέξετε οποιονδήποτε φάκελο έχετε δικαίωμα εγγραφής.

```csharp
        // Step 4: Save the workbook to view the result
        string outputPath = @"C:\Temp\ExpandFormula.xlsx";
        workbook.Save(outputPath);
    }
}
```

> **Τι θα δείτε:** Ανοίξτε το `ExpandFormula.xlsx` στο Excel και το κελί `A1` θα εμφανίσει τον επεκταμένο πίνακα. Ο τύπος παραμένει στο κελί, έτσι αν επεξεργαστείτε τον πηγαίο πίνακα, η έξοδος ενημερώνεται αυτόματα.

---

## Προαιρετικό: Επαλήθευση του Αποτελέσματος Προγραμματιστικά

Αν προτιμάτε να μην ανοίξετε το Excel χειροκίνητα, μπορείτε να διαβάσετε ξανά τις τιμές για να επιβεβαιώσετε ότι ταιριάζουν με τις προσδοκίες.

```csharp
        // Verify values without opening Excel
        for (int row = 0; row < 5; row++)
        {
            var value = worksheet.Cells[row, 0].Value; // column 0 = A
            Console.WriteLine($"Row {row + 1}: {value}");
        }
```

Η εκτέλεση του παραπάνω θα εκτυπώσει:

```
Row 1: 1
Row 2: 2
Row 3: 3
Row 4: 0
Row 5: 0
```

---

## Συχνές Ερωτήσεις & Ακραίες Περιπτώσεις

| Ερώτηση | Απάντηση |
|----------|--------|
| **Μπορώ να χρησιμοποιήσω το EXPAND με μεγαλύτερο πηγαίο πίνακα;** | Φυσικά. Απλώς αλλάξτε το `{1,2,3}` σε οποιονδήποτε σταθερό ή περιοχή κελιών, π.χ. `EXPAND(A1:C1,10,1)`. |
| **Τι γίνεται αν χρειάζομαι οριζόντιο αποτέλεσμα;** | Αντιστρέψτε τα ορίσματα γραμμής/στήλης: `EXPAND({1,2,3},1,5)` θα παράγει μια διάδοση 1‑γραμμής, 5‑στηλών. |
| **Θα λειτουργήσει αυτό σε παλαιότερες εκδόσεις του Excel;** | Το `EXPAND` είναι διαθέσιμο από το Excel 365/2021. Για παλαιότερες εκδόσεις, θα πρέπει να προσομοιώσετε τον πίνακα με `INDEX`/`SEQUENCE`. |
| **Πρέπει να καλέσω `workbook.CalculateFormula()`;** | Όχι. Το Aspose.Cells αξιολογεί αυτόματα τους τύπους κατά την αποθήκευση, έτσι οι τιμές εμφανίζονται αμέσως. |
| **Πώς να προσθέσω περισσότερα από ένα φύλλα πριν την αποθήκευση;** | Καλέστε `workbook.Worksheets.Add("SecondSheet")` και επαναλάβετε τα βήματα διαχείρισης κελιών στο νέο φύλλο. |

---

## Πλήρες Παράδειγμα Λειτουργίας

Ακολουθεί το ολοκληρωμένο, έτοιμο‑για‑εκτέλεση πρόγραμμα. Αντιγράψτε‑και‑επικολλήστε το σε μια εφαρμογή console, προσαρμόστε τη διαδρομή εξόδου, και πατήστε **F5**.

```csharp
using System;
using Aspose.Cells;

namespace ExcelAutomationDemo
{
    class Program
    {
        static void Main(string[] args)
        {
            // Create new workbook
            Workbook workbook = new Workbook();

            // Access first worksheet
            Worksheet worksheet = workbook.Worksheets[0];

            // Add EXPAND formula to A1
            worksheet.Cells["A1"].Formula = "EXPAND({1,2,3},5,1)";

            // Optional: verify values in console
            workbook.CalculateFormula(); // ensures formulas are evaluated now
            for (int i = 0; i < 5; i++)
            {
                Console.WriteLine($"A{i + 1} = {worksheet.Cells[i, 0].Value}");
            }

            // Save the workbook
            string filePath = @"C:\Temp\ExpandFormula.xlsx";
            workbook.Save(filePath);
            Console.WriteLine($"Workbook saved to {filePath}");
        }
    }
}
```

**Αναμενόμενη έξοδος στην κονσόλα:**

```
A1 = 1
A2 = 2
A3 = 3
A4 = 0
A5 = 0
Workbook saved to C:\Temp\ExpandFormula.xlsx
```

Ανοίξτε το παραγόμενο αρχείο και θα δείτε τους ίδιους αριθμούς να έχουν γεμίσει στη στήλη **A**.

---

## Οπτική Σύνοψη

![Create new workbook example](create-new-workbook.png "Στιγμιότυπο οθόνης που δείχνει ένα νέο workbook δημιουργημένο με create new workbook in C#")

*Η εικόνα απεικονίζει το φρέσκο δημιουργημένο workbook με το αποτέλεσμα του EXPAND.*

---

## Συμπέρασμα

Τώρα ξέρετε πώς να **δημιουργήσετε νέο workbook**, **προσθέσετε τύπο σε κελί**, και **αποθηκεύσετε excel workbook** χρησιμοποιώντας C#. Με την εξοικείωση στο **πώς να χρησιμοποιήσετε το expand**, μπορείτε να δημιουργείτε δυναμικούς πίνακες χωρίς χειροκίνητη προσπάθεια, και όλη η διαδικασία σας επιτρέπει να **δημιουργήσετε αρχείο excel προγραμματιστικά** για οποιοδήποτε σενάριο αυτοματοποίησης.

Τι θα κάνετε στη συνέχεια; Δοκιμάστε να αντικαταστήσετε τον σταθερό πίνακα με μια αναφορά περιοχής, πειραματιστείτε με διαφορετικές διαστάσεις του `EXPAND`, ή συνδέστε πολλαπλούς τύπους σε διαφορετικά φύλλα. Το ίδιο μοτίβο λειτουργεί για γραφήματα, στυλ και ακόμη και πίνακες Pivot — οπότε συνεχίστε την εξερεύνηση.

Αν αντιμετωπίσατε κάποιο πρόβλημα, αφήστε ένα σχόλιο παρακάτω. Καλό coding, και απολαύστε τη δύναμη του προγραμματιστικού Excel!

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}