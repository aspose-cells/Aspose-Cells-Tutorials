---
category: general
date: 2026-02-15
description: Δημιουργήστε νέο βιβλίο εργασίας Excel και μάθετε πώς να χρησιμοποιείτε
  το EXPAND, να επεκτείνετε μια ακολουθία και να υπολογίζετε την συνεφαπτομένη. Δείτε
  επίσης πώς να αποθηκεύσετε το βιβλίο εργασίας σε αρχείο.
draft: false
keywords:
- create new excel workbook
- save workbook to file
- how to use expand
- how to expand sequence
- how to calculate cotangent
language: el
og_description: Δημιουργήστε νέο βιβλίο εργασίας Excel με C#. Μάθετε πώς να χρησιμοποιείτε
  το EXPAND, να επεκτείνετε μια ακολουθία, να υπολογίζετε τη συνεφαπτομένη και να
  αποθηκεύετε το βιβλίο εργασίας σε αρχείο.
og_title: Δημιουργία νέου βιβλίου εργασίας Excel σε C# – Πλήρης οδηγός προγραμματισμού
tags:
- C#
- Aspose.Cells
- Excel automation
title: Δημιουργία νέου βιβλίου εργασίας Excel σε C# – Οδηγός βήμα‑βήμα
url: /el/net/excel-workbook/create-new-excel-workbook-in-c-step-by-step-guide/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Δημιουργία νέου βιβλίου εργασίας Excel σε C# – Πλήρης Οδηγός Προγραμματισμού

Έχετε χρειαστεί ποτέ να **create new Excel workbook** από κώδικα και δεν ήξερες από πού να ξεκινήσεις; Δεν είστε μόνοι· πολλοί προγραμματιστές συναντούν αυτό το εμπόδιο όταν αυτοματοποιούν αναφορές ή δημιουργούν pipelines δεδομένων. Σε αυτό το tutorial θα σας δείξουμε ακριβώς πώς να δημιουργήσετε νέο βιβλίο εργασίας Excel, να γράψετε μερικούς ενδιαφέροντες τύπους και στη συνέχεια **save workbook to file** για μετέπειτα επιθεώρηση.  

Θα εμβαθύνουμε επίσης στις λεπτομέρειες της συνάρτησης `EXPAND`, θα δείξουμε **how to use expand** για να μετατρέψουμε μια μικρή ακολουθία σε μεγάλο μπλοκ, θα εξηγήσουμε **how to expand sequence** στην πράξη, και τελικά θα αποκαλύψουμε **how to calculate cotangent** απευθείας μέσα στο Excel. Στο τέλος θα έχετε ένα εκτελέσιμο πρόγραμμα C# που μπορείτε να ενσωματώσετε σε οποιοδήποτε έργο .NET.

## Τι Θα Χρειαστεί

- **Aspose.Cells for .NET** (δωρεάν δοκιμή ή έκδοση με άδεια) – η βιβλιοθήκη που μας επιτρέπει να χειριζόμαστε το Excel χωρίς εγκατεστημένο Office.  
- **.NET 6+** (ή .NET Framework 4.6+).  
- Ένα μέτριο IDE όπως το Visual Studio 2022, VS Code ή Rider.  

Δεν απαιτούνται πρόσθετα πακέτα NuGet πέρα από το `Aspose.Cells`. Αν δεν το έχετε ακόμη, εκτελέστε:

```bash
dotnet add package Aspose.Cells
```

Αυτό είναι όλο—τίποτα άλλο δεν χρειάζεται να ρυθμίσετε.

## Βήμα 1: Δημιουργία νέου βιβλίου εργασίας Excel

Το πρώτο πράγμα που κάνουμε είναι να δημιουργήσουμε ένα αντικείμενο `Workbook`. Σκεφτείτε το ως το κενό καμβά όπου θα ζήσουν όλα τα φύλλα, τα κελιά και οι τύποι.

```csharp
using Aspose.Cells;

class Program
{
    static void Main()
    {
        // Step 1: Create a new workbook and get the first worksheet
        Workbook workbook = new Workbook();               // creates an empty .xlsx in memory
        Worksheet worksheet = workbook.Worksheets[0];    // default sheet is named "Sheet1"
```

> **Γιατί είναι σημαντικό:** Η δημιουργία του βιβλίου εργασίας στη μνήμη σημαίνει ότι δεν αγγίζουμε ποτέ το δίσκο μέχρι να αποφασίσουμε ρητά να **save workbook to file**. Αυτό διατηρεί τη λειτουργία γρήγορη και σας επιτρέπει να αλυσίδωσετε περαιτέρω τροποποιήσεις χωρίς κόστος I/O.

## Βήμα 2: Πώς να χρησιμοποιήσετε το EXPAND για να επεκτείνετε μια ακολουθία

`EXPAND` είναι μια νεότερη συνάρτηση του Excel που παίρνει έναν μικρότερο πίνακα και τον τεντώνει σε καθορισμένο μέγεθος. Στο παράδειγμά μας ξεκινάμε με μια κάθετη ακολουθία τριών γραμμών και τη μετατρέπουμε σε μπλοκ 5 × 5.

```csharp
        // Step 2: Write a formula that expands a 3‑row sequence into a 5×5 block
        // The formula lives in A1 and will spill over to E5
        worksheet.Cells["A1"].Formula = "=EXPAND(SEQUENCE(3),5,5)";
```

> **Εξήγηση:** `SEQUENCE(3)` παράγει `{1;2;3}` (ένας κάθετος πίνακας). `EXPAND(...,5,5)` λέει στο Excel να επαναλάβει αυτόν τον πίνακα μέχρι να γεμίσει ένα ορθογώνιο 5 γραμμών επί 5 στηλών, ξεκινώντας από το A1. Το αποτέλεσμα είναι ένας πίνακας όπου κάθε στήλη επαναλαμβάνει τους αρχικούς τρεις αριθμούς, και οι τελευταίες δύο γραμμές είναι κενές επειδή η πηγή έχει μόνο τρεις γραμμές.

### Αναμενόμενο αποτέλεσμα

| A | B | C | D | E |
|---|---|---|---|---|
| 1 | 1 | 1 | 1 | 1 |
| 2 | 2 | 2 | 2 | 2 |
| 3 | 3 | 3 | 3 | 3 |
|   |   |   |   |   |
|   |   |   |   |   |

Θα δείτε το ίδιο μοτίβο να εξαπλώνεται σε όλο το εύρος μόλις ανοίξετε το βιβλίο εργασίας στο Excel.

## Βήμα 3: Πώς να υπολογίσετε το συνημίτονο (cotangent) στο Excel

Οι περισσότεροι είναι εξοικειωμένοι με τις `SIN`, `COS` και `TAN`, αλλά το `COT` είναι μια χρήσιμη συντόμευση για το αντίστροφο της εφαπτομένης. Εδώ είναι πώς να υπολογίσετε το συνημίτονο των 45° (που ισούται με 1) χρησιμοποιώντας ακτίνια.

```csharp
        // Step 3: Write a formula that returns the cotangent of 45° (π/4 radians)
        worksheet.Cells["B1"].Formula = "=COT(PI()/4)";
```

> **Γιατί να χρησιμοποιήσετε το COT;** Η άμεση κλήση του `COT` αποφεύγει την επιπλέον διαίρεση που θα χρειάζονταν με `1/TAN(...)`, καθιστώντας τον τύπο πιο σαφή και ελαφρώς ταχύτερο για μεγάλα φύλλα.

## Βήμα 4: Αξιολόγηση όλων των τύπων

Το Aspose.Cells δεν υπολογίζει αυτόματα τους τύπους εκτός αν το υποδείξετε. Η μέθοδος `CalculateFormula` επιβάλλει μια πλήρη αξιολόγηση ώστε οι προκύπτοντες τιμές να αποθηκευτούν στα κελιά.

```csharp
        // Step 4: Evaluate all formulas so the results are stored in the cells
        workbook.CalculateFormula();
```

> **Συμβουλή:** Αν έχετε πολλούς δαπανηρούς τύπους, μπορείτε να περάσετε ένα αντικείμενο `CalculationOptions` για να ρυθμίσετε την απόδοση (π.χ., ενεργοποίηση πολυνηματικότητας).

## Βήμα 5: Αποθήκευση βιβλίου εργασίας σε αρχείο

Τώρα που όλα είναι έτοιμα, τελικά **save workbook to file**. Επιλέξτε έναν φάκελο στον οποίο έχετε δικαίωμα εγγραφής και δώστε στο αρχείο ένα περιγραφικό όνομα.

```csharp
        // Step 5: Save the workbook to a file for inspection
        string outputPath = @"C:\Temp\output.xlsx";
        workbook.Save(outputPath);
        System.Console.WriteLine($"Workbook saved to {outputPath}");
    }
}
```

> **Τι συμβαίνει στο δίσκο;** Η κλήση `Save` γράφει ένα πλήρως σχηματισμένο πακέτο `.xlsx`, συμπεριλαμβανομένου του διασκορπισμένου πίνακα από το `EXPAND` και της υπολογισμένης τιμής του συνημιτόνου. Ανοίξτε το αρχείο στο Excel και θα δείτε το μπλοκ 5 × 5 που ξεκινά από το A1 και τον αριθμό `1` στο B1.

![Έξοδος Excel που εμφανίζει την επεκταμένη ακολουθία και την τιμή του συνημιτόνου](excel-output.png "δημιουργία νέου βιβλίου εργασίας excel παράδειγμα εξόδου")

*Κείμενο alt εικόνας: δημιουργία νέου βιβλίου εργασίας excel παράδειγμα εξόδου*

### Γρήγορη επαλήθευση

1. Ανοίξτε το `output.xlsx`.  
2. Ελέγξτε ότι τα κελιά **A1:E5** περιέχουν το επαναλαμβανόμενο μοτίβο 1‑2‑3.  
3. Κοιτάξτε το **B1** – θα πρέπει να εμφανίζει `1`.  

Αν όλα ταιριάζουν, συγχαρητήρια—έχετε αυτοματοποιήσει επιτυχώς το Excel!

## Πώς να επεκτείνετε την ακολουθία σε άλλα σενάρια

Αν και το παραπάνω παράδειγμα χρησιμοποιεί ένα στατικό `SEQUENCE(3)`, μπορείτε εύκολα να το αντικαταστήσετε με μια δυναμική περιοχή ή έναν άλλο τύπο:

```csharp
// Expand a dynamic range from D1:D10 to a 4×4 block
worksheet.Cells["F1"].Formula = "=EXPAND(D1:D10,4,4)";
```

**Πότε να το χρησιμοποιήσετε;**  
- Δημιουργία πινάκων placeholder για πρότυπα.  
- Γρήγορη αντιγραφή μιας γραμμής κεφαλίδας σε πολλές στήλες.  
- Κατασκευή πλέγματος heat‑map χωρίς χειροκίνητη αντιγραφή‑επικόλληση.

## Συνηθισμένα προβλήματα και πώς να τα αποφύγετε

| Πρόβλημα | Γιατί συμβαίνει | Διόρθωση |
|----------|----------------|----------|
| `#VALUE!` μετά από `EXPAND` | Ο πίνακας προέλευσης δεν είναι σωστή περιοχή (π.χ., περιέχει σφάλματα) | Καθαρίστε τα δεδομένα προέλευσης ή τυλίξτε τα σε `IFERROR`. |
| Το συνημίτονο επιστρέφει `#DIV/0!` για 0° | `COT(0)` είναι μαθηματικά άπειρο | Προστατέψτε με `IF(PI()/4=0,0,COT(...))`. |
| Το βιβλίο εργασίας δεν αποθηκεύεται | Η διαδρομή είναι άκυρη ή λείπουν δικαιώματα εγγραφής | Χρησιμοποιήστε `Path.GetFullPath` και επαληθεύστε ότι ο φάκελος υπάρχει. |
| Οι τύποι δεν υπολογίζονται | `CalculateFormula` παραλείπεται | Πάντα καλέστε το πριν το `Save`. |

## Μπόνους: Προσθήκη μορφοποίησης (προαιρετικό)

Αν θέλετε η έξοδος να φαίνεται πιο ωραία, μπορείτε να εφαρμόσετε ένα απλό στυλ μετά τους υπολογισμούς:

```csharp
        // Apply a light gray background to the expanded block
        Style style = workbook.CreateStyle();
        style.Pattern = BackgroundType.Solid;
        style.ForegroundColor = System.Drawing.Color.LightGray;
        StyleFlag flag = new StyleFlag { CellShading = true };
        worksheet.Cells.CreateRange("A1:E5").ApplyStyle(style, flag);
```

Αυτό το απόσπασμα είναι προαιρετικό, αλλά δείχνει πώς μπορείτε να συνδυάσετε τη λογική **create new Excel workbook** με μορφοποίηση σε ένα μόνο βήμα.

## Ανακεφαλαίωση

Διασχίσαμε όλη τη διαδικασία:

1. **Create new Excel workbook** με Aspose.Cells.  
2. Χρησιμοποιήστε **how to use expand** για να μετατρέψετε ένα μικρό `SEQUENCE` σε πίνακα 5 × 5.  
3. Δείξτε **how to calculate cotangent** απευθείας σε κελί.  
4. Εξαναγκάστε τον υπολογισμό με `CalculateFormula`.  
5. **Save workbook to file** και επαληθεύστε το αποτέλεσμα.

Όλα αυτά είναι αυτόνομα, τρέχουν σε οποιοδήποτε πρόσφατο runtime .NET και απαιτούν μόνο ένα πακέτο NuGet.

## Τι Ακολουθεί;

- **Dynamic data sources:** Ανάκτηση δεδομένων από βάση δεδομένων και τροφοδοσία τους στο `EXPAND`.  
- **Multiple worksheets:** Επανάληψη πάνω σε μια συλλογή φύλλων για δημιουργία πλήρους βιβλίου αναφοράς.  
- **Advanced formulas:** Εξερευνήστε τις `LET`, `LAMBDA`, ή λογική με βάση πίνακες για πιο έξυπνα φύλλα εργασίας.  

Νιώστε ελεύθεροι να πειραματιστείτε—αντικαταστήστε το όρισμα του `SEQUENCE`, δοκιμάστε διαφορετικές γωνίες για το `COT`, ή συνδυάστε τη δημιουργία γραφημάτων. Ο ουρανός είναι το όριο όταν μπορείτε να **create new Excel workbook** προγραμματιστικά.

---

*Καλό προγραμματισμό! Αν αντιμετωπίσατε κάποιο πρόβλημα, αφήστε ένα σχόλιο παρακάτω ή στείλτε μου μήνυμα στο Twitter @YourHandle. Θα χαρώ να βοηθήσω.*

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}