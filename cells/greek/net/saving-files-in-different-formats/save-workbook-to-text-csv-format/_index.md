---
"description": "Μάθετε πώς να μετατρέπετε εύκολα βιβλία εργασίας του Excel σε μορφή CSV με το Aspose.Cells σε αυτό το ολοκληρωμένο, βήμα προς βήμα σεμινάριο σχεδιασμένο για προγραμματιστές .NET."
"linktitle": "Αποθήκευση βιβλίου εργασίας σε μορφή κειμένου CSV"
"second_title": "API επεξεργασίας Excel Aspose.Cells .NET"
"title": "Αποθήκευση βιβλίου εργασίας σε μορφή κειμένου CSV"
"url": "/el/net/saving-files-in-different-formats/save-workbook-to-text-csv-format/"
"weight": 17
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Αποθήκευση βιβλίου εργασίας σε μορφή κειμένου CSV

## Εισαγωγή
Όταν χειρίζεστε δεδομένα, η μορφή που επιλέγετε μπορεί πραγματικά να καθορίσει πόσο εύκολα μπορείτε να εργαστείτε με αυτά. Μεταξύ των πιο συνηθισμένων μορφών για τη διαχείριση δεδομένων σε μορφή πίνακα είναι το CSV (Τιμές διαχωρισμένες με κόμμα). Εάν είστε προγραμματιστής που εργάζεται με αρχεία Excel και χρειάζεται να μετατρέψετε βιβλία εργασίας σε μορφή CSV, το Aspose.Cells για .NET είναι μια φανταστική βιβλιοθήκη που απλοποιεί αυτήν την εργασία. Σε αυτό το σεμινάριο, θα αναλύσουμε τα βήματα για την απρόσκοπτη μετατροπή ενός βιβλίου εργασίας Excel σε μορφή κειμένου CSV.
## Προαπαιτούμενα
Πριν ξεκινήσουμε, ας βεβαιωθούμε ότι έχετε όλα όσα χρειάζεστε για να ξεκινήσετε:
1. Βασικές γνώσεις C# και .NET: Δεδομένου ότι θα γράφουμε κώδικα σε C#, η εξοικείωση με τη γλώσσα και το .NET framework είναι απαραίτητη.
2. Βιβλιοθήκη Aspose.Cells: Βεβαιωθείτε ότι έχετε εγκαταστήσει τη βιβλιοθήκη Aspose.Cells for .NET στο περιβάλλον ανάπτυξής σας. Μπορείτε να την κατεβάσετε. [εδώ](https://releases.aspose.com/cells/net/).
3. Visual Studio ή οποιοδήποτε C# IDE: Θα χρειαστείτε ένα ολοκληρωμένο περιβάλλον ανάπτυξης (IDE) για να γράψετε και να εκτελέσετε τον κώδικά σας. Το Visual Studio είναι μια δημοφιλής επιλογή.
4. Βιβλίο εργασίας Excel: Προετοιμάστε ένα δείγμα βιβλίου εργασίας Excel (π.χ., "book1.xls") που περιέχει ορισμένα δεδομένα για να ελέγξετε τη μετατροπή.
## Εισαγωγή πακέτων
Τώρα που έχουμε καλύψει τις προϋποθέσεις μας, το πρώτο βήμα στη διαδικασία είναι η εισαγωγή των απαραίτητων πακέτων. Στο έργο C# σας, πρέπει να συμπεριλάβετε τον ακόλουθο χώρο ονομάτων στην κορυφή του αρχείου κώδικά σας:
```csharp
using System.IO;
using Aspose.Cells;
using System;
```
Αυτοί οι χώροι ονομάτων θα σας δώσουν πρόσβαση στις κλάσεις και τις μεθόδους που απαιτούνται για την εργασία με αρχεία Excel και τη διαχείριση ροών μνήμης.
## Βήμα 1: Ορίστε τη διαδρομή προς τον κατάλογο εγγράφων
Το πρώτο βήμα στη διαδικασία μας είναι να ορίσουμε πού αποθηκεύονται τα έγγραφά μας (βιβλία εργασίας Excel). Αυτό είναι απαραίτητο, καθώς επιτρέπει στο πρόγραμμά μας να γνωρίζει πού να βρει τα αρχεία που χρειάζεται να επεξεργαστεί. 
```csharp
// Η διαδρομή προς τον κατάλογο εγγράφων.
string dataDir = "Your Document Directory";
```
Φροντίστε να αντικαταστήσετε `"Your Document Directory"` με την πραγματική διαδρομή όπου βρίσκεται το αρχείο "book1.xls". Αυτή θα μπορούσε να είναι ένας κατάλογος στον υπολογιστή σας ή μια διαδρομή προς έναν διακομιστή.
## Βήμα 2: Φόρτωση του βιβλίου εργασίας πηγαίου κώδικα
Στη συνέχεια, πρέπει να φορτώσουμε το βιβλίο εργασίας του Excel που θα μετατραπεί σε μορφή CSV.
```csharp
// Φόρτωση του βιβλίου εργασίας πηγαίου κώδικα
Workbook workbook = new Workbook(dataDir + "book1.xls");
```
Ο `Workbook` Η κλάση από τη βιβλιοθήκη Aspose.Cells επιτρέπει τον χειρισμό και την πρόσβαση σε βιβλία εργασίας του Excel. Μεταβιβάζοντας τη διαδρομή αρχείου, φορτώνουμε το καθορισμένο βιβλίο εργασίας για επεξεργασία.
## Βήμα 3: Αρχικοποίηση ενός πίνακα byte για δεδομένα βιβλίου εργασίας
Πριν ξεκινήσουμε τη μετατροπή του βιβλίου εργασίας σε CSV, πρέπει να αρχικοποιήσουμε έναν κενό πίνακα byte που τελικά θα περιέχει όλα τα δεδομένα του φύλλου εργασίας.
```csharp
// πίνακας 0 byte
byte[] workbookData = new byte[0];
```
Αυτός ο πίνακας byte θα συνδυάσει τα δεδομένα από κάθε φύλλο εργασίας σε μια ενιαία δομή την οποία μπορούμε να γράψουμε σε ένα αρχείο αργότερα.
## Βήμα 4: Ρύθμιση επιλογών αποθήκευσης κειμένου
Τώρα, ας ορίσουμε τις επιλογές για τον τρόπο αποθήκευσης της μορφής κειμένου. Μπορείτε να επιλέξετε προσαρμοσμένους οριοθέτες ή να χρησιμοποιήσετε στηλοθέτες.
```csharp
// Επιλογές αποθήκευσης κειμένου. Μπορείτε να χρησιμοποιήσετε οποιονδήποτε τύπο διαχωριστικού
TxtSaveOptions opts = new TxtSaveOptions();
opts.Separator = '\t'; // Ορισμός καρτέλας ως διαχωριστή
```
Σε αυτό το παράδειγμα, χρησιμοποιούμε έναν χαρακτήρα tab ως διαχωριστικό. Μπορείτε να αντικαταστήσετε `'\t'` με οποιονδήποτε χαρακτήρα θέλετε, όπως κόμμα (`,`), ανάλογα με τη μορφή που θέλετε να έχετε στο αρχείο CSV.
## Βήμα 5: Επαναλάβετε κάθε φύλλο εργασίας
Στη συνέχεια, θα επανεξετάσουμε όλα τα φύλλα εργασίας μέσα στο βιβλίο εργασίας, αποθηκεύοντας το καθένα στη δική μας `workbookData` πίνακα, αλλά πρέπει πρώτα να επιλέξετε σε ποιο φύλλο εργασίας θα εργαστείτε.
```csharp
// Αντιγράψτε τα δεδομένα κάθε φύλλου εργασίας σε μορφή κειμένου μέσα στον πίνακα δεδομένων βιβλίου εργασίας
for (int idx = 0; idx < workbook.Worksheets.Count; idx++)
{
    // Αποθήκευση του ενεργού φύλλου εργασίας σε μορφή κειμένου
    MemoryStream ms = new MemoryStream();
    workbook.Worksheets.ActiveSheetIndex = idx;
    workbook.Save(ms, opts);
```
Ο βρόχος εκτελείται σε κάθε φύλλο εργασίας στο βιβλίο εργασίας. `ActiveSheetIndex` έχει οριστεί έτσι ώστε κάθε φορά που εκτελείται ο βρόχος, να αποθηκεύουμε το τρέχον φύλλο εργασίας. Τα αποτελέσματα θα αποθηκευτούν στη μνήμη χρησιμοποιώντας ένα `MemoryStream`.
## Βήμα 6: Ανάκτηση δεδομένων φύλλου εργασίας
Αφού αποθηκεύσουμε ένα φύλλο εργασίας στη ροή μνήμης, το επόμενο βήμα είναι να ανακτήσουμε αυτά τα δεδομένα και να τα προσθέσουμε στη ροή μνήμης μας. `workbookData` παράταξη.
```csharp
    // Αποθήκευση δεδομένων φύλλου εργασίας σε πίνακα δεδομένων φύλλου
    ms.Position = 0; // Επαναφορά θέσης ροής μνήμης
    byte[] sheetData = ms.ToArray(); // Λήψη του πίνακα byte
```
`ms.Position = 0;` επαναφέρει τη θέση για ανάγνωση μετά την εγγραφή. Στη συνέχεια, χρησιμοποιούμε `ToArray()` για να μετατρέψετε τη ροή μνήμης σε έναν πίνακα byte που περιέχει τα δεδομένα του φύλλου εργασίας.
## Βήμα 7: Συνδυασμός δεδομένων φύλλου εργασίας
Τώρα, θα συνδυάσουμε τα δεδομένα από κάθε φύλλο εργασίας σε ένα μόνο `workbookData` πίνακας που αρχικοποιήθηκε νωρίτερα.
```csharp
    // Συνδυάστε τα δεδομένα αυτού του φύλλου εργασίας σε έναν πίνακα δεδομένων βιβλίου εργασίας
    byte[] combinedArray = new byte[workbookData.Length + sheetData.Length];
    Array.Copy(workbookData, 0, combinedArray, 0, workbookData.Length);
    Array.Copy(sheetData, 0, combinedArray, workbookData.Length, sheetData.Length);
    workbookData = combinedArray;
}
```
Δημιουργούμε έναν νέο πίνακα που είναι αρκετά μεγάλος ώστε να περιέχει τόσο υπάρχοντα δεδομένα βιβλίου εργασίας όσο και νέα δεδομένα φύλλου εργασίας. Στη συνέχεια, αντιγράφουμε τα υπάρχοντα και τα νέα δεδομένα σε αυτόν τον συνδυασμένο πίνακα για μελλοντική χρήση.
## Βήμα 8: Αποθήκευση ολόκληρων δεδομένων βιβλίου εργασίας σε αρχείο
Τέλος, με όλα τα δεδομένα που έχουμε συνδυάσει `workbookData` πίνακα, μπορούμε να αποθηκεύσουμε αυτόν τον πίνακα σε μια καθορισμένη διαδρομή αρχείου.
```csharp
// Αποθήκευση ολόκληρων δεδομένων βιβλίου εργασίας σε αρχείο
File.WriteAllBytes(dataDir + "out.txt", workbookData);
```
`WriteAllBytes` παίρνει τον συνδυασμένο πίνακα byte και τον γράφει σε ένα αρχείο κειμένου με το όνομα "out.txt" στον καθορισμένο κατάλογο.
## Σύναψη
Και να το! Μετατρέψατε με επιτυχία ένα βιβλίο εργασίας Excel σε μορφή CSV χρησιμοποιώντας το Aspose.Cells για .NET. Αυτή η διαδικασία δεν είναι μόνο αποτελεσματική, αλλά επιτρέπει και τον εύκολο χειρισμό δεδομένων Excel για περαιτέρω ανάλυση ή αναφορά. Τώρα μπορείτε να αυτοματοποιήσετε τις εργασίες επεξεργασίας δεδομένων σας ή ακόμα και να ενσωματώσετε αυτήν τη λειτουργικότητα σε μεγαλύτερες εφαρμογές.
## Συχνές ερωτήσεις
### Μπορώ να χρησιμοποιήσω διαφορετικούς οριοθέτες για το αρχείο CSV;
Ναι, μπορείτε να αλλάξετε το `opts.Separator` σε οποιονδήποτε χαρακτήρα θέλετε, όπως κόμματα ή καθέτες.
### Είναι το Aspose.Cells δωρεάν στη χρήση;
Το Aspose.Cells δεν είναι δωρεάν, αλλά μπορείτε να λάβετε μια δωρεάν δοκιμή [εδώ](https://releases.aspose.com/).
### Σε τι είδους μορφές μπορώ να αποθηκεύσω εκτός από το CSV;
Το Aspose.Cells επιτρέπει την αποθήκευση σε πολλαπλές μορφές, όπως XLSX, PDF και άλλα.
### Μπορώ να επεξεργαστώ μεγάλα αρχεία Excel χρησιμοποιώντας το Aspose.Cells;
Ναι, το Aspose.Cells έχει σχεδιαστεί για να χειρίζεται μεγάλα αρχεία αποτελεσματικά, αλλά η απόδοση μπορεί να εξαρτάται από τους πόρους του συστήματος.
### Πού μπορώ να βρω πιο λεπτομερή τεκμηρίωση;
Μπορείτε να βρείτε πλήρη τεκμηρίωση και παραδείγματα στο [ιστότοπος αναφοράς](https://reference.aspose.com/cells/net/).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}