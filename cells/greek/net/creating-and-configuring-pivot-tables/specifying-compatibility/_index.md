---
"description": "Μάθετε να χειρίζεστε συγκεντρωτικούς πίνακες του Excel με το Aspose.Cells για .NET, συμπεριλαμβανομένων ενημερώσεων δεδομένων, ρυθμίσεων συμβατότητας και μορφοποίησης κελιών."
"linktitle": "Καθορίστε τη συμβατότητα του αρχείου Excel μέσω προγραμματισμού στο .NET"
"second_title": "API επεξεργασίας Excel Aspose.Cells .NET"
"title": "Καθορίστε τη συμβατότητα του αρχείου Excel μέσω προγραμματισμού στο .NET"
"url": "/el/net/creating-and-configuring-pivot-tables/specifying-compatibility/"
"weight": 23
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Καθορίστε τη συμβατότητα του αρχείου Excel μέσω προγραμματισμού στο .NET

## Εισαγωγή

Στον σημερινό κόσμο που βασίζεται στα δεδομένα, η διαχείριση και ο χειρισμός αρχείων Excel μέσω προγραμματισμού έχει γίνει απαραίτητος για πολλούς προγραμματιστές. Εάν εργάζεστε με το Excel σε .NET, το Aspose.Cells είναι μια ισχυρή βιβλιοθήκη που διευκολύνει τη δημιουργία, την ανάγνωση, την τροποποίηση και την αποθήκευση αρχείων Excel. Ένα σημαντικό χαρακτηριστικό αυτής της βιβλιοθήκης σάς επιτρέπει να καθορίσετε τη συμβατότητα των αρχείων Excel μέσω προγραμματισμού. Σε αυτό το σεμινάριο, θα εξερευνήσουμε τον τρόπο χειρισμού αρχείων Excel, εστιάζοντας ιδιαίτερα στη διαχείριση της συμβατότητας χρησιμοποιώντας το Aspose.Cells για .NET. Μέχρι το τέλος, θα κατανοήσετε πώς να ορίσετε τη συμβατότητα για αρχεία Excel, ειδικά για συγκεντρωτικούς πίνακες, ενώ παράλληλα ανανεώνετε και διαχειρίζεστε δεδομένα.

## Προαπαιτούμενα

Πριν ξεκινήσετε τη φάση του προγραμματισμού, βεβαιωθείτε ότι έχετε τα εξής:

1. Βασικές γνώσεις C#: Δεδομένου ότι θα γράφουμε κώδικα σε C#, η εξοικείωση με τη γλώσσα θα σας βοηθήσει να κατανοήσετε καλύτερα το σεμινάριο.
2. Aspose.Cells για βιβλιοθήκη .NET: Μπορείτε να το κατεβάσετε από το [Σελίδα κυκλοφορίας Aspose Cells](https://releases.aspose.com/cells/net/)Αν δεν το έχετε κάνει ήδη, σκεφτείτε να αποκτήσετε μια δωρεάν δοκιμή για να εξερευνήσετε πρώτα τις δυνατότητές του.
3. Visual Studio: Ένα IDE όπου μπορείτε να γράψετε και να δοκιμάσετε αποτελεσματικά τον κώδικα C#.
4. Δείγμα αρχείου Excel: Βεβαιωθείτε ότι έχετε ένα δείγμα αρχείου Excel, κατά προτίμηση ένα που περιέχει έναν συγκεντρωτικό πίνακα για την επίδειξη. Για το παράδειγμά μας, θα χρησιμοποιήσουμε `sample-pivot-table.xlsx`.

Έχοντας θέσει αυτές τις προϋποθέσεις, ας ξεκινήσουμε τη διαδικασία κωδικοποίησης.

## Εισαγωγή πακέτων

Πριν ξεκινήσετε να γράφετε την εφαρμογή σας, πρέπει να συμπεριλάβετε τους απαραίτητους χώρους ονομάτων στον κώδικά σας για να χρησιμοποιήσετε αποτελεσματικά τη βιβλιοθήκη Aspose.Cells. Δείτε πώς μπορείτε να το κάνετε.

### Εισαγωγή χώρου ονομάτων Aspose.Cells

```csharp
using System.IO;
using System;
using Aspose.Cells;
using Aspose.Cells.Pivot;
using System.Drawing;
```

Αυτή η γραμμή κώδικα διασφαλίζει ότι μπορείτε να έχετε πρόσβαση σε όλες τις κλάσεις και τις μεθόδους μέσα στη βιβλιοθήκη Aspose.Cells.

Τώρα, ας αναλύσουμε τη διαδικασία λεπτομερώς για να βεβαιωθούμε ότι όλα είναι σαφή και κατανοητά.

## Βήμα 1: Ρύθμιση του καταλόγου σας

Πρώτα απ 'όλα, ορίστε τον κατάλογο όπου βρίσκονται τα αρχεία Excel. Είναι σημαντικό να δώσετε τη σωστή διαδρομή αρχείου.

```csharp
// Η διαδρομή προς τον κατάλογο εγγράφων.
string dataDir = "Your Document Directory";
```

Εδώ, αντικαταστήστε `"Your Document Directory"` με την πραγματική διαδρομή προς τα αρχεία Excel. Εδώ θα πρέπει να βρίσκεται το δείγμα αρχείου συγκεντρωτικού πίνακα.

## Βήμα 2: Φόρτωση του αρχείου Excel προέλευσης

Στη συνέχεια, πρέπει να φορτώσουμε το αρχείο Excel που περιέχει το δείγμα συγκεντρωτικού πίνακα. 

```csharp
// Φόρτωση αρχείου excel πηγαίου κώδικα που περιέχει δείγμα συγκεντρωτικού πίνακα
Workbook wb = new Workbook(dataDir + "sample-pivot-table.xlsx");
```

Σε αυτό το βήμα, δημιουργούμε μια παρουσία του `Workbook` κλάση, η οποία φορτώνει το καθορισμένο αρχείο Excel. 

## Βήμα 3: Πρόσβαση στα Φύλλα Εργασίας

Τώρα που το βιβλίο εργασίας έχει φορτωθεί, πρέπει να αποκτήσετε πρόσβαση στο φύλλο εργασίας που περιέχει τα δεδομένα του συγκεντρωτικού πίνακα.

```csharp
// Πρώτο φύλλο εργασίας Access που περιέχει δεδομένα Συγκεντρωτικού Πίνακα
Worksheet dataSheet = wb.Worksheets[0];
```

Εδώ, έχουμε πρόσβαση στο πρώτο φύλλο εργασίας όπου βρίσκεται ο συγκεντρωτικός πίνακας. Μπορείτε επίσης να κάνετε επανάληψη ή να καθορίσετε άλλα φύλλα εργασίας με βάση τη δομή του Excel σας.

## Βήμα 4: Χειρισμός δεδομένων κελιού

Στη συνέχεια, θα τροποποιήσετε ορισμένες τιμές κελιών στο φύλλο εργασίας. 

### Βήμα 4.1: Τροποποίηση κελιού A3

Ας ξεκινήσουμε αποκτώντας πρόσβαση στο κελί A3 και ορίζοντας την τιμή του.

```csharp
// Αποκτήστε πρόσβαση στο κελί A3 και ορίστε τα δεδομένα του
Cells cells = dataSheet.Cells;
Cell cell = cells["A3"];
cell.PutValue("FooBar");
```

Αυτό το απόσπασμα κώδικα ενημερώνει το κελί A3 με την τιμή "FooBar".

### Βήμα 4.2: Τροποποίηση κελιού B3 με μεγάλη συμβολοσειρά

Τώρα, ας ορίσουμε μια μεγάλη συμβολοσειρά στο κελί B3, η οποία υπερβαίνει τα τυπικά όρια χαρακτήρων του Excel.

```csharp
// Αποκτήστε πρόσβαση στο κελί B3, ορίστε τα δεδομένα του
string longStr = "Very long text 1. very long text 2.... [continue your long string]";
cell = cells["B3"];
cell.PutValue(longStr);
```

Αυτός ο κώδικας είναι σημαντικός επειδή ορίζει τις προσδοκίες σας σχετικά με τα όρια δεδομένων, ειδικά όταν εργάζεστε με ρυθμίσεις συμβατότητας στο Excel.

## Βήμα 5: Ελέγξτε το μήκος του κελιού B3

Είναι επίσης απαραίτητο να επιβεβαιώσουμε το μήκος της συμβολοσειράς που εισαγάγαμε.

```csharp
// Εκτυπώστε το μήκος της συμβολοσειράς του κελιού B3
Console.WriteLine("Length of original data string: " + cell.StringValue.Length);
```

Αυτό γίνεται απλώς για επαλήθευση, ώστε να φαίνεται πόσους χαρακτήρες περιέχει το κελί σας.

## Βήμα 6: Ορισμός άλλων τιμών κελιών

Τώρα θα έχουμε πρόσβαση σε περισσότερα κελιά και θα ορίσουμε ορισμένες τιμές.

```csharp
// Αποκτήστε πρόσβαση στο κελί C3 και ορίστε τα δεδομένα του
cell = cells["C3"];
cell.PutValue("closed");

// Αποκτήστε πρόσβαση στο κελί D3 και ορίστε τα δεδομένα του
cell = cells["D3"];
cell.PutValue("2016/07/21");
```

Κάθε ένα από αυτά τα τμήματα κώδικα ενημερώνει πολλά επιπλέον κελιά μέσα στο φύλλο εργασίας.

## Βήμα 7: Πρόσβαση στον Συγκεντρωτικό Πίνακα

Στη συνέχεια, θα έχετε πρόσβαση στο δεύτερο φύλλο εργασίας, το οποίο αποτελείται από τα δεδομένα του συγκεντρωτικού πίνακα.

```csharp
// Πρόσβαση στο δεύτερο φύλλο εργασίας που περιέχει τον συγκεντρωτικό πίνακα
Worksheet pivotSheet = wb.Worksheets[1];

// Πρόσβαση στον συγκεντρωτικό πίνακα
PivotTable pivotTable = pivotSheet.PivotTables[0];
```

Αυτό το απόσπασμα σάς επιτρέπει να χειρίζεστε τον συγκεντρωτικό πίνακα για ρυθμίσεις συμβατότητας.

## Βήμα 8: Ορισμός συμβατότητας για το Excel 2003

Είναι σημαντικό να ορίσετε εάν ο συγκεντρωτικός πίνακας σας είναι συμβατός με το Excel 2003 ή όχι. 

```csharp
// Η ιδιότητα IsExcel2003Compatible υποδεικνύει εάν ο Συγκεντρωτικός Πίνακας είναι συμβατός με το Excel2003 κατά την ανανέωση του Συγκεντρωτικού Πίνακα
pivotTable.IsExcel2003Compatible = true;
pivotTable.RefreshData();
pivotTable.CalculateData();
```

Εδώ ξεκινά η πραγματική μεταμόρφωση. Ορίζοντας `IsExcel2003Compatible` να `true`περιορίζετε το μήκος των χαρακτήρων σε 255 κατά την ανανέωση.

## Βήμα 9: Έλεγχος μήκους μετά τη ρύθμιση συμβατότητας

Αφού ορίσουμε τη συμβατότητα, ας δούμε πώς επηρεάζει τα δεδομένα.

```csharp
// Ελέγξτε την τιμή του κελιού B5 του περιστρεφόμενου φύλλου.
Cell b5 = pivotSheet.Cells["B5"];
Console.WriteLine("Length of cell B5 after setting IsExcel2003Compatible property to True: " + b5.StringValue.Length);
```

Πιθανότατα θα δείτε ένα αποτέλεσμα που επιβεβαιώνει το φαινόμενο περικοπής εάν τα αρχικά δεδομένα υπερβαίνουν τους 255 χαρακτήρες.

## Βήμα 10: Αλλαγή ρύθμισης συμβατότητας

Τώρα, ας αλλάξουμε τη ρύθμιση συμβατότητας και ας ελέγξουμε ξανά.

```csharp
// Τώρα ορίστε την ιδιότητα IsExcel2003Compatible σε false και ανανεώστε ξανά.
pivotTable.IsExcel2003Compatible = false;
pivotTable.RefreshData();
pivotTable.CalculateData();
```

Αυτό επιτρέπει στα δεδομένα σας να αντικατοπτρίζουν το αρχικό τους μήκος χωρίς τους προηγούμενους περιορισμούς.

## Βήμα 11: Επαναλάβετε την επαλήθευση μήκους 

Ας επαληθεύσουμε ότι τα δεδομένα αντικατοπτρίζουν πλέον με ακρίβεια το πραγματικό τους μήκος.

```csharp
// Τώρα θα εκτυπώσει το αρχικό μήκος των δεδομένων κελιού. Τα δεδομένα δεν έχουν περικοπεί τώρα.
b5 = pivotSheet.Cells["B5"];
Console.WriteLine("Length of cell B5 after setting IsExcel2003Compatible property to False: " + b5.StringValue.Length);
```

Θα πρέπει να δείτε ότι η έξοδος επιβεβαιώνει την αφαίρεση της περικοπής.

## Βήμα 12: Μορφοποίηση των κελιών

Για να βελτιώσετε την οπτική εμπειρία, ίσως θελήσετε να μορφοποιήσετε τα κελιά. 

```csharp
// Ορίστε το ύψος γραμμής και το πλάτος στήλης του κελιού B5 και επίσης τυλίξτε το κείμενό του
pivotSheet.Cells.SetRowHeight(b5.Row, 100);
pivotSheet.Cells.SetColumnWidth(b5.Column, 65);
Style st = b5.GetStyle();
st.IsTextWrapped = true;
b5.SetStyle(st);
```

Αυτές οι γραμμές κώδικα κάνουν τα δεδομένα πιο εύκολα στην ανάγνωση, προσαρμόζοντας τις διαστάσεις των κελιών και ενεργοποιώντας την αναδίπλωση κειμένου.

## Βήμα 13: Αποθήκευση του βιβλίου εργασίας

Τέλος, αποθηκεύστε το βιβλίο εργασίας σας με τις αλλαγές που έχετε κάνει.

```csharp
// Αποθήκευση βιβλίου εργασίας σε μορφή xlsx
wb.Save(dataDir + "SpecifyCompatibility_out.xlsx", SaveFormat.Xlsx);
```

Η επιλογή της κατάλληλης μορφής αρχείου είναι ζωτικής σημασίας κατά την αποθήκευση αρχείων Excel. `Xlsx` Η μορφή χρησιμοποιείται ευρέως και είναι συμβατή με πολλές εκδόσεις του Excel.

## Σύναψη

Συγχαρητήρια! Έχετε πλέον προγραμματίσει ρυθμίσεις συμβατότητας αρχείων Excel χρησιμοποιώντας το Aspose.Cells για .NET. Αυτό το σεμινάριο περιγράφει κάθε βήμα, από τη ρύθμιση του περιβάλλοντός σας έως την τροποποίηση των ρυθμίσεων συμβατότητας για τους συγκεντρωτικούς πίνακες. Εάν έχετε εργαστεί ποτέ με δεδομένα που απαιτούσαν συγκεκριμένους περιορισμούς ή συμβατότητα, αυτή είναι μια δεξιότητα που δεν θα θέλετε να παραβλέψετε.

## Συχνές ερωτήσεις

### Τι είναι το Aspose.Cells;  
Το Aspose.Cells είναι μια βιβλιοθήκη .NET που έχει σχεδιαστεί για να βοηθά τους προγραμματιστές να δημιουργούν, να χειρίζονται και να μετατρέπουν αρχεία Excel απρόσκοπτα.

### Γιατί είναι σημαντική η συμβατότητα με το Excel;  
Η συμβατότητα με το Excel είναι ζωτικής σημασίας για να διασφαλιστεί ότι τα αρχεία μπορούν να ανοιχτούν και να χρησιμοποιηθούν στις προβλεπόμενες εκδόσεις του Excel, ειδικά εάν περιέχουν λειτουργίες ή μορφές που δεν υποστηρίζονται σε παλαιότερες εκδόσεις.

### Μπορώ να δημιουργήσω Συγκεντρωτικούς Πίνακες μέσω προγραμματισμού με το Aspose.Cells;  
Ναι, μπορείτε να δημιουργήσετε και να χειριστείτε Συγκεντρωτικούς Πίνακες μέσω προγραμματισμού χρησιμοποιώντας το Aspose.Cells. Η βιβλιοθήκη παρέχει διάφορες μεθόδους για την προσθήκη πηγών δεδομένων, πεδίων και λειτουργιών που σχετίζονται με Συγκεντρωτικούς Πίνακες.

### Πώς μπορώ να ελέγξω το μήκος μιας συμβολοσειράς σε ένα κελί του Excel;  
Μπορείτε να χρησιμοποιήσετε το `StringValue` ιδιοκτησία ενός `Cell` αντικείμενο για να λάβετε το περιεχόμενο του κελιού και στη συνέχεια να καλέσετε το `.Length` ιδιότητα για να βρείτε το μήκος της συμβολοσειράς.

### Μπορώ να προσαρμόσω τη μορφοποίηση κελιών πέρα από το ύψος και το πλάτος της γραμμής;  
Απολύτως! Το Aspose.Cells επιτρέπει εκτεταμένη μορφοποίηση κελιών. Μπορείτε να αλλάξετε στυλ γραμματοσειράς, χρώματα, περιγράμματα, μορφές αριθμών και πολλά άλλα μέσω του `Style` τάξη.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}