---
title: Αντιγράψτε το VBAMacro User Form Designer Storage στο βιβλίο εργασίας χρησιμοποιώντας το Aspose.Cells
linktitle: Αντιγράψτε το VBAMacro User Form Designer Storage στο βιβλίο εργασίας χρησιμοποιώντας το Aspose.Cells
second_title: Aspose.Cells .NET Excel Processing API
description: Μάθετε πώς να αντιγράφετε αποτελεσματικά το VBA Macro User Form Designer στο Aspose.Cells για .NET με τον αναλυτικό μας οδηγό βήμα προς βήμα! Ξεκλειδώστε τις δυνατότητες του Excel.
weight: 11
url: /el/net/workbook-vba-project/copy-vbamacro-user-form-designer/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Αντιγράψτε το VBAMacro User Form Designer Storage στο βιβλίο εργασίας χρησιμοποιώντας το Aspose.Cells

## Εισαγωγή
Καλωσόρισμα! Αν θέλετε να βελτιώσετε την εμπειρία σας στο Excel με μακροεντολές VBA και φόρμες χρηστών, βρίσκεστε στο σωστό μέρος! Σε αυτόν τον οδηγό, εξετάζουμε πώς μπορείτε να αντιγράψετε απρόσκοπτα ένα VBA Macro UserForm Designer από το ένα βιβλίο εργασίας στο άλλο χρησιμοποιώντας το Aspose.Cells για .NET. Είτε είστε έμπειρος προγραμματιστής είτε μόλις ξεκινάτε, θα σας καθοδηγήσουμε σε κάθε κρίσιμο βήμα. Θεωρήστε αυτό το βιβλίο σας για να κατακτήσετε την τέχνη του χειρισμού αρχείων Excel μέσω προγραμματισμού. Είστε έτοιμοι να βουτήξετε; Πάμε!
## Προαπαιτούμενα
Προτού περάσουμε στη λεπτομέρεια της κωδικοποίησης, ας βεβαιωθούμε ότι έχετε όλα όσα χρειάζεστε:
1. Περιβάλλον ανάπτυξης C#: Θα πρέπει να έχετε ένα περιβάλλον εργασίας έτοιμο για ανάπτυξη C#. Το Visual Studio συνιστάται ιδιαίτερα.
2.  Aspose.Cells for .NET Library: Βεβαιωθείτε ότι έχετε ενσωματωμένη τη βιβλιοθήκη Aspose.Cells στο έργο σας. Μπορείτε εύκολα[κατεβάστε το εδώ](https://releases.aspose.com/cells/net/).
3. Βασικές γνώσεις μακροεντολών VBA και Excel: Η καλή κατανόηση της VBA και του τρόπου λειτουργίας των μακροεντολών του Excel θα σας βοηθήσει να πλοηγηθείτε σε αυτό το σεμινάριο με ευκολία.
4. Ένα αρχείο Excel με φόρμα χρήστη: Για να πειραματιστείτε, να δημιουργήσετε ή να αποκτήσετε ένα βιβλίο εργασίας του Excel που περιέχει μια φόρμα χρήστη, κατά προτίμηση με ενεργοποιημένες μακροεντολές (όπως`.xlsm` αρχεία).
## Εισαγωγή πακέτων
Στο έργο σας C#, θα χρειαστεί να εισαγάγετε ορισμένους χώρους ονομάτων στην κορυφή του αρχείου σας για να χρησιμοποιήσετε τις λειτουργίες Aspose.Cells. Δείτε πώς το κάνετε:
```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Aspose.Cells.Vba;
```
Η συμπερίληψη αυτών των χώρων ονομάτων σάς επιτρέπει να έχετε πρόσβαση σε όλα τα ισχυρά εργαλεία που είναι ενσωματωμένα στη βιβλιοθήκη Aspose.Cells. 
Τώρα που έχουμε καλύψει τις προϋποθέσεις και τα πακέτα μας, ήρθε η ώρα να προχωρήσουμε στο διασκεδαστικό κομμάτι: την κωδικοποίηση! Ας το αναλύσουμε βήμα-βήμα.
## Βήμα 1: Καθορίστε τους καταλόγους προέλευσης και εξόδου σας
Αρχικά, πρέπει να καθορίσετε πού βρίσκονται τα αρχεία σας:
```csharp
// Κατάλογος πηγής
string sourceDir = "Your Document Directory";
// Κατάλογος εξόδου
string outputDir = "Your Document Directory";
```
 Εδώ, αντικαταστήστε`"Your Document Directory"` με την πραγματική διαδρομή όπου είναι αποθηκευμένα τα αρχεία σας. Από εδώ θα συλληφθεί το βιβλίο εργασίας προέλευσης (με τη φόρμα χρήστη) και θα αποθηκευτεί το νέο βιβλίο εργασίας.
## Βήμα 2: Δημιουργήστε ένα κενό βιβλίο εργασίας στόχου
Στη συνέχεια, ας δημιουργήσουμε το βιβλίο εργασίας στόχου όπου θα αντιγράφουμε τη φόρμα χρήστη και τις μακροεντολές μας:
```csharp
// Δημιουργία κενού βιβλίου εργασίας στόχου
Workbook target = new Workbook();
```
Αυτή η γραμμή κώδικα προετοιμάζει ένα νέο, κενό βιβλίο εργασίας για να το γεμίσουμε με δεδομένα. Σκεφτείτε το σαν έναν κενό καμβά για το αριστούργημά σας!
## Βήμα 3: Φορτώστε το βιβλίο εργασίας του προτύπου σας
Πρέπει να φορτώσουμε το βιβλίο εργασίας που περιέχει τη φόρμα χρήστη και τις μακροεντολές σας:
```csharp
// Φορτώστε το αρχείο Excel που περιέχει τη φόρμα χρήστη VBA-Macro Designer
Workbook templateFile = new Workbook(sourceDir + "sampleDesignerForm.xlsm");
```
 Φροντίστε να αλλάξετε`"sampleDesignerForm.xlsm"` στο όνομα του πραγματικού σας αρχείου. Αυτό το βιβλίο εργασίας είναι σαν το βιβλίο συνταγών σας—από αυτό θα αντλήσουμε τα συστατικά μας!
## Βήμα 4: Αντιγράψτε τα φύλλα εργασίας στο Βιβλίο εργασίας στοχοθέτησης
Τώρα, ας ξεκινήσουμε την αντιγραφή φύλλων εργασίας από το πρότυπό μας στο βιβλίο εργασίας προορισμού:
```csharp
// Αντιγράψτε όλα τα φύλλα εργασίας προτύπων στο βιβλίο εργασίας στόχευσης
foreach (Worksheet ws in templateFile.Worksheets)
{
    if (ws.Type == SheetType.Worksheet)
    {
        Worksheet s = target.Worksheets.Add(ws.Name);
        s.Copy(ws);
        // Τοποθετήστε το μήνυμα στο κελί A2 του φύλλου εργασίας προορισμού
        s.Cells["A2"].PutValue("VBA Macro and User Form copied from template to target.");
    }
}
```
Σε αυτό το βήμα, πραγματοποιούμε κύκλους σε κάθε φύλλο εργασίας του προτύπου και τα αντιγράφουμε στο στοχευόμενο βιβλίο εργασίας μας. Αν το σκεφτείς, είναι σαν να μεταφέρεις τις καλύτερες συνταγές σου από το ένα βιβλίο μαγειρικής στο άλλο!
## Βήμα 5: Αντιγράψτε τις μακροεντολές VBA από το Πρότυπο
Στη συνέχεια, θα αντιγράψουμε τις μακροεντολές VBA, συμπεριλαμβανομένων των λειτουργικών μονάδων UserForm Designer, στο νέο μας βιβλίο εργασίας:
```csharp
// Αντιγράψτε τη φόρμα χρήστη VBA-Macro Designer από το Πρότυπο στον Στόχο
foreach (VbaModule vbaItem in templateFile.VbaProject.Modules)
{
    if (vbaItem.Name == "ThisWorkbook")
    {
        // Αντιγράψτε τον κωδικό ενότητας ThisWorkbook
        target.VbaProject.Modules["ThisWorkbook"].Codes = vbaItem.Codes;
    }
    else
    {
        // Αντιγράψτε τον κώδικα και τα δεδομένα άλλων μονάδων
        System.Diagnostics.Debug.Print(vbaItem.Name);
        int vbaMod = 0;
        Worksheet sheet = target.Worksheets.GetSheetByCodeName(vbaItem.Name);
        if (sheet == null)
        {
            vbaMod = target.VbaProject.Modules.Add(vbaItem.Type, vbaItem.Name);
        }
        else
        {
            vbaMod = target.VbaProject.Modules.Add(sheet);
        }
        target.VbaProject.Modules[vbaMod].Codes = vbaItem.Codes;
        if ((vbaItem.Type == VbaModuleType.Designer))
        {
            // Λάβετε τα δεδομένα της φόρμας χρήστη, π.χ. αποθήκευση σχεδιαστή
            byte[] designerStorage = templateFile.VbaProject.Modules.GetDesignerStorage(vbaItem.Name);
            // Προσθέστε τον αποθηκευτικό χώρο σχεδιαστή για να στοχεύσετε το Vba Project
            target.VbaProject.Modules.AddDesignerStorage(vbaItem.Name, designerStorage);
        }
    }
}
```
Αυτό το τεράστιο κομμάτι κώδικα χειρίζεται τον έλεγχο κάθε λειτουργικής μονάδας VBA στο αρχείο προτύπου. Αντιγράφουμε το σχέδιο UserForm και τους σχετικούς κωδικούς του. Είναι σαν να διασφαλίζεις ότι όχι μόνο θα πάρεις τη διάσημη συνταγή πίτας της γιαγιάς αλλά και τις ακριβείς τεχνικές ψησίματός της!
## Βήμα 6: Αποθηκεύστε το βιβλίο εργασίας στόχου
Αφού πετύχουμε όλα τα αντίγραφά μας, ήρθε η ώρα να σώσουμε τη σκληρή δουλειά μας:
```csharp
// Αποθηκεύστε το βιβλίο εργασίας προορισμού
target.Save(outputDir + "outputDesignerForm.xlsm", SaveFormat.Xlsm);
```
Φροντίστε να τροποποιήσετε το όνομα του αρχείου εξόδου όπως απαιτείται. Μόλις το αποθηκεύσετε, δημιουργείτε ουσιαστικά τη δική σας προσαρμοσμένη έκδοση του βιβλίου εργασίας γεμάτη μακροεντολές και φόρμες χρήστη. Πόσο συναρπαστικό είναι αυτό;
## Βήμα 7: Επιβεβαιώστε την επιτυχία
Τέλος, ας εκτυπώσουμε ένα μήνυμα επιτυχίας στην κονσόλα:
```csharp
Console.WriteLine("CopyVBAMacroUserFormDesignerStorageToWorkbook executed successfully.\r\n");
```
Αυτή η μικρή γραμμή σας καθησυχάζει ότι η διαδικασία σας πήγε ομαλά. Είναι το κεράσι πάνω από την κωδικοποίηση σου!
## Σύναψη
Συγχαρητήρια! Ολοκληρώσατε τον αναλυτικό οδηγό για την αντιγραφή ενός VBA Macro User Form Designer από το ένα βιβλίο εργασίας στο άλλο χρησιμοποιώντας το Aspose.Cells για .NET. Μπορεί στην αρχή να φαίνεται λίγο υπερβολικό, αλλά με εξάσκηση, θα χειριστείτε τους χειρισμούς του βιβλίου εργασίας σαν επαγγελματίας. Να θυμάστε ότι η κωδικοποίηση έχει να κάνει με την εξάσκηση, επομένως μην διστάζετε να δοκιμάσετε διαφορετικά πράγματα στα αρχεία σας Excel. Εάν έχετε οποιεσδήποτε ερωτήσεις ή αντιμετωπίζετε προβλήματα, μη διστάσετε να ελέγξετε τα φόρουμ του Aspose ή την τεκμηρίωση για υποστήριξη!
## Συχνές ερωτήσεις
### Ποιες εκδόσεις του Excel υποστηρίζει το Aspose.Cells;
Το Aspose.Cells υποστηρίζει ένα ευρύ φάσμα μορφών Excel, συμπεριλαμβανομένων των XLSX, XLSM, CSV και άλλων.
### Μπορώ να χρησιμοποιήσω το Aspose.Cells δωρεάν;
 Ναί! Μπορείτε να ξεκινήσετε με μια δωρεάν δοκιμή, η οποία σας επιτρέπει να αξιολογήσετε τη βιβλιοθήκη:[Δωρεάν δοκιμή](https://releases.aspose.com/).
### Χρειάζομαι το Visual Studio για να εκτελέσω αυτόν τον κώδικα;
Αν και συνιστάται ιδιαίτερα λόγω των φιλικών προς τον χρήστη χαρακτηριστικών του, κάθε C# IDE θα το κάνει αρκεί να υποστηρίζει την ανάπτυξη .NET.
### Πού μπορώ να βρω περισσότερα παραδείγματα και τεκμηρίωση;
 Μπορείτε να εξερευνήσετε το[Aspose.Cells Documentation](https://reference.aspose.com/cells/net/) για περισσότερα παραδείγματα και εμπεριστατωμένες εξηγήσεις.
### Πώς μπορώ να επιλύσω προβλήματα κατά τη χρήση του Aspose.Cells;
 Θα πρέπει να επισκεφθείτε το[Aspose Support Forum](https://forum.aspose.com/c/cells/9) για βοήθεια από την κοινότητα και το προσωπικό υποστήριξης της Aspose.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
