---
"description": "تعرّف على كيفية حماية الصفوف في ورقة عمل Excel باستخدام Aspose.Cells لـ .NET. وفّر الحماية لبياناتك على مستوى الصفوف، وامنع التغييرات غير المقصودة."
"linktitle": "حماية الصفوف في ورقة العمل باستخدام Aspose.Cells"
"second_title": "واجهة برمجة تطبيقات معالجة Excel Aspose.Cells .NET"
"title": "حماية الصفوف في ورقة العمل باستخدام Aspose.Cells"
"url": "/ar/net/worksheet-security/protect-rows/"
"weight": 18
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# حماية الصفوف في ورقة العمل باستخدام Aspose.Cells

## مقدمة
غالبًا ما يتطلب العمل مع ملفات Excel برمجيًا معالجة البيانات وحمايتها. سواءً كنت بحاجة إلى حماية بيانات حساسة أو منع التعديل غير المقصود، فإن حماية الصفوف في ورقة العمل خطوة بالغة الأهمية. في هذا البرنامج التعليمي، سنتناول بالتفصيل كيفية حماية صفوف محددة في ورقة عمل Excel باستخدام Aspose.Cells لـ .NET. سنشرح جميع الخطوات اللازمة، بدءًا من إعداد بيئة العمل وحتى تطبيق ميزات الحماية بطريقة بسيطة وسهلة المتابعة.
## المتطلبات الأساسية
قبل أن تتمكن من البدء في حماية الصفوف في ورقة العمل، هناك بعض الأشياء التي ستحتاج إلى وضعها في مكانها:
1. Aspose.Cells لـ .NET: تأكد من تثبيت Aspose.Cells لـ .NET على جهاز التطوير لديك. إذا لم تقم بذلك، يمكنك تنزيله بسهولة من [صفحة تنزيل Aspose Cells](https://releases.aspose.com/cells/net/).
2. Visual Studio أو أي بيئة تطوير متكاملة متوافقة مع .NET: لتنفيذ الحل، يجب إعداد بيئة تطوير. يُعد Visual Studio خيارًا ممتازًا، ولكن أي بيئة تطوير متكاملة متوافقة مع .NET ستفي بالغرض.
3. المعرفة الأساسية بلغة C#: إن فهم أساسيات برمجة C# سيساعدك على متابعة البرنامج التعليمي وتعديل كود المثال ليناسب احتياجاتك.
4. توثيق واجهة برمجة التطبيقات Aspose.Cells: تعرف على [توثيق Aspose.Cells لـ .NET](https://reference.aspose.com/cells/net/) للحصول على نظرة عامة على بنية الفصل والأساليب المستخدمة في المكتبة.
إذا كنت قد قمت بإعداد كل المتطلبات الأساسية، فيمكننا البدء مباشرة في التنفيذ.
## استيراد الحزم
للبدء، عليك استيراد الحزم المطلوبة. هذه المكتبات ضرورية للتفاعل مع ملفات Excel في مشروع C# الخاص بك.
```csharp
using System.IO;
using Aspose.Cells;
```
بمجرد استيراد الحزم اللازمة، يمكنك البدء في الترميز. 
الآن، لنُقسّم العملية إلى خطوات أصغر ليسهل عليك اتباعها. تُركّز كل خطوة على جانب مُحدّد من التنفيذ، مما يضمن فهمها وتطبيقها بسرعة. 
## الخطوة 1: إنشاء مصنف وورقة عمل جديدة
قبل تطبيق أي إعدادات حماية، عليك إنشاء مصنف جديد وتحديد ورقة العمل التي تريد العمل عليها. ستكون هذه ورقة العمل الخاصة بك.
```csharp
// المسار إلى دليل المستندات.
string dataDir = "Your Document Directory";
// إنشاء الدليل إذا لم يكن موجودًا بالفعل.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
	System.IO.Directory.CreateDirectory(dataDir);
// إنشاء مصنف جديد.
Workbook wb = new Workbook();
// إنشاء كائن ورقة عمل والحصول على الورقة الأولى.
Worksheet sheet = wb.Worksheets[0];
```
في هذا المثال، سننشئ مصنفًا جديدًا بورقة عمل واحدة (وهو الإعداد الافتراضي عند إنشاء مصنف جديد باستخدام Aspose.Cells). ثم سنختار أول ورقة عمل فيه، والتي ستكون هدفًا لحماية الصفوف.
## الخطوة 2: تحديد كائنات Style وStyleFlag
الخطوة التالية هي تعريف كائنات النمط وعلم النمط. تتيح لك هذه الكائنات تعديل خصائص الخلية، مثل ما إذا كانت مقفلة أم لا.
```csharp
// تعريف كائن النمط.
Style style;
// تعريف كائن styleflag.
StyleFlag flag;
```
سوف تستخدم هذه الكائنات في الخطوات اللاحقة لتخصيص خصائص الخلية وتطبيقها على ورقة العمل الخاصة بك.
## الخطوة 3: إلغاء قفل جميع الأعمدة في ورقة العمل
افتراضيًا، تكون جميع خلايا ورقة عمل Excel مقفلة. ومع ذلك، عند حماية ورقة عمل، يتم تطبيق حالة القفل. لضمان حماية صفوف أو خلايا محددة فقط، يمكنك إلغاء قفل جميع الأعمدة أولاً. هذه الخطوة ضرورية إذا كنت ترغب في حماية صفوف أو خلايا محددة فقط.
```csharp
// قم بالمرور على جميع الأعمدة في ورقة العمل وإلغاء قفلها.
for (int i = 0; i <= 255; i++)
{
    style = sheet.Cells.Columns[(byte)i].Style;
    style.IsLocked = false;
    flag = new StyleFlag();
    flag.Locked = true;
    sheet.Cells.Columns[(byte)i].ApplyStyle(style, flag);
}
```
في هذا الكود، نقوم بالمرور على جميع الأعمدة البالغ عددها 256 في ورقة العمل (تحتوي أوراق عمل Excel على حد أقصى يبلغ 256 عمودًا، مفهرسة من 0 إلى 255) ونقوم بتعيين `IsLocked` الممتلكات إلى `false`يضمن هذا الإجراء إلغاء قفل جميع الأعمدة، ولكننا سنظل نقفل صفوفًا محددة لاحقًا.
## الخطوة 4: قفل الصف الأول
بعد فتح الأعمدة، الخطوة التالية هي قفل صفوف محددة ترغب في حمايتها. في هذا المثال، سنقفل الصف الأول. هذا يضمن عدم تمكن المستخدمين من تعديله بينما تبقى الصفوف الأخرى مفتوحة.
```csharp
// احصل على نمط الصف الأول.
style = sheet.Cells.Rows[0].Style;
// قفله.
style.IsLocked = true;
// إنشاء العلم.
flag = new StyleFlag();
// ضبط إعداد القفل.
flag.Locked = true;
// قم بتطبيق النمط على الصف الأول.
sheet.Cells.ApplyRowStyle(0, style, flag);
```
هنا نصل إلى نمط الصف الأول ونضبطه `IsLocked` الممتلكات إلى `true`. بعد ذلك نستخدم `ApplyRowStyle()` طريقة لتطبيق نمط القفل على الصف بأكمله. يمكنك تكرار هذه الخطوة لقفل أي صفوف أخرى تريد حمايتها.
## الخطوة 5: حماية الورقة
بعد أن فتحنا قفل الصفوف اللازمة، حان وقت حماية ورقة العمل. تضمن الحماية عدم تمكن أي شخص من تعديل الصفوف أو الخلايا المقفلة إلا بعد إزالة كلمة مرور الحماية (إن وُجدت).
```csharp
// حماية الورقة.
sheet.Protect(ProtectionType.All);
```
في هذه الخطوة، نقوم بتطبيق الحماية على الورقة بأكملها باستخدام `ProtectionType.All`هذا النوع من الحماية يعني حماية جميع جوانب الورقة، بما في ذلك الصفوف والخلايا المقفلة. يمكنك أيضًا تخصيص هذه الحماية بتحديد أنواع حماية مختلفة عند الحاجة.
## الخطوة 6: حفظ المصنف
أخيرًا، علينا حفظ المصنف بعد تطبيق الأنماط والحماية اللازمة. يمكن حفظ المصنف بتنسيقات مختلفة، مثل Excel 97-2003، وExcel 2010، إلخ.
```csharp
// احفظ ملف Excel.
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```
يحفظ هذا السطر من التعليمات البرمجية المصنف بتنسيق Excel 97-2003 مع التغييرات المطبقة. يمكنك تغيير تنسيق الملف حسب احتياجاتك بالاختيار من بين مجموعة متنوعة من التنسيقات. `SaveFormat` خيارات.
## خاتمة
ها قد انتهيت! لقد تعلمت بنجاح كيفية حماية الصفوف في ورقة العمل باستخدام Aspose.Cells لـ .NET. باتباع الخطوات المذكورة أعلاه، يمكنك فتح أو قفل أي صفوف أو أعمدة حسب الحاجة، وتطبيق الحماية لضمان سلامة بياناتك.
## الأسئلة الشائعة
### كيف يمكنني حماية صفوف متعددة في وقت واحد؟  
يمكنك التنقل بين عدة صفوف وتطبيق نمط القفل على كل صف على حدة. ببساطة، استبدل `0` مع فهرس الصف الذي تريد قفله.
### هل يمكنني تعيين كلمة مرور لحماية الورقة؟  
نعم! يمكنك تمرير كلمة مرور إلى `sheet.Protect()` طريقة لفرض حماية كلمة المرور.
### هل يمكنني فتح الخلايا بدلاً من الأعمدة بأكملها؟  
نعم! بدلاً من فتح الأعمدة، يمكنك فتح خلايا فردية بتعديل خصائص نمطها.
### ماذا يحدث إذا حاولت تحرير صف محمي؟  
عندما يتم حماية صف، سيمنع Excel إجراء أي تعديلات على الخلايا المقفلة ما لم تقم بإلغاء حماية الورقة.
### هل يمكنني حماية نطاقات محددة على التوالي؟  
نعم! يمكنك قفل نطاقات فردية في صف واحد عن طريق ضبط `IsLocked` خاصية لخلايا محددة ضمن النطاق.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}