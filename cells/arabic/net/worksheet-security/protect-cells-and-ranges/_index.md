---
"description": "تعرّف على كيفية حماية الخلايا والنطاقات في ورقة عمل Excel باستخدام Aspose.Cells لـ .NET. اتبع هذا الدليل خطوة بخطوة لتأمين جداول بياناتك."
"linktitle": "حماية الخلايا والنطاقات في ورقة العمل باستخدام Aspose.Cells"
"second_title": "واجهة برمجة تطبيقات معالجة Excel Aspose.Cells .NET"
"title": "حماية الخلايا والنطاقات في ورقة العمل باستخدام Aspose.Cells"
"url": "/ar/net/worksheet-security/protect-cells-and-ranges/"
"weight": 11
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# حماية الخلايا والنطاقات في ورقة العمل باستخدام Aspose.Cells

## مقدمة
غالبًا ما يتطلب العمل مع جداول البيانات حماية أجزاء معينة من الورقة من التعديلات غير المرغوب فيها، خاصةً في بيئات العمل التعاونية. في هذا البرنامج التعليمي، سنستكشف كيفية حماية خلايا ونطاقات محددة في ورقة عمل باستخدام Aspose.Cells لـ .NET. سنرشدك خلال عملية إعداد ورقة عمل محمية، وتحديد النطاقات القابلة للتحرير، وحفظ الملف. تُعد هذه الميزة مفيدة للغاية عند الرغبة في تقييد الوصول إلى البيانات الحساسة مع السماح للآخرين بتعديل أقسام معينة.
## المتطلبات الأساسية
قبل الغوص في البرنامج التعليمي، تأكد من أن لديك المتطلبات الأساسية التالية:
1. Aspose.Cells لـ .NET: يجب تثبيت مكتبة Aspose.Cells في مشروعك. إذا لم تكن مثبتة بالفعل، يمكنك تنزيلها من [موقع Aspose](https://releases.aspose.com/cells/net/).
2. Visual Studio: يفترض هذا الدليل أنك تستخدم Visual Studio أو أي بيئة تطوير متكاملة مماثلة تدعم تطوير C#.
3. المعرفة الأساسية بلغة C#: يجب أن تكون على دراية بأساسيات برمجة C# وكيفية إعداد مشروع في Visual Studio.
4. ترخيص Aspose.Cells: مع أن Aspose يقدم نسخة تجريبية مجانية، فإن الترخيص الساري يسمح لك باستخدام كامل ميزات المكتبة. إذا لم يكن لديك ترخيص، يمكنك الحصول على ترخيص جديد. [رخصة مؤقتة هنا](https://purchase.aspose.com/temporary-license/).
بمجرد التأكد من أن كل ما سبق جاهز، يمكننا الانتقال إلى جزء الترميز.
## استيراد الحزم
للعمل مع Aspose.Cells، يجب عليك أولاً استيراد مساحات الأسماء اللازمة إلى ملف C#. إليك كيفية استيرادها:
```csharp
using System.IO;
using Aspose.Cells;
```
ال `Aspose.Cells` تتيح لك مساحة الاسم الوصول إلى الوظائف الأساسية للتعامل مع ملفات Excel، و `System.IO` يتم استخدامه لعمليات الملفات مثل حفظ المصنف.
الآن، دعنا نقوم بتفصيل الخطوات لحماية الخلايا والنطاقات داخل ورقة العمل باستخدام Aspose.Cells.
## الخطوة 1: إعداد البيئة الخاصة بك
أولاً، أنشئ مجلدًا لحفظ ملفات Excel. إذا لم يكن هذا المجلد موجودًا بالفعل، فسننشئه. هذا يضمن لك مكانًا لتخزين ملف الإخراج.
```csharp
// حدد المسار إلى دليل المستند الخاص بك
string dataDir = "Your Document Directory";
// تحقق مما إذا كان الدليل موجودًا، وإذا لم يكن كذلك، قم بإنشائه
bool IsExists = Directory.Exists(dataDir);
if (!IsExists)
    Directory.CreateDirectory(dataDir);
```
هنا، نحن نستخدم `System.IO.Directory.Exists()` للتحقق مما إذا كان المجلد موجودًا، وإذا لم يكن كذلك، نقوم بإنشائه باستخدام `Directory.CreateDirectory()`.
## الخطوة 2: إنشاء مصنف جديد
الآن، لنُنشئ كائن مصنف جديد. سيُستخدم هذا الكائن كملف Excel الذي سنُعرّف فيه خلايانا ونطاقاتنا.
```csharp
// إنشاء كائن مصنف جديد
Workbook book = new Workbook();
```
ال `Workbook` الفئة هي نقطة البداية للعمل مع ملفات Excel في Aspose.Cells. وهي تُمثل مستند Excel.
## الخطوة 3: الوصول إلى ورقة العمل الافتراضية
لكل مصنف جديد مُنشأ، ورقة عمل افتراضية. سنستعيدها للعمل على محتواها.
```csharp
// احصل على ورقة العمل الأولى (الافتراضية) في المصنف
Worksheet sheet = book.Worksheets[0];
```
هنا، `Worksheets[0]` يمنحنا الورقة الأولى في المصنف (يبدأ الفهرس من 0).
## الخطوة 4: تحديد النطاقات القابلة للتحرير
لحماية أجزاء معينة من ورقة العمل مع السماح للمستخدمين بتحرير خلايا محددة، نحتاج إلى تحديد نطاقات قابلة للتحرير. سننشئ نطاقًا قابلًا للتحرير ونضيفه إلى مجموعة AllowEditRanges في ورقة العمل.
```csharp
// احصل على مجموعة AllowEditRanges
ProtectedRangeCollection allowRanges = sheet.AllowEditRanges;
// قم بتعريف ProtectedRange وإضافته إلى المجموعة
int idx = allowRanges.Add("r2", 1, 1, 3, 3);
ProtectedRange protectedRange = allowRanges[idx];
```
في الكود أعلاه:
- `"r2"` هو اسم النطاق القابل للتحرير.
- الأرقام `1, 1, 3, 3` تمثل مؤشرات الصفوف والأعمدة الأولية والنهائية للنطاق (أي من الخلية B2 إلى D4).
## الخطوة 5: تعيين كلمة مرور للنطاق المحمي
بعد أن حددنا النطاق القابل للتحرير، لنُضِف كلمة مرور لحمايته. هذا يعني أن المستخدمين سيحتاجون إلى كلمة المرور لتحرير هذا النطاق المحدد.
```csharp
// حدد كلمة المرور للنطاق القابل للتحرير
protectedRange.Password = "123";
```
هنا، قمنا بتعيين كلمة المرور كـ `"123"`ولكن يمكنك اختيار أي كلمة مرور آمنة. هذه الخطوة ضرورية للتحكم في الوصول إلى المناطق القابلة للتعديل.
## الخطوة 6: حماية الورقة بأكملها
في هذه المرحلة، سنحمي ورقة العمل بأكملها. تضمن حماية ورقة العمل عدم إمكانية تعديل أجزاء أخرى منها، باستثناء النطاقات المسموح بها.
```csharp
// حماية الورقة باستخدام نوع الحماية المحدد (الكل)
sheet.Protect(ProtectionType.All);
```
يضمن هذا أن يتم تأمين جميع الخلايا في الورقة، باستثناء تلك الموجودة في النطاقات القابلة للتحرير.
## الخطوة 7: حفظ المصنف
أخيرًا، نحفظ المصنف في ملف. سيتم حفظ الورقة المحمية بالاسم الذي تحدده.
```csharp
// حفظ ملف Excel في الدليل المحدد
book.Save(dataDir + "protectedrange.out.xls");
```
هنا سيتم حفظ ملف Excel باسم `protectedrange.out.xls` في المجلد الذي حددناه سابقًا. إذا أردت حفظه باسم أو تنسيق مختلف، يمكنك تعديل اسم الملف وامتداده.
## خاتمة
باتباع هذا البرنامج التعليمي، ستتعلم كيفية حماية الخلايا والنطاقات في ورقة عمل Excel باستخدام Aspose.Cells لـ .NET. يمنحك هذا النهج مرونة في التحكم في أيٍّ من مناطق جدول البيانات يمكن تحريرها وأيها لا يمكن تحريرها. يمكنك الآن تطبيق هذه المهارات في مشاريعك الخاصة، مما يضمن أمان بياناتك الحساسة مع توفير مناطق قابلة للتحرير للمستخدمين.
تذكر أن Aspose.Cells يوفر مجموعة قوية من الأدوات للعمل مع ملفات Excel، وهذا مجرد واحد من العديد من الأشياء التي يمكنك القيام بها باستخدامها. 
## الأسئلة الشائعة
### هل يمكنني حماية خلايا معينة فقط في ورقة العمل؟
نعم، باستخدام `AllowEditRanges` باستخدام الخاصية، يمكنك تحديد الخلايا أو النطاقات التي يمكن تحريرها بينما تظل بقية ورقة العمل محمية.
### هل يمكنني إزالة الحماية لاحقًا؟
نعم، يمكنك إلغاء حماية ورقة العمل باستخدام `Unprotect()` الطريقة، وإذا تم تعيين كلمة مرور، فسوف تحتاج إلى تقديمها.
### كيف أحمي ورقة كاملة بكلمة مرور؟
لحماية الورقة بأكملها، ما عليك سوى استخدام `Protect()` طريقة مع أو بدون كلمة مرور. على سبيل المثال، `sheet.Protect("password")`.
### هل يمكنني إضافة نطاقات متعددة قابلة للتحرير؟
بالتأكيد! يمكنك إضافة أي عدد من النطاقات القابلة للتعديل حسب حاجتك عن طريق استدعاء `allowRanges.Add()` عدة مرات.
### ما هي ميزات الأمان الأخرى التي يقدمها Aspose.Cells؟
يدعم Aspose.Cells ميزات أمان مختلفة مثل تشفير المصنف، وتعيين كلمات مرور للملفات، وحماية الخلايا والأوراق.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}