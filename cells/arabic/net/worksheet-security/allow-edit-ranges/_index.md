---
title: السماح للمستخدمين بتحرير النطاقات في ورقة العمل باستخدام Aspose.Cells
linktitle: السماح للمستخدمين بتحرير النطاقات في ورقة العمل باستخدام Aspose.Cells
second_title: واجهة برمجة تطبيقات معالجة Excel الخاصة بـ Aspose.Cells .NET
description: تعلم كيفية إنشاء نطاقات قابلة للتحرير في أوراق عمل Excel باستخدام Aspose.Cells لـ .NET، مما يسمح بتحرير خلايا معينة مع تأمين الباقي باستخدام حماية ورقة العمل.
weight: 10
url: /ar/net/worksheet-security/allow-edit-ranges/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# السماح للمستخدمين بتحرير النطاقات في ورقة العمل باستخدام Aspose.Cells

## مقدمة
غالبًا ما تحتوي مستندات Excel على بيانات حساسة أو محتوى منظم تريد حمايته من التحرير غير المرغوب فيه. ومع ذلك، قد تكون هناك خلايا أو نطاقات معينة تريد جعلها قابلة للتحرير لمستخدمين معينين. وهنا يأتي دور Aspose.Cells for .NET كأداة قوية تتيح لك حماية ورقة عمل كاملة مع الاستمرار في منح أذونات التحرير لنطاقات معينة. تخيل مشاركة جدول بيانات الميزانية حيث تكون خلايا معينة فقط قابلة للتحرير، وتظل الخلايا الأخرى آمنة - يجعل Aspose.Cells هذا الأمر سهلاً وفعالاً.
## المتطلبات الأساسية
قبل التعمق في جزء الترميز، دعنا نتأكد من أن لديك كل ما تحتاجه:
-  Aspose.Cells for .NET: تأكد من تثبيت مكتبة Aspose.Cells for .NET. يمكنك تنزيلها[هنا](https://releases.aspose.com/cells/net/).
- بيئة التطوير: Visual Studio أو أي بيئة تطوير متكاملة متوافقة مع C#.
- .NET Framework: الإصدار 4.0 أو أحدث.
- الترخيص: فكر في الحصول على ترخيص لتجنب قيود التجربة. يمكنك الحصول على ترخيص[رخصة مؤقتة هنا](https://purchase.aspose.com/temporary-license/).
## استيراد الحزم
تأكد من تضمين مساحة اسم Aspose.Cells الضرورية في بداية الكود الخاص بك:
```csharp
using System.IO;
using Aspose.Cells;
```
سيضمن هذا إمكانية الوصول إلى جميع الفئات والطرق المطلوبة لإعداد النطاقات المحمية في ملفات Excel.
الآن بعد أن أصبح الأساس جاهزًا، دعنا ننتقل إلى التعليمات البرمجية بالتفصيل، خطوة بخطوة.
## الخطوة 1: إعداد الدليل
قبل العمل بالملفات، يجب عليك إعداد الدليل الذي ستحفظ فيه ملف Excel. يضمن هذا أن ملفاتك منظمة بشكل جيد ومخزنة بشكل آمن.
```csharp
// قم بتحديد المسار إلى دليل المستندات الخاص بك
string dataDir = "Your Document Directory";
// تحقق مما إذا كان الدليل موجودًا، وإذا لم يكن كذلك، قم بإنشائه
bool isExists = Directory.Exists(dataDir);
if (!isExists)
{
    Directory.CreateDirectory(dataDir);
}
```
يضمن هذا الجزء من التعليمات البرمجية أن يكون الدليل جاهزًا لعمليات الملفات. فكر في الأمر على أنه وضع الأساس لكل ما يلي.
## الخطوة 2: تهيئة المصنف وورقة العمل
الآن، دعنا ننتقل إلى الأمام من خلال إنشاء مصنف جديد والوصول إلى ورقة العمل الافتراضية الخاصة به.
```csharp
// تهيئة مصنف عمل جديد
Workbook book = new Workbook();
// الوصول إلى ورقة العمل الأولى في المصنف
Worksheet sheet = book.Worksheets[0];
```
هنا، نقوم بتهيئة مصنف Excel وتحديد ورقة العمل الأولى بداخله. ستكون ورقة العمل هذه بمثابة اللوحة التي نطبق عليها إعدادات الحماية ونحدد النطاقات القابلة للتحرير.
## الخطوة 3: الوصول إلى مجموعة السماح بتحرير النطاقات
 يحتوي Aspose.Cells على ميزة تسمى`AllowEditRanges`، وهي عبارة عن مجموعة من النطاقات القابلة للتحرير، حتى عندما تكون ورقة العمل محمية.
```csharp
// الوصول إلى مجموعة السماح بتحرير النطاقات
ProtectedRangeCollection allowRanges = sheet.AllowEditRanges;
```
يتيح لك هذا السطر الوصول إلى مجموعة خاصة من النطاقات التي يمكن تعديلها. يمكنك اعتبارها منطقة "VIP" في ورقة العمل الخاصة بك، حيث يُسمح فقط لنطاقات محددة بتجاوز الحماية.
## الخطوة 4: تحديد وإنشاء نطاق محمي
الآن، دعنا نحدد وننشئ نطاقًا محميًا في ورقة العمل الخاصة بنا. سنحدد خلايا البداية والنهاية لهذا النطاق.
```csharp
// تعريف متغير ProtectedRange
ProtectedRange protectedRange;
// إضافة نطاق جديد إلى المجموعة باسم محدد ومواضع خلايا
int idx = allowRanges.Add("EditableRange", 1, 1, 3, 3);
protectedRange = allowRanges[idx];
```
في كتلة التعليمات البرمجية هذه:
- `EditableRange` هو الاسم المخصص للنطاق.
- الأرقام (1، 1، 3، 3) تحدد إحداثيات النطاق، وهذا يعني أنه يبدأ من الخلية B2 (الصف 1، العمود 1) إلى الخلية D4 (الصف 3، العمود 3).
## الخطوة 5: تعيين كلمة مرور للنطاق المحمي
لمزيد من الأمان، يمكنك تعيين كلمة مرور للنطاق المحمي. تضيف هذه الخطوة طبقة إضافية من الحماية لضمان أن المستخدمين المصرح لهم فقط يمكنهم تحرير النطاق.
```csharp
// تعيين كلمة مرور للنطاق القابل للتحرير
protectedRange.Password = "123";
```
هنا، أضفنا كلمة مرور (`"123"`) إلى النطاق المحمي. يوفر متطلب كلمة المرور هذا مستوى إضافيًا من التحكم في من يمكنه إجراء التغييرات.
## الخطوة 6: حماية ورقة العمل
بعد تحديد النطاق القابل للتحرير، فإن الخطوة التالية هي حماية ورقة العمل بأكملها. سيضمن إعداد الحماية هذا أن تكون جميع الخلايا خارج النطاق المحدد مقفلة وغير قابلة للتحرير.
```csharp
// تطبيق الحماية على ورقة العمل، مما يجعل جميع الخلايا الأخرى غير قابلة للتحرير
sheet.Protect(ProtectionType.All);
```
 ال`Protect`تقوم الطريقة بتأمين ورقة العمل بأكملها، باستثناء النطاقات التي حددناها كقابلة للتعديل. تعمل هذه الخطوة بشكل أساسي على إنشاء بيئة آمنة "للقراءة فقط"، مع إمكانية الوصول إلى خلايا معينة حسب الحاجة.
## الخطوة 7: احفظ المصنف
الخطوة الأخيرة هي حفظ المصنف، حتى يتم تطبيق الإعدادات الخاصة بك وتخزينها.
```csharp
// حفظ ملف Excel في الدليل المحدد
book.Save(dataDir + "protectedrange.out.xls");
```
في هذه الخطوة، نقوم بحفظ المصنف الخاص بنا باسم "protectedrange.out.xls" في الدليل الذي قمنا بإعداده في الخطوة 1. الآن، لديك ملف Excel آمن وكامل الوظائف حيث يمكن تحرير نطاقات محددة فقط!
## خاتمة
توفر Aspose.Cells for .NET طريقة ممتازة لإدارة الحماية والأذونات داخل ملفات Excel. من خلال إنشاء نطاقات قابلة للتحرير، يمكنك تأمين أوراق العمل الخاصة بك مع السماح في الوقت نفسه بإمكانية الوصول إلى مناطق معينة. هذه الوظيفة مفيدة بشكل خاص للمستندات التعاونية، حيث يجب أن تكون بضع خلايا فقط مفتوحة للتحرير بينما تظل الخلايا الأخرى مقفلة.
## الأسئلة الشائعة
### هل يمكنني إضافة نطاقات متعددة قابلة للتحرير إلى ورقة عمل؟
نعم، يمكنك إضافة نطاقات متعددة ببساطة عن طريق تكرار`allowRanges.Add()` طريقة لكل نطاق جديد.
### ماذا لو أردت إزالة نطاق محمي لاحقًا؟
 استخدم`allowRanges.RemoveAt()` الطريقة مع مؤشر النطاق الذي ترغب في إزالته.
### هل يمكنني تعيين كلمات مرور مختلفة لكل نطاق؟
 بالتأكيد. كل واحد`ProtectedRange` يمكن أن يكون لها كلمة مرور فريدة خاصة بها، مما يتيح لك التحكم الدقيق.
### ماذا يحدث إذا قمت بحماية ورقة العمل التي لا تحتوي على أي نطاقات قابلة للتحرير؟
إذا لم تقم بتحديد نطاقات قابلة للتحرير، فستكون ورقة العمل بأكملها غير قابلة للتحرير بمجرد حمايتها.
### هل النطاق المحمي مرئي للمستخدمين الآخرين؟
لا، الحماية داخلية. لن يُطلب من المستخدمين إدخال كلمة مرور إلا إذا حاولوا تحرير المنطقة المحمية.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
