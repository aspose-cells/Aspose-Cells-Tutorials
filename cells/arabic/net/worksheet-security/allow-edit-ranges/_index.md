---
"description": "تعلم كيفية إنشاء نطاقات قابلة للتحرير في أوراق عمل Excel باستخدام Aspose.Cells لـ .NET، مما يسمح بتحرير خلايا معينة مع تأمين الباقي باستخدام حماية ورقة العمل."
"linktitle": "السماح للمستخدمين بتحرير النطاقات في ورقة العمل باستخدام Aspose.Cells"
"second_title": "واجهة برمجة تطبيقات معالجة Excel Aspose.Cells .NET"
"title": "السماح للمستخدمين بتحرير النطاقات في ورقة العمل باستخدام Aspose.Cells"
"url": "/ar/net/worksheet-security/allow-edit-ranges/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# السماح للمستخدمين بتحرير النطاقات في ورقة العمل باستخدام Aspose.Cells

## مقدمة
غالبًا ما تحتوي مستندات Excel على بيانات حساسة أو محتوى منظم ترغب في حمايته من التعديل غير المرغوب فيه. ومع ذلك، قد تكون هناك خلايا أو نطاقات محددة ترغب في جعلها قابلة للتعديل من قبل مستخدمين محددين. وهنا يأتي دور Aspose.Cells for .NET كأداة فعّالة تتيح لك حماية ورقة عمل كاملة مع منح أذونات التعديل لنطاقات محددة. تخيل مشاركة جدول بيانات ميزانية حيث تكون خلايا معينة فقط قابلة للتعديل، بينما تبقى الخلايا الأخرى آمنة - Aspose.Cells يجعل هذا الأمر سهلاً وفعالاً.
## المتطلبات الأساسية
قبل الخوض في جزء الترميز، دعنا نتأكد من أن لديك كل ما تحتاجه:
- Aspose.Cells لـ .NET: تأكد من تثبيت مكتبة Aspose.Cells لـ .NET. يمكنك تنزيلها. [هنا](https://releases.aspose.com/cells/net/).
- بيئة التطوير: Visual Studio أو أي بيئة تطوير متكاملة متوافقة مع C#.
- .NET Framework: الإصدار 4.0 أو أحدث.
- الترخيص: فكّر في الحصول على ترخيص لتجنب قيود التجربة. يمكنك الحصول على [رخصة مؤقتة هنا](https://purchase.aspose.com/temporary-license/).
## استيراد الحزم
تأكد من تضمين مساحة اسم Aspose.Cells الضرورية في بداية الكود الخاص بك:
```csharp
using System.IO;
using Aspose.Cells;
```
سيضمن هذا إمكانية الوصول إلى جميع الفئات والطرق المطلوبة لإعداد النطاقات المحمية في ملفات Excel.
الآن بعد أن أصبح الأساس في مكانه، دعنا ننتقل إلى الكود بالتفصيل، خطوة بخطوة.
## الخطوة 1: إعداد الدليل
قبل العمل على الملفات، عليك تحديد المجلد الذي ستحفظ فيه ملف Excel. هذا يضمن تنظيم ملفاتك وتخزينها بشكل آمن.
```csharp
// حدد المسار إلى دليل المستندات الخاص بك
string dataDir = "Your Document Directory";
// تحقق مما إذا كان الدليل موجودًا، وإذا لم يكن كذلك، قم بإنشائه
bool isExists = Directory.Exists(dataDir);
if (!isExists)
{
    Directory.CreateDirectory(dataDir);
}
```
يضمن هذا الجزء من الكود جاهزية مجلدك لعمليات الملفات. تخيله بمثابة وضع الأساس لكل ما يليه.
## الخطوة 2: تهيئة المصنف وورقة العمل
الآن، دعنا ننتقل إلى الأمام من خلال إنشاء مصنف جديد والوصول إلى ورقة العمل الافتراضية الخاصة به.
```csharp
// تهيئة مصنف جديد
Workbook book = new Workbook();
// الوصول إلى ورقة العمل الأولى في المصنف
Worksheet sheet = book.Worksheets[0];
```
هنا، نقوم بتهيئة مصنف Excel واختيار أول ورقة عمل فيه. ستكون هذه الورقة هي اللوحة التي سنطبق عليها إعدادات الحماية ونحدد نطاقات قابلة للتحرير.
## الخطوة 3: الوصول إلى مجموعة السماح بتحرير النطاقات
يحتوي Aspose.Cells على ميزة تسمى `AllowEditRanges`، وهي عبارة عن مجموعة من النطاقات التي يمكن تحريرها، حتى عندما تكون ورقة العمل محمية.
```csharp
// الوصول إلى مجموعة السماح بتحرير النطاقات
ProtectedRangeCollection allowRanges = sheet.AllowEditRanges;
```
يُهيئ هذا السطر الوصول إلى مجموعة خاصة من النطاقات القابلة للتعديل. يمكنك اعتبارها منطقة "VIP" في ورقة العمل، حيث يُسمح فقط لنطاقات محددة بتجاوز الحماية.
## الخطوة 4: تحديد وإنشاء نطاق محمي
الآن، لنُعرّف ونُنشئ نطاقًا محميًا في ورقة العمل. سنُحدد خلايا البداية والنهاية لهذا النطاق.
```csharp
// تعريف متغير ProtectedRange
ProtectedRange protectedRange;
// إضافة نطاق جديد إلى المجموعة باسم محدد ومواضع خلايا محددة
int idx = allowRanges.Add("EditableRange", 1, 1, 3, 3);
protectedRange = allowRanges[idx];
```
في كتلة التعليمات البرمجية هذه:
- `EditableRange` هو الاسم المخصص للنطاق.
- الأرقام (1، 1، 3، 3) تحدد إحداثيات النطاق، وهذا يعني أنه يبدأ من الخلية B2 (الصف 1، العمود 1) إلى الخلية D4 (الصف 3، العمود 3).
## الخطوة 5: تعيين كلمة مرور للنطاق المحمي
لمزيد من الأمان، يمكنك تعيين كلمة مرور للنطاق المحمي. تُضيف هذه الخطوة طبقة حماية إضافية لضمان تمكين المستخدمين المُصرّح لهم فقط من تعديل النطاق.
```csharp
// تعيين كلمة مرور للنطاق القابل للتحرير
protectedRange.Password = "123";
```
هنا، أضفنا كلمة مرور (`"123"`) إلى النطاق المحمي. يوفر متطلب كلمة المرور هذا مستوى إضافيًا من التحكم في من يمكنه إجراء التغييرات.
## الخطوة 6: حماية ورقة العمل
بعد تحديد نطاقنا القابل للتعديل، ننتقل إلى حماية ورقة العمل بأكملها. يضمن هذا الإعداد أن تكون جميع الخلايا خارج النطاق المحدد مقفلة وغير قابلة للتعديل.
```csharp
// تطبيق الحماية على ورقة العمل، مما يجعل جميع الخلايا الأخرى غير قابلة للتحرير
sheet.Protect(ProtectionType.All);
```
ال `Protect` تُغلق هذه الطريقة ورقة العمل بأكملها، باستثناء النطاقات التي حددناها كقابلة للتعديل. تُنشئ هذه الخطوة بيئة آمنة للقراءة فقط، مع إمكانية الوصول إلى خلايا مُحددة حسب الحاجة.
## الخطوة 7: حفظ المصنف
الخطوة الأخيرة هي حفظ المصنف، حتى يتم تطبيق الإعدادات الخاصة بك وتخزينها.
```csharp
// حفظ ملف Excel في الدليل المحدد
book.Save(dataDir + "protectedrange.out.xls");
```
في هذه الخطوة، نقوم بحفظ المصنف الخاص بنا باسم "protectedrange.out.xls" في الدليل الذي قمنا بإعداده في الخطوة 1. الآن، لديك ملف Excel آمن وكامل الوظائف حيث يمكن تحرير نطاقات محددة فقط!
## خاتمة
يوفر Aspose.Cells لـ .NET طريقة ممتازة لإدارة الحماية والأذونات داخل ملفات Excel. بإنشاء نطاقات قابلة للتعديل، يمكنك تأمين أوراق العمل مع الحفاظ على إمكانية الوصول إلى مناطق محددة. تُعد هذه الوظيفة مفيدة بشكل خاص للمستندات التعاونية، حيث يجب أن تكون بعض الخلايا فقط مفتوحة للتحرير بينما تبقى الخلايا الأخرى مغلقة.
## الأسئلة الشائعة
### هل يمكنني إضافة نطاقات متعددة قابلة للتحرير إلى ورقة عمل؟
نعم، يمكنك إضافة نطاقات متعددة عن طريق تكرار الأمر ببساطة `allowRanges.Add()` طريقة لكل نطاق جديد.
### ماذا لو أردت إزالة نطاق محمي لاحقًا؟
استخدم `allowRanges.RemoveAt()` الطريقة مع مؤشر النطاق الذي ترغب في إزالته.
### هل يمكنني تعيين كلمات مرور مختلفة لكل نطاق؟
بالتأكيد. كل `ProtectedRange` يمكن أن يكون لها كلمة مرور فريدة خاصة بها، مما يتيح لك التحكم الدقيق.
### ماذا سيحدث إذا قمت بحماية ورقة العمل التي لا تحتوي على أي نطاقات قابلة للتحرير؟
إذا لم تقم بتحديد نطاقات قابلة للتحرير، فستكون ورقة العمل بأكملها غير قابلة للتحرير بمجرد حمايتها.
### هل النطاق المحمي مرئي للمستخدمين الآخرين؟
لا، الحماية داخلية. سيُطلب من المستخدمين إدخال كلمة مرور فقط عند محاولة تعديل المنطقة المحمية.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}