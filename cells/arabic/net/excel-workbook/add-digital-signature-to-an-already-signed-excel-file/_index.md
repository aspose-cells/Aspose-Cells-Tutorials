---
"description": "تعرف على كيفية إضافة توقيع رقمي إلى ملف Excel موقّع بالفعل باستخدام Aspose.Cells for .NET من خلال هذا الدليل التفصيلي خطوة بخطوة."
"linktitle": "إضافة توقيع رقمي إلى ملف Excel موقّع بالفعل"
"second_title": "مرجع واجهة برمجة التطبيقات Aspose.Cells لـ .NET"
"title": "إضافة توقيع رقمي إلى ملف Excel موقّع بالفعل"
"url": "/ar/net/excel-workbook/add-digital-signature-to-an-already-signed-excel-file/"
"weight": 30
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# إضافة توقيع رقمي إلى ملف Excel موقّع بالفعل

## مقدمة

في عالمنا الرقمي اليوم، أصبح تأمين المستندات أكثر أهمية من أي وقت مضى. توفر التوقيعات الرقمية وسيلةً لضمان صحة ملفاتك وسلامتها، خاصةً عند التعامل مع معلومات حساسة. إذا كنت تعمل على ملفات Excel وترغب في إضافة توقيع رقمي جديد إلى مصنف مُوقّع مسبقًا، فأنت في المكان المناسب! في هذا الدليل، سنشرح لك عملية إضافة توقيع رقمي إلى ملف Excel مُوقّع مسبقًا باستخدام Aspose.Cells لـ .NET. هيا بنا!

## المتطلبات الأساسية

قبل أن ننتقل إلى التفاصيل الدقيقة للترميز، هناك بعض الأشياء التي تحتاج إلى وضعها في مكانها:

1. Aspose.Cells لـ .NET: تأكد من تثبيت مكتبة Aspose.Cells في مشروع .NET الخاص بك. يمكنك تنزيلها من [موقع](https://releases.aspose.com/cells/net/).
2. ملف الشهادة: ستحتاج إلى ملف شهادة صالح (عادةً ما يكون `.pfx` الملف الذي يحتوي على شهادتك الرقمية. تأكد من معرفة كلمة المرور لهذا الملف.
3. بيئة التطوير: قم بإعداد بيئة التطوير الخاصة بك باستخدام Visual Studio أو أي بيئة تطوير متكاملة أخرى تدعم .NET.
4. المعرفة الأساسية بلغة C#: ستساعدك المعرفة ببرمجة C# على المتابعة بسلاسة.
5. ملفات نموذجية: احرص على أن يكون لديك ملف إكسل نموذجي موقّع رقميًا. هذا هو الملف الذي ستضيف إليه توقيعًا جديدًا.

الآن بعد أن أصبح كل شيء في مكانه، فلنبدأ في الترميز!

## استيراد الحزم

للبدء، ستحتاج إلى استيراد الحزم اللازمة في ملف C#. إليك الطريقة:

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```

ستتيح لك هذه المساحات الاسمية العمل مع ملفات Excel ومعالجة التوقيعات الرقمية بسلاسة.

## الخطوة 1: إعداد دليل المصدر والإخراج

قبل أن تتمكن من التعامل مع ملفات Excel، عليك تحديد مكان ملفات المصدر ومكان حفظ ملف الإخراج. إليك كيفية القيام بذلك:

```csharp
// دليل المصدر
string sourceDir = "Your Document Directory";
// دليل الإخراج
string outputDir = "Your Document Directory";
```

في هذه الخطوة، نستخدم طريقةً للحصول على مسارات مجلدات المصدر والإخراج. تأكد من وجود هذه المجلدات واحتوائها على الملفات المطلوبة.

## الخطوة 2: تحميل المصنف الموقّع بالفعل

بعد ذلك، ستحتاج إلى تحميل مصنف Excel الذي تريد تعديله. يتم ذلك بإنشاء مثيل من `Workbook` الفئة وتمرير مسار الملف الموقع.

```csharp
// قم بتحميل المصنف الذي تم توقيعه رقميًا بالفعل
Aspose.Cells.Workbook workbook = new Aspose.Cells.Workbook(sourceDir + "sampleDigitallySignedByCells.xlsx");
```

هنا، نقوم بتحميل المصنف المسمى `sampleDigitallySignedByCells.xlsx`تأكد من أن هذا الملف موقّع بالفعل.

## الخطوة 3: إنشاء مجموعة توقيعات رقمية

الآن، لنُنشئ مجموعة توقيعات رقمية. ستحتوي هذه المجموعة على جميع التوقيعات الرقمية التي ترغب في إضافتها إلى المصنف.

```csharp
// إنشاء مجموعة التوقيعات الرقمية
Aspose.Cells.DigitalSignatures.DigitalSignatureCollection dsCollection = new Aspose.Cells.DigitalSignatures.DigitalSignatureCollection();
```

تعتبر هذه الخطوة بالغة الأهمية لأنها تسمح لك بإدارة توقيعات متعددة إذا لزم الأمر.

## الخطوة 4: إنشاء شهادة جديدة

يجب عليك تحميل ملف الشهادة لإنشاء توقيع رقمي جديد. هنا يمكنك تحديد المسار إلى `.pfx` الملف وكلمة المرور الخاصة به.

```csharp
// ملف الشهادة وكلمة المرور الخاصة به
string certFileName = sourceDir + "AsposeDemo.pfx";
string password = "aspose";

// إنشاء شهادة جديدة
System.Security.Cryptography.X509Certificates.X509Certificate2 certificate = new System.Security.Cryptography.X509Certificates.X509Certificate2(certFileName, password);
```

تأكد من الاستبدال `AsposeDemo.pfx` وكلمة المرور مع اسم ملف الشهادة وكلمة المرور الفعلية الخاصة بك.

## الخطوة 5: إنشاء التوقيع الرقمي

بعد الحصول على الشهادة، يمكنك الآن إنشاء توقيع رقمي. ستحتاج أيضًا إلى توضيح سبب التوقيع والتاريخ والوقت الحاليين.

```csharp
// إنشاء توقيع رقمي جديد وإضافته إلى مجموعة التوقيعات الرقمية
Aspose.Cells.DigitalSignatures.DigitalSignature signature = new Aspose.Cells.DigitalSignatures.DigitalSignature(certificate, "Aspose.Cells added new digital signature in existing digitally signed workbook.", DateTime.Now);
```

تضيف هذه الخطوة التوقيع الجديد إلى مجموعتك، والذي ستطبقه لاحقًا على المصنف.

## الخطوة 6: إضافة مجموعة التوقيعات الرقمية إلى المصنف

الآن حان وقت إضافة مجموعة التوقيعات الرقمية إلى مصنف العمل. هنا تبدأ المفاجأة!

```csharp
// إضافة مجموعة التوقيعات الرقمية داخل المصنف
workbook.AddDigitalSignature(dsCollection);
```

من خلال تنفيذ هذا السطر، فإنك تقوم فعليًا بإرفاق التوقيع الرقمي الجديد بالمصنف الموقع بالفعل.

## الخطوة 7: حفظ المصنف والتخلص منه

أخيرًا، قد ترغب في حفظ المصنف المعدّل في دليل الإخراج الخاص بك وإطلاق أي موارد قيد الاستخدام.

```csharp
// احفظ المصنف وتخلص منه.
workbook.Save(outputDir + "outputDigitallySignedByCells.xlsx");
workbook.Dispose();
```

تضمن هذه الخطوة حفظ التغييرات، والتخلص من المصنف بشكل صحيح لتحرير الموارد.

## الخطوة 8: تأكيد التنفيذ

لاختتام الأمر، يُنصح بالتأكد من نجاح تنفيذ الكود. يمكنك القيام بذلك برسالة بسيطة في وحدة التحكم.

```csharp
Console.WriteLine("AddDigitalSignatureToAnAlreadySignedExcelFile executed successfully.\r\n");
```

يؤدي هذا إلى توفير تعليقات تفيد بأن عمليتك كانت ناجحة، وهو أمر لطيف دائمًا رؤيته!

## خاتمة

ها قد انتهيت! لقد نجحت في إضافة توقيع رقمي جديد إلى ملف Excel مُوقّع مسبقًا باستخدام Aspose.Cells لـ .NET. تُعد التوقيعات الرقمية وسيلة فعّالة لضمان صحة مستنداتك، والآن أصبحت تعرف كيفية إدارتها برمجيًا. سواء كنت تعمل على مستندات مالية أو عقود أو أي معلومات حساسة، فإن استخدام التوقيعات الرقمية يُعزز الأمان والثقة.

## الأسئلة الشائعة

### ما هو التوقيع الرقمي؟
التوقيع الرقمي هو أسلوب تشفيري يستخدم للتحقق من صحة وسلامة الرسالة أو المستند.

### هل يمكنني إضافة توقيعات رقمية متعددة إلى نفس ملف Excel؟
نعم، يمكنك إنشاء مجموعة توقيعات رقمية وإضافة توقيعات متعددة إلى نفس المصنف.

### ما هي التنسيقات التي يدعمها Aspose.Cells للتوقيعات الرقمية؟
يدعم Aspose.Cells تنسيقات مختلفة، بما في ذلك `.pfx` للحصول على الشهادات.

### هل أحتاج إلى إصدار محدد من .NET لاستخدام Aspose.Cells؟
التحقق من [توثيق Aspose.Cells](https://reference.aspose.com/cells/net/) للتوافق مع إصدار .NET الخاص بك.

### كيف يمكنني الحصول على ترخيص مؤقت لـ Aspose.Cells؟
يمكنك طلب ترخيص مؤقت من [صفحة شراء Aspose](https://purchase.aspose.com/temporary-license/).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}