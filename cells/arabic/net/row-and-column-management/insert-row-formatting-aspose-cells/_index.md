---
title: إدراج صف مع التنسيق في Aspose.Cells .NET
linktitle: إدراج صف مع التنسيق في Aspose.Cells .NET
second_title: واجهة برمجة تطبيقات معالجة Excel الخاصة بـ Aspose.Cells .NET
description: تعلم كيفية إدراج صف بتنسيق في Excel باستخدام Aspose.Cells for .NET. اتبع دليلنا خطوة بخطوة لسهولة التنفيذ.
weight: 24
url: /ar/net/row-and-column-management/insert-row-formatting-aspose-cells/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# إدراج صف مع التنسيق في Aspose.Cells .NET

## مقدمة
إذا سبق لك العمل باستخدام Excel، فأنت تعلم مدى أهمية الحفاظ على تنسيق بياناتك أثناء إجراء التغييرات. سواء كنت تضيف صفوفًا أو أعمدة جديدة أو تجري أي تحديثات، فإن الحفاظ على مظهر وشكل جدول البيانات الخاص بك أمر ضروري لسهولة القراءة والاحترافية. في هذا البرنامج التعليمي، سنشرح كيفية إدراج صف بتنسيق باستخدام Aspose.Cells لـ .NET. استعد لأننا نتعمق في التفاصيل خطوة بخطوة!
## المتطلبات الأساسية
قبل أن نبدأ، تأكد من أن لديك ما يلي:
1.  Aspose.Cells for .NET: يمكنك تنزيله[هنا](https://releases.aspose.com/cells/net/).
2. بيئة تطوير .NET: يمكنك استخدام Visual Studio أو أي بيئة تطوير متكاملة أخرى من اختيارك.
3. الفهم الأساسي للغة C#: إن القليل من الألفة مع لغة C# سوف يساعدك كثيرًا في فهم الكود.
## استيراد الحزم
للبدء في استخدام Aspose.Cells في مشروعك، تحتاج إلى استيراد الحزم اللازمة. إليك كيفية القيام بذلك:
1. تثبيت حزمة Aspose.Cells: افتح وحدة التحكم في إدارة الحزم NuGet وقم بتشغيل الأمر التالي:
```bash
Install-Package Aspose.Cells
```
2. إضافة استخدام التوجيهات: في الجزء العلوي من ملف C# الخاص بك، قم بتضمين المساحات التالية:
```csharp
using System.IO;
using Aspose.Cells;
```
الآن بعد أن قمنا بتغطية المتطلبات الأساسية واستيراد الحزم، دعنا ننتقل إلى الدليل خطوة بخطوة لإدراج صف مع التنسيق!
## الخطوة 1: إعداد دليل المستندات الخاص بك
 أولاً وقبل كل شيء، عليك تعيين المسار إلى الدليل الذي يوجد به ملف Excel الخاص بك. هذا هو المكان الذي`book1.xls` سيتم تخزين الملف أو الوصول إليه. 
```csharp
// المسار إلى دليل المستندات.
string dataDir = "Your Document Directory";
```
 يستبدل`"Your Document Directory"` مع المسار الفعلي على جهاز الكمبيوتر الخاص بك حيث يتم حفظ ملف Excel. وهذا يضمن أن التطبيق الخاص بك يعرف مكان البحث عن الملف.
## الخطوة 2: إنشاء تدفق ملف
بعد ذلك، سنقوم بإنشاء مجرى ملف لفتح ملف Excel. وهذا أمر بالغ الأهمية لأنه يسمح لنا بقراءة المصنف وتعديله.
```csharp
// إنشاء مجرى ملف يحتوي على ملف Excel الذي سيتم فتحه
FileStream fstream = new FileStream(dataDir + "book1.xls", FileMode.Open);
```
 هنا، نحن نفتح`book1.xls` الملف في وضع القراءة. تأكد من وجود الملف في الدليل المحدد؛ وإلا فسوف تواجه خطأ.
## الخطوة 3: إنشاء مثيل لكائن المصنف
 الآن، دعنا ننشئ مثيلًا لـ`Workbook`الفئة التي تمثل ملف Excel الذي سنعمل عليه.
```csharp
// إنشاء كائن مصنف
// فتح ملف Excel من خلال مجرى الملف
Workbook workbook = new Workbook(fstream);
```
يقوم هذا السطر بتهيئة كائن المصنف وفتحه باستخدام مجرى الملف الذي أنشأناه للتو.
## الخطوة 4: الوصول إلى ورقة العمل
لإجراء التغييرات، نحتاج إلى الوصول إلى ورقة العمل المحددة داخل المصنف. في هذا المثال، سنستخدم ورقة العمل الأولى.
```csharp
// الوصول إلى ورقة العمل الأولى في ملف Excel
Worksheet worksheet = workbook.Worksheets[0];
```
يتم فهرسة أوراق العمل في Excel بدءًا من 0. هنا، نقوم بالوصول إلى ورقة العمل الأولى، والتي تقع عند الفهرس 0.
## الخطوة 5: تعيين خيارات التنسيق
 بعد ذلك، نحتاج إلى تحديد كيفية إدخال الصف الجديد. سنستخدم`InsertOptions` لتحديد أننا نريد نسخ التنسيق من الصف أعلاه.
```csharp
// ضبط خيارات التنسيق
InsertOptions insertOptions = new InsertOptions();
insertOptions.CopyFormatType = CopyFormatType.SameAsAbove;
```
 عن طريق الإعداد`CopyFormatType` ل`SameAsAbove`سيتم تطبيق أي تنسيق (مثل الخط واللون والحدود) من الصف الموجود أعلى نقطة الإدراج مباشرة على الصف الجديد.
## الخطوة 6: إدراج الصف
الآن، أصبحنا مستعدين لإدراج الصف في ورقة العمل. سنضعه في الموضع الثالث (المؤشر 2، لأنه يعتمد على الصفر).
```csharp
// إدراج صف في ورقة العمل في الموضع الثالث
worksheet.Cells.InsertRows(2, 1, insertOptions);
```
يقوم هذا الأمر بإدراج صف جديد في الموضع المحدد أثناء تطبيق خيارات التنسيق التي قمنا بتعيينها للتو. إنه مثل السحر - يظهر الصف الجديد بكل الأنماط الصحيحة!
## الخطوة 7: احفظ ملف Excel المعدّل
بعد إجراء التغييرات، من المهم حفظ المصنف للحفاظ على تعديلاتك. 
```csharp
// حفظ ملف Excel المعدل
workbook.Save(dataDir + "InsertingARowWithFormatting.out.xls");
```
 هنا، نقوم بحفظ المصنف المعدّل تحت اسم جديد،`InsertingARowWithFormatting.out.xls`لتجنب الكتابة فوق الملف الأصلي. بهذه الطريقة، يمكنك دائمًا الرجوع إلى الملف الأصلي إذا لزم الأمر!
## الخطوة 8: إغلاق مجرى الملف
أخيرًا، دعنا ننظف عن طريق إغلاق مجرى الملفات. هذه ممارسة جيدة لتحرير الموارد.
```csharp
// إغلاق مجرى الملف لتحرير كافة الموارد
fstream.Close();
```
من خلال إغلاق الدفق، يمكنك التأكد من تحرير جميع الموارد المستخدمة أثناء العملية بشكل صحيح، مما يمنع تسرب الذاكرة.
## خاتمة
والآن، لقد تعلمت للتو كيفية إدراج صف بتنسيق في ملف Excel باستخدام Aspose.Cells for .NET. لا تسمح لك هذه الطريقة بالحفاظ على جمالية جداول البيانات فحسب، بل إنها تعزز أيضًا إنتاجيتك من خلال أتمتة المهام المتكررة. في المرة القادمة التي تواجه فيها الحاجة إلى تعديل جداول Excel، تذكر هذه الخطوات، وستكون مجهزًا جيدًا للتعامل معها كمحترف!
## الأسئلة الشائعة
### ما هو Aspose.Cells لـ .NET؟
Aspose.Cells for .NET هي مكتبة قوية تسمح للمطورين بإنشاء ملفات Excel ومعالجتها وتحويلها في تطبيقات .NET دون الحاجة إلى تثبيت Microsoft Excel.
### هل يمكنني إدراج صفوف متعددة في وقت واحد؟
 نعم! يمكنك تعديل`InsertRows` طريقة لإدراج صفوف متعددة عن طريق تغيير المعلمة الثانية إلى العدد المطلوب من الصفوف التي تريد إدراجها.
### هل من الضروري إغلاق مجرى الملف؟
نعم، من المهم إغلاق مجرى الملف لتحرير أي موارد يحتفظ بها المجرى ومنع تسرب الذاكرة.
### ما هي التنسيقات التي يمكنني حفظ ملف Excel المعدل بها؟
يدعم Aspose.Cells تنسيقات مختلفة، بما في ذلك XLSX، وCSV، وPDF، وغيرها.
### كيف يمكنني معرفة المزيد عن ميزات Aspose.Cells؟
 يمكنك استكشاف المزيد من الميزات والوظائف من خلال زيارة[التوثيق](https://reference.aspose.com/cells/net/).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
