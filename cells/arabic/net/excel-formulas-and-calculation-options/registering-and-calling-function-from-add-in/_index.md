---
title: تسجيل واستدعاء الوظيفة من الوظيفة الإضافية في Excel
linktitle: تسجيل واستدعاء الوظيفة من الوظيفة الإضافية في Excel
second_title: واجهة برمجة تطبيقات معالجة Excel الخاصة بـ Aspose.Cells .NET
description: اكتشف كيفية تسجيل واستدعاء الوظائف من الوظائف الإضافية في Excel باستخدام Aspose.Cells for .NET من خلال البرنامج التعليمي السهل خطوة بخطوة.
weight: 20
url: /ar/net/excel-formulas-and-calculation-options/registering-and-calling-function-from-add-in/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# تسجيل واستدعاء الوظيفة من الوظيفة الإضافية في Excel

## مقدمة
هل تريد تحسين تجربتك مع Excel من خلال استدعاء وظائف من وظيفة إضافية؟ إذا كانت الإجابة بنعم، فأنت في المكان الصحيح! الوظائف الإضافية في Excel تشبه العرابات الجنيات لجداول البيانات؛ فهي تعمل على توسيع الوظائف بطريقة سحرية، مما يمنحك مجموعة من الأدوات الجديدة في متناول يدك. ومع Aspose.Cells for .NET، أصبح تسجيل هذه الوظائف الإضافية واستخدامها أسهل من أي وقت مضى. 
في هذا الدليل، سأشرح لك عملية تسجيل واستدعاء دالة من وظيفة إضافية في Excel باستخدام Aspose.Cells for .NET. وسنوضح لك كل شيء خطوة بخطوة، حتى تشعر وكأنك محترف في وقت قصير!
## المتطلبات الأساسية
قبل أن نتعمق في سحر الترميز، دعنا نغطي ما تحتاج إلى توفره:
1. Visual Studio: تأكد من تثبيت Visual Studio على جهازك. هذا هو المكان الذي سنكتب فيه ونشغل فيه الكود الخاص بنا.
2.  مكتبة Aspose.Cells: ستحتاج إلى تثبيت مكتبة Aspose.Cells. يمكنك الحصول عليها من موقعها[صفحة التحميل](https://releases.aspose.com/cells/net/).
3. المعرفة الأساسية بلغة C#: إن فهم القليل من لغة C# سوف يساعدك كثيرًا؛ حيث سيساعدك على المتابعة بسلاسة.
4.  الوظائف الإضافية لبرنامج Excel: يجب أن يكون لديك ملف الوظيفة الإضافية (مثل`.xlam`) الذي يحتوي على الوظائف التي تريد تسجيلها واستخدامها.
5.  مثال على إضافة Excel: في هذا البرنامج التعليمي، سنستخدم إضافة Excel باسم`TESTUDF.xlam`لذا تأكد من توفر هذا في متناول يدك!
الآن بعد أن قمت بالإعداد، فلنبدأ في البرمجة!
## استيراد الحزم
للبدء، ستحتاج إلى استيراد بعض المساحات الأساسية في أعلى ملف C# الخاص بك. إليك ما تحتاج إلى تضمينه:
```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```
ستسمح لك هذه المساحات الاسمية بالوصول إلى الفئات والطرق التي سنستخدمها في هذا البرنامج التعليمي.
دعنا نقسم هذا إلى خطوات يمكن إدارتها. بحلول نهاية هذا الدليل، ستكون لديك فكرة واضحة عن كيفية تسجيل وظائف الإضافة واستخدامها في مصنفات Excel الخاصة بك.
## الخطوة 1: إعداد أدلة المصدر والإخراج
قبل أن تتمكن من تسجيل الوظيفة الإضافية الخاصة بك، يتعين عليك تحديد المكان الذي ستتواجد فيه ملفات الوظيفة الإضافية والملفات الناتجة.
```csharp
// دليل المصدر
string sourceDir = "Your Document Directory";
// دليل الإخراج
string outputDir = "Your Document Directory";
```
 يستبدل`"Your Document Directory"` مع المسار الفعلي الذي تريده`.xlam` سيتم حفظ الملفات والملفات الناتجة. وهذا يشبه تمامًا إعداد المسرح قبل بدء العرض.
## الخطوة 2: إنشاء مصنف فارغ
بعد ذلك، ستحتاج إلى إنشاء مصنف فارغ حيث يمكننا اللعب بالوظائف الإضافية.
```csharp
// إنشاء مصنف فارغ
Workbook workbook = new Workbook();
```
يؤدي هذا السطر من التعليمات البرمجية إلى إنشاء مصنف عمل جديد سيعمل كملعب لنا. فكر فيه كلوحة قماشية جديدة جاهزة لضرباتك الإبداعية.
## الخطوة 3: تسجيل وظيفة الإضافة
الآن، دعنا ننتقل إلى لب الموضوع! لقد حان الوقت لتسجيل وظيفة الإضافة الخاصة بك. وإليك كيفية القيام بذلك:
```csharp
// تسجيل الوظيفة الإضافية الممكّنة للماكرو مع اسم الوظيفة
int id = workbook.Worksheets.RegisterAddInFunction(sourceDir + @"TESTUDF.xlam", "TEST_UDF", false);
```
 يسجل هذا السطر وظيفة الإضافة المسماة`TEST_UDF` وجدت في`TESTUDF.xlam` ملف الإضافة.`false`تعني المعلمة أن الوظيفة الإضافية لم يتم تحميلها في وضع "معزول". 
## الخطوة 4: تسجيل الوظائف الإضافية (إن وجدت)
إذا كان لديك المزيد من الوظائف المسجلة في نفس ملف الوظيفة الإضافية، فيمكنك تسجيلها أيضًا!
```csharp
// تسجيل المزيد من الوظائف في الملف (إن وجدت)
workbook.Worksheets.RegisterAddInFunction(id, "TEST_UDF1");
```
هنا، يمكنك أن ترى مدى سهولة إضافة المزيد من الوظائف من نفس الوظيفة الإضافية. فقط استمر في تكديسها مثل كتل البناء!
## الخطوة 5: الوصول إلى ورقة العمل
دعنا ننتقل إلى الوصول إلى ورقة العمل التي سنستخدم فيها وظيفتنا. 
```csharp
// الوصول إلى ورقة العمل الأولى
Worksheet worksheet = workbook.Worksheets[0];
```
نحن ننتقل الآن إلى ورقة العمل الأولى في المصنف لوضع الصيغة الخاصة بنا. الأمر أشبه بفتح باب الغرفة حيث تحدث المتعة.
## الخطوة 6: الوصول إلى خلية محددة
بعد ذلك، نحتاج إلى اختيار الخلية التي نريد استخدامها لصيغتنا. 
```csharp
// الوصول إلى الخلية الأولى
var cell = worksheet.Cells["A1"];
```
هنا نشير إلى الخلية A1. هذا هو المكان الذي سنضع فيه معادلتنا السحرية. يمكنك أن تفكر في الأمر وكأنه تحديد هدف على خريطة الكنز الخاصة بك!
## الخطوة 7: تعيين الصيغة
الآن حان وقت الكشف الكبير! فلنقم بإعداد الصيغة التي تستدعي الدالة المسجلة.
```csharp
// تعيين اسم الصيغة الموجودة في الوظيفة الإضافية
cell.Formula = "=TEST_UDF()";
```
باستخدام هذا السطر، نطلب من Excel استخدام الدالة الموجودة داخل الخلية A1. الأمر أشبه بإعطاء Excel أمرًا والقول له، "مرحبًا، افعل هذا!"
## الخطوة 8: احفظ المصنف
وأخيرًا وليس آخرًا، حان الوقت لإنقاذ تحفتنا الفنية.
```csharp
// احفظ المصنف لإخراج تنسيق XLSX.
workbook.Save(outputDir + @"test_udf.xlsx", Aspose.Cells.SaveFormat.Xlsx);
```
هنا، نقوم بحفظ مصنف العمل الخاص بنا كملف XLSX. هذه الخطوة الأخيرة تشبه وضع اللوحة في إطار والاستعداد لعرضها!
## الخطوة 9: تأكيد التنفيذ
أخيرًا، دعنا نختتم كل هذا بطباعة رسالة نجاح على وحدة التحكم.
```csharp
Console.WriteLine("RegisterAndCallFuncFromAddIn executed successfully.");
```
يعمل هذا الخط كعلم النصر لدينا. إنه لمسة صغيرة لطيفة لتأكيد أن كل شيء سار بسلاسة.
## خاتمة 
والآن، لقد انتهيت! لم تتعلم فقط كيفية تسجيل واستدعاء الوظائف من الوظائف الإضافية لبرنامج Excel باستخدام Aspose.Cells لـ .NET، بل اكتسبت أيضًا فهمًا أعمق لكل خطوة متضمنة. أصبحت الحياة أسهل قليلاً الآن، أليس كذلك؟ فلماذا لا تجربها بنفسك؟ انغمس في تلك الوظائف الإضافية لبرنامج Excel وامنح جداول البيانات الخاصة بك مستوى جديدًا من التفاعلية والوظائف.
## الأسئلة الشائعة
### ما هي الوظيفة الإضافية لبرنامج Excel؟  
الوظيفة الإضافية لـ Excel عبارة عن برنامج يضيف ميزات أو وظائف أو أوامر مخصصة إلى Excel، مما يسمح للمستخدمين بتوسيع قدراته.
### هل يمكنني استخدام Aspose.Cells دون تثبيته محليًا؟  
لا، يتعين عليك تثبيت مكتبة Aspose.Cells لاستخدامها في تطبيقات .NET الخاصة بك.
### كيف يمكنني الحصول على ترخيص مؤقت لـ Aspose.Cells؟  
 يمكنك زيارتهم[صفحة الترخيص المؤقت](https://purchase.aspose.com/temporary-license/) لمزيد من المعلومات.
### هل من الممكن استدعاء وظائف متعددة من وظيفة إضافية واحدة؟  
 نعم! يمكنك تسجيل وظائف متعددة من نفس ملف الوظيفة الإضافية باستخدام`RegisterAddInFunction` طريقة.
### أين يمكنني العثور على مزيد من الوثائق حول Aspose.Cells؟  
 يمكنك استكشاف وثائقهم الشاملة على الموقع[هنا](https://reference.aspose.com/cells/net/).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
