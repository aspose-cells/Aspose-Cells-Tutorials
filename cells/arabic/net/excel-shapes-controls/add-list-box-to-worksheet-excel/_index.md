---
"description": "تعرّف على كيفية إضافة مربع قائمة إلى ورقة عمل Excel باستخدام Aspose.Cells لـ .NET. اتبع دليلنا السهل خطوة بخطوة لجعل أوراق عمل Excel تفاعلية."
"linktitle": "إضافة مربع القائمة إلى ورقة العمل في Excel"
"second_title": "واجهة برمجة تطبيقات معالجة Excel Aspose.Cells .NET"
"title": "إضافة مربع القائمة إلى ورقة العمل في Excel"
"url": "/ar/net/excel-shapes-controls/add-list-box-to-worksheet-excel/"
"weight": 20
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# إضافة مربع القائمة إلى ورقة العمل في Excel

## مقدمة
إضافة عناصر تفاعلية إلى أوراق عمل Excel، مثل مربع القائمة، يُحسّن إدارة البيانات وعرضها بشكل ملحوظ. سواءً كنت تُنشئ نموذجًا تفاعليًا أو أداة إدخال بيانات مخصصة، فإن إمكانية التحكم في إدخال المستخدم باستخدام مربع القائمة لا تُقدر بثمن. يُوفر Aspose.Cells for .NET طريقة فعّالة لإضافة عناصر التحكم هذه وإدارتها في ملفات Excel. في هذا الدليل، سنشرح لك عملية إضافة مربع قائمة إلى ورقة عمل باستخدام Aspose.Cells for .NET.
## المتطلبات الأساسية
قبل التعمق في البرمجة، تأكد من أن لديك الأدوات والموارد التالية:
- مكتبة Aspose.Cells لـ .NET: يمكنك تنزيلها من [صفحة تنزيل Aspose.Cells لـ .NET](https://releases.aspose.com/cells/net/).
- بيئة التطوير: أي بيئة تطوير متكاملة تدعم تطوير .NET، مثل Visual Studio.
- .NET Framework: تأكد من أن مشروعك يستهدف إصدارًا مدعومًا من إطار عمل .NET.
أيضا، فكر في الحصول على [رخصة مؤقتة](https://purchase.aspose.com/temporary-license/) إذا كنت تريد استكشاف كافة الميزات دون قيود.
## استيراد الحزم
قبل البدء، تأكد من استيراد مساحات أسماء Aspose.Cells اللازمة. إليك كيفية القيام بذلك:
```csharp
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Drawing;
```
في هذا البرنامج التعليمي، سنُقسّم عملية إضافة مربع قائمة إلى عدة خطوات بسيطة. اتبع كل خطوة بدقة لضمان سير كل شيء كما هو متوقع.
## الخطوة 1: إعداد دليل المستندات الخاص بك
قبل إنشاء أي ملف إكسل، ستحتاج إلى تحديد مكان لحفظه. إليك كيفية إعداد المجلد:
```csharp
// المسار إلى دليل المستندات.
string dataDir = "Your Document Directory";
// إنشاء الدليل إذا لم يكن موجودًا بالفعل.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
في هذه الخطوة، ستحدد مكان تخزين ملفك. يتحقق الكود من وجود الدليل، وإن لم يكن موجودًا، يُنشئه لك. هذا يضمن عدم مواجهة أي أخطاء "الملف غير موجود" لاحقًا.
## الخطوة 2: إنشاء مصنف جديد والوصول إلى ورقة العمل الأولى
بعد ذلك، سنقوم بإنشاء مصنف جديد والوصول إلى ورقة العمل الأولى حيث سنضيف مربع القائمة الخاص بنا.
```csharp
// إنشاء مصنف جديد.
Workbook workbook = new Workbook();
// احصل على ورقة العمل الأولى.
Worksheet sheet = workbook.Worksheets[0];
```
المصنف هو في الأساس ملف إكسل. هنا، نقوم بإنشاء مصنف جديد والوصول إلى ورقة العمل الأولى، حيث سنضع مربع القائمة. تخيل هذا كإنشاء لوحة فارغة لرسم عناصر التحكم.
## الخطوة 3: إدخال البيانات لمربع القائمة
قبل أن نضيف مربع القائمة، نحتاج إلى ملء بعض البيانات التي سيشير إليها مربع القائمة.
```csharp
// احصل على مجموعة خلايا ورقة العمل.
Cells cells = sheet.Cells;
// أدخل قيمة للتسمية.
cells["B3"].PutValue("Choose Dept:");
// ضبط العلامة على الخط العريض.
cells["B3"].GetStyle().Font.IsBold = true;
// قيم الإدخال لمربع القائمة.
cells["A2"].PutValue("Sales");
cells["A3"].PutValue("Finance");
cells["A4"].PutValue("MIS");
cells["A5"].PutValue("R&D");
cells["A6"].PutValue("Marketing");
cells["A7"].PutValue("HRA");
```
هنا، نضيف نصًا إلى ورقة العمل. وُضع عنوان "اختيار القسم:" في الخلية B3، وخطه عريض. في العمود A، نُدخل قيمًا تُمثل نطاق الإدخال لمربع القائمة، مُمثلةً أقسامًا مختلفة. هذا النطاق هو ما سيختاره المستخدمون عند التفاعل مع مربع القائمة.
## الخطوة 4: إضافة مربع القائمة إلى ورقة العمل
الآن بعد أن قمنا بإعداد البيانات، فلنقم بإضافة عنصر التحكم في مربع القائمة نفسه.
```csharp
// إضافة مربع قائمة جديد.
Aspose.Cells.Drawing.ListBox listBox = sheet.Shapes.AddListBox(2, 0, 3, 0, 122, 100);
```
يضيف هذا الكود مربع القائمة إلى ورقة العمل. تُحدد المعلمات موضع وحجم مربع القائمة. يقع مربع القائمة في الصف الثاني، العمود 0، بعرض 122 وارتفاع 100. هذه هي الإحداثيات والحجم اللذان يحددان مكان ظهور مربع القائمة في ورقة العمل.
## الخطوة 5: تعيين خصائص مربع القائمة
بعد ذلك، سنقوم بتعيين خصائص مختلفة لمربع القائمة لجعله يعمل بكامل طاقته.
```csharp
// تعيين نوع التنسيب.
listBox.Placement = PlacementType.FreeFloating;
// تعيين الخلية المرتبطة.
listBox.LinkedCell = "A1";
// تعيين نطاق الإدخال.
listBox.InputRange = "A2:A7";
// تعيين نوع الاختيار.
listBox.SelectionType = SelectionType.Single;
// تعيين مربع القائمة باستخدام التظليل ثلاثي الأبعاد.
listBox.Shadow = true;
```
- PlacementType.FreeFloating: تعمل هذه الخاصية على التأكد من بقاء مربع القائمة في موضعه بغض النظر عن كيفية تعديل ورقة العمل.
- LinkedCell: يؤدي هذا إلى تعيين خلية (في هذه الحالة، A1) حيث سيتم عرض القيمة المحددة من مربع القائمة.
- نطاق الإدخال: يخبر مربع القائمة بالمكان الذي يجب أن يبحث فيه عن قائمة الخيارات الخاصة به (من A2 إلى A7، والتي قمنا بتعيينها مسبقًا).
- SelectionType.Single: يقيد هذا المستخدم باختيار عنصر واحد فقط من مربع القائمة.
- الظل: يمنح تأثير الظل مربع القائمة مظهرًا ثلاثي الأبعاد أكثر، مما يجعله جذابًا بصريًا.
## الخطوة 6: حفظ ملف Excel
أخيرًا، دعنا نحفظ مصنفنا مع تضمين مربع القائمة.
```csharp
// احفظ المصنف.
workbook.Save(dataDir + "book1.out.xls");
```
هذا السطر من التعليمات البرمجية يحفظ المصنف في المجلد الذي أنشأناه سابقًا. اسم الملف "book1.out.xls"، ولكن يمكنك اختيار أي اسم يناسب مشروعك.
## خاتمة
وها قد انتهيت! لقد نجحت في إضافة مربع قائمة إلى ورقة عمل Excel باستخدام Aspose.Cells لـ .NET. ببضعة أسطر برمجية فقط، أنشأنا مربع قائمة متكامل الوظائف، مما يجعل ورقة العمل أكثر تفاعلية وديناميكية. سيمنحك هذا البرنامج التعليمي أساسًا متينًا لاستكشاف عناصر التحكم والميزات الأخرى في Aspose.Cells لـ .NET. استمر في التجربة، وسرعان ما ستتقن وظائف المكتبة الواسعة!
## الأسئلة الشائعة
### هل يمكنني السماح باختيارات متعددة في مربع القائمة؟  
نعم يمكنك تغيير `SelectionType` ل `SelectionType.Multi` للسماح باختيارات متعددة.
### هل يمكنني تغيير مظهر مربع القائمة؟  
بالتأكيد! يتيح لك Aspose.Cells تخصيص مظهر مربع القائمة، بما في ذلك الحجم والخط وحتى اللون.
### ماذا لو كنت بحاجة إلى إزالة مربع القائمة لاحقًا؟  
يمكنك الوصول إلى مربع القائمة وإزالته من `Shapes` جمع باستخدام `sheet.Shapes.RemoveAt(index)`.
### هل يمكنني ربط مربع القائمة بخلية مختلفة؟  
نعم، قم بتغيير فقط `LinkedCell` نقل الخاصية إلى أي خلية أخرى تريد عرض القيمة المحددة فيها.
### كيف أضيف المزيد من العناصر إلى مربع القائمة؟  
كل ما عليك فعله هو تحديث نطاق الإدخال عن طريق إدراج المزيد من القيم في الخلايا المحددة، وسيتم تحديث مربع القائمة تلقائيًا.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}