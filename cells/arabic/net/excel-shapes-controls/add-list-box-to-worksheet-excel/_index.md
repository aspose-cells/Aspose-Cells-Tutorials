---
title: إضافة مربع القائمة إلى ورقة العمل في Excel
linktitle: إضافة مربع القائمة إلى ورقة العمل في Excel
second_title: واجهة برمجة تطبيقات معالجة Excel الخاصة بـ Aspose.Cells .NET
description: تعرف على كيفية إضافة مربع قائمة إلى ورقة عمل Excel باستخدام Aspose.Cells for .NET. اتبع دليلنا السهل خطوة بخطوة واجعل أوراق عمل Excel الخاصة بك تفاعلية.
weight: 20
url: /ar/net/excel-shapes-controls/add-list-box-to-worksheet-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# إضافة مربع القائمة إلى ورقة العمل في Excel

## مقدمة
إن إضافة عناصر تفاعلية إلى أوراق عمل Excel، مثل مربع القائمة، يمكن أن يحسن إدارة البيانات وعرضها بشكل كبير. سواء كنت تقوم بإنشاء نموذج تفاعلي أو أداة إدخال بيانات مخصصة، فإن القدرة على التحكم في إدخال المستخدم باستخدام مربع القائمة لا تقدر بثمن. يوفر Aspose.Cells for .NET طريقة فعّالة لإضافة عناصر التحكم هذه وإدارتها في ملفات Excel. في هذا الدليل، سنرشدك خلال عملية إضافة مربع القائمة إلى ورقة عمل باستخدام Aspose.Cells for .NET.
## المتطلبات الأساسية
قبل التعمق في الترميز، تأكد من أن لديك الأدوات والموارد التالية:
-  مكتبة Aspose.Cells لـ .NET: يمكنك تنزيلها من[صفحة تنزيل Aspose.Cells لـ .NET](https://releases.aspose.com/cells/net/).
- بيئة التطوير: أي بيئة تطوير متكاملة تدعم تطوير .NET، مثل Visual Studio.
- .NET Framework: تأكد من أن مشروعك يستهدف إصدارًا مدعومًا من إطار عمل .NET.
 أيضًا، فكر في الحصول على[رخصة مؤقتة](https://purchase.aspose.com/temporary-license/) إذا كنت تريد استكشاف كافة الميزات دون قيود.
## استيراد الحزم
قبل البدء، تأكد من استيراد مساحات الأسماء Aspose.Cells الضرورية. وإليك كيفية القيام بذلك:
```csharp
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Drawing;
```
في هذا البرنامج التعليمي، سنقوم بتقسيم عملية إضافة مربع قائمة إلى عدة خطوات بسيطة. اتبع كل خطوة عن كثب للتأكد من أن كل شيء يعمل كما هو متوقع.
## الخطوة 1: إعداد دليل المستندات الخاص بك
قبل إنشاء أي ملف Excel، ستحتاج إلى تحديد مكان لحفظه. إليك كيفية إعداد الدليل:
```csharp
// المسار إلى دليل المستندات.
string dataDir = "Your Document Directory";
// إنشاء الدليل إذا لم يكن موجودًا بالفعل.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
في هذه الخطوة، تقوم بتحديد المكان الذي سيتم تخزين الملف فيه. يتحقق الكود من وجود الدليل، وإذا لم يكن موجودًا، فإنه ينشئ دليلًا لك. وهذا يضمن عدم مواجهة أي أخطاء "لم يتم العثور على الملف" لاحقًا.
## الخطوة 2: إنشاء مصنف جديد والوصول إلى ورقة العمل الأولى
بعد ذلك، سنقوم بإنشاء مصنف جديد والوصول إلى ورقة العمل الأولى حيث سنضيف مربع القائمة الخاص بنا.
```csharp
// إنشاء مصنف جديد.
Workbook workbook = new Workbook();
// احصل على ورقة العمل الأولى.
Worksheet sheet = workbook.Worksheets[0];
```
يُعد المصنف في الأساس ملف Excel الخاص بك. هنا، نقوم بإنشاء مصنف جديد والوصول إلى ورقة العمل الأولى، حيث سنضع مربع القائمة. فكر في هذا الأمر باعتباره إنشاء لوحة قماشية فارغة حيث ستقوم برسم عناصر التحكم.
## الخطوة 3: إدخال البيانات لمربع القائمة
قبل أن نضيف مربع القائمة، نحتاج إلى ملء بعض البيانات التي سيشير إليها مربع القائمة.
```csharp
// احصل على مجموعة خلايا أوراق العمل.
Cells cells = sheet.Cells;
// أدخل قيمة للتسمية.
cells["B3"].PutValue("Choose Dept:");
// ضبط الملصق إلى الخط العريض.
cells["B3"].GetStyle().Font.IsBold = true;
// قيم الإدخال لمربع القائمة.
cells["A2"].PutValue("Sales");
cells["A3"].PutValue("Finance");
cells["A4"].PutValue("MIS");
cells["A5"].PutValue("R&D");
cells["A6"].PutValue("Marketing");
cells["A7"].PutValue("HRA");
```
هنا، نضيف بعض النصوص إلى ورقة العمل. يتم وضع العلامة "Choose Dept:" في الخلية B3، ويتم ضبط الخط على غامق. في العمود A، نقوم بإدراج القيم التي ستكون بمثابة نطاق الإدخال لقائمتنا، والتي تمثل أقسامًا مختلفة. نطاق الإدخال هذا هو ما سيختاره المستخدمون عند التفاعل مع قائمة الإدخال.
## الخطوة 4: إضافة مربع القائمة إلى ورقة العمل
الآن بعد أن قمنا بإعداد البيانات، فلنقم بإضافة عنصر التحكم في قائمة المربع نفسها.
```csharp
// إضافة قائمة مربعة جديدة.
Aspose.Cells.Drawing.ListBox listBox = sheet.Shapes.AddListBox(2, 0, 3, 0, 122, 100);
```
يضيف هذا الكود مربع القائمة إلى ورقة العمل. تحدد المعلمات موضع وحجم مربع القائمة. يقع مربع القائمة في الصف 2، العمود 0 بعرض 122 وارتفاع 100. هذه هي الإحداثيات والحجم التي تحدد مكان ظهور مربع القائمة في ورقة العمل.
## الخطوة 5: تعيين خصائص مربع القائمة
بعد ذلك، سنقوم بتعيين خصائص مختلفة لمربع القائمة لجعله يعمل بكامل طاقته.
```csharp
// تعيين نوع التنسيب.
listBox.Placement = PlacementType.FreeFloating;
// تعيين الخلية المرتبطة.
listBox.LinkedCell = "A1";
// تعيين نطاق الإدخال.
listBox.InputRange = "A2:A7";
// تعيين نوع الاختيار.
listBox.SelectionType = SelectionType.Single;
// تعيين مربع القائمة باستخدام التظليل ثلاثي الأبعاد.
listBox.Shadow = true;
```
- PlacementType.FreeFloating: تعمل هذه الخاصية على التأكد من بقاء مربع القائمة في موضعه بغض النظر عن كيفية تعديل ورقة العمل.
- LinkedCell: يؤدي هذا إلى تحديد خلية (في هذه الحالة، A1) حيث سيتم عرض القيمة المحددة من مربع القائمة.
- نطاق الإدخال: يخبر مربع القائمة بالمكان الذي يجب أن يبحث فيه عن قائمة الخيارات الخاصة به (من A2 إلى A7، والتي قمنا بتعيينها مسبقًا).
- SelectionType.Single: يقيد هذا المستخدم باختيار عنصر واحد فقط من مربع القائمة.
- الظل: يعطي تأثير الظل لمربع القائمة مظهرًا أكثر ثلاثي الأبعاد، مما يجعله جذابًا بصريًا.
## الخطوة 6: حفظ ملف Excel
وأخيرًا، دعونا نحفظ المصنف الخاص بنا مع تضمين مربع القائمة.
```csharp
// احفظ المصنف.
workbook.Save(dataDir + "book1.out.xls");
```
يحفظ هذا السطر من التعليمات البرمجية المصنف في الدليل الذي قمنا بإعداده مسبقًا. يُسمى الملف "book1.out.xls"، ولكن يمكنك اختيار أي اسم يناسب مشروعك.
## خاتمة
والآن، لقد نجحت في إضافة مربع قائمة إلى ورقة عمل Excel باستخدام Aspose.Cells for .NET. فباستخدام بضعة أسطر فقط من التعليمات البرمجية، قمنا بإنشاء مربع قائمة يعمل بكامل طاقته، مما يجعل ورقة العمل أكثر تفاعلية وديناميكية. يجب أن يمنحك هذا البرنامج التعليمي أساسًا قويًا لاستكشاف عناصر التحكم والميزات الأخرى في Aspose.Cells for .NET. استمر في التجربة، وسرعان ما ستتقن الوظائف الواسعة للمكتبة!
## الأسئلة الشائعة
### هل يمكنني السماح باختيارات متعددة في مربع القائمة؟  
 نعم يمكنك تغيير`SelectionType` ل`SelectionType.Multi` للسماح باختيارات متعددة.
### هل يمكنني تغيير مظهر مربع القائمة؟  
بالتأكيد! يتيح لك Aspose.Cells تخصيص مظهر مربع القائمة، بما في ذلك حجمه وخطه وحتى لونه.
### ماذا لو كنت بحاجة إلى إزالة مربع القائمة لاحقًا؟  
 يمكنك الوصول إلى مربع القائمة وإزالته من`Shapes` جمع باستخدام`sheet.Shapes.RemoveAt(index)`.
### هل يمكنني ربط مربع القائمة بخلية مختلفة؟  
 نعم، قم بتغيير ببساطة`LinkedCell` نقل الخاصية إلى أي خلية أخرى تريد عرض القيمة المحددة فيها.
### كيف أضيف المزيد من العناصر إلى مربع القائمة؟  
كل ما عليك فعله هو تحديث نطاق الإدخال عن طريق إدراج المزيد من القيم في الخلايا المحددة، وسيتم تحديث مربع القائمة تلقائيًا.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
