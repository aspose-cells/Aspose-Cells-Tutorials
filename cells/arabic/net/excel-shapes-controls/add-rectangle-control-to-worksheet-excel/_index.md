---
title: إضافة عنصر التحكم المستطيل إلى ورقة العمل في Excel
linktitle: إضافة عنصر التحكم المستطيل إلى ورقة العمل في Excel
second_title: واجهة برمجة تطبيقات معالجة Excel الخاصة بـ Aspose.Cells .NET
description: تعرف على كيفية إضافة عنصر تحكم مستطيل إلى ورقة عمل Excel باستخدام Aspose.Cells for .NET من خلال دليل مفصل خطوة بخطوة.
weight: 25
url: /ar/net/excel-shapes-controls/add-rectangle-control-to-worksheet-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# إضافة عنصر التحكم المستطيل إلى ورقة العمل في Excel

## مقدمة
عندما يتعلق الأمر بأتمتة مهام Excel، فإن Aspose.Cells for .NET هي أداة قوية يمكنها مساعدتك في تحقيق مجموعة متنوعة من الأهداف، أحدها إضافة أشكال مثل المستطيلات إلى أوراق العمل الخاصة بك. في هذا الدليل، سنستكشف كيفية إضافة عنصر تحكم مستطيل إلى ورقة عمل Excel باستخدام Aspose.Cells for .NET. بحلول النهاية، ستتمكن من إنشاء وتخصيص وحفظ ورقة عمل مع عنصر تحكم مستطيل مضمن فيها.
ولكن قبل الغوص في هذا الموضوع، دعونا نتحدث عن المتطلبات الأساسية.
## المتطلبات الأساسية
لمتابعة هذا البرنامج التعليمي، تأكد من توفر المتطلبات الأساسية التالية:
1.  مكتبة Aspose.Cells لـ .NET: إذا لم تقم بذلك بالفعل،[تنزيل المكتبة](https://releases.aspose.com/cells/net/) أو قم بتثبيته باستخدام NuGet في Visual Studio.
2. .NET Framework: يجب أن يكون لديك بيئة تطوير .NET مُعدّة على جهازك.
3. المعرفة الأساسية بلغة C#: على الرغم من أننا سنرشدك خطوة بخطوة، فإن المعرفة الأساسية بلغة C# والبرمجة الموجهة للكائنات مفيدة.
4.  الترخيص: يعمل استخدام Aspose.Cells في وضع التقييم بشكل جيد للمهام الأساسية، ولكن للحصول على الوظائف الكاملة، فكر في الحصول على[رخصة مؤقتة](https://purchase.aspose.com/temporary-license/)أو شراء واحدة من[هنا](https://purchase.aspose.com/buy).
الآن، دعونا نتعمق في الكود!
## استيراد الحزم
للبدء في استخدام Aspose.Cells، تأكد من استيراد المساحات الأساسية اللازمة إلى مشروعك. ستتيح لك عمليات الاستيراد هذه الوصول إلى الفئات والطرق المختلفة التي تحتاجها للتفاعل مع ملفات Excel.
```csharp
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Drawing;
using System.Drawing;
```
تضمن هذه الأسطر أن يتمكن مشروعك من التفاعل مع أدلة الملفات (`System.IO`), مصنفات Excel (`Aspose.Cells`)، ورسم الشكل (`Aspose.Cells.Drawing`).
الآن، دعنا نقوم بتقسيم العملية إلى خطوات بسيطة حتى تتمكن من متابعتها بسهولة وتكرارها في مشاريعك الخاصة.
## الخطوة 1: إعداد مسار الدليل
أول شيء عليك القيام به هو تحديد الدليل الذي سيتم حفظ ملف Excel فيه. تضمن هذه الخطوة أن يعرف مشروعك مكان إنشاء ملف الإخراج وتخزينه.
### تعريف دليل البيانات
```csharp
// المسار إلى دليل المستندات.
string dataDir = "Your Document Directory";
```
 هنا، يمكنك تحديد مسار الدليل الذي سيتم تخزين ملف Excel فيه. يمكنك استبدال`"Your Document Directory"` مع المسار الفعلي على جهازك، أو قم بإنشاء مجلد بشكل ديناميكي إذا لم يكن موجودًا.
### التحقق من الدليل وإنشائه
```csharp
// إنشاء الدليل إذا لم يكن موجودًا بالفعل.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
يتحقق هذا المربع من وجود الدليل. وإذا لم يكن موجودًا، فإنه ينشئ دليلاً. فكر في الأمر كما لو كنت تقوم بإعداد خزانة الملفات الخاصة بك قبل تخزين أي مستندات.
## الخطوة 2: إنشاء مصنف جديد
 في هذه الخطوة، يمكنك إنشاء مصنف Excel جديد باستخدام`Aspose.Cells.Workbook` سيكون هذا بمثابة الحاوية لورقة العمل والأشكال الخاصة بك.
```csharp
// إنشاء مصنف جديد.
Workbook excelbook = new Workbook();
```
 من خلال الاتصال`Workbook` المنشئ، لديك الآن مصنف Excel فارغ جاهز للتخصيص.
## الخطوة 3: إضافة عنصر تحكم مستطيل
وهنا يحدث السحر. ستضيف شكل مستطيل إلى ورقة العمل الأولى في المصنف الخاص بك.
```csharp
// إضافة عنصر التحكم المستطيل.
Aspose.Cells.Drawing.RectangleShape rectangle = excelbook.Worksheets[0].Shapes.AddRectangle(3, 0, 2, 0, 70, 130);
```
دعونا نحلل هذا الأمر:
- `excelbook.Worksheets[0]`:يؤدي هذا إلى الوصول إلى ورقة العمل الأولى في المصنف الخاص بك.
- `.Shapes.AddRectangle(3, 0, 2, 0, 70, 130)`:يؤدي هذا إلى إضافة شكل مستطيل إلى ورقة العمل. تحدد المعلمات هنا الموضع (الصف والعمود)، بالإضافة إلى عرض المستطيل وارتفاعه.
## الخطوة 4: تخصيص المستطيل
إن مجرد إضافة مستطيل ليس كافيًا، بل ستحتاج إلى تخصيصه. في هذه الخطوة، سنقوم بتعيين موضع المستطيل ووزن الخط ونمط الشرطة.
### تحديد الموضع
```csharp
// ضبط موضع المستطيل.
rectangle.Placement = PlacementType.FreeFloating;
```
يشير هذا إلى أن المستطيل عائم حر، مما يعني أنه لن يكون مقيدًا بأبعاد الخلية.
### ضبط وزن الخط
```csharp
// ضبط وزن الخط.
rectangle.Line.Weight = 4;
```
هنا، قمنا بتعيين سمك خط المستطيل إلى 4 نقاط. كلما زاد الرقم، زاد سمك الخط.
### ضبط نمط لوحة القيادة
```csharp
// تعيين نمط الشرطة للمستطيل.
rectangle.Line.DashStyle = MsoLineDashStyle.Solid;
```
 يحدد هذا الخط نمط الخط المنقط لحدود المستطيل ليصبح صلبًا. يمكنك تجربة أنماط مختلفة مثل`Dash` أو`Dot` اعتمادا على متطلباتك.
## الخطوة 5: حفظ المصنف
بمجرد إضافة المستطيل وتخصيصه، تكون الخطوة الأخيرة هي حفظ المصنف في الدليل المحدد.
```csharp
// احفظ ملف Excel.
excelbook.Save(dataDir + "book1.out.xls");
```
 يؤدي هذا إلى حفظ المصنف كملف`.xls` الملف في المجلد الذي حددته مسبقًا. يمكنك تعديل تنسيق الملف عن طريق تغيير الامتداد، مثل`.xlsx` إذا كنت تفضل تنسيق Excel الأحدث.
## خاتمة
والآن، لقد انتهيت! إن إضافة عنصر تحكم مستطيل إلى ورقة عمل Excel باستخدام Aspose.Cells for .NET هي عملية بسيطة بمجرد تقسيمها خطوة بخطوة. سواء كنت بحاجة إلى إضافة أشكال لإضفاء مظهر جذاب، أو إبراز أقسام من بياناتك، أو تخصيص تقاريرك، فإن Aspose.Cells يمنحك المرونة للقيام بذلك برمجيًا.
يجب أن يكون هذا الدليل قد زودك بكل المعرفة التي تحتاجها لبدء إضافة أشكال مثل المستطيلات إلى جداول Excel الخاصة بك باستخدام Aspose.Cells. حان الوقت الآن للتجربة ومعرفة ما يمكنك تحقيقه باستخدام هذه المكتبة القوية!
## الأسئلة الشائعة
### هل يمكنني إضافة أشكال أخرى مثل الدوائر أو الخطوط باستخدام Aspose.Cells لـ .NET؟  
نعم، يسمح لك Aspose.Cells بإضافة مجموعة متنوعة من الأشكال، بما في ذلك الدوائر والخطوط والسهام والمزيد.
### ما هي الخصائص الأخرى التي يمكنني تعيينها لعنصر التحكم المستطيل؟  
يمكنك تخصيص لون التعبئة، ولون الخط، والشفافية، وحتى إضافة نص داخل المستطيل.
### هل Aspose.Cells متوافق مع .NET Core؟  
نعم، يدعم Aspose.Cells .NET Core، بالإضافة إلى .NET Framework والمنصات الأخرى المستندة إلى .NET.
### هل يمكنني وضع المستطيل بالنسبة لخلية معينة؟  
 نعم، يمكنك وضع المستطيل داخل صفوف وأعمدة محددة، أو استخدام`PlacementType` للتحكم في كيفية تثبيته.
### هل هناك نسخة تجريبية مجانية متاحة لـ Aspose.Cells؟  
 نعم يمكنك الحصول على[نسخة تجريبية مجانية](https://releases.aspose.com/) من الموقع الإلكتروني لاختبار ميزات المكتبة قبل الشراء.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
