---
"description": "تعرف على كيفية إضافة عنصر تحكم مستطيل إلى ورقة عمل Excel باستخدام Aspose.Cells for .NET من خلال دليل مفصل خطوة بخطوة."
"linktitle": "إضافة عنصر التحكم المستطيل إلى ورقة العمل في Excel"
"second_title": "واجهة برمجة تطبيقات معالجة Excel Aspose.Cells .NET"
"title": "إضافة عنصر التحكم المستطيل إلى ورقة العمل في Excel"
"url": "/ar/net/excel-shapes-controls/add-rectangle-control-to-worksheet-excel/"
"weight": 25
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# إضافة عنصر التحكم المستطيل إلى ورقة العمل في Excel

## مقدمة
عندما يتعلق الأمر بأتمتة مهام Excel، يُعد Aspose.Cells for .NET أداة فعّالة تُساعدك على تحقيق أهداف مُتعددة، منها إضافة أشكال مثل المستطيلات إلى أوراق العمل. في هذا الدليل، سنستكشف كيفية إضافة عنصر تحكم مستطيل إلى ورقة عمل Excel باستخدام Aspose.Cells for .NET. في النهاية، ستتمكن من إنشاء ورقة عمل مُدمج فيها عنصر تحكم مستطيل، وتخصيصها، وحفظها.
ولكن قبل الغوص في هذا الموضوع، دعونا نتحدث عن المتطلبات الأساسية.
## المتطلبات الأساسية
لمتابعة هذا البرنامج التعليمي، تأكد من توفر المتطلبات الأساسية التالية:
1. مكتبة Aspose.Cells لـ .NET: إذا لم تقم بذلك بالفعل، [تنزيل المكتبة](https://releases.aspose.com/cells/net/) أو قم بتثبيته باستخدام NuGet في Visual Studio.
2. .NET Framework: يجب أن يكون لديك بيئة تطوير .NET مُعدّة على جهازك.
3. المعرفة الأساسية بلغة C#: على الرغم من أننا سنرشدك خطوة بخطوة، فإن المعرفة الأساسية بلغة C# والبرمجة الموجهة للكائنات مفيدة.
4. الترخيص: يعمل استخدام Aspose.Cells في وضع التقييم بشكل جيد للمهام الأساسية، ولكن للحصول على الوظائف الكاملة، فكر في الحصول على [رخصة مؤقتة](https://purchase.aspose.com/temporary-license/) أو شراء واحدة من [هنا](https://purchase.aspose.com/buy).
الآن، دعونا ننتقل إلى الكود!
## استيراد الحزم
لبدء استخدام Aspose.Cells، تأكد من استيراد مساحات الأسماء اللازمة إلى مشروعك. ستتيح لك هذه الاستيرادات الوصول إلى مختلف الفئات والأساليب اللازمة للتفاعل مع ملفات Excel.
```csharp
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Drawing;
using System.Drawing;
```
تضمن هذه الأسطر أن يتمكن مشروعك من التفاعل مع أدلة الملفات (`System.IO`), مصنفات Excel (`Aspose.Cells`)، ورسم الشكل (`Aspose.Cells.Drawing`).
الآن، دعنا نقسم العملية إلى خطوات بسيطة حتى تتمكن من متابعتها بسهولة وتكرارها في مشاريعك الخاصة.
## الخطوة 1: إعداد مسار الدليل
أول ما عليك فعله هو تحديد المجلد الذي ستحفظ فيه ملف Excel. تضمن هذه الخطوة أن يعرف مشروعك مكان إنشاء ملف الإخراج وتخزينه.
### تعريف دليل البيانات
```csharp
// المسار إلى دليل المستندات.
string dataDir = "Your Document Directory";
```
هنا، يمكنك تحديد مسار الدليل الذي سيتم تخزين ملف Excel فيه. يمكنك استبدال `"Your Document Directory"` مع المسار الفعلي على جهازك، أو قم بإنشاء مجلد بشكل ديناميكي إذا لم يكن موجودًا.
### التحقق من الدليل وإنشائه
```csharp
// إنشاء الدليل إذا لم يكن موجودًا بالفعل.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
يتحقق هذا القسم من وجود الدليل. إن لم يكن موجودًا، يُنشئ واحدًا. تخيل الأمر كأنك تُجهّز خزانة ملفاتك قبل تخزين أي مستندات.
## الخطوة 2: إنشاء مصنف جديد
في هذه الخطوة، يمكنك إنشاء مصنف Excel جديد باستخدام `Aspose.Cells.Workbook` سيكون هذا بمثابة الحاوية لورقة العمل والأشكال الخاصة بك.
```csharp
// إنشاء مصنف جديد.
Workbook excelbook = new Workbook();
```
عن طريق الاتصال `Workbook` المنشئ، لديك الآن مصنف Excel فارغ جاهز للتخصيص.
## الخطوة 3: إضافة عنصر تحكم مستطيل
هنا يأتي السحر. ستضيف شكل مستطيل إلى ورقة العمل الأولى من مصنفك.
```csharp
// أضف عنصر التحكم المستطيل.
Aspose.Cells.Drawing.RectangleShape rectangle = excelbook.Worksheets[0].Shapes.AddRectangle(3, 0, 2, 0, 70, 130);
```
دعونا نكسر هذا:
- `excelbook.Worksheets[0]`:يؤدي هذا إلى الوصول إلى ورقة العمل الأولى في المصنف الخاص بك.
- `.Shapes.AddRectangle(3, 0, 2, 0, 70, 130)`يُضيف هذا شكل مستطيل إلى ورقة العمل. تُحدد المعلمات هنا موضع المستطيل (صف وعمود)، بالإضافة إلى عرضه وارتفاعه.
## الخطوة 4: تخصيص المستطيل
إضافة مستطيل فقط لا تكفي، بل ستحتاج إلى تخصيصه. في هذه الخطوة، سنحدد موضع المستطيل، وسمك خطه، ونمط شرطة.
### تحديد الموضع
```csharp
// ضبط موضع المستطيل.
rectangle.Placement = PlacementType.FreeFloating;
```
يشير هذا إلى أن المستطيل عائم بحرية، مما يعني أنه لن يكون مقيدًا بأبعاد الخلية.
### ضبط وزن الخط
```csharp
// ضبط وزن الخط.
rectangle.Line.Weight = 4;
```
هنا، حددنا سُمك خط المستطيل بأربع نقاط. كلما زاد الرقم، زاد سُمك الخط.
### ضبط نمط لوحة القيادة
```csharp
// تعيين نمط الشرطة للمستطيل.
rectangle.Line.DashStyle = MsoLineDashStyle.Solid;
```
هذا الخط يُعيّن نمط خطّ حدود المستطيل إلى نمطٍ متواصل. يمكنك تجربة أنماطٍ مختلفة مثل `Dash` أو `Dot` اعتمادا على متطلباتك.
## الخطوة 5: حفظ المصنف
بمجرد إضافة المستطيل وتخصيصه، تكون الخطوة الأخيرة هي حفظ المصنف في الدليل المحدد.
```csharp
// احفظ ملف الاكسل.
excelbook.Save(dataDir + "book1.out.xls");
```
يؤدي هذا إلى حفظ المصنف كملف `.xls` الملف في المجلد الذي حددته سابقًا. يمكنك تعديل تنسيق الملف بتغيير الامتداد، مثل `.xlsx` إذا كنت تفضل تنسيق Excel الأحدث.
## خاتمة
وهذا كل ما في الأمر! إضافة عنصر تحكم مستطيل إلى ورقة عمل Excel باستخدام Aspose.Cells لـ .NET عملية سهلة وبسيطة بمجرد شرحها خطوة بخطوة. سواءً كنت ترغب في إضافة أشكال لإضفاء لمسة جمالية، أو تمييز أجزاء من بياناتك، أو تخصيص تقاريرك، فإن Aspose.Cells يمنحك المرونة اللازمة للقيام بذلك برمجيًا.
من المفترض أن يكون هذا الدليل قد زوَّدك بكل المعرفة اللازمة لبدء إضافة أشكال، مثل المستطيلات، إلى جداول بيانات Excel باستخدام Aspose.Cells. الآن، حان وقت التجربة ومعرفة ما يمكنك تحقيقه باستخدام هذه المكتبة الفعّالة!
## الأسئلة الشائعة
### هل يمكنني إضافة أشكال أخرى مثل الدوائر أو الخطوط باستخدام Aspose.Cells لـ .NET؟  
نعم، يسمح لك Aspose.Cells بإضافة مجموعة متنوعة من الأشكال، بما في ذلك الدوائر والخطوط والأسهم والمزيد.
### ما هي الخصائص الأخرى التي يمكنني تعيينها لعنصر التحكم المستطيل؟  
يمكنك تخصيص لون التعبئة، ولون الخط، والشفافية، وحتى إضافة نص داخل المستطيل.
### هل Aspose.Cells متوافق مع .NET Core؟  
نعم، يدعم Aspose.Cells .NET Core، بالإضافة إلى .NET Framework والمنصات الأخرى المستندة إلى .NET.
### هل يمكنني وضع المستطيل بالنسبة لخلية معينة؟  
نعم، يمكنك وضع المستطيل داخل صفوف وأعمدة محددة، أو استخدام `PlacementType` للتحكم في كيفية تثبيته.
### هل هناك نسخة تجريبية مجانية متاحة لـ Aspose.Cells؟  
نعم يمكنك الحصول على [نسخة تجريبية مجانية](https://releases.aspose.com/) من الموقع الإلكتروني لاختبار ميزات المكتبة قبل الشراء.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}