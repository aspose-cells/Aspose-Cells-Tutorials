---
title: الحصول على نقاط اتصال الشكل في Excel
linktitle: الحصول على نقاط اتصال الشكل في Excel
second_title: واجهة برمجة تطبيقات معالجة Excel الخاصة بـ Aspose.Cells .NET
description: تعرف على كيفية الحصول على نقاط اتصال الشكل في Excel باستخدام Aspose.Cells for .NET. اتبع دليلنا خطوة بخطوة لاستخراج نقاط الشكل وعرضها بسهولة برمجيًا.
weight: 11
url: /ar/net/excel-shapes-controls/get-connection-points-shape-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# الحصول على نقاط اتصال الشكل في Excel

## مقدمة
عند العمل مع ملفات Excel برمجيًا، غالبًا ما نحتاج إلى التفاعل مع الأشكال المضمنة في الأوراق. إحدى المهام الأكثر تقدمًا التي يمكنك القيام بها هي استخراج نقاط الاتصال من الشكل. تُستخدم نقاط الاتصال لربط الأشكال بالموصلات وإدارة تخطيطها بدقة أكبر. إذا كنت تتطلع إلى الحصول على نقاط اتصال شكل في Excel، فإن Aspose.Cells for .NET هي الأداة التي تحتاجها. في هذا البرنامج التعليمي، سنأخذك خلال عملية خطوة بخطوة لتحقيق ذلك.
## المتطلبات الأساسية
قبل الغوص في الكود، تأكد من أن لديك المتطلبات الأساسية التالية:
- Aspose.Cells لـ .NET: ستحتاج إلى تثبيت Aspose.Cells في بيئة التطوير الخاصة بك. إذا لم يكن لديك بعد، فيمكنك[قم بتنزيل الإصدار الأحدث هنا](https://releases.aspose.com/cells/net/).
- بيئة التطوير: تأكد من أن لديك تثبيتًا صالحًا لبرنامج Visual Studio أو أي بيئة تطوير متكاملة أخرى متوافقة مع .NET.
- المعرفة الأساسية بلغة C#: يفترض هذا البرنامج التعليمي أن لديك فهمًا أساسيًا لبرمجة C# ومبادئ التوجه الكائني.
 يمكنك أيضًا التسجيل للحصول على[نسخة تجريبية مجانية من Aspose.Cells](https://releases.aspose.com/) إذا لم تكن قد قمت بذلك بالفعل، فسيمنحك هذا إمكانية الوصول إلى جميع الميزات المطلوبة لهذا الدليل.

## استيراد الحزم
للعمل مع Aspose.Cells في مشروعك، تحتاج إلى تضمين مساحات الأسماء الضرورية. يجب وضع عبارات الاستيراد التالية في أعلى الكود الخاص بك:
```csharp
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Drawing;
using System.Drawing;
```
تتيح لك مساحات الأسماء هذه الوصول إلى الوظائف الأساسية لـ Aspose.Cells وتسمح لك بالتعامل مع أوراق العمل والأشكال.

## دليل خطوة بخطوة للحصول على نقاط اتصال الشكل
في هذا القسم، سنوضح لك كيفية استخراج نقاط الاتصال لشكل ما داخل ورقة عمل Excel. اتبع كل خطوة بعناية للحصول على فهم واضح.
## الخطوة 1: إنشاء مصنف جديد
 أولاً وقبل كل شيء، نحتاج إلى إنشاء مثيل لـ`Workbook` يمثل هذا ملف Excel في Aspose.Cells. إذا لم يكن لديك ملف موجود، فلا توجد مشكلة، يمكنك البدء بمصنف فارغ.
```csharp
// إنشاء مصنف جديد
Workbook workbook = new Workbook();
```
 في هذه الخطوة، قمنا بإنشاء مصنف Excel فارغ، ولكن يمكنك أيضًا تحميل مصنف موجود عن طريق تمرير مسار الملف إلى`Workbook` منشئ.
## الخطوة 2: الوصول إلى ورقة العمل الأولى
بعد ذلك، نحتاج إلى الوصول إلى ورقة العمل التي نريد العمل عليها بالأشكال. في هذه الحالة، سنستخدم ورقة العمل الأولى من المصنف.
```csharp
// احصل على ورقة العمل الأولى في المصنف
Worksheet worksheet = workbook.Worksheets[0];
```
 يؤدي هذا السطر إلى الوصول إلى ورقة العمل الأولى من مجموعة أوراق العمل الموجودة في المصنف. إذا كنت تعمل على ورقة عمل معينة، فيمكنك استبدال الفهرس`0` مع الفهرس المطلوب.
## الخطوة 3: إضافة مربع نص جديد (شكل)
الآن، دعنا نضيف شكلاً جديدًا إلى ورقة العمل. سننشئ مربع نص، وهو نوع من الأشكال. يمكنك أيضًا إضافة أنواع أخرى من الأشكال، ولكن من أجل التبسيط، سنلتزم بمربع النص في هذا البرنامج التعليمي.
```csharp
// إضافة مربع نص جديد إلى المجموعة
int textboxIndex = worksheet.TextBoxes.Add(2, 1, 160, 200);
```
وهذا ما فعلناه:
-  تمت إضافة مربع نص في الصف`2` ، عمود`1`.
-  تعيين أبعاد مربع النص إلى`160` وحدات في العرض و`200` وحدات في الارتفاع.
## الخطوة 4: الوصول إلى الشكل من مجموعة الأشكال
 بمجرد إضافة مربع النص، يصبح جزءًا من مجموعة الأشكال في ورقة العمل. الآن، سنتمكن من الوصول إلى هذا الشكل باستخدام`Shapes`مجموعة.
```csharp
// الوصول إلى الشكل (مربع النص) من مجموعة الأشكال
Shape shape = workbook.Worksheets[0].Shapes[0];
```
في هذه الخطوة، نسترد الشكل الأول (مربع النص الخاص بنا) من المجموعة. إذا كان لديك أشكال متعددة، فيمكنك تحديد الفهرس أو حتى العثور على الشكل بالاسم.
## الخطوة 5: استرداد نقاط الاتصال
الآن بعد أن أصبح لدينا الشكل، فلنستخرج نقاط اتصاله. تُستخدم هذه النقاط لربط الموصلات بالشكل.`ConnectionPoints` تقوم خاصية الشكل بإرجاع جميع نقاط الاتصال المتاحة.
```csharp
// احصل على جميع نقاط الاتصال بهذا الشكل
var connectionPoints = shape.ConnectionPoints;
```
يتيح لنا هذا مجموعة من نقاط الاتصال المتاحة لهذا الشكل.
## الخطوة 6: عرض نقاط الاتصال
أخيرًا، نريد عرض إحداثيات كل نقطة اتصال. وهنا ننتقل عبر نقاط الاتصال ونطبعها على وحدة التحكم.
```csharp
// عرض جميع نقاط الشكل
foreach (var pt in connectionPoints)
{
    System.Console.WriteLine(string.Format("X = {0}, Y = {1}", pt.X, pt.Y));
}
```
 تتكرر هذه الحلقة على كل نقطة اتصال وتطبع`X` و`Y` الإحداثيات. يمكن أن يكون هذا مفيدًا في تصحيح أخطاء نقاط اتصال الشكل أو تأكيدها بصريًا.
## الخطوة 7: التنفيذ والإكمال
بمجرد إعداد كل الخطوات المذكورة أعلاه، يمكنك تشغيل التعليمات البرمجية. إليك السطر الأخير الذي يضمن اكتمال العملية بنجاح:
```csharp
System.Console.WriteLine("GetShapeConnectionPoints executed successfully.");
```
يقوم هذا الخط ببساطة بتسجيل رسالة إلى وحدة التحكم تشير إلى اكتمال العملية.

## خاتمة
في هذا البرنامج التعليمي، تناولنا كيفية استرداد نقاط اتصال شكل في Excel باستخدام Aspose.Cells for .NET. من خلال تقسيم المهمة إلى خطوات صغيرة وسهلة الفهم، استكشفنا عملية إنشاء مصنف وإضافة شكل واستخراج نقاط الاتصال.
من خلال فهم كيفية التعامل مع الأشكال برمجيًا، يمكنك فتح عالم من الاحتمالات لبناء جداول Excel ديناميكية وتفاعلية. سواء كنت تقوم ببناء التقارير أو تصميم لوحات المعلومات أو إنشاء المخططات البيانية، فستكون هذه المعرفة مفيدة.
## الأسئلة الشائعة
### ما هي نقطة الاتصال في الشكل؟
نقطة الاتصال هي نقطة محددة على الشكل حيث يمكنك إرفاق موصلات أو ربطها بأشكال أخرى.
### هل يمكنني استرجاع نقاط الاتصال لجميع الأشكال في ورقة العمل؟
نعم، يتيح لك Aspose.Cells استرداد نقاط الاتصال لأي شكل يدعمها. ما عليك سوى التنقل عبر مجموعة الأشكال في ورقة العمل.
### هل أحتاج إلى ترخيص لاستخدام Aspose.Cells؟
نعم، على الرغم من أنه يمكنك تجربته مجانًا، إلا أنه يلزم الحصول على ترخيص للاستفادة من الميزات الكاملة. يمكنك[اشتري ترخيص هنا](https://purchase.aspose.com/buy)أو الحصول على[رخصة مؤقتة](https://purchase.aspose.com/temporary-license/).
### كيف يمكنني إضافة أنواع مختلفة من الأشكال في Aspose.Cells؟
يمكنك استخدام`Add` طريقة للأشكال مثل المستطيلات والقطع الناقص وغيرها. كل شكل له معلمات محددة يمكنك تخصيصها.
### كيف يمكنني تحميل ملف Excel موجود بدلاً من إنشاء ملف جديد؟
 لتحميل ملف موجود، مرر مسار الملف إلى`Workbook` منشئ مثل هذا:  
```csharp
Workbook workbook = new Workbook("path_to_file.xlsx");
```
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
