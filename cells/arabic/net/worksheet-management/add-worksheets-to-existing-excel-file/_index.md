---
"description": "تعرّف على كيفية إضافة أوراق عمل إلى ملف Excel موجود في Aspose.Cells لـ .NET من خلال هذا الدليل المفصل. مثالي لإدارة البيانات الديناميكية."
"linktitle": "إضافة أوراق عمل إلى ملف Excel موجود باستخدام Aspose.Cells"
"second_title": "واجهة برمجة تطبيقات معالجة Excel Aspose.Cells .NET"
"title": "إضافة أوراق عمل إلى ملف Excel موجود باستخدام Aspose.Cells"
"url": "/ar/net/worksheet-management/add-worksheets-to-existing-excel-file/"
"weight": 13
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# إضافة أوراق عمل إلى ملف Excel موجود باستخدام Aspose.Cells

## مقدمة

في هذا البرنامج التعليمي، سنتعمق في أساسيات إضافة ورقة عمل إلى ملف Excel موجود باستخدام Aspose.Cells لـ .NET. سيتضمن هذا البرنامج التعليمي المتطلبات الأساسية، واستيراد الحزم، ودليلًا خطوة بخطوة لبدء تشغيل الكود.

## المتطلبات الأساسية

للبدء، تأكد من توفر المتطلبات الأساسية التالية:

1. مكتبة Aspose.Cells لـ .NET: [تحميله هنا](https://releases.aspose.com/cells/net/) أو قم بتثبيته عبر NuGet باستخدام:
```bash
Install-Package Aspose.Cells
```
2. بيئة .NET: قم بإعداد بيئة تطوير .NET، ويفضل أن تكون .NET Framework 4.0 أو أحدث.
3. المعرفة الأساسية بلغة C#: ستساعدك المعرفة بلغة C# على المتابعة بسهولة أكبر.
4. ملف Excel للاختبار: قم بإعداد ملف Excel الذي ستضيف إليه ورقة عمل.

## إعداد الترخيص الخاص بك (اختياري)

إذا كنت تعمل على إصدار مرخص، فاستخدم ترخيصك للاستفادة من كامل إمكانات المكتبة. للحصول على ترخيص مؤقت، راجع [هذا الرابط](https://purchase.aspose.com/temporary-license/).


## استيراد الحزم

قبل الغوص في الكود، تأكد من استيراد حزمة Aspose.Cells وSystem.IO اللازمة للتعامل مع الملفات.

```csharp
using System.IO;
using Aspose.Cells;
```

دعونا نقسم العملية إلى خطوات واضحة لمساعدتك على فهم كيفية ترابط كل شيء معًا.


## الخطوة 1: تحديد مسار الملف

في هذه الخطوة الأولية، ستحدد المجلد الذي توجد فيه ملفات Excel. هذه خطوة بسيطة ولكنها أساسية لمساعدة برنامجك في تحديد موقع الملف.

```csharp
// المسار إلى دليل المستندات.
string dataDir = "Your Document Directory";
```

يجب أن يشير هذا الدليل إلى المكان الذي تريده `book1.xls` تم حفظ الملف. إذا لم تكن متأكدًا من المسار، فاستخدم المسار المطلق (مثلًا، `C:\\Users\\YourName\\Documents\\`).


## الخطوة 2: فتح ملف Excel كملف FileStream

للعمل مع ملف Excel موجود، افتحه كملف `FileStream`يتيح هذا لـ Aspose.Cells قراءة بيانات الملف ومعالجتها.

```csharp
// إنشاء مجرى ملف يحتوي على ملف Excel الذي سيتم فتحه
FileStream fstream = new FileStream(dataDir + "book1.xls", FileMode.Open);
```

هنا، `FileMode.Open` يخبر البرنامج بفتح الملف إذا كان موجودًا. تأكد `book1.xls` تم تسميته بشكل صحيح ووضعه في الدليل الخاص بك لتجنب الأخطاء.


## الخطوة 3: إنشاء كائن المصنف

بعد ذلك، قم بإنشاء `Workbook` كائن باستخدام FileStream. يمثل هذا الكائن ملف Excel ويتيح لك الوصول إلى جميع خصائصه وطرقه.

```csharp
// إنشاء كائن مصنف
// فتح ملف Excel من خلال تدفق الملف
Workbook workbook = new Workbook(fstream);
```

الآن، `workbook` يحتفظ بملف Excel الخاص بك، جاهزًا للتعديل.


## الخطوة 4: إضافة ورقة عمل جديدة إلى المصنف

بعد إنشاء نسخة المصنف، الخطوة التالية هي إضافة ورقة عمل جديدة. هنا، يوفر Aspose.Cells طريقة سهلة `Add()` طريقة للتعامل مع هذا.

```csharp
// إضافة ورقة عمل جديدة إلى كائن المصنف
int i = workbook.Worksheets.Add();
```

ال `Add()` تعيد الطريقة فهرس ورقة العمل المضافة حديثًا، والذي يمكنك استخدامه للوصول إليها وتعديلها.


## الخطوة 5: الوصول إلى ورقة العمل المضافة حديثًا عن طريق الفهرس

بعد إضافة ورقة العمل، يمكنك استردادها من خلال فهرسها. يتيح لك هذا إجراء تغييرات إضافية، مثل إعادة تسمية ورقة العمل.

```csharp
// الحصول على مرجع ورقة العمل المضافة حديثًا عن طريق تمرير فهرس الورقة الخاصة بها
Worksheet worksheet = workbook.Worksheets[i];
```

هنا، `worksheet` يمثل الورقة الفارغة الجديدة الخاصة بك ضمن المصنف.


## الخطوة 6: إعادة تسمية ورقة العمل الجديدة

تسمية ورقة العمل تساعد في التنظيم، خاصةً عند التعامل مع أوراق عمل متعددة. حدّد الاسم باستخدام `Name` ملكية.

```csharp
// تعيين اسم ورقة العمل المضافة حديثًا
worksheet.Name = "My Worksheet";
```

لا تتردد في إعادة تسميته إلى شيء ذي معنى لسياق مشروعك.


## الخطوة 7: حفظ ملف Excel المعدّل

بعد إجراء التغييرات، حان وقت حفظ الملف المعدّل. يمكنك حفظه كملف جديد أو استبدال الملف الحالي.

```csharp
// حفظ ملف Excel
workbook.Save(dataDir + "output.out.xls");
```

حفظه باسم `output.out.xls` يُبقي الملف الأصلي سليمًا. إذا أردت استبدال الملف الحالي، فاستخدم نفس اسم ملف الإدخال.


## الخطوة 8: إغلاق FileStream

أخيرًا، أغلق FileStream لتحرير الموارد.

```csharp
// إغلاق مجرى الملف لتحرير كافة الموارد
fstream.Close();
```

يعد إغلاق التدفق أمرًا ضروريًا لمنع تسرب الذاكرة، خاصةً إذا كنت تعمل مع ملفات كبيرة أو تدفقات متعددة في برنامج واحد.


## خاتمة

مع Aspose.Cells لـ .NET، تُعدّ إضافة ورقة عمل إلى ملف Excel موجود عملية سهلة وبسيطة. باتباع هذه الخطوات البسيطة، يمكنك بسهولة فتح ملف Excel، وإضافة أوراق عمل جديدة، وإعادة تسميتها، وحفظ التغييرات - كل ذلك في بضعة أسطر من التعليمات البرمجية. يوضح هذا البرنامج التعليمي كيفية تنفيذ هذه الإجراءات برمجيًا، مما يُسهّل إدارة ملفات Excel ديناميكيًا في تطبيقات .NET. إذا كنت ترغب في إضافة معالجة بيانات معقدة أو إنشاء تقارير ديناميكية، فإن Aspose.Cells يوفر العديد من الميزات الإضافية لاستكشافها.

## الأسئلة الشائعة

### هل يمكنني إضافة أوراق عمل متعددة دفعة واحدة؟
نعم! يمكنك الاتصال `workbook.Worksheets.Add()` عدة مرات لإضافة عدد أوراق العمل التي تحتاجها.

### كيف يمكنني حذف ورقة عمل في Aspose.Cells؟
يستخدم `workbook.Worksheets.RemoveAt(sheetIndex)` لحذف ورقة عمل حسب فهرسها.

### هل Aspose.Cells for .NET متوافق مع .NET Core؟
بالتأكيد، يدعم Aspose.Cells for .NET .NET Core، مما يجعله متعدد الأنظمة الأساسية.

### هل يمكنني تعيين كلمة مرور للمصنف؟
نعم، يمكنك تعيين كلمة مرور باستخدام `workbook.Settings.Password = "yourPassword";` لتأمين المصنف.

### هل يدعم Aspose.Cells تنسيقات ملفات أخرى مثل CSV أو PDF؟
نعم، يدعم Aspose.Cells مجموعة واسعة من تنسيقات الملفات، بما في ذلك CSV وPDF وHTML والمزيد.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}