---
title: إضافة أوراق عمل إلى ملف Excel موجود باستخدام Aspose.Cells
linktitle: إضافة أوراق عمل إلى ملف Excel موجود باستخدام Aspose.Cells
second_title: واجهة برمجة تطبيقات معالجة Excel الخاصة بـ Aspose.Cells .NET
description: تعرف على كيفية إضافة أوراق عمل إلى ملف Excel موجود في Aspose.Cells for .NET باستخدام هذا الدليل التفصيلي. مثالي لإدارة البيانات الديناميكية.
weight: 13
url: /ar/net/worksheet-management/add-worksheets-to-existing-excel-file/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# إضافة أوراق عمل إلى ملف Excel موجود باستخدام Aspose.Cells

## مقدمة

في هذا البرنامج التعليمي، سنتعمق في أساسيات إضافة ورقة عمل إلى ملف Excel موجود باستخدام Aspose.Cells for .NET. سيتضمن هذا البرنامج التعليمي المتطلبات الأساسية، وعمليات استيراد الحزم، ودليلًا خطوة بخطوة لبدء تشغيل الكود الخاص بك.

## المتطلبات الأساسية

للبدء، تأكد من توفر المتطلبات الأساسية التالية:

1.  مكتبة Aspose.Cells لـ .NET:[تحميله هنا](https://releases.aspose.com/cells/net/) أو قم بتثبيته عبر NuGet باستخدام:
```bash
Install-Package Aspose.Cells
```
2. بيئة .NET: قم بإعداد بيئة تطوير .NET، ويفضل أن تكون .NET Framework 4.0 أو إصدار أحدث.
3. المعرفة الأساسية بلغة C#: ستساعدك المعرفة بلغة C# على المتابعة بسهولة أكبر.
4. ملف Excel للاختبار: قم بإعداد ملف Excel الذي ستضيف إليه ورقة عمل.

## إعداد الترخيص الخاص بك (اختياري)

 إذا كنت تعمل على إصدار مرخص، فقم بتطبيق ترخيصك لإطلاق العنان لإمكانات المكتبة الكاملة. للحصول على ترخيص مؤقت، راجع[هذا الرابط](https://purchase.aspose.com/temporary-license/).


## استيراد الحزم

قبل الغوص في الكود، تأكد من استيراد حزمة Aspose.Cells وSystem.IO اللازمة للتعامل مع الملفات.

```csharp
using System.IO;
using Aspose.Cells;
```

دعونا نقسم العملية إلى خطوات واضحة لمساعدتك على فهم كيفية ترابط كل شيء معًا.


## الخطوة 1: تحديد مسار الملف

في هذه الخطوة الأولية، ستحدد الدليل الذي توجد به ملفات Excel. هذا جزء بسيط ولكنه ضروري لمساعدة برنامجك في تحديد موقع الملف.

```csharp
// المسار إلى دليل المستندات.
string dataDir = "Your Document Directory";
```

 يجب أن يشير هذا الدليل إلى المكان الذي`book1.xls` تم حفظ الملف. إذا لم تكن متأكدًا من المسار، فاستخدم المسار المطلق (على سبيل المثال،`C:\\Users\\YourName\\Documents\\`).


## الخطوة 2: افتح ملف Excel كملف FileStream

 للعمل مع ملف Excel الحالي، افتحه كملف`FileStream`يتيح هذا لـ Aspose.Cells قراءة بيانات الملف ومعالجتها.

```csharp
// إنشاء مجرى ملف يحتوي على ملف Excel الذي سيتم فتحه
FileStream fstream = new FileStream(dataDir + "book1.xls", FileMode.Open);
```

 هنا،`FileMode.Open` يخبر البرنامج بفتح الملف إذا كان موجودًا. تأكد`book1.xls`تم تسميته بشكل صحيح ووضعه في الدليل الخاص بك لتجنب الأخطاء.


## الخطوة 3: إنشاء مثيل لكائن المصنف

 بعد ذلك، قم بإنشاء`Workbook` الكائن باستخدام FileStream. يمثل هذا الكائن ملف Excel ويمنحك إمكانية الوصول إلى جميع خصائصه وطرقه.

```csharp
// إنشاء كائن مصنف
// فتح ملف Excel من خلال مجرى الملف
Workbook workbook = new Workbook(fstream);
```

 الآن،`workbook` يحتفظ بملف Excel الخاص بك، جاهزًا للتعديل.


## الخطوة 4: إضافة ورقة عمل جديدة إلى المصنف

 بعد إنشاء مثيل المصنف، تكون الخطوة التالية هي إضافة ورقة عمل جديدة. هنا، يوفر Aspose.Cells طريقة سهلة`Add()` الطريقة للتعامل مع هذا.

```csharp
// إضافة ورقة عمل جديدة إلى كائن المصنف
int i = workbook.Worksheets.Add();
```

 ال`Add()` تعيد الطريقة فهرس ورقة العمل المضافة حديثًا، والذي يمكنك استخدامه للوصول إليها وتعديلها.


## الخطوة 5: الوصول إلى ورقة العمل المضافة حديثًا عن طريق الفهرس

بمجرد إضافة ورقة العمل، يمكنك استردادها من خلال فهرسها. يتيح لك هذا إجراء المزيد من التغييرات، مثل إعادة تسمية ورقة العمل.

```csharp
// الحصول على مرجع ورقة العمل المضافة حديثًا عن طريق تمرير فهرس الورقة الخاصة بها
Worksheet worksheet = workbook.Worksheets[i];
```

 هنا،`worksheet` يمثل الورقة الفارغة الجديدة داخل المصنف.


## الخطوة 6: إعادة تسمية ورقة العمل الجديدة

 قد يساعد تسمية ورقة العمل في التنظيم، وخاصة عند التعامل مع أوراق متعددة. اضبط الاسم باستخدام`Name` ملكية.

```csharp
// تعيين اسم ورقة العمل المضافة حديثًا
worksheet.Name = "My Worksheet";
```

لا تتردد في إعادة تسميته إلى شيء ذي معنى لسياق مشروعك.


## الخطوة 7: احفظ ملف Excel المعدّل

الآن بعد أن أجريت التغييرات، حان الوقت لحفظ الملف المعدّل. يمكنك حفظه كملف جديد أو استبدال الملف الموجود.

```csharp
// حفظ ملف Excel
workbook.Save(dataDir + "output.out.xls");
```

 حفظه كـ`output.out.xls` يحافظ على الملف الأصلي دون أي مساس. إذا كنت تريد استبدال الملف الموجود، فما عليك سوى استخدام نفس اسم الملف كملف الإدخال.


## الخطوة 8: إغلاق تدفق الملفات

أخيرًا، أغلق FileStream لتحرير الموارد.

```csharp
// إغلاق مجرى الملف لتحرير كافة الموارد
fstream.Close();
```

يعد إغلاق التدفق أمرًا ضروريًا لمنع تسرب الذاكرة، خاصةً إذا كنت تعمل مع ملفات كبيرة أو تدفقات متعددة في برنامج واحد.


## خاتمة

مع Aspose.Cells for .NET، تعد إضافة ورقة عمل إلى ملف Excel موجود عملية بسيطة. باتباع هذه الخطوات البسيطة، يمكنك بسهولة فتح ملف Excel وإضافة أوراق عمل جديدة وإعادة تسميتها وحفظ التغييرات التي أجريتها، كل ذلك في غضون بضعة أسطر من التعليمات البرمجية. يوضح هذا البرنامج التعليمي كيفية تنفيذ هذه الإجراءات برمجيًا، مما يجعل إدارة ملفات Excel ديناميكيًا في تطبيقات .NET أسهل. إذا كنت تتطلع إلى إضافة معالجة بيانات معقدة أو إنشاء تقارير ديناميكية، فإن Aspose.Cells يوفر الكثير من الميزات الإضافية لاستكشافها.

## الأسئلة الشائعة

### هل يمكنني إضافة أوراق عمل متعددة دفعة واحدة؟
 نعم يمكنك الاتصال`workbook.Worksheets.Add()` عدة مرات لإضافة عدد أوراق العمل التي تحتاجها.

### كيف يمكنني حذف ورقة عمل في Aspose.Cells؟
 يستخدم`workbook.Worksheets.RemoveAt(sheetIndex)` لحذف ورقة عمل حسب فهرسها.

### هل Aspose.Cells for .NET متوافق مع .NET Core؟
بالتأكيد، يدعم Aspose.Cells for .NET .NET Core، مما يجعله متعدد الأنظمة الأساسية.

### هل يمكنني تعيين كلمة مرور للمصنف؟
 نعم، يمكنك تعيين كلمة مرور باستخدام`workbook.Settings.Password = "yourPassword";` لتأمين المصنف.

### هل يدعم Aspose.Cells تنسيقات الملفات الأخرى مثل CSV أو PDF؟
نعم، يدعم Aspose.Cells مجموعة واسعة من تنسيقات الملفات، بما في ذلك CSV، وPDF، وHTML، والمزيد.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
