---
category: general
date: 2026-02-23
description: ุฅูุดุงุก ูุฌููุนุฉ ุนูุงูุงุช ุฐููุฉ ูู C# ุจุงุณุชุฎุฏุงู Aspose.Cells. ุชุนููู ููููุฉ ุฅุถุงูุฉ
  ุงูุนูุงูุงุชุ ุงูุชุนูููุงุชุ ูุชุทุจูููุง ุนูู ูุฑูุฉ ุงูุนูู ูู ุจุถุน ุฎุทูุงุช ููุท.
draft: false
keywords:
- create smart marker collection
- smart markers
- marker collection
- Aspose.Cells
- worksheet smart markers
language: ar
og_description: ุฅูุดุงุก ูุฌููุนุฉ ุนูุงูุงุช ุฐููุฉ ูู C# ุจุงุณุชุฎุฏุงู Aspose.Cells. ููุถุญ ูู ูุฐุง
  ุงูุจุฑูุงูุฌ ุงูุชุนูููู ููููุฉ ุฅุถุงูุฉ ุงูุนูุงูุงุช ูุงูุชุนูููุงุช ูุชุทุจูููุง ุนูู ูุฑูุฉ ุงูุนูู.
og_title: ุฅูุดุงุก ูุฌููุนุฉ ุนูุงูุงุช ุฐููุฉ โ ุฏููู C# ุงููุงูู
tags:
- Aspose.Cells
- C#
- SmartMarkers
title: ุฅูุดุงุก ูุฌููุนุฉ ุนูุงูุงุช ุฐููุฉ โ ุฏููู C# ุงููุงูู
url: /ar/net/smart-markers-dynamic-data/create-smart-marker-collection-complete-c-guide/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# ุฅูุดุงุก ูุฌููุนุฉ ุนูุงูุงุช ุฐููุฉ โ ุฏููู C# ุงููุงูู

ูู ุงุญุชุฌุช ููููุง ุฅูู **ุฅูุดุงุก ูุฌููุนุฉ ุนูุงูุงุช ุฐููุฉ** ูู ุฌุฏูู ุจูุงูุงุช ููู ูู ุชูู ูุชุฃูุฏูุง ูู ุฃูู ุชุจุฏุฃุ ูุณุช ูุญุฏูุ ุงูุนุฏูุฏ ูู ุงููุทูุฑูู ููุงุฌููู ููุณ ุงููุดููุฉ ุนูุฏูุง ูุณุชุฎุฏููู ููุฒุฉ SmartMarkers ูู Aspose.Cells ูููุฑุฉ ุงูุฃููู. ุงูุฎุจุฑ ุงูุณุงุฑุ ุงูุฃูุฑ ุจุณูุท ุฌุฏูุง ุจูุฌุฑุฏ ุฃู ุชุฑู ุงูููุทุ ูุณุฃุฑุดุฏู ุฎูุงูู ุฎุทูุฉ ุจุฎุทูุฉ.

ูู ูุฐุง ุงูุฏุฑุณ ุณุชุชุนูู ููููุฉ ุฅูุดุงุก `MarkerCollection`ุ ูุฅุถุงูุฉ ุนูุงูุงุช ุงูุจูุงูุงุช ูุงูุชุนูููุงุช ุฅูููุงุ ูุฑุจุทูุง ุจู **SmartMarkers** ููุฑูุฉ ุงูุนููุ ูุฃุฎูุฑูุง ุงุณุชุฏุนุงุก ุทุฑููุฉ `Apply()` ูุชุธูุฑ ูู ุงูุฃุดูุงุก ุจุดูู ุตุญูุญ. ูุง ุญุงุฌุฉ ูุฃู ูุณุชูุฏุงุช ุฎุงุฑุฌูุฉโููุท ููุฏ C# ูุงุจู ููุชูููุฐ ูุจุนุถ ุงูุดุฑูุญุงุช ุงูุชู ุชูุถุญ โุงูุณุจุจโ ูุฑุงุก ูู ุณุทุฑ.

## ูุง ุณุชุญุตู ุนููู

- ูุฌููุนุฉ **marker collection** ุนุงููุฉ ููููู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงููุง ุนุจุฑ ุฃูุฑุงู ุงูุนูู.  
- ูุนุฑูุฉ ููููุฉ ุชูุงุนู **smart markers** ูุน ูุงุฆูุงุช Aspose.Cells.  
- ูุตุงุฆุญ ููุชุนุงูู ูุน ุงูููุงุชูุญ ุงูููุฑุฑุฉุ ุงุนุชุจุงุฑุงุช ุงูุฃุฏุงุกุ ูุงููุดููุงุช ุงูุดุงุฆุนุฉ.  
- ูุซุงู ูุงูู ููููู ูุณุฎู ููุตูู ูู ุฃู ูุดุฑูุน .NET ูููู ูุฑุงุฌุน ุฅูู Aspose.Cells.

**Prerequisites:**  
- .NETโฏ6 (ุฃู ุฃู ูุณุฎุฉ ุญุฏูุซุฉ ูู .NET) ูุน ุชุซุจูุช Aspose.Cells for .NET.  
- ุฅููุงู ุฃุณุงุณู ุจุตูุงุบุฉ C# ูููุงููู ุงูุจุฑูุฌุฉ ุงููุงุฆููุฉ.  
- ูุฌูุฏ ูุณุฎุฉ `Worksheet` ุชุฑูุฏ ุชุนุจุฆุชูุง โ ุณููุชุฑุถ ุฃูู ูุฏ ุญูููุช ุฃู ุฃูุดุฃุช ูุตูููุง ุจุงููุนู.

ุฅุฐุง ููุช ุชุชุณุงุกู *ููุงุฐุง ูุญุชุงุฌ ูุฌููุนุฉ ุนูุงูุงุช ุฐููุฉ ุฃุตูุงู*ุ ููุฑ ูููุง ููุงุฆูุฉ ุฎูููุฉ ุงููุฒู ุชุฏูุฑ ุฅุฏุฑุงุฌ ุงููุญุชูู ุงูุฏููุงูููู ุฏูู ุงูุญุงุฌุฉ ูุชุญุฏูุฏ ุนูุงููู ุงูุฎูุงูุง ูุฏูููุง. ุฅููุง ูููุฏุฉ ุฌุฏูุง ููุชูุงุฑูุฑ ุงููุงูุจูุฉุ ุงูููุงุชูุฑ ุจููุท ุฏูุฌ ุงูุจุฑูุฏุ ุฃู ุฃู ุณููุงุฑูู ูุญุชุงุฌ ุฅูู ููุก ููุณ ุงูุชุฎุทูุท ุจุจูุงูุงุช ูุฎุชููุฉ.

---

## ุงูุฎุทูุฉ 1: ููููุฉ **ุฅูุดุงุก ูุฌููุนุฉ ุนูุงูุงุช ุฐููุฉ** ูู C#

ุงูุฃูู ุงูุฐู ุชุญุชุงุฌู ูู ุญุงููุฉ ูุงุฑุบุฉ ุณุชุญุชูู ุฌููุน ุงูุนูุงูุงุช ุงูุฎุงุตุฉ ุจู. ุชููุฑ Aspose.Cells ุงููุฆุฉ `MarkerCollection` ููุฐุง ุงูุบุฑุถ ุจุงูุถุจุท.

```csharp
// Step 1: Initialize a fresh MarkerCollection instance
MarkerCollection markerCollection = new MarkerCollection();
```

> **Why this matters:**  
> `MarkerCollection` acts like a map where each key corresponds to a placeholder in your Excel template. By creating it early you keep the code tidy and avoid scattering marker definitions throughout your logic.

### ูุตูุญุฉ ุงุญุชุฑุงููุฉ
ุฅุฐุง ููุช ุชุฎุทุท ูุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ููุณ ุงููุฌููุนุฉ ุนุจุฑ ุฃูุฑุงู ุนูู ูุชุนุฏุฏุฉุ ููููุฑ ูู ุงุณุชูุณุงุฎูุง (`markerCollection.Clone()`) ุจุฏูุงู ูู ุฅุนุงุฏุฉ ุจูุงุฆูุง ูู ุงูุตูุฑ ูู ูู ูุฑุฉ. ูุฐุง ูููู ุฃู ูููุฑ ุจุถุน ูููุซุงููุฉ ูู ูุธุงุฆู ุงูุฏูุนุงุช ุงููุจูุฑุฉ.

---

## ุงูุฎุทูุฉ 2: ุฅุถุงูุฉ ุนูุงูุงุช ุงูุจูุงูุงุช ูุงูุชุนูููุงุช

ุงูุขู ุจุนุฏ ุฃู ุฃุตุจุญุช ุงููุฌููุนุฉ ููุฌูุฏุฉุ ููููู ุงูุจุฏุก ุจููุฆูุง ุจุนูุงูุงุช ุงูุจูุงูุงุช. ุงููุซุงู ุฃุฏูุงู ูุถูู ุนูุงูุฉ ูููุฉ ุจุณูุทุฉ (`A1`) ูุนูุงูุฉ ุชุนููู (`A1.Comment`). ุชูุถุญ ุนูุงูุฉ ุงูุชุนููู ุฃู **smart markers** ูููููุง ุงูุชุนุงูู ูุน ุงูุจูุงูุงุช ุงููุณุงุนุฏุฉ ูุซู ุงูููุงุญุธุงุช ุฃู ุงูุชุฐูููุงุช.

```csharp
// Step 2: Add a data marker and an associated comment marker
markerCollection.Add("A1", "Value");                 // Replaces ${A1} in the template
markerCollection.Add("A1.Comment", "This is a comment"); // Replaces ${A1.Comment}
```

> **Why we add a comment:**  
> Many reporting scenarios need a humanโreadable note next to a value. By using the `.Comment` suffix you keep the data and its annotation tightly coupled, which makes the final sheet easier to read.

### ุญุงูุฉ ุฎุงุตุฉ
ุฅุฐุง ุฃุถูุช ุนู ุทุฑูู ุงูุฎุทุฃ ููุณ ุงูููุชุงุญ ูุฑุชููุ ูุฅู ุงูุงุณุชุฏุนุงุก ุงููุงุญู ุณูุณุชุจุฏู ุงูุณุงุจู. ูุชุฌูุจ ููุฏุงู ุงูุจูุงูุงุช ุงูุตุงูุชุ ููููู ุงูุชุญูู ูู ูุฌูุฏ ุงูููุชุงุญ ุฃูููุง:

```csharp
if (!markerCollection.ContainsKey("A1"))
{
    markerCollection.Add("A1", "Value");
}
```

---

## ุงูุฎุทูุฉ 3: ุฅุฑูุงู ุงููุฌููุนุฉ ุจู **Worksheet SmartMarkers**

ูุน ุชุนุฑูู ุงูุนูุงูุงุชุ ุงูุฎุทูุฉ ุงูุชุงููุฉ ูู ุฑุจุท ุงููุฌููุนุฉ ุจุฎุตุงุฆุต `SmartMarkers` ููุฑูุฉ ุงูุนูู. ูุฐุง ูุฎุจุฑ Aspose.Cells ุฃูู ุชุจุญุซ ุนูุฏูุง ูุนุงูุฌ ุงููุงูุจ.

```csharp
// Step 3: Link the collection to the worksheet's SmartMarkers collection
worksheet.SmartMarkers.Add(markerCollection);
```

> **Why this works:**  
> `worksheet.SmartMarkers` is itself a collection that can hold multiple `MarkerCollection` objects. By adding yours, you enable the engine to replace every `${...}` placeholder in the sheet with the values you supplied.

### ูุตูุญุฉ ุนูููุฉ
ููููู ุฅุฑูุงู ุนุฏุฉ ูุงุฆูุงุช `MarkerCollection` ุฅูู ููุณ ูุฑูุฉ ุงูุนููโูููุฏ ุนูุฏูุง ุชููุฏ ูุญุฏุงุช ูุฎุชููุฉ ูุฌููุนุงุช ุจูุงูุงุช ูุชููุฒุฉ (ูุซู ุงูุฑุฃุณ ููุงุจู ุงูุฌุณู). ูููู ุงููุญุฑู ุจุฏูุฌูุง ุจุชุฑุชูุจ ุงูุฅุถุงูุฉ.

---

## ุงูุฎุทูุฉ 4: ุชุทุจูู ุงูุนูุงูุงุช ุงูุฐููุฉ ููุนุงูุฌุฉ ูุฑูุฉ ุงูุนูู

ุงููุนู ุงูุฃุฎูุฑ ูู ุงุณุชุฏุนุงุก `Apply()`. ูุฐู ุงูุทุฑููุฉ ุชูุฑ ุนุจุฑ ุงููุฑูุฉุ ูุชุฌุฏ ูู ุนูุตุฑ ูุงุฆุจ `${key}`ุ ูุชุณุชุจุฏูู ุจุงููููุฉ ุงูููุงุจูุฉ ูู ูุฌููุนุชู.

```csharp
// Step 4: Execute the smart marker processing
worksheet.SmartMarkers.Apply();
```

> **What happens under the hood:**  
> Aspose.Cells parses the cell formulas, identifies the `${}` tokens, looks them up in the attached collections, and writes the resolved values back into the cellsโall in memory. No file I/O is performed unless you explicitly save the workbook afterward.

### ููุงุญุธุฉ ุงูุฃุฏุงุก
ุงุณุชุฏุนุงุก `Apply()` ูุฑุฉ ูุงุญุฏุฉ ุจุนุฏ ุฅุถุงูุฉ ุฌููุน ุงูุนูุงูุงุช ุฃูุซุฑ ููุงุกุฉ ุจูุซูุฑ ูู ุงุณุชุฏุนุงุฆู ุจุนุฏ ูู ุฅุถุงูุฉ. ุงููุนุงูุฌุฉ ุงูุฏูุนูุฉ ุชููู ุนุฏุฏ ุงููุฑูุฑ ุนูู ูุฑูุฉ ุงูุนูู.

---

## ุงูุฎุทูุฉ 5: ุงูุชุญูู ูู ุงููุชูุฌุฉ (ูุง ูุฌุจ ุฃู ุชุฑุงู)

ุจุนุฏ ุงุณุชุฏุนุงุก `Apply()`ุ ูุฌุจ ุฃู ุชุญุชูู ูุฑูุฉ ุงูุนูู ุนูู ุงูููู ุงูุญุฑููุฉ ุงูุชู ุฃุฏุฎูุชูุง. ุฅุฐุง ูุชุญุช ุงููุตูู ูู Excelุ ุณุชุฑู:

| A | B |
|---|---|
| ุงููููุฉ | *(ูุงุฑุบ)* |
| *(ูุงุฑุบ)* | *(ูุงุฑุบ)* |
| *(ูุงุฑุบ)* | *(ูุงุฑุบ)* |

ููุธูุฑ ุงูุชุนููู ุงููุฑูู ุจู `A1` ูุชุนููู ุฎููุฉ (ุงููุฑ ุจุฒุฑ ุงููุฃุฑุฉ ุงูุฃููู โ *Show/Hide Comments* ูู Excel).

```csharp
// Optional: Verify that the cell now holds the expected value
string cellValue = worksheet.Cells["A1"].StringValue;
Console.WriteLine($"A1 = {cellValue}"); // Should output: A1 = Value

// Verify the comment
var comment = worksheet.Cells["A1"].GetComment();
Console.WriteLine($"Comment = {comment?.Note}"); // Should output: Comment = This is a comment
```

ุฅุฐุง ูุงู ุงูุฅุฎุฑุงุฌ ูุทุงุจููุงุ ุชูุงูููุงโููุฏ ูุฌุญุช ูู **ุฅูุดุงุก ูุฌููุนุฉ ุนูุงูุงุช ุฐููุฉ** ูุชุทุจูููุง ุนูู ูุฑูุฉ ุงูุนูู!

---

## ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ ูููููุฉ ุชุฌูุจูุง

| ุงูุนูุฑูุถ | ุงูุณุจุจ ุงููุญุชูู | ุงูุญู |
|---------|--------------|-----|
| `${A1}` remains unchanged | Marker not added or collection not attached | Doubleโcheck `markerCollection.Add("A1", ...)` and `worksheet.SmartMarkers.Add(markerCollection)` |
| Comment not showing | Used wrong key suffix or didnโt call `GetComment()` | Use `"A1.Comment"` as the key and ensure the cell has a comment object |
| Duplicate values | Same key added multiple times without intention | Use `ContainsKey` guard or rename keys (e.g., `A1_1`, `A1_2`) |
| Performance slowdown on large sheets | Calling `Apply()` inside a loop | Batch all markers first, then call `Apply()` once |

---

## ูุซุงู ูุงูู ูุนูู

ูููุง ููู ุจุฑูุงูุฌ ูุณุชูู ููููู ุชุฌููุนู ูุชุดุบููู. ููุดุฆ ูุตูููุงุ ูุถูู ุฎููุฉ ูุงูุจ ุจุนูุงุตุฑ ูุงุฆุจุ ูุจูู ูุฌููุนุฉ ุนูุงูุงุช ุฐููุฉุ ูุทุจููุงุ ูุฃุฎูุฑูุง ูุญูุธ ุงูููู ุจุงุณู `Result.xlsx`.

```csharp
using System;
using Aspose.Cells;

class SmartMarkerDemo
{
    static void Main()
    {
        // 1๏ธโฃ Create a new workbook and get the first worksheet
        Workbook workbook = new Workbook();
        Worksheet worksheet = workbook.Worksheets[0];

        // Insert placeholders into the sheet (this mimics a template)
        worksheet.Cells["A1"].PutValue("${A1}");
        worksheet.Cells["A2"].PutValue("${A1.Comment}");

        // 2๏ธโฃ Create the marker collection
        MarkerCollection markerCollection = new MarkerCollection();

        // 3๏ธโฃ Add data and a comment marker
        markerCollection.Add("A1", "Value");
        markerCollection.Add("A1.Comment", "This is a comment");

        // 4๏ธโฃ Attach the collection to the worksheet's SmartMarkers
        worksheet.SmartMarkers.Add(markerCollection);

        // 5๏ธโฃ Apply the markers
        worksheet.SmartMarkers.Apply();

        // 6๏ธโฃ Optional verification
        Console.WriteLine($"A1 = {worksheet.Cells["A1"].StringValue}");
        var comment = worksheet.Cells["A1"].GetComment();
        Console.WriteLine($"Comment = {comment?.Note}");

        // 7๏ธโฃ Save the workbook
        workbook.Save("Result.xlsx");
        Console.WriteLine("Workbook saved as Result.xlsx");
    }
}
```

**ุงูุฅุฎุฑุงุฌ ุงููุชููุน ูู ูุญุฏุฉ ุงูุชุญูู**

```
A1 = Value
Comment = This is a comment
Workbook saved as Result.xlsx
```

ุงูุชุญ `Result.xlsx` ูุณุชุฑู ุงููููุฉ ุงูุญุฑููุฉ โValueโ ูู ุงูุฎููุฉโฏA1 ูุชุนููููุง ูุฑูููุง ุจููุณ ุงูุฎููุฉ.

---

## ๐ ุงูุฎูุงุตุฉ

ุฃูุช ุงูุขู ุชุนุฑู ููููุฉ **ุฅูุดุงุก ูุฌููุนุฉ ุนูุงูุงุช ุฐููุฉ** ูู C# ุจุงุณุชุฎุฏุงู Aspose.Cellsุ ุฅุถุงูุฉ ูู ูู ุนูุงูุงุช ุงูุจูุงูุงุช ูุงูุชุนูููุงุชุ ุฑุจุทูุง ุจูุฑูุฉ ุนููุ ูุงุณุชุฏุนุงุก ุทุฑููุฉ `Apply()` ูุชุฌุณูุฏ ุงูุชุบููุฑุงุช. ูุฐุง ุงูููุท ูุชูุณุน ุจุณูููุฉ: ููุท ุนุจู ุงููุฌููุนุฉ ุจูุฏุฑ ูุง ุชุญุชุงุฌ ูู ููุงุชูุญุ ุงุฑุจุทูุง ูุฑุฉ ูุงุญุฏุฉุ ูุฏุน ุงููุญุฑู ูุชููู ุงูุนูู ุงูุดุงู.

**ูุง ุงูุชุงููุ**  
- ุฌุฑูุจ ุงููุฌููุนุงุช ุงููุชุฏุงุฎูุฉ ููุจูุงูุงุช ุงููุฑููุฉ (ูุซู ุชูุงุฑูุฑ ุงูุฑุฆูุณโุงูุชูุตูู).  
- ุงุฌูุน ุจูู ุงูุนูุงูุงุช ุงูุฐููุฉ ูุฅูุดุงุก ูุฎุทุทุงุช **Aspose.Cells** ูููุญุฉ ูุนูููุงุช ุฏููุงููููุฉ.  
- ุงุณุชูุดู ุทุฑููุฉ `MarkerCollection.Clone()` ูุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงูููุงูุจ ุนุจุฑ ูุตููุงุช ูุชุนุฏุฏุฉ ุฏูู ุฅุนุงุฏุฉ ุจูุงุก ุงูุนูุงูุงุช ูู ูู ูุฑุฉ.

ูุง ุชุชุฑุฏุฏ ูู ุชุฑู ุชุนููู ุฅุฐุง ูุงุฌูุช ุฃู ุตุนูุจุงุชุ ุฃู ูุดุงุฑูุฉ ููู ุงุณุชูุฏุช ูู ุงูุนูุงูุงุช ุงูุฐููุฉ ูู ูุดุงุฑูุนู. Happy coding!  

![ูุฎุทุท ููุถุญ ููููุฉ ุฅูุดุงุก ูุฌููุนุฉ ุนูุงูุงุช ุฐููุฉ ูู Aspose.Cells](https://example.com/images/smart-marker-collection-diagram.png "ูุฎุทุท ุฅูุดุงุก ูุฌููุนุฉ ุนูุงูุงุช ุฐููุฉ")

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}