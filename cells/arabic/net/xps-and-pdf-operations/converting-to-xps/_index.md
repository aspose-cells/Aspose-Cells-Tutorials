---
title: التحويل إلى XPS في .NET
linktitle: التحويل إلى XPS في .NET
second_title: واجهة برمجة تطبيقات معالجة Excel الخاصة بـ Aspose.Cells .NET
description: تعرف على كيفية تحويل ملفات Excel إلى تنسيق XPS باستخدام Aspose.Cells لـ .NET في بضع خطوات سهلة، مصحوبة بأمثلة عملية للكود.
weight: 10
url: /ar/net/xps-and-pdf-operations/converting-to-xps/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# التحويل إلى XPS في .NET

## مقدمة
عندما يتعلق الأمر بتحويل ملفات Excel إلى تنسيق XPS، فقد تشعر أنك لست على دراية كافية، خاصة إذا كنت جديدًا في عالم البرمجة أو تتعمق في تطوير .NET. ولكن لا تقلق! في هذا الدليل، سنقوم بتقسيم العملية باستخدام Aspose.Cells لـ .NET مثل المحترفين. بحلول الوقت الذي تنتهي فيه من القراءة، لن يكون لديك فهم واضح لكيفية القيام بذلك فحسب، بل ستكتسب أيضًا بعض الأفكار العملية التي يمكن أن ترفع من مهاراتك في الترميز. لذا، فلنبدأ!
## المتطلبات الأساسية
قبل أن تتعمق في التفاصيل الدقيقة للتحويل، دعنا نتأكد من أنك تمتلك كل ما تحتاجه. إليك ما ستحتاج إليه:
1. Visual Studio: هذا هو برنامج التطوير المتكامل الذي ستكتب فيه الكود الخاص بك. تأكد من تثبيته.
2.  مكتبة Aspose.Cells: تحتاج إلى هذه المكتبة للتعامل مع ملفات Excel بكفاءة. يمكنك تنزيلها من[هنا](https://releases.aspose.com/cells/net/).
3. المعرفة الأساسية بـ .NET: ستساعدك المعرفة بـ C# أو VB.NET على فهم أمثلتنا بشكل أفضل.
4. ملف Excel: قم بإعداد ملف Excel نموذجي (لهذا البرنامج التعليمي، سوف نستخدم "Book1.xls") جاهزًا في دليل العمل الخاص بك.

## استيراد الحزم
الآن بعد أن قمنا بتغطية المتطلبات الأساسية، فلننتقل إلى استيراد الحزم الضرورية. يعد استيراد المساحات الصحيحة أمرًا بالغ الأهمية، حيث يخبر المترجم بمكان العثور على الفئات والطرق التي سنستخدمها.
### قم بإعداد مشروعك
أولاً وقبل كل شيء، افتح Visual Studio وأنشئ مشروعًا جديدًا. اختر تطبيق وحدة التحكم، فهو سهل وبسيط ومثالي لهذا النوع من المهام.
### أضف Aspose.Cells إلى مشروعك
للبدء في استخدام Aspose.Cells، تحتاج إلى إضافة المكتبة. للقيام بذلك:
1. انقر بزر الماوس الأيمن على مشروعك في مستكشف الحلول.
2. انقر فوق "إدارة حزم NuGet".
3. ابحث عن "Aspose.Cells" وانقر على "تثبيت".
### استيراد المساحات المطلوبة
في بداية ملف C#، ستحتاج إلى استيراد Aspose.Cells. ويتضمن هذا إضافة التعليمات التالية باستخدام:
```csharp
using System.IO;
using Aspose.Cells;
```
دعونا نقوم بتقسيم عملية تحويل ملف Excel إلى تنسيق XPS إلى خطوات بسيطة وقابلة للإدارة. 
## الخطوة 1: قم بتحديد دليل المستندات الخاص بك
هنا يمكنك تحديد المسار الذي توجد به ملفات Excel. وهذا أمر بالغ الأهمية لأن الكود سيحتاج إلى معرفة مكان العثور على الملفات.
```csharp
string dataDir = "Your Document Directory"; // تأكد من الاستبدال بالمسار الفعلي الخاص بك
```
## الخطوة 2: فتح ملف Excel
الآن، لنقم بتحميل ملف Excel الخاص بك إلى كائن Aspose Workbook. يتيح هذا الإجراء لبرنامجك الوصول إلى البيانات الموجودة داخل ملف Excel هذا.
```csharp
Workbook workbook = new Workbook(dataDir + "Book1.xls");
```
 هنا، نقوم بإنشاء مثيل جديد لـ`Workbook` الفئة وتحميل "Book1.xls" فيها.
## الخطوة 3: الوصول إلى ورقة العمل الأولى
بعد ذلك، نحتاج إلى الحصول على ورقة العمل التي نريد العمل عليها. نظرًا لأننا نستخدم ورقة العمل الأولى، فسيبدو الكود الخاص بنا على النحو التالي:
```csharp
Worksheet sheet = workbook.Worksheets[0]; // الوصول إلى ورقة العمل الأولى
```
يسمح لك هذا السطر من التعليمات البرمجية بالوصول إلى ورقة العمل الأولى للحصول على أوامر أخرى.
## الخطوة 4: تكوين خيارات الصورة والطباعة
 الآن نحتاج إلى تحديد كيفية عرض الناتج الذي نريده. يتضمن هذا إنشاء مثيل لـ`ImageOrPrintOptions` وتعيين تنسيق الإخراج المطلوب.
```csharp
Aspose.Cells.Rendering.ImageOrPrintOptions options = new Aspose.Cells.Rendering.ImageOrPrintOptions();
options.SaveFormat = SaveFormat.Xps; // ضبط تنسيق الإخراج إلى XPS
```
تخبر هذه الخطوة Aspose أننا نريد تحويل محتوى Excel إلى تنسيق XPS.
## الخطوة 5: عرض الورقة
بعد تحديد الخيارات، حان الوقت لعرض الورقة المحددة:
```csharp
Aspose.Cells.Rendering.SheetRender sr = new Aspose.Cells.Rendering.SheetRender(sheet, options);
sr.ToImage(0, dataDir + "out_printingxps.out.xps");
```
 هنا، قمنا بإنشاء`SheetRender` الكائن الذي يتولى عملية العرض. الطريقة`ToImage` يتعامل مع التحويل الفعلي ويحفظ الناتج الناتج باسم "out_printingxps.out.xps".
## الخطوة 6: تصدير المصنف بأكمله إلى XPS
إذا كنت تريد تحويل المصنف بأكمله بدلاً من ورقة واحدة فقط، فيمكنك اتباع هذه الخطوة الإضافية:
```csharp
WorkbookRender wr = new WorkbookRender(workbook, options);
wr.ToImage(dataDir + "out_whole_printingxps.out.xps");
```
يتيح لك مقتطف التعليمات البرمجية هذا تصدير المصنف بأكمله دفعة واحدة، مما يجعله فعالاً إذا كان لديك أوراق عمل متعددة لتحويلها.
## خاتمة
تهانينا! لقد نجحت في تحويل ملف Excel إلى تنسيق XPS باستخدام مكتبة Aspose.Cells في .NET. قد يبدو الأمر وكأنه خطوات كثيرة، لكن كل منها تلعب دورًا حيويًا في العملية. وبفضل هذه المعرفة، أصبحت مجهزًا جيدًا للتعامل مع ملفات Excel في تطبيقاتك وتحسينها لتناسب التنسيقات المختلفة. لذا في المرة القادمة التي يسألك فيها شخص ما عن كيفية تحويل جداول البيانات المزعجة هذه، ستعرف بالضبط ما يجب عليك فعله!
## الأسئلة الشائعة
### ما هو تنسيق XPS؟
XPS (مواصفات ورق XML) هو تنسيق مستند ثابت يحتفظ بتخطيط ومظهر المستندات.
### هل أحتاج إلى شراء Aspose.Cells لاستخدامه؟
 يمكنك تجربة نسخة تجريبية مجانية من Aspose.Cells المتاحة[هنا](https://releases.aspose.com/)بعد ذلك، قد تحتاج إلى شراء ترخيص للاستفادة من الوظائف الكاملة.
### هل يمكنني تحويل ملفات Excel متعددة مرة واحدة؟
نعم، يمكنك تكييف الكود للتنقل عبر ملفات متعددة في الدليل وتطبيق نفس منطق التحويل لكل ملف.
### ماذا لو كنت بحاجة إلى تحويل أوراق محددة فقط؟
 يمكنك تحديد فهرس الورقة التي تريدها في`SheetRender` الكائن كما هو موضح في خطواتنا.
### أين يمكنني العثور على مزيد من المعلومات حول Aspose.Cells؟
 يمكنك استكشاف[التوثيق](https://reference.aspose.com/cells/net/) لمزيد من الميزات والخيارات المتقدمة المتوفرة مع المكتبة.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
