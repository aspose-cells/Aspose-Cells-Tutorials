---
title: إدراج صورة في رأس الصفحة وتذييلها
linktitle: إدراج صورة في رأس الصفحة وتذييلها
second_title: مرجع واجهة برمجة التطبيقات Aspose.Cells لـ .NET
description: تعرف على كيفية إدراج الصور في رؤوس الصفحات وتذييلاتها باستخدام Aspose.Cells لـ .NET من خلال هذا الدليل الشامل خطوة بخطوة.
weight: 60
url: /ar/net/excel-page-setup/insert-image-in-header-footer/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# إدراج صورة في رأس الصفحة وتذييلها

## مقدمة

عند العمل مع ملفات Excel، تلعب الرؤوس والتذييلات دورًا بالغ الأهمية في توفير السياق والمعلومات القيمة. تخيل أنك تقوم بصياغة تقرير لشركتك، ويجب أن يكون شعار الشركة موجودًا في الرأس لإضفاء لمسة احترافية عليه. في هذا الدليل، سنوضح لك كيفية استخدام Aspose.Cells for .NET لإدراج صورة في الرأس أو التذييل لأوراق Excel الخاصة بك.

## المتطلبات الأساسية

قبل الغوص في الكود الفعلي، هناك بعض الأشياء التي تحتاج إلى أن تكون جاهزة:

1.  مكتبة Aspose.Cells لـ .NET: تأكد من تثبيت مكتبة Aspose.Cells في بيئة .NET الخاصة بك. إذا لم تكن مثبتة لديك بعد، فيمكنك[تحميله هنا](https://releases.aspose.com/cells/net/).
2. Visual Studio أو أي بيئة تطوير متكاملة أخرى: ستحتاج إلى بيئة تطوير متكاملة لكتابة وتنفيذ كود C# الخاص بك.
3.  صورة نموذجية: قم بإعداد صورة تريد إدراجها في الرأس أو التذييل. في مثالنا، سنستخدم شعار شركة يسمى`aspose-logo.jpg`.
4. المعرفة الأساسية بلغة C#: على الرغم من أنها ليست إلزامية، فإن فهم لغة C# سيجعل من الأسهل عليك متابعة هذا البرنامج التعليمي.
5. الوصول إلى نظام الملفات: تأكد من أن لديك إمكانية الوصول إلى نظام الملفات الخاص بك حيث ستقرأ الصورة وتحفظ ملف Excel.

## استيراد الحزم

للبدء، تحتاج إلى استيراد المساحات الأساسية اللازمة في ملف C# الخاص بك. فيما يلي شرح سريع:

```csharp
using System.IO;
using Aspose.Cells;
using System;
```

ستوفر هذه الاستيرادات إمكانية الوصول إلى جميع الفئات التي نحتاجها للتعامل مع ملفات Excel والتعامل مع الملفات على النظام.

## الخطوة 1: إعداد مسار الدليل

أولاً، ستحتاج إلى تحديد الدليل الذي توجد به ملفات Excel والصور. قم بتحديث المسار ليناسب البنية المحلية لديك.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY"; // التحديث وفقا لذلك
```

 هذا الخط يحدد`dataDir`المتغير، وهو المسار الأساسي لتحديد الصورة التي تريد إدراجها في الرأس.

## الخطوة 2: إنشاء كائن مصنف

بعد ذلك، ستحتاج إلى إنشاء مصنف جديد ستضيف فيه صورتك.

```csharp
Workbook workbook = new Workbook();
```

 يقوم هذا السطر من التعليمات البرمجية بتهيئة مثيل جديد من`Workbook` الفئة التي تسمح لك بالتعامل مع جداول بيانات Excel.

## الخطوة 3: تحديد مسار الصورة

 حان الوقت لإنشاء متغير سلسلة يحمل المسار إلى الصورة التي تريد استخدامها. في حالتنا، نستخدم`aspose-logo.jpg`.

```csharp
string logo_url = dataDir + "aspose-logo.jpg";
```

هنا، نقوم بربط مسار الدليل مع اسم ملف الشعار.

## الخطوة 4: قراءة الصورة كبيانات ثنائية

لإدراج الصورة في الرأس، نحتاج إلى قراءة ملف الصورة كبيانات ثنائية.

```csharp
FileStream inFile = new FileStream(logo_url, FileMode.Open, FileAccess.Read);
byte[] binaryData = new byte[inFile.Length];
long bytesRead = inFile.Read(binaryData, 0, (int)inFile.Length);
```

-  ال`FileStream` يتم استخدامه لفتح الصورة في وضع القراءة.
-  ثم نعلن عن مصفوفة البايتات`binaryData` لحفظ بيانات الصورة.
-  وأخيرًا، نقرأ بيانات الصورة من`FileStream`.

## الخطوة 5: الوصول إلى كائن إعداد الصفحة

 لإجراء تغييرات على الرأس، يجب علينا الوصول إلى`PageSetup` الكائن المرتبط بالورقة العمل الأولى. 

```csharp
PageSetup pageSetup = workbook.Worksheets[0].PageSetup;
```

 هنا، نحصل على`PageSetup` الكائن الذي يسمح لنا بالتحكم في إعدادات الطباعة الخاصة بأوراق العمل.

## الخطوة 6: إدراج الصورة في الرأس

باستخدام البيانات الثنائية للصورة المتوفرة لدينا، يمكننا الآن إدراجها في الرأس.

```csharp
pageSetup.SetHeaderPicture(1, binaryData);
```

 يضع هذا الخط الصورة في القسم المركزي من العنوان. المعلمة`1` يحدد قسم الرأس.

## الخطوة 7: ضبط محتوى الرأس

الآن بعد أن أصبح لدينا صورتنا في مكانها، دعنا نضيف بعض النص إلى العنوان لتعزيز سياقه. 

```csharp
pageSetup.SetHeader(1, "&G"); // إدراج الصورة
pageSetup.SetHeader(2, "&A"); // إدراج اسم الورقة
```

- يقوم السطر الأول بإدراج عنصر نائب للصورة (`&G`).
- يضيف السطر الثاني اسم الورقة إلى القسم الأيمن من الرأس، باستخدام العنصر النائب (`&A`).

## الخطوة 8: حفظ المصنف

بعد إجراء كافة التغييرات اللازمة، حان الوقت لحفظ المصنف.

```csharp
workbook.Save(dataDir + "InsertImageInHeaderFooter_out.xls");
```

يحفظ هذا السطر المصنف باسم الملف المحدد في الدليل الذي حددته مسبقًا.

## الخطوة 9: إغلاق تدفق الملفات

 وأخيرًا، لا تنسَ إغلاق`FileStream` لتحرير الموارد.

```csharp
inFile.Close();
```

يؤدي هذا إلى إبقاء تطبيقك مرتبًا ويمنع تسرب الذاكرة.

## خاتمة

تهانينا! لقد نجحت في إضافة صورة إلى رأس ملف Excel باستخدام Aspose.Cells لـ .NET. سواء كان شعار شركة أو اقتباسًا ملهمًا، يمكن أن تعمل الرؤوس على تعزيز احترافية مستنداتك بشكل كبير. الآن، يمكنك تطبيق هذه المعرفة على مشاريع مختلفة - تخيل مدى روعة تقاريرك باستخدام الرؤوس والتذييلات المخصصة!

## الأسئلة الشائعة

### ما هي تنسيقات الملفات التي يدعمها Aspose.Cells للصور؟
يدعم Aspose.Cells مجموعة متنوعة من التنسيقات، بما في ذلك JPEG، PNG، BMP، GIF، وTIFF.

### هل يمكنني إدراج صور متعددة في الرأس/التذييل؟
نعم، يمكنك إدراج صور منفصلة في أقسام مختلفة من الرأس أو التذييل باستخدام عناصر نائبة مختلفة.

### هل Aspose.Cells مجاني؟
 يقدم Aspose.Cells نسخة تجريبية مجانية، ولكن يتوفر إصدار مرخص للوصول الكامل والميزات الإضافية. يمكنك الحصول على[رخصة مؤقتة هنا](https://purchase.aspose.com/temporary-license/).

### كيف يمكنني استكشاف الأخطاء وإصلاحها المتعلقة بعدم عرض الصور؟
تأكد من صحة مسار الصورة ووجود الملف. وتحقق أيضًا من توافق تنسيق الصورة.

### أين يمكنني العثور على وثائق إضافية لـ Aspose.Cells؟
 يمكنك العثور على وثائق مفصلة[هنا](https://reference.aspose.com/cells/net/).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
