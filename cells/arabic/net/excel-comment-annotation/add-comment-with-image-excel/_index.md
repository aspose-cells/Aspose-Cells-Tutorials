---
"description": "تعرّف على كيفية إضافة تعليقات على الصور في Excel باستخدام Aspose.Cells لـ .NET. حسّن جداول بياناتك بإضافة تعليقات توضيحية مخصصة."
"linktitle": "إضافة تعليق مع صورة في Excel"
"second_title": "واجهة برمجة تطبيقات معالجة Excel Aspose.Cells .NET"
"title": "إضافة تعليق مع صورة في Excel"
"url": "/ar/net/excel-comment-annotation/add-comment-with-image-excel/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# إضافة تعليق مع صورة في Excel

## مقدمة
يُعدّ Excel أداة فعّالة لإدارة البيانات وتحليلها، ولكنك تحتاج أحيانًا إلى إضافة لمسة شخصية إلى جداول بياناتك، أليس كذلك؟ ربما ترغب في إضافة تعليقات توضيحية إلى البيانات، أو تقديم ملاحظات، أو حتى إضافة لمسة جمالية باستخدام الصور. وهنا تبرز أهمية التعليقات! في هذا البرنامج التعليمي، سنستكشف كيفية إضافة تعليق مع صورة في Excel باستخدام مكتبة Aspose.Cells لـ .NET. يُعدّ هذا الأسلوب مفيدًا بشكل خاص لإنشاء جداول بيانات أكثر تفاعلية وجاذبية بصريًا.
## المتطلبات الأساسية
قبل أن نتعمق في التفاصيل المتعلقة بإضافة التعليقات مع الصور في Excel، دعنا نتأكد من أن لديك كل ما تحتاجه للبدء:
1. Visual Studio: تأكد من تثبيت Visual Studio على جهاز الكمبيوتر الخاص بك. هنا ستكتب وتنفذ شفرتك البرمجية.
2. Aspose.Cells لـ .NET: يجب أن يكون لديك مكتبة Aspose.Cells. إذا لم تقم بتثبيتها بعد، يمكنك تنزيلها من [هنا](https://releases.aspose.com/cells/net/).
3. المعرفة الأساسية بلغة C#: ستساعدك المعرفة ببرمجة C# على فهم مقتطفات التعليمات البرمجية بشكل أفضل.
4. ملف صورة: جهّز ملف صورة (مثل شعار) ترغب في تضمينه في تعليقك على Excel. في هذا البرنامج التعليمي، سنفترض أن لديك ملفًا باسم `logo.jpg`.
5. .NET Framework: تأكد من تثبيت .NET Framework، حيث يتطلب Aspose.Cells أن يعمل بشكل صحيح.
الآن بعد أن قمنا بتغطية المتطلبات الأساسية، دعنا ننتقل إلى الترميز الفعلي!
## استيراد الحزم
أولاً، نحتاج إلى استيراد الحزم اللازمة. في مشروع C#، تأكد من إضافة مرجع إلى مكتبة Aspose.Cells. يمكنك القيام بذلك باستخدام مدير الحزم NuGet في Visual Studio. إليك الطريقة:
1. افتح Visual Studio.
2. إنشاء مشروع جديد أو فتح مشروع موجود.
3. انقر بزر الماوس الأيمن على مشروعك في مستكشف الحلول.
4. حدد إدارة حزم NuGet.
5. ابحث عن Aspose.Cells وقم بتثبيته.

```csharp
using System.IO;
using Aspose.Cells;
using System.Drawing;
```

بعد تثبيت المكتبة، يمكنك البدء بكتابة الكود. إليك كيفية القيام بذلك خطوة بخطوة.
## الخطوة 1: إعداد دليل المستندات الخاص بك
للبدء، علينا إنشاء مجلد لحفظ ملفات إكسل. هذه خطوة بالغة الأهمية لتنظيم عملنا.
```csharp
// المسار إلى دليل المستندات.
string dataDir = "Your Document Directory";
// إنشاء الدليل إذا لم يكن موجودًا بالفعل.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
- dataDir: هذا المتغير يحمل مسار دليل المستندات. استبدل `"Your Document Directory"` مع المسار الفعلي الذي تريد حفظ ملف Excel فيه.
- Directory.Exists: يتحقق هذا من وجود الدليل بالفعل.
- Directory.CreateDirectory: إذا لم يكن الدليل موجودًا، فسيتم إنشاءه.
## الخطوة 2: إنشاء مصنف
بعد ذلك، نحتاج إلى إنشاء مثيل لـ `Workbook` هذه الفئة تمثل مصنف Excel في الذاكرة.
```csharp
// إنشاء مصنف
Workbook workbook = new Workbook();
```
- مصنف: هذا هو الفصل الرئيسي في Aspose.Cells، الذي يسمح لك بإنشاء ملفات Excel ومعالجتها. بإنشاء مثيل له، ستُنشئ مصنف Excel جديدًا.
## الخطوة 3: الحصول على مجموعة التعليقات
الآن بعد أن أصبح لدينا مصنف العمل، فلننتقل إلى مجموعة التعليقات الموجودة في ورقة العمل الأولى.
```csharp
// احصل على مرجع لمجموعة التعليقات مع الورقة الأولى
CommentCollection comments = workbook.Worksheets[0].Comments;
```
- أوراق العمل[0]: يؤدي هذا إلى الوصول إلى أول ورقة عمل في المصنف. تذكر أن الفهرس يبدأ من الصفر، لذا `[0]` يشير إلى الورقة الأولى.
- التعليقات: تتيح لنا هذه الخاصية الوصول إلى مجموعة التعليقات الموجودة على ورقة العمل هذه.
## الخطوة 4: إضافة تعليق إلى خلية
لنُضِف تعليقًا إلى خلية مُحدَّدة. في هذه الحالة، سنُضيف تعليقًا إلى الخلية A1.
```csharp
// أضف تعليقًا إلى الخلية A1
int commentIndex = comments.Add(0, 0);
Comment comment = comments[commentIndex];
comment.Note = "First note.";
comment.Font.Name = "Times New Roman";
```
- comments.Add(0, 0): تقوم هذه الطريقة بإضافة تعليق إلى الخلية A1 (الصف 0، العمود 0).
- تعليق.ملاحظة: هنا، قمنا بتعيين نص التعليق.
- comment.Font.Name: يحدد هذا الخط الخاص بنص التعليق.
## الخطوة 5: تحميل صورة في مجرى
الآن حان وقت تحميل الصورة التي نريد تضمينها في تعليقنا. سنستخدم `MemoryStream` لحفظ بيانات الصورة.
```csharp
// تحميل صورة إلى تيار
Bitmap bmp = new Bitmap(dataDir + "logo.jpg");
MemoryStream ms = new MemoryStream();
bmp.Save(ms, System.Drawing.Imaging.ImageFormat.Png);
```
- خريطة نقطية: تُستخدم هذه الفئة لتحميل ملف الصورة. تأكد من صحة المسار.
- MemoryStream: هذا هو التدفق الذي سنستخدمه لحفظ الصورة في الذاكرة.
- bmp.Save: يؤدي هذا إلى حفظ صورة الخريطة النقطية في مجرى الذاكرة بتنسيق PNG.
## الخطوة 6: تعيين بيانات الصورة إلى شكل التعليق
الآن نحتاج إلى تعيين بيانات الصورة إلى الشكل المرتبط بالتعليق الذي أنشأناه سابقًا.
```csharp
// تعيين بيانات الصورة إلى الشكل المرتبط بالتعليق
comment.CommentShape.Fill.ImageData = ms.ToArray();
```
- تعليق.شكل التعليق.ملء.بيانات الصورة: تتيح لك هذه الخاصية تعيين صورة لشكل التعليق. نقوم بتحويل `MemoryStream` إلى مصفوفة بايت باستخدام `ms.ToArray()`.
## الخطوة 7: حفظ المصنف
وأخيرًا، دعونا نحفظ مصنفنا مع التعليق والصورة المضمنة.
```csharp
// حفظ المصنف
workbook.Save(dataDir + "book1.out.xlsx", Aspose.Cells.SaveFormat.Xlsx);
```
- حفظ المصنف: تحفظ هذه الطريقة المصنف في المسار المحدد. نحفظه كملف XLSX.
## خاتمة
ها قد انتهيت! لقد نجحت في إضافة تعليق مع صورة إلى ملف Excel باستخدام Aspose.Cells لـ .NET. هذه الميزة تجعل جداول بياناتك أكثر إفادة وجاذبية بصريًا. سواء كنت تُعلق على البيانات، أو تُقدم ملاحظات، أو تُضيف لمسة شخصية، فإن التعليقات المصحوبة بالصور تُحسّن تجربة المستخدم بشكل كبير.
## الأسئلة الشائعة
### هل يمكنني إضافة تعليقات متعددة لنفس الخلية؟
لا، لا يسمح إكسل بإضافة تعليقات متعددة على الخلية نفسها. يمكنك إضافة تعليق واحد فقط لكل خلية.
### ما هي تنسيقات الصور المدعومة؟
يدعم Aspose.Cells تنسيقات الصور المختلفة، بما في ذلك PNG وJPEG وBMP.
### هل أحتاج إلى ترخيص لاستخدام Aspose.Cells؟
يقدم Aspose.Cells نسخة تجريبية مجانية، ولكن للحصول على الوظائف الكاملة، ستحتاج إلى شراء ترخيص.
### هل يمكنني تخصيص مظهر التعليق؟
نعم، يمكنك تخصيص الخط وحجم ولون نص التعليق، ويمكنك أيضًا تغيير شكل وحجم التعليق نفسه.
### أين يمكنني العثور على مزيد من الوثائق حول Aspose.Cells؟
يمكنك العثور على وثائق شاملة على Aspose.Cells [هنا](https://reference.aspose.com/cells/net/).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}