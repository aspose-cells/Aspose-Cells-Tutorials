---
"description": "تعرّف على كيفية تخصيص تنسيقات العرض باستخدام Aspose.Cells لـ .NET. نسّق التواريخ والنسب المئوية والعملات باستخدام هذا الدليل المفصل."
"linktitle": "تخصيص تنسيقات العرض باستخدام أرقام محددة من قبل المستخدم"
"second_title": "واجهة برمجة تطبيقات معالجة Excel Aspose.Cells .NET"
"title": "تخصيص تنسيقات العرض باستخدام أرقام محددة من قبل المستخدم"
"url": "/ar/net/number-and-display-formats-in-excel/customizing-display-formats-with-user-defined-numbers/"
"weight": 11
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# تخصيص تنسيقات العرض باستخدام أرقام محددة من قبل المستخدم

## مقدمة
يتطلب العمل مع ملفات Excel غالبًا تنسيقًا مخصصًا للخلايا لعرض البيانات بطريقة أكثر وضوحًا وسهولة في الاستخدام. تخيل أنك تُنشئ ملف Excel لتقرير. أنت لا تريد أرقامًا خامًا فحسب، بل تريد أيضًا أن تبدو التواريخ والنسب المئوية والعملات أنيقة واحترافية، أليس كذلك؟ هنا يأتي دور تنسيقات العرض المخصصة. في هذا البرنامج التعليمي، سنتعمق في Aspose.Cells لـ .NET لنوضح لك كيفية تخصيص تنسيق عرض الأرقام باستخدام إعدادات مُحددة من قِبل المستخدم.
## المتطلبات الأساسية
قبل البدء، تأكد من تجهيز كل ما يلزم لمتابعة هذا البرنامج التعليمي. إليك ما ستحتاجه:
- تم تثبيت Aspose.Cells لـ .NET. [تحميله هنا](https://releases.aspose.com/cells/net/).
- المعرفة الأساسية بلغة C# وإطار عمل .NET.
- ترخيص صالح لـ Aspose.Cells. إذا لم يكن لديك ترخيص، فاحصل عليه. [نسخة تجريبية مجانية](https://releases.aspose.com/) أو اطلب [رخصة مؤقتة](https://purchase.aspose.com/temporary-license/).
- بيئة تطوير متكاملة مثل Visual Studio.
- .NET Framework 4.0 أو أعلى.
إذا فاتك أي شيء، فلا تقلق. يمكنك دائمًا إعادة زيارة هذه الروابط لتنزيل الملفات اللازمة أو طلب المساعدة من [منتدى دعم Aspose](https://forum.aspose.com/c/cells/9).
## استيراد مساحات الأسماء
قبل القفز إلى الكود، تحتاج إلى استيراد المساحات المطلوبة للوصول إلى جميع وظائف Aspose.Cells الضرورية.
```csharp
using System.IO;
using Aspose.Cells;
using System;
```
ستكون هاتان المساحتان الأساسيتان أدواتك الأساسية في هذا البرنامج التعليمي. والآن، لننتقل إلى الجزء الممتع:
## الخطوة 1: إعداد دليل المشروع
أولاً، أنت بحاجة إلى مكان لتخزين ملفاتك، أليس كذلك؟ لنُنشئ مجلدًا لحفظ ملف Excel الناتج. في هذه الخطوة، سنتأكد أيضًا من وجود المجلد قبل حفظ أي شيء.
```csharp
// المسار إلى دليل المستندات.
string dataDir = "Your Document Directory";
// إنشاء الدليل إذا لم يكن موجودًا بالفعل.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
- نحن نحدد `dataDir` متغير لتخزين المسار الذي سيذهب إليه ملف Excel الناتج.
- ثم نتحقق مما إذا كان الدليل موجودًا باستخدام `System.IO.Directory.Exists()`.
- إذا لم يكن الدليل موجودًا، فسيتم إنشاؤه باستخدام `System.IO.Directory.CreateDirectory()`.
## الخطوة 2: إنشاء مصنف جديد وإضافة ورقة عمل
الآن بعد أن حصلنا على الدليل، فلنقم بإنشاء مصنف Excel جديد وإضافة ورقة عمل إليه.
```csharp
// إنشاء كائن مصنف
Workbook workbook = new Workbook();
// إضافة ورقة عمل جديدة إلى كائن Excel
int i = workbook.Worksheets.Add();
// الحصول على مرجع ورقة العمل المضافة حديثًا عن طريق تمرير فهرس الورقة الخاصة بها
Worksheet worksheet = workbook.Worksheets[i];
```
- أولاً، نقوم بإنشاء ملف جديد `Workbook` اعتبر هذا بمثابة ملف Excel الخاص بك.
- نضيف ورقة عمل جديدة إلى هذا المصنف باستخدام `Add()` الطريقة وتخزين الفهرس في المتغير `i`.
- نحن نشير إلى ورقة العمل هذه باستخدام `workbook.Worksheets[i]`.
## الخطوة 3: إضافة التاريخ إلى خلية وتخصيص تنسيقها
الآن، لنُدخل التاريخ الحالي في خلية ونُنسّقه لعرضه بطريقة مُخصصة. بدلًا من تنسيق التاريخ الافتراضي، سنُعيّن تنسيقًا مُخصصًا مثل `d-mmm-yy`.
```csharp
// إضافة تاريخ النظام الحالي إلى الخلية "A1"
worksheet.Cells["A1"].PutValue(DateTime.Now);
// الحصول على نمط الخلية A1
Style style = worksheet.Cells["A1"].GetStyle();
// ضبط تنسيق العرض المخصص لإظهار التاريخ كـ "d-mmm-yy"
style.Custom = "d-mmm-yy";
// تطبيق النمط على الخلية A1
worksheet.Cells["A1"].SetStyle(style);
```
- نضيف تاريخ النظام الحالي إلى الخلية `A1` استخدام `PutValue(DateTime.Now)`.
- نحن نسترد النمط الحالي للخلية `A1` استخدام `GetStyle()`.
- نقوم بتعديل نمط الخلية عن طريق الضبط `style.Custom = "d-mmm-yy"`، الذي يقوم بتنسيق التاريخ لإظهار اليوم والشهر المختصر والسنة.
- وأخيرًا، نطبق النمط الجديد على الخلية باستخدام `SetStyle()`.
## الخطوة 4: تنسيق الخلية كنسبة مئوية
الآن، لنبدأ بالأرقام. سنضيف قيمة رقمية إلى خلية أخرى، مثلاً `A2`، وتنسيقها كنسبة مئوية.
```csharp
// إضافة قيمة رقمية إلى الخلية "A2"
worksheet.Cells["A2"].PutValue(20);
// الحصول على نمط الخلية A2
style = worksheet.Cells["A2"].GetStyle();
// تعيين تنسيق العرض المخصص لإظهار القيمة كنسبة مئوية
style.Custom = "0.0%";
// تطبيق النمط على الخلية A2
worksheet.Cells["A2"].SetStyle(style);
```
- نحن نضيف القيمة `20` إلى الخلية `A2`.
- نحن نستعيد نمط الخلية `A2` وضبط التنسيق المخصص إلى `0.0%` لعرض القيمة كنسبة مئوية (أي 20%).
- وأخيرًا، نطبق النمط على الخلية باستخدام `SetStyle()`.
## الخطوة 5: تنسيق الخلية كعملة
دعنا نضيف قيمة أخرى، لنقل إلى الخلية `A3`، ونسّقها لعرضها كعملة. ولجعل الأمور أكثر تشويقًا، سنستخدم تنسيقًا يعرض القيم الإيجابية كعملة بالجنيه الإسترليني والقيم السلبية بالدولار.
```csharp
// إضافة قيمة رقمية إلى الخلية "A3"
worksheet.Cells["A3"].PutValue(2546);
// الحصول على نمط خلية A3
style = worksheet.Cells["A3"].GetStyle();
// تعيين تنسيق العرض المخصص لإظهار القيمة كعملة
style.Custom = "£#,##0;[Red]$-#,##0";
// تطبيق النمط على خلية A3
worksheet.Cells["A3"].SetStyle(style);
```
- نحن نضيف القيمة `2546` إلى الخلية `A3`.
- لقد حددنا تنسيقًا مخصصًا `£#,##0;[Red]$-#,##0`، والذي يعرض القيم الإيجابية بعلامة الجنيه والقيم السلبية باللون الأحمر بعلامة الدولار.
- نطبق النمط على الخلية باستخدام `SetStyle()`.
## الخطوة 6: حفظ المصنف
الخطوة الأخيرة هي حفظ المصنف كملف Excel. سنستخدم تنسيق Excel 97-2003 في هذا البرنامج التعليمي.
```csharp
// حفظ ملف Excel
workbook.Save(dataDir + "book1.out.xls", SaveFormat.Excel97To2003);
```
- ال `Save()` تحفظ الطريقة المصنف في الدليل المحدد.
- نحن نختار `SaveFormat.Excel97To2003` لضمان التوافق مع الإصدارات الأقدم من Excel.
## خاتمة
هذا كل ما في الأمر! لقد أنشأنا ملف Excel، وأضفنا تنسيقات مخصصة للتاريخ والنسب المئوية والعملات إلى خلايا محددة باستخدام Aspose.Cells لـ .NET، وحفظنا الملف. التنسيق المخصص يجعل ملفات Excel الخاصة بك أكثر سهولة في القراءة واحترافية. لا تنسَ استكشاف خيارات التنسيق الأخرى في Aspose.Cells، مثل التنسيق الشرطي، لمزيد من التحكم في مظهر بياناتك.
## الأسئلة الشائعة
### كيف يمكنني تطبيق خيارات التنسيق الأكثر تعقيدًا في Aspose.Cells؟
يمكنك الجمع بين أنماط التنسيق المختلفة، مثل لون الخط والحدود وألوان الخلفية، مع تنسيقات الأرقام المخصصة.
### هل يمكنني تطبيق تنسيق رقم مخصص على نطاق من الخلايا؟
نعم، يسمح لك Aspose.Cells بتطبيق نمط على نطاق من الخلايا باستخدام `Range.SetStyle()` طريقة.
### ما هي تنسيقات الملفات الأخرى التي يمكنني حفظ المصنف بها؟
يدعم Aspose.Cells العديد من التنسيقات، بما في ذلك XLSX وCSV وPDF. ما عليك سوى تغيير `SaveFormat` في `Save()` طريقة.
### هل يمكنني تنسيق الأرقام السلبية بشكل مختلف؟
بالتأكيد! يمكنك استخدام تنسيقات أرقام مخصصة لعرض الأرقام السالبة بألوان أو رموز مختلفة.
### هل Aspose.Cells لـ .NET مجاني؟
يقدم Aspose.Cells نسخة تجريبية مجانية، ولكن للاستفادة من كامل وظائفه، ستحتاج إلى ترخيص ساري المفعول. يمكنك الحصول على [رخصة مؤقتة هنا](https://purchase.aspose.com/temporary-license/).


{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}