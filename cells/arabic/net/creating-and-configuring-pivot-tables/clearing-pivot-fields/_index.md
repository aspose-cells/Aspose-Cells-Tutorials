---
title: مسح حقول المحور برمجيًا في .NET
linktitle: مسح حقول المحور برمجيًا في .NET
second_title: واجهة برمجة تطبيقات معالجة Excel الخاصة بـ Aspose.Cells .NET
description: استخدم قوة Aspose.Cells لـ .NET. قم بمسح الحقول المحورية في Excel بسهولة باستخدام البرنامج التعليمي الكامل خطوة بخطوة.
weight: 11
url: /ar/net/creating-and-configuring-pivot-tables/clearing-pivot-fields/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# مسح حقول المحور برمجيًا في .NET

## مقدمة
هل سبق لك أن تجولت عبر عدد لا يحصى من جداول Excel، محاولًا معرفة كيفية تنظيف فوضى حقول المحور برمجيًا؟ حسنًا، أنت في المكان الصحيح! في هذه المقالة، سنتعمق في استخدام Aspose.Cells لـ .NET، وهو مكون قوي للتعامل مع ملفات Excel، لمسح حقول المحور دون عناء. لن أطلعك على العملية خطوة بخطوة فحسب، بل سأتأكد أيضًا من فهمك "لماذا" و"كيف" وراء كل خطوة نقوم بها. سواء كنت مطورًا أو مهووسًا بـ Excel، سيساعدك هذا الدليل على تحقيق أقصى استفادة من مهام أتمتة Excel الخاصة بك.

## المتطلبات الأساسية
قبل أن نبدأ هذه الرحلة، هناك بعض الأشياء التي يجب أن تكون موجودة في مجموعة أدواتك:

1. Visual Studio: تأكد من تثبيت Visual Studio على جهازك. سنستخدم بيئة التطوير المتكاملة هذه لكتابة كود .NET الخاص بنا.
2.  Aspose.Cells for .NET: هذه هي الحزمة الرئيسية التي سنستخدمها لمعالجة ملفات Excel. إذا لم تقم بذلك بعد، فيمكنك تنزيلها[هنا](https://releases.aspose.com/cells/net/).
3. المعرفة الأساسية بلغة C#: لا يلزمك أن تكون خبيرًا، ولكن الحصول على فهم أساسي للغة C# سيساعدك في التنقل عبر الكود الذي سنستكشفه معًا.

## استيراد الحزم
بمجرد حصولك على هذه الأساسيات، حان الوقت لإعداد مساحة العمل الخاصة بنا. فيما يلي كيفية استيراد الحزم اللازمة للبدء في استخدام Aspose.Cells لـ .NET:

### إنشاء مشروع جديد
افتح Visual Studio وأنشئ مشروع تطبيق وحدة تحكم C# جديد. هذه هي مساحة العمل الخاصة بك، حيث ستكتب التعليمات البرمجية لمسح حقول المحور.

### إضافة المراجع
في مشروعك، انقر بزر الماوس الأيمن على "المراجع". حدد "إضافة مرجع" ثم استعرض للعثور على ملف Aspose.Cells.dll الذي قمت بتنزيله. تتيح هذه الخطوة لمشروعك الاستفادة من الوظائف التي يوفرها Aspose.Cells.

### تضمين استخدام التوجيهات
في أعلى ملف C# الخاص بك، أضف التوجيه التالي:

```csharp
using System.IO;
using Aspose.Cells;
using System.Drawing;
using Aspose.Cells.Pivot;
```

هذا يشبه دعوة مكتبة Aspose.Cells للانضمام إلى حفلة البرمجة الخاصة بك، مما يتيح لك الوصول السريع إلى ميزاتها المذهلة.

الآن، دعنا ننتقل مباشرة إلى المهمة الرئيسية: مسح حقول المحور من ورقة عمل Excel. وسنقسم هذه المهمة إلى خطوات يمكن فهمها.

## الخطوة 1: تعيين دليل المستندات
أولاً وقبل كل شيء، نحتاج إلى تحديد مكان حفظ ملف Excel. وهذا مهم لأنه إذا لم يعرف الكود الخاص بك أين يبحث، فسيكون الأمر أشبه بالبحث عن المفاتيح في المكان الخطأ! وإليك كيفية القيام بذلك:

```csharp
// المسار إلى دليل المستندات.
string dataDir = "Your Document Directory";
```
استبدل "دليل المستندات الخاص بك" بالمسار الفعلي للمستند الخاص بك. سيوجه هذا البرنامج للبحث في المجلد الصحيح!

## الخطوة 2: تحميل المصنف
بعد ذلك، دعنا نحمل ملف Excel الذي نريد العمل عليه. فكر في هذه الخطوة وكأنها فتح كتاب. لن تتمكن من قراءة ما بداخله إلا بعد فتحه!

```csharp
// تحميل ملف القالب
Workbook workbook = new Workbook(dataDir + "Book1.xls");
```
 هنا، نقوم بإنشاء مثيل جديد`Workbook` الكائن وتحميل ملف Excel الخاص بنا المسمى "Book1.xls". يتيح لنا هذا التفاعل مع البيانات الموجودة.

## الخطوة 3: الوصول إلى ورقة العمل
الآن بعد أن فتحنا المصنف، نحتاج إلى الوصول إلى ورقة العمل المحددة التي تحتوي على جداول البيانات المحورية. الأمر أشبه بتصفح الصفحات للعثور على الصفحة التي تحتاجها.

```csharp
// احصل على ورقة العمل الأولى
Worksheet sheet = workbook.Worksheets[0];
```
 ال`Worksheets`تتيح لنا المجموعة التقاط أي ورقة من خلال فهرسها (بدءًا من 0). هنا، سنأخذ الورقة الأولى فقط.

## الخطوة 4: الحصول على جداول المحور
الخطوة التالية هي جمع كل الجداول المحورية من ورقة العمل التي اخترناها. حان الوقت لمعرفة ما نعمل عليه!

```csharp
// احصل على الجداول المحورية في الورقة
PivotTableCollection pivotTables = sheet.PivotTables;
```
 نحن ننشئ`PivotTableCollection` مثال يحتوي على جميع جداول البيانات المحورية الموجودة في الورقة. هذه هي مجموعة أدواتنا لإدارة جداول البيانات المحورية.

## الخطوة 5: الوصول إلى جدول المحور الأول
دعنا نركز على الجدول المحوري الأول لهذا المثال. الأمر أشبه باتخاذ قرار بالعمل على مشروع واحد بدلاً من إدارة العديد من المشاريع في وقت واحد!

```csharp
// احصل على أول جدول محوري
PivotTable pivotTable = pivotTables[0];
```
كما في السابق، نقوم بالوصول إلى الجدول المحوري الأول. تأكد من أن ورقتك تحتوي على جدول محوري واحد على الأقل؛ وإلا فقد تصادف مرجعًا فارغًا!

## الخطوة 6: مسح حقول البيانات
الآن وصلنا إلى الجزء الأكثر أهمية: مسح حقول البيانات في جدولنا المحوري. يساعد هذا في إعادة ضبط أي حسابات أو ملخصات.
```csharp
//مسح كافة حقول البيانات
pivotTable.DataFields.Clear();
```
 ال`Clear()` الطريقة تشبه الضغط على زر إعادة الضبط، مما يسمح لنا بالبدء من جديد بحقول البيانات الخاصة بنا.

## الخطوة 7: إضافة حقل بيانات جديد
بمجرد مسح حقول البيانات القديمة، يمكننا إضافة حقول جديدة. هذه الخطوة تشبه تمامًا تغيير المكونات في وصفة لطبق جديد!

```csharp
// إضافة حقل بيانات جديد
pivotTable.AddFieldToArea(PivotFieldType.Data, "Betrag Netto FW");
```
هنا، نضيف حقل بيانات جديد يسمى "Betrag Netto FW". هذه هي نقطة البيانات التي نريد أن يقوم جدولنا المحوري بتحليلها.

## الخطوة 8: تعيين علامة تحديث البيانات
الآن، دعونا نتأكد من تحديث بياناتنا بشكل صحيح.
```csharp
// تعيين علم تحديث البيانات على
pivotTable.RefreshDataFlag = false;
```
 ضبط`RefreshDataFlag` يؤدي استخدام false إلى تجنب جلب البيانات غير الضرورية. الأمر أشبه بإخبار مساعدك بعدم الذهاب للبحث عن البقالة الآن!

## الخطوة 9: تحديث البيانات وحسابها
دعونا نضغط على زر التحديث ونقوم ببعض الحسابات للتأكد من تحديث جدول المحور الخاص بنا بالبيانات الجديدة.

```csharp
// تحديث بيانات الجدول المحوري وحسابها
pivotTable.RefreshData();
pivotTable.CalculateData();
```
 ال`RefreshData()`تقوم الطريقة بجلب البيانات الحالية وتحديث جدول المحور. وفي الوقت نفسه،`CalculateData()` معالجة أي حسابات تحتاج إلى إجرائها.

## الخطوة 10: احفظ المصنف
أخيرًا، دعنا نحفظ التغييرات التي أجريناها على ملف Excel. الأمر أشبه بإغلاق المغلف بعد كتابة الرسالة!

```csharp
// حفظ ملف Excel
workbook.Save(dataDir + "output.xls");
```
هنا، تقوم بحفظ المصنف المعدّل باسم "output.xls". تأكد من حصولك على الإذن بالكتابة في دليل المستندات الخاص بك!

## خاتمة
لقد تعلمت للتو كيفية مسح حقول المحور برمجيًا في .NET باستخدام Aspose.Cells. سواء كنت تقوم بتنظيف البيانات القديمة أو تستعد لتحليلات جديدة، فإن هذا النهج يسمح لك بتجربة سلسة مع مستندات Excel الخاصة بك. لذا، انطلق وجرب الأمر! تذكر أن الممارسة تؤدي إلى الإتقان، وكلما جربت Aspose.Cells أكثر، كلما أصبحت أكثر راحة.

## الأسئلة الشائعة

### ما هو Aspose.Cells لـ .NET؟
Aspose.Cells for .NET عبارة عن مكتبة للتعامل مع ملفات Excel، مما يسمح للمستخدمين بإنشاء ملفات Excel وتحريرها وتحويلها وطباعتها.

### هل أحتاج إلى ترخيص لـ Aspose.Cells؟
 Aspose.Cells هي مكتبة مدفوعة الأجر، ولكن يمكنك البدء بإصدار تجريبي مجاني[هنا](https://releases.aspose.com/).

### هل يمكنني مسح حقول محورية متعددة باستخدام هذه الطريقة؟
نعم! يمكنك استخدام حلقة للتنقل عبر جداول محورية متعددة ومسح حقولها حسب الحاجة.

### ما هي أنواع الملفات التي يمكنني التعامل معها باستخدام Aspose.Cells؟
يمكنك العمل مع تنسيقات Excel المختلفة مثل XLS، وXLSX، وCSV، وغيرها الكثير.

### هل يوجد مجتمع للمساعدة مع Aspose.Cells؟
 بالتأكيد! يمكن العثور على دعم مجتمع Aspose[هنا](https://forum.aspose.com/c/cells/9).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
