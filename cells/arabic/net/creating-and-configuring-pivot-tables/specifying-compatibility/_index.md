---
"description": "تعلم كيفية التعامل مع جداول البيانات المحورية في Excel باستخدام Aspose.Cells لـ .NET، بما في ذلك تحديثات البيانات وإعدادات التوافق وتنسيق الخلايا."
"linktitle": "تحديد توافق ملف Excel برمجيًا في .NET"
"second_title": "واجهة برمجة تطبيقات معالجة Excel Aspose.Cells .NET"
"title": "تحديد توافق ملف Excel برمجيًا في .NET"
"url": "/ar/net/creating-and-configuring-pivot-tables/specifying-compatibility/"
"weight": 23
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# تحديد توافق ملف Excel برمجيًا في .NET

## مقدمة

في عالمنا اليوم الذي يعتمد على البيانات، أصبحت إدارة ملفات Excel ومعالجتها برمجيًا أمرًا بالغ الأهمية للعديد من المطورين. إذا كنت تعمل على Excel في بيئة .NET، فإن Aspose.Cells مكتبة فعّالة تُسهّل إنشاء ملفات Excel وقراءتها وتعديلها وحفظها. من أهم ميزات هذه المكتبة إمكانية تحديد توافق ملفات Excel برمجيًا. في هذا البرنامج التعليمي، سنستكشف كيفية معالجة ملفات Excel، مع التركيز بشكل خاص على إدارة التوافق باستخدام Aspose.Cells لبيئة .NET. في النهاية، ستفهم كيفية ضبط توافق ملفات Excel، وخاصةً جداول البيانات المحورية، أثناء تحديث البيانات وإدارتها.

## المتطلبات الأساسية

قبل الخوض في مرحلة الترميز، تأكد من أن لديك ما يلي:

1. المعرفة الأساسية بلغة C#: نظرًا لأننا سنكتب التعليمات البرمجية بلغة C#، فإن الإلمام باللغة سيساعدك على فهم البرنامج التعليمي بشكل أفضل.
2. مكتبة Aspose.Cells لـ .NET: يمكنك تنزيلها من [صفحة إصدارات Aspose Cells](https://releases.aspose.com/cells/net/)إذا لم تكن قد فعلت ذلك بالفعل، ففكر في الحصول على نسخة تجريبية مجانية لاستكشاف ميزاته أولاً.
3. Visual Studio: بيئة تطوير متكاملة يمكنك من خلالها كتابة واختبار كود C# الخاص بك بفعالية.
4. ملف إكسل نموذجي: تأكد من وجود ملف إكسل نموذجي، ويفضل أن يحتوي على جدول محوري للعرض التوضيحي. في مثالنا، سنستخدم `sample-pivot-table.xlsx`.

بعد وضع هذه المتطلبات الأساسية في مكانها، فلنبدأ عملية الترميز.

## استيراد الحزم

قبل البدء بكتابة تطبيقك، عليك تضمين مساحات الأسماء اللازمة في الكود الخاص بك للاستفادة من مكتبة Aspose.Cells بفعالية. إليك كيفية القيام بذلك.

### استيراد مساحة اسم Aspose.Cells

```csharp
using System.IO;
using System;
using Aspose.Cells;
using Aspose.Cells.Pivot;
using System.Drawing;
```

يضمن هذا السطر من التعليمات البرمجية إمكانية الوصول إلى جميع الفئات والطرق داخل مكتبة Aspose.Cells.

الآن، دعونا نقوم بتقسيم العملية بالتفصيل للتأكد من أن كل شيء واضح ومفهوم.

## الخطوة 1: إعداد الدليل الخاص بك

أولاً، حدّد المجلد الذي تحفظ فيه ملفات Excel. من المهم تحديد المسار الصحيح للملف.

```csharp
// المسار إلى دليل المستندات.
string dataDir = "Your Document Directory";
```

هنا، استبدل `"Your Document Directory"` مع المسار الفعلي لملفات Excel. هذا هو المكان الذي يجب أن يوجد فيه ملف الجدول المحوري النموذجي.

## الخطوة 2: تحميل ملف Excel المصدر

بعد ذلك، نحتاج إلى تحميل ملف Excel الذي يحتوي على جدول البيانات المحوري النموذجي. 

```csharp
// تحميل ملف Excel المصدر الذي يحتوي على جدول محوري نموذجي
Workbook wb = new Workbook(dataDir + "sample-pivot-table.xlsx");
```

في هذه الخطوة، نقوم بإنشاء مثيل لـ `Workbook` الفئة التي تقوم بتحميل ملف Excel المحدد. 

## الخطوة 3: الوصول إلى أوراق العمل

الآن بعد أن تم تحميل المصنف، يتعين عليك الوصول إلى ورقة العمل التي تحتوي على بيانات الجدول المحوري.

```csharp
// الوصول إلى أول ورقة عمل تحتوي على بيانات جدول محوري
Worksheet dataSheet = wb.Worksheets[0];
```

هنا، نصل إلى ورقة العمل الأولى التي تحتوي على الجدول المحوري. يمكنك أيضًا التنقل بين أوراق العمل الأخرى أو تحديدها بناءً على بنية Excel الخاصة بك.

## الخطوة 4: معالجة بيانات الخلية

بعد ذلك، ستقوم بتعديل بعض قيم الخلايا في ورقة العمل. 

### الخطوة 4.1: تعديل الخلية A3

لنبدأ بالوصول إلى الخلية A3 وتعيين قيمتها.

```csharp
// الوصول إلى الخلية A3 وتعيين بياناتها
Cells cells = dataSheet.Cells;
Cell cell = cells["A3"];
cell.PutValue("FooBar");
```

يقوم مقتطف التعليمات البرمجية هذا بتحديث الخلية A3 بالقيمة "FooBar".

### الخطوة 4.2: تعديل الخلية B3 باستخدام سلسلة طويلة

الآن، دعنا نضع سلسلة طويلة في الخلية B3، والتي تتجاوز حدود الأحرف القياسية في Excel.

```csharp
// الوصول إلى الخلية B3 وتعيين بياناتها
string longStr = "Very long text 1. very long text 2.... [continue your long string]";
cell = cells["B3"];
cell.PutValue(longStr);
```

يعد هذا الرمز مهمًا لأنه يحدد توقعاتك فيما يتعلق بحدود البيانات، وخاصةً عند العمل بإعدادات التوافق في Excel.

## الخطوة 5: التحقق من طول الخلية B3

ومن الضروري أيضًا التأكد من طول السلسلة التي أدخلناها.

```csharp
// طباعة طول سلسلة الخلية B3
Console.WriteLine("Length of original data string: " + cell.StringValue.Length);
```

هذا فقط للتحقق من عدد الأحرف الموجودة في خليتك.

## الخطوة 6: تعيين قيم الخلايا الأخرى

الآن سوف نقوم بالوصول إلى المزيد من الخلايا وتعيين بعض القيم.

```csharp
// الوصول إلى الخلية C3 وتعيين بياناتها
cell = cells["C3"];
cell.PutValue("closed");

// الوصول إلى الخلية D3 وتعيين بياناتها
cell = cells["D3"];
cell.PutValue("2016/07/21");
```

يقوم كل جزء من هذه الأجزاء بتحديث عدة خلايا إضافية ضمن ورقة العمل.

## الخطوة 7: الوصول إلى جدول المحور

بعد ذلك، ستتمكن من الوصول إلى ورقة العمل الثانية، والتي تتكون من بيانات الجدول المحوري.

```csharp
// قم بالوصول إلى ورقة العمل الثانية التي تحتوي على جدول محوري
Worksheet pivotSheet = wb.Worksheets[1];

// الوصول إلى الجدول المحوري
PivotTable pivotTable = pivotSheet.PivotTables[0];
```

تتيح لك هذه القطعة الصغيرة التعامل مع جدول المحور للحصول على إعدادات التوافق.

## الخطوة 8: ضبط التوافق مع Excel 2003

من المهم تحديد ما إذا كان جدول المحور الخاص بك متوافقًا مع Excel 2003 أم لا. 

```csharp
// تخبرك الخاصية IsExcel2003Compatible ما إذا كان PivotTable متوافقًا مع Excel2003 أثناء تحديث PivotTable
pivotTable.IsExcel2003Compatible = true;
pivotTable.RefreshData();
pivotTable.CalculateData();
```

وهنا يبدأ التحول الحقيقي. من خلال وضع `IsExcel2003Compatible` ل `true`، يمكنك تحديد طول الأحرف إلى 255 عند التحديث.

## الخطوة 9: التحقق من الطول بعد إعداد التوافق

بعد ضبط التوافق، دعنا نرى كيف يؤثر ذلك على البيانات.

```csharp
// تحقق من قيمة الخلية B5 في ورقة المحور.
Cell b5 = pivotSheet.Cells["B5"];
Console.WriteLine("Length of cell B5 after setting IsExcel2003Compatible property to True: " + b5.StringValue.Length);
```

من المحتمل أن ترى إخراجًا يؤكد تأثير الاقتطاع إذا تجاوزت البيانات الأولية 255 حرفًا.

## الخطوة 10: تغيير إعدادات التوافق

الآن، دعنا نغير إعدادات التوافق ونتحقق منها مرة أخرى.

```csharp
// الآن قم بتعيين الخاصية IsExcel2003Compatible إلى false ثم قم بالتحديث مرة أخرى
pivotTable.IsExcel2003Compatible = false;
pivotTable.RefreshData();
pivotTable.CalculateData();
```

يتيح لك هذا أن تعكس بياناتك طولها الأصلي دون القيود السابقة.

## الخطوة 11: التحقق من الطول مرة أخرى 

دعونا نتأكد من أن البيانات تعكس الآن طولها الحقيقي بشكل دقيق.

```csharp
// سيتم الآن طباعة الطول الأصلي لبيانات الخلية. لم يتم اقتطاع البيانات بعد.
b5 = pivotSheet.Cells["B5"];
Console.WriteLine("Length of cell B5 after setting IsExcel2003Compatible property to False: " + b5.StringValue.Length);
```

يجب أن ترى أن الإخراج يؤكد إزالة الاقتطاع.

## الخطوة 12: تنسيق الخلايا

لتحسين التجربة البصرية، قد ترغب في تنسيق الخلايا. 

```csharp
// تعيين ارتفاع الصف وعرض العمود للخلية B5 وكذلك لف النص الخاص بها
pivotSheet.Cells.SetRowHeight(b5.Row, 100);
pivotSheet.Cells.SetColumnWidth(b5.Column, 65);
Style st = b5.GetStyle();
st.IsTextWrapped = true;
b5.SetStyle(st);
```

تجعل هذه الأسطر من التعليمات البرمجية البيانات أسهل للقراءة عن طريق ضبط أبعاد الخلية وتمكين التفاف النص.

## الخطوة 13: حفظ المصنف

وأخيرًا، احفظ المصنف الخاص بك بالتغييرات التي أجريتها.

```csharp
// حفظ المصنف بصيغة xlsx
wb.Save(dataDir + "SpecifyCompatibility_out.xlsx", SaveFormat.Xlsx);
```

يعد اختيار تنسيق الملف المناسب أمرًا بالغ الأهمية عند حفظ ملفات Excel. `Xlsx` يتم استخدام التنسيق على نطاق واسع وهو متوافق مع العديد من إصدارات Excel.

## خاتمة

تهانينا! لقد قمتَ الآن ببرمجة إعدادات توافق ملفات Excel باستخدام Aspose.Cells لـ .NET. وضّح هذا البرنامج التعليمي كل خطوة، بدءًا من إعداد بيئتك ووصولًا إلى تعديل إعدادات التوافق لجداول البيانات المحورية. إذا سبق لك العمل مع بيانات تتطلب قيودًا أو توافقًا محددًا، فهذه مهارة لا تُفوّت.

## الأسئلة الشائعة

### ما هو Aspose.Cells؟  
Aspose.Cells هي مكتبة .NET مصممة لمساعدة المطورين على إنشاء ملفات Excel ومعالجتها وتحويلها بسلاسة.

### لماذا يعد توافق Excel مهمًا؟  
يعد توافق Excel أمرًا بالغ الأهمية لضمان إمكانية فتح الملفات واستخدامها في الإصدارات المقصودة من Excel، خاصةً إذا كانت تحتوي على ميزات أو تنسيقات غير مدعومة في الإصدارات السابقة.

### هل يمكنني إنشاء جداول محورية برمجيًا باستخدام Aspose.Cells؟  
نعم، يمكنك إنشاء جداول محورية ومعالجتها برمجيًا باستخدام Aspose.Cells. توفر المكتبة طرقًا متنوعة لإضافة مصادر البيانات والحقول والميزات المرتبطة بجداول المحورية.

### كيف يمكنني التحقق من طول السلسلة في خلية Excel؟  
يمكنك استخدام `StringValue` ممتلكات `Cell` الكائن للحصول على محتوى الخلية ثم استدعاء `.Length` خاصية لمعرفة طول السلسلة.

### هل يمكنني تخصيص تنسيق الخلية بما يتجاوز ارتفاع الصف وعرضه؟  
بالتأكيد! يتيح لك Aspose.Cells تنسيقًا شاملًا للخلايا. يمكنك تغيير أنماط الخطوط والألوان والحدود وتنسيقات الأرقام وغير ذلك الكثير من خلال `Style` فصل.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}