---
title: السماح للمستخدم بتحرير النطاقات في ورقة عمل Excel
linktitle: السماح للمستخدم بتحرير النطاقات في ورقة عمل Excel
second_title: مرجع واجهة برمجة التطبيقات Aspose.Cells لـ .NET
description: السماح للمستخدمين بتحرير نطاقات معينة في جدول بيانات Excel باستخدام Aspose.Cells لـ .NET. دليل خطوة بخطوة مع الكود المصدر بلغة C#.
weight: 10
url: /ar/net/protect-excel-file/allow-user-to-edit-ranges-in-excel-worksheet/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# السماح للمستخدم بتحرير النطاقات في ورقة عمل Excel

## مقدمة

عندما يتعلق الأمر بالعمل مع أوراق عمل Excel، غالبًا ما تكون المرونة هي المفتاح - خاصةً عندما يحتاج مستخدمون متعددون إلى الوصول لتحرير مناطق معينة دون المساس بسلامة البيانات في الورقة بأكملها. هذا هو المكان الذي يتألق فيه Aspose.Cells for .NET! في هذا البرنامج التعليمي، سنتعمق في كيفية السماح للمستخدمين بتحرير نطاقات معينة داخل ورقة عمل Excel مع حماية بقية المستند. بحلول نهاية هذه المقالة، لن تستوعب المفاهيم فحسب، بل سيكون لديك أيضًا مثال ملموس للعمل معه. 

## المتطلبات الأساسية

قبل أن ننتقل إلى التفاصيل الدقيقة، دعنا نتأكد من أن لديك كل ما تحتاجه للبدء:

1. بيئة تطوير .NET: يجب أن يكون لديك بيئة تطوير .NET عاملة (يمكن أن تكون Visual Studio أو أي بيئة تطوير متكاملة أخرى من اختيارك).
2.  مكتبة Aspose.Cells لـ .NET: قم بتنزيل مكتبة Aspose.Cells وتثبيتها. يمكنك العثور عليها[هنا](https://releases.aspose.com/cells/net/).
3. المعرفة الأساسية بلغة C#: ستساعدك المعرفة ببرمجة C# على التنقل عبر أمثلة التعليمات البرمجية بسهولة.
4. فهم أساسيات Excel: إن معرفة كيفية عمل Excel سيوفر الأساس للوظائف التي سنناقشها.

بمجرد الانتهاء من هذه المتطلبات الأساسية، ستكون جاهزًا للانطلاق!

## استيراد الحزم

قبل أن نبدأ في كتابة التعليمات البرمجية، نحتاج إلى التأكد من أن مشروعنا يتعرف على مساحة اسم Aspose.Cells. وإليك كيفية استيراد الحزم الضرورية:

```csharp
using System.IO;
using Aspose.Cells;
```

الآن بعد أن قمنا باستيراد ما نحتاجه، فلننتقل إلى برنامجنا التعليمي خطوة بخطوة.

## الخطوة 1: إعداد دليل المستندات

بالنسبة لأي عمليات ملفات، من الضروري أن يكون لدينا موقع محدد لحفظ مستنداتنا. فلنقم بإعداد دليل العمل الخاص بنا لتخزين ملفات Excel.

```csharp
// المسار إلى دليل المستندات.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// إنشاء الدليل إذا لم يكن موجودًا بالفعل.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```

 أولاً، استبدل`"YOUR DOCUMENT DIRECTORY"` مع المسار الذي تريد حفظ ملفاتك فيه. يتحقق هذا الكود من وجود الدليل؛ وإذا لم يكن موجودًا، فإنه ينشئ دليلًا.

## الخطوة 2: إنشاء مصنف جديد

بعد أن أصبح دليل العمل الخاص بنا جاهزًا، حان الوقت لإنشاء مصنف Excel الخاص بنا. 

```csharp
// إنشاء مصنف جديد
Workbook book = new Workbook();
```

 هنا، نقوم بإنشاء مثيل جديد لـ`Workbook` الفئة التي يوفرها Aspose.Cells، والتي تسمح لنا بالتعامل مع ملف Excel.

## الخطوة 3: الوصول إلى ورقة العمل الافتراضية

يأتي كل مصنف تم إنشاؤه حديثًا مع ورقة عمل واحدة على الأقل. دعنا نتعرف على ذلك.

```csharp
// احصل على ورقة العمل الأولى (الافتراضية)
Worksheet sheet = book.Worksheets[0];
```

في مقتطف التعليمات البرمجية هذا، نقوم بالوصول إلى ورقة العمل الأولى من مصنفنا، والتي سنقوم بمعالجتها في الخطوات اللاحقة.

## الخطوة 4: الحصول على نطاقات السماح بالتحرير

 لتمكين نطاقات محددة من ورقة العمل للتحرير، نحتاج إلى الوصول إلى`AllowEditRanges` ملكية.

```csharp
// احصل على نطاقات التحرير المسموح بها
ProtectedRangeCollection allowRanges = sheet.AllowEditRanges;
```

ستسمح لنا هذه المجموعة بإدارة النطاقات القابلة للتحرير في ورقة العمل الخاصة بنا.

## الخطوة 5: تحديد النطاق المحمي

بعد ذلك، دعنا نحدد الجزء من ورقة العمل الذي نريد حمايته مع السماح بالتحرير في نطاق محدد.

```csharp
// تحديد النطاق المحمي
ProtectedRange proteced_range;

// إنشاء النطاق
int idx = allowRanges.Add("r2", 1, 1, 3, 3);
proteced_range = allowRanges[idx];

// حدد كلمة المرور
proteced_range.Password = "123";
```

في هذه الخطوة، نضيف نطاقًا جديدًا قابلًا للتحرير يسمى "r2" والذي يسمح بالتحرير في الخلايا من الصف 1 العمود 1 إلى الصف 3 العمود 3. بالإضافة إلى ذلك، نقوم بتعيين كلمة مرور لحماية هذا النطاق، مما يضمن أن المستخدمين المصرح لهم فقط يمكنهم تعديله.

## الخطوة 6: حماية ورقة العمل

الآن بعد أن قمنا بإعداد نطاقنا القابل للتحرير، نحتاج إلى حماية ورقة العمل.

```csharp
// حماية الورقة
sheet.Protect(ProtectionType.All);
```

سوف يقوم هذا الكود بحماية ورقة العمل بأكملها من أي تغييرات غير مرغوب فيها، باستثناء النطاق الذي حددناه للتو.

## الخطوة 7: حفظ ملف Excel

دعنا نحفظ المصنف حتى نتمكن من رؤية التغييرات التي أجريناها تنعكس في ملف Excel.

```csharp
// حفظ ملف Excel
book.Save(dataDir + "protectedrange.out.xls");
```

تأكد من ضبط اسم الملف حسب الحاجة. سيؤدي هذا إلى إنشاء ملف Excel في الدليل المحدد بالإعدادات التي قمنا بتكوينها.

## خاتمة

ها أنت ذا! لقد نجحت في إنشاء ورقة عمل Excel تقيد عمليات التحرير بنطاق محدد مع حماية بقية الورقة. إن استخدام Aspose.Cells لـ .NET يجعل إدارة هذه الأنواع من المهام أكثر سهولة وكفاءة. سواء كنت تقوم بتطوير تطبيق معقد أو كنت بحاجة فقط إلى إدارة البيانات بأمان، فإن هذه الإمكانات يمكن أن تعزز سير عملك بشكل كبير.

## الأسئلة الشائعة

### ما هو Aspose.Cells؟
Aspose.Cells عبارة عن مكتبة .NET قوية للتعامل مع ملفات Excel، حيث تقدم وظائف مثل إنشاء جداول البيانات وتحريرها وتحويلها برمجيًا.

### هل يمكنني تطبيق نطاقات قابلة للتعديل متعددة؟
 بالتأكيد! يمكنك الاتصال بـ`Add` الطريقة على`allowRanges` قم بتجميع عدة مرات لتحديد نطاقات متعددة قابلة للتحرير.

### ماذا يحدث إذا نسيت كلمة المرور؟
لسوء الحظ، إذا نسيت كلمة المرور الخاصة بنطاق قابل للتحرير، فسوف تحتاج إلى إزالة الحماية أو الوصول إلى الملف بطريقة محددة مسبقًا والتي قد تتضمن بيانات اعتماد.

### هل هناك نسخة مجانية من Aspose.Cells؟
نعم، يوفر Aspose نسخة تجريبية مجانية يمكنك الاستفادة منها لاستكشاف الميزات قبل الشراء.

### أين يمكنني العثور على مزيد من المعلومات حول Aspose.Cells؟
 يمكنك التحقق من[التوثيق](https://reference.aspose.com/cells/net/)للحصول على أدلة ومراجع مفصلة.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
