---
"description": "السماح للمستخدمين بتعديل نطاقات محددة في جدول بيانات Excel باستخدام Aspose.Cells لـ .NET. دليل خطوة بخطوة مع الكود المصدري بلغة C#."
"linktitle": "السماح للمستخدم بتحرير النطاقات في ورقة عمل Excel"
"second_title": "مرجع واجهة برمجة التطبيقات Aspose.Cells لـ .NET"
"title": "السماح للمستخدم بتحرير النطاقات في ورقة عمل Excel"
"url": "/ar/net/protect-excel-file/allow-user-to-edit-ranges-in-excel-worksheet/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# السماح للمستخدم بتحرير النطاقات في ورقة عمل Excel

## مقدمة

عند استخدام جداول بيانات Excel، غالبًا ما تكون المرونة أمرًا بالغ الأهمية، خاصةً عندما يحتاج عدة مستخدمين إلى الوصول لتحرير مناطق محددة دون المساس بسلامة بيانات الجدول بأكمله. وهنا تبرز ميزة Aspose.Cells لـ .NET! في هذا البرنامج التعليمي، سنتعمق في كيفية السماح للمستخدمين بتحرير نطاقات معينة داخل جدول بيانات Excel مع حماية باقي المستند. بنهاية هذه المقالة، لن تستوعب المفاهيم فحسب، بل ستمتلك أيضًا مثالًا عمليًا للعمل عليه. 

## المتطلبات الأساسية

قبل أن ننتقل إلى التفاصيل الدقيقة، دعنا نتأكد من أن لديك كل ما تحتاجه للبدء:

1. بيئة تطوير .NET: يجب أن يكون لديك بيئة تطوير .NET عاملة (يمكن أن تكون Visual Studio أو أي بيئة تطوير متكاملة أخرى من اختيارك).
2. مكتبة Aspose.Cells لـ .NET: نزّل مكتبة Aspose.Cells وثبّتها. يمكنك العثور عليها [هنا](https://releases.aspose.com/cells/net/).
3. المعرفة الأساسية بلغة C#: ستساعدك المعرفة ببرمجة C# على التنقل عبر أمثلة التعليمات البرمجية بسهولة.
4. فهم أساسيات Excel: إن معرفة كيفية عمل Excel سيوفر الأساس للوظائف التي سنناقشها.

بمجرد الانتهاء من هذه المتطلبات الأساسية، فأنت جاهز للانطلاق!

## استيراد الحزم

قبل البدء بالبرمجة، علينا التأكد من أن مشروعنا يتعرف على مساحة اسم Aspose.Cells. إليك كيفية استيراد الحزم اللازمة:

```csharp
using System.IO;
using Aspose.Cells;
```

الآن بعد أن قمنا باستيراد ما نحتاجه، فلننتقل إلى برنامجنا التعليمي خطوة بخطوة.

## الخطوة 1: إعداد دليل المستندات

لأي عمليات ملفات، من الضروري تحديد موقع محدد لحفظ مستنداتنا. لنُنشئ دليل عمل لتخزين ملفات Excel.

```csharp
// المسار إلى دليل المستندات.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// إنشاء الدليل إذا لم يكن موجودًا بالفعل.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```

أولاً، استبدل `"YOUR DOCUMENT DIRECTORY"` مع المسار الذي تريد حفظ ملفاتك فيه. يتحقق هذا الكود من وجود الدليل، وإن لم يكن موجودًا، يُنشئه.

## الخطوة 2: إنشاء مصنف جديد

بعد أن أصبح دليل العمل جاهزًا، حان الوقت لإنشاء مصنف Excel الخاص بنا. 

```csharp
// إنشاء مصنف جديد
Workbook book = new Workbook();
```

هنا، نقوم بإنشاء مثيل جديد لـ `Workbook` الفئة التي يوفرها Aspose.Cells، والتي تسمح لنا بالتعامل مع ملف Excel.

## الخطوة 3: الوصول إلى ورقة العمل الافتراضية

كل مصنف جديد يأتي مع ورقة عمل واحدة على الأقل. لنبدأ بالوصول إليها.

```csharp
// احصل على ورقة العمل الأولى (الافتراضية)
Worksheet sheet = book.Worksheets[0];
```

في مقتطف التعليمات البرمجية هذا، نقوم بالوصول إلى ورقة العمل الأولى من مصنفنا، والتي سنقوم بمعالجتها في الخطوات اللاحقة.

## الخطوة 4: الحصول على نطاقات السماح بالتحرير

لتمكين نطاقات محددة من ورقة العمل للتحرير، نحتاج إلى الوصول إلى `AllowEditRanges` ملكية.

```csharp
// احصل على نطاقات التحرير المسموح بها
ProtectedRangeCollection allowRanges = sheet.AllowEditRanges;
```

ستسمح لنا هذه المجموعة بإدارة النطاقات القابلة للتحرير في ورقة العمل الخاصة بنا.

## الخطوة 5: تحديد النطاق المحمي

بعد ذلك، دعنا نحدد الجزء من ورقة العمل الذي نريد حمايته مع السماح بالتعديلات على نطاق محدد.

```csharp
// تعريف النطاق المحمي
ProtectedRange proteced_range;

// إنشاء النطاق
int idx = allowRanges.Add("r2", 1, 1, 3, 3);
proteced_range = allowRanges[idx];

// حدد كلمة المرور
proteced_range.Password = "123";
```

في هذه الخطوة، نضيف نطاقًا جديدًا قابلًا للتحرير يسمى "r2" يسمح بالتحرير في الخلايا من الصف 1 العمود 1 إلى الصف 3 العمود 3. بالإضافة إلى ذلك، نقوم بتعيين كلمة مرور لحماية هذا النطاق، مما يضمن أن المستخدمين المصرح لهم فقط يمكنهم تعديله.

## الخطوة 6: حماية ورقة العمل

الآن بعد أن قمنا بإعداد النطاق القابل للتحرير، نحتاج إلى حماية ورقة العمل.

```csharp
// حماية الورقة
sheet.Protect(ProtectionType.All);
```

سوف يقوم هذا الكود بحماية ورقة العمل بأكملها من أي تغييرات غير مرغوب فيها، باستثناء النطاق الذي حددناه للتو.

## الخطوة 7: حفظ ملف Excel

دعنا نحفظ المصنف حتى نتمكن من رؤية التغييرات التي أجريناها تنعكس في ملف Excel.

```csharp
// حفظ ملف Excel
book.Save(dataDir + "protectedrange.out.xls");
```

تأكد من تعديل اسم الملف حسب الحاجة. سيؤدي هذا إلى إنشاء ملف Excel في المجلد المحدد بالإعدادات التي قمنا بضبطها.

## خاتمة

ها قد انتهيت! لقد نجحت في إنشاء ورقة عمل Excel تُقيّد عمليات التحرير بنطاق مُحدّد مع حماية باقي الورقة. استخدام Aspose.Cells لـ .NET يُسهّل إدارة هذه المهام ويجعلها أكثر كفاءة. سواء كنت تُطوّر تطبيقًا مُعقّدًا أو تحتاج فقط إلى إدارة البيانات بأمان، فإن هذه الإمكانيات تُحسّن سير عملك بشكل ملحوظ.

## الأسئلة الشائعة

### ما هو Aspose.Cells؟
Aspose.Cells هي مكتبة .NET قوية للتعامل مع ملفات Excel، وتوفر وظائف مثل إنشاء جداول البيانات وتحريرها وتحويلها برمجيًا.

### هل يمكنني تطبيق نطاقات متعددة قابلة للتحرير؟
بالتأكيد! يمكنك الاتصال بـ `Add` الطريقة على `allowRanges` قم بتجميع عدة مرات لتحديد نطاقات متعددة قابلة للتحرير.

### ماذا يحدث إذا نسيت كلمة المرور؟
لسوء الحظ، إذا نسيت كلمة المرور الخاصة بنطاق قابل للتحرير، فسوف تحتاج إلى إزالة الحماية أو الوصول إلى الملف بطريقة محددة مسبقًا والتي قد تتضمن بيانات اعتماد.

### هل هناك نسخة مجانية من Aspose.Cells؟
نعم، يوفر Aspose نسخة تجريبية مجانية يمكنك الاستفادة منها لاستكشاف الميزات قبل الشراء.

### أين يمكنني العثور على مزيد من المعلومات حول Aspose.Cells؟
يمكنك التحقق من [التوثيق](https://reference.aspose.com/cells/net/) للحصول على إرشادات ومراجع مفصلة.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}