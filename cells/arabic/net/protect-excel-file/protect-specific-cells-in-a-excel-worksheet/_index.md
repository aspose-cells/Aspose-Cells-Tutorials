---
title: حماية خلايا محددة في ورقة عمل Excel
linktitle: حماية خلايا محددة في ورقة عمل Excel
second_title: مرجع واجهة برمجة التطبيقات Aspose.Cells لـ .NET
description: تعرف على كيفية حماية خلايا معينة في ورقة عمل Excel باستخدام Aspose.Cells for .NET من خلال هذا البرنامج التعليمي خطوة بخطوة.
weight: 70
url: /ar/net/protect-excel-file/protect-specific-cells-in-a-excel-worksheet/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# حماية خلايا محددة في ورقة عمل Excel

## مقدمة

قد يبدو إنشاء جداول عمل Excel وإدارة حماية الخلايا بمثابة معركة شاقة، أليس كذلك؟ خاصة عندما تحاول التأكد من إمكانية تحرير خلايا معينة فقط مع الحفاظ على أمان الخلايا الأخرى. حسنًا، الخبر السار هو أنه باستخدام Aspose.Cells for .NET، يمكنك بسهولة حماية خلايا معينة داخل ورقة عمل Excel باستخدام بضعة أسطر من التعليمات البرمجية فقط!

في هذه المقالة، سنطلعك على برنامج تعليمي خطوة بخطوة حول كيفية تنفيذ حماية الخلايا باستخدام Aspose.Cells لـ .NET. بحلول نهاية هذا الدليل، ستكتسب المعرفة اللازمة لحماية بيانات Excel بكفاءة.

## المتطلبات الأساسية

قبل التعمق في الكود، هناك بعض المتطلبات الأساسية التي يجب أن تتوفر لديك:

1. Visual Studio: تأكد من تثبيت Visual Studio على جهازك لأننا سنقوم بالبرمجة باستخدام C#.
2.  Aspose.Cells for .NET: يجب أن يكون لديك Aspose.Cells for .NET مثبتًا. إذا لم تقم بذلك بعد، فقم بتنزيله من[هنا](https://releases.aspose.com/cells/net/).
3. الفهم الأساسي للغة C#: إن الإلمام ببرمجة C# سيساعدك على فهم الأمثلة المقدمة بسهولة أكبر.

## استيراد الحزم

بمجرد أن تكون قد انتهيت من المتطلبات الأساسية، فقد حان الوقت لاستيراد الحزم الضرورية في مشروعك. في ملف C# الخاص بك، ستحتاج إلى تضمين مساحة الأسماء التالية:

```csharp
using System.IO;
using Aspose.Cells;
```

تحتوي هذه المساحة الاسمية على جميع الفئات والطرق اللازمة للعمل مع ملفات Excel وتنفيذ الوظائف التي نحتاجها.

دعنا نكشف النقاب عن عملية حماية خلايا معينة في ورقة عمل Excel باستخدام Aspose.Cells for .NET. سنقوم بتقسيم الكود إلى عدة خطوات يمكن فهمها:

## الخطوة 1: إعداد دليل العمل الخاص بك

أول شيء نريد القيام به هو تحديد المكان الذي ستوضع فيه ملفاتك. هذه الخطوة بسيطة للغاية، حيث ستحدد دليلاً لملف Excel الخاص بك.

```csharp
// المسار إلى دليل المستندات.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// إنشاء الدليل إذا لم يكن موجودًا بالفعل.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
 هنا، نقوم بتعريف متغير سلسلة`dataDir` يشير هذا إلى دليل المستند المطلوب. نتحقق مما إذا كان هذا الدليل موجودًا. إذا لم يكن موجودًا، نقوم بإنشائه. وهذا يضمن عدم مواجهة أي مشكلات عند حفظ ملف Excel الخاص بك لاحقًا.

## الخطوة 2: إنشاء مصنف جديد

بعد ذلك، دعونا نقوم بإنشاء مصنف جديد للعمل عليه.

```csharp
// إنشاء مصنف جديد.
Workbook wb = new Workbook();
```
 لقد قمنا بإنشاء مثيل جديد`Workbook` فكر في هذا الأمر باعتباره لوحة قماشية فارغة يمكنك من خلالها رسم بياناتك.

## الخطوة 3: الوصول إلى ورقة العمل

الآن بعد أن أصبح لدينا مصنف، فلننتقل إلى ورقة العمل الأولى حيث سنطبق إعدادات الحماية الخاصة بنا.

```csharp
// إنشاء كائن ورقة عمل والحصول على الورقة الأولى.
Worksheet sheet = wb.Worksheets[0];
```
هنا، نصل إلى ورقة العمل الأولى من كتاب العمل الخاص بنا. هنا سيحدث كل السحر!

## الخطوة 4: إلغاء قفل جميع الأعمدة

قبل أن نتمكن من قفل خلايا معينة، نحتاج إلى إلغاء قفل جميع الأعمدة في ورقة العمل. وهذا يسمح بقفل الخلايا المحددة فقط لاحقًا.

```csharp
// تعريف كائن النمط.
Style style;
// تعريف كائن styleflag.
StyleFlag styleflag;

// قم بالمرور على جميع الأعمدة في ورقة العمل وإلغاء قفلها.
for (int i = 0; i <= 255; i++)
{
    style = sheet.Cells.Columns[(byte)i].Style;
    style.IsLocked = false;
    styleflag = new StyleFlag();
    styleflag.Locked = true;
    sheet.Cells.Columns[(byte)i].ApplyStyle(style, styleflag);
}
```
تتكرر هذه الحلقة على جميع الأعمدة (من 0 إلى 255) في ورقة العمل، فتفتح قفل كل منها. وبذلك، نكون قد قمنا بإعداد المسرح لقفل الخلايا التي نختارها لاحقًا فقط.

## الخطوة 5: قفل خلايا محددة

الآن نصل إلى الجزء المثير: قفل خلايا معينة! في هذا المثال، سنقوم بقفل الخلايا A1 وB1 وC1.

```csharp
// قم بإغلاق الخلايا الثلاث...أي A1، B1، C1.
style = sheet.Cells["A1"].GetStyle();
style.IsLocked = true;
sheet.Cells["A1"].SetStyle(style);

style = sheet.Cells["B1"].GetStyle();
style.IsLocked = true;
sheet.Cells["B1"].SetStyle(style);

style = sheet.Cells["C1"].GetStyle();
style.IsLocked = true;
sheet.Cells["C1"].SetStyle(style);
```
بالنسبة لكل خلية محددة، نسترد النمط الحالي ونضبط`IsLocked` الخاصية إلى true. الآن تم قفل هذه الخلايا الثلاث ولا يمكن تحريرها بعد الآن.

## الخطوة 6: حماية ورقة العمل

لقد اكتملت قائمتنا تقريبًا! الخطوة الأخيرة التي يتعين عليك القيام بها هي حماية ورقة العمل نفسها.

```csharp
// وأخيرا، قم بحماية الورقة الآن.
sheet.Protect(ProtectionType.All);
```
 من خلال الاتصال`Protect` باستخدام الطريقة الموجودة في ورقة العمل، نطبق إعدادات الحماية الخاصة بنا.`ProtectionType.All`نحن نحدد أن جميع جوانب الورقة ستكون محمية.

## الخطوة 7: حفظ ملف Excel

وأخيرًا، دعونا نحفظ عملنا اليدوي في ملف Excel.

```csharp
// احفظ ملف Excel.
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```
يحفظ هذا الأمر المصنف في الدليل المحدد باسم الملف "output.out.xls". يمكنك الوصول إلى هذا الملف في أي وقت لرؤية الخلايا المحمية أثناء العمل.

## خاتمة

والآن، لقد نجحت في حماية خلايا معينة في ورقة عمل Excel باستخدام Aspose.Cells for .NET. باتباع هذه الخطوات، تكون قد تعلمت كيفية إعداد بيئتك وإنشاء مصنف Excel وقفل الخلايا بشكل مشروط للحفاظ على سلامة البيانات. لذا في المرة القادمة التي تفكر فيها في السماح للآخرين بتحرير جداول البيانات الخاصة بك، تذكر التقنيات البسيطة التي يمكنك تطبيقها لحماية بياناتك المهمة!

## الأسئلة الشائعة

### ما هو Aspose.Cells لـ .NET؟  
Aspose.Cells for .NET عبارة عن مكتبة قوية للتعامل مع ملفات Excel برمجيًا باستخدام C#، مما يسمح للمطورين بإنشاء جداول بيانات Excel وتعديلها وتحويلها دون الحاجة إلى Microsoft Excel.

### كيف أقوم بتثبيت Aspose.Cells لـ .NET؟  
 يمكنك تنزيل Aspose.Cells لـ .NET من موقع الويب[هنا](https://releases.aspose.com/cells/net/)اتبع تعليمات التثبيت المقدمة.

### هل يمكنني حماية أكثر من ثلاث خلايا؟  
بالتأكيد! يمكنك قفل عدد الخلايا الذي تريده عن طريق إضافة المزيد من الأسطر المشابهة لتلك الخاصة بالخلايا A1 وB1 وC1 في المثال.

### ما هي التنسيقات التي يمكنني حفظ ملف Excel بها؟  
يمكنك حفظ ملف Excel الخاص بك بتنسيقات مختلفة، بما في ذلك XLSX وXLS وCSV والمزيد. ما عليك سوى تغيير`SaveFormat` المعلمة وفقا لذلك.

### أين يمكنني العثور على مزيد من الوثائق التفصيلية حول Aspose.Cells؟  
 يمكنك استكشاف المزيد حول Aspose.Cells لـ .NET في الوثائق[هنا](https://reference.aspose.com/cells/net/).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
