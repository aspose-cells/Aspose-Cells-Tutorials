---
title: استخدام طريقة النسخ برمجياً في برنامج Excel
linktitle: استخدام طريقة النسخ برمجياً في برنامج Excel
second_title: واجهة برمجة تطبيقات معالجة Excel الخاصة بـ Aspose.Cells .NET
description: تعرف على كيفية استخدام طريقة النسخ في Aspose.Cells for .NET للتعامل مع ملفات Excel بكفاءة. يتضمن هذا الدليل دليلاً خطوة بخطوة.
weight: 10
url: /ar/net/excel-formatting-methods-and-options/using-copy-method/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# استخدام طريقة النسخ برمجياً في برنامج Excel

## مقدمة
عندما يتعلق الأمر بإدارة جداول البيانات ومعالجتها برمجيًا، فإن Aspose.Cells for .NET هو أداة قوية يمكنها توفير الوقت وتبسيط سير عملك. إحدى المهام الشائعة التي يواجهها المطورون هي الحاجة إلى نسخ النطاقات من ورقة عمل إلى أخرى داخل مصنف Excel. في هذا البرنامج التعليمي، سنرشدك خلال استخدام طريقة النسخ في Aspose.Cells، وسنرشدك خلال كل خطوة من خلال تفسيرات واضحة وأمثلة التعليمات البرمجية.
## المتطلبات الأساسية
قبل أن نتعمق في خطوات استخدام طريقة النسخ، ستحتاج إلى التأكد من توفر المتطلبات الأساسية التالية:
1. .NET Framework: تأكد من تثبيت .NET Framework على جهازك. Aspose.Cells متوافق مع إصدارات مختلفة، لذا تحقق من[التوثيق](https://reference.aspose.com/cells/net/) للحصول على تفاصيل.
2. Visual Studio: يعد إعداد Visual Studio أو أي بيئة تطوير متكاملة متوافقة لتطوير .NET أمرًا ضروريًا. سيساعدك هذا في إنشاء وإدارة مشاريعك بشكل مريح.
3.  مكتبة Aspose.Cells: قم بتنزيل مكتبة Aspose.Cells من[صفحة الإصدارات](https://releases.aspose.com/cells/net/) وأضف مرجعًا إليه في مشروعك.
4.  ملف Excel نموذجي: قم بإنشاء ملف Excel أو احتفظ به جاهزًا (على سبيل المثال،`Book1.xlsx`) التي ستعمل عليها في هذا البرنامج التعليمي.
5. المعرفة الأساسية بلغة C#: الإلمام بمفاهيم لغة C# وقواعدها النحوية.
بمجرد استيفاء هذه المتطلبات الأساسية، ستكون جاهزًا لبدء البرمجة!
## استيراد الحزم
للاستفادة من الوظائف التي توفرها Aspose.Cells، تحتاج إلى استيراد الحزم اللازمة. في مشروع C# الخاص بك، تأكد من تضمين التوجيه التالي في أعلى ملف التعليمات البرمجية الخاص بك:
```csharp
using System.IO;
using Aspose.Cells;
using System.Drawing;
```
يتيح لك هذا الوصول إلى الفئات والطرق المطلوبة للتعامل مع ملفات Excel بسهولة.
الآن بعد أن أصبح كل شيء جاهزًا، دعنا نقسم عملية استخدام طريقة النسخ إلى خطوات يمكن إدارتها. سنبدأ بتحميل ملف Excel ثم ننتقل إلى نسخ النطاق المطلوب.
## الخطوة 1: إعداد تدفق الملف
الخطوة الأولى هي إنشاء مجرى ملف يسمح لنا بفتح ملف Excel والعمل عليه. إليك كيفية القيام بذلك:
```csharp
// المسار إلى دليل المستندات.
string dataDir = "Your Document Directory";
// إنشاء مجرى ملف يحتوي على ملف Excel الذي سيتم فتحه
FileStream fstream = new FileStream(dataDir + "Book1.xlsx", FileMode.Open);
```
 في هذا الكود، تحتاج إلى تحديد المسار الذي سيتم فيه`Book1.xlsx` تم العثور على الملف.`FileMode.Open` تشير المعلمة إلى أننا نريد فتح ملف موجود.
## الخطوة 2: فتح المصنف
بعد ذلك، سننشئ كائن مصنف باستخدام مجرى الملف الذي قمنا بإعداده للتو. يتيح لنا هذا الوصول إلى محتوى ملف Excel.
```csharp
// فتح ملف Excel من خلال مجرى الملف
Workbook workbook = new Workbook(fstream);
```
في هذه المرحلة، قمنا بفتح المصنف ويمكننا البدء في العمل بمحتوياته.
## الخطوة 3: الوصول إلى ورقة العمل
بمجرد تحميل المصنف، نحتاج إلى الوصول إلى ورقة العمل المحددة التي نريد العمل عليها. عادةً، ستكون هذه هي ورقة العمل الأولى في المصنف.
```csharp
// الوصول إلى ورقة العمل الأولى في ملف Excel
Worksheet worksheet = workbook.Worksheets[0];
```
 هنا،`Worksheets[0]` قم بإمساك الورقة الأولى. إذا كنت تريد الوصول إلى أي ورقة عمل أخرى، فما عليك سوى تغيير الفهرس.
## الخطوة 4: نسخ النطاق
الآن يأتي الجزء الرئيسي - نسخ نطاق الخلايا. في هذا البرنامج التعليمي، سنوضح كيفية نسخ إعدادات التنسيق الشرطي من خلية إلى أخرى، بالإضافة إلى كيفية نسخ النطاق الكامل لورقة Excel.
### نسخ التنسيق الشرطي (مثال)
```csharp
// نسخ إعدادات التنسيق الشرطي من الخلية "A1" إلى الخلية "B1"
// ورقة العمل.نسخ التنسيق الشرطي(0، 0، 0، 1)؛
```
تم التعليق على هذا السطر في الكود الأصلي، ولكنه يوضح لك كيفية نسخ التنسيق الشرطي من الخلية A1 إلى الخلية B1 في نفس ورقة العمل. تمثل المعلمات مؤشرات الصفوف والأعمدة للخلايا المصدر والوجهة. يمكنك إلغاء التعليق عليه إذا كانت هذه الوظيفة مطلوبة.
### نسخ النطاق بأكمله (مثال)
يمكننا توسيع وظيفة النسخ لدينا بشكل أكبر لتشمل نسخ نطاق كامل، حيث سنستخدم حلقة للانتقال عبر جميع أوراق العمل.
```csharp
int TotalRowCount = 0;
for (int i = 0; i < workbook.Worksheets.Count; i++)
{
    // الوصول إلى كل ورقة عمل
    Worksheet sourceSheet = workbook.Worksheets[i];
    // الحصول على نطاق العرض في ورقة العمل
    Range sourceRange = sourceSheet.Cells.MaxDisplayRange;
    // إنشاء نطاق في ورقة العمل الوجهة
    Range destRange = worksheet.Cells.CreateRange(
        sourceRange.FirstRow + TotalRowCount,
        sourceRange.FirstColumn,
        sourceRange.RowCount,
        sourceRange.ColumnCount);
    // نسخ نطاق المصدر إلى نطاق الوجهة
    destRange.Copy(sourceRange);
    // تحديث إجمالي عدد الصفوف لتكرار الحلقة التالي
    TotalRowCount += sourceRange.RowCount; 
}
```
## الخطوة 5: حفظ المصنف المعدل
بعد نسخ النطاقات المطلوبة، ستحتاج إلى حفظ المصنف المعدّل للحفاظ على التغييرات التي أجريتها. إليك كيفية القيام بذلك:
```csharp
// حفظ ملف Excel المعدل
workbook.Save(dataDir + "output.xls");
```
 سيحفظ هذا الكود المصنف المعدل الخاص بك باسم`output.xls` في الدليل المحدد. تأكد من اختيار التنسيق المناسب الذي يناسب احتياجاتك. 
## الخطوة 6: إغلاق مجرى الملف
أخيرًا، للتأكد من تحرير موارد النظام، نحتاج إلى إغلاق مجرى الملف الذي فتحناه في البداية.
```csharp
// إغلاق مجرى الملف لتحرير كافة الموارد
fstream.Close();
```
وبهذا تكون قد أكملت بنجاح عملية نسخ النطاقات وحفظ ملف Excel المحدث!
## خاتمة
يتيح لك استخدام طريقة النسخ في Aspose.Cells for .NET إمكانيات قوية للتعامل مع ملفات Excel بسهولة. باتباع هذا الدليل التفصيلي، يمكنك نسخ نطاقات الخلايا والتنسيق الشرطي بفعالية من ورقة عمل إلى أخرى، مما يبسط مهام إدارة البيانات الخاصة بك. 
## الأسئلة الشائعة
### ما هو Aspose.Cells لـ .NET؟
Aspose.Cells for .NET هي مكتبة تسمح للمطورين بإنشاء ملفات Excel ومعالجتها وإدارتها برمجيًا في تطبيقات .NET.
### هل يمكنني نسخ التنسيقات والصيغ والقيم باستخدام Aspose.Cells؟
نعم، يسمح لك Aspose.Cells بنسخ ليس فقط القيم ولكن أيضًا التنسيقات والصيغ بين النطاقات.
### هل استخدام Aspose.Cells مجاني؟
 يقدم Aspose.Cells نسخة تجريبية مجانية، ولكن للاستخدام المستمر، يجب شراء ترخيص. يمكنك العثور على مزيد من المعلومات[هنا](https://purchase.aspose.com/buy).
### كيف يمكنني الحصول على الدعم إذا واجهت مشاكل؟
 يمكنك طلب المساعدة من خلال منتدى دعم Aspose الموجود[هنا](https://forum.aspose.com/c/cells/9).
### أين يمكنني تنزيل مكتبة Aspose.Cells؟
 يمكنك تنزيل المكتبة من صفحة الإصدارات[هنا](https://releases.aspose.com/cells/net/).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
