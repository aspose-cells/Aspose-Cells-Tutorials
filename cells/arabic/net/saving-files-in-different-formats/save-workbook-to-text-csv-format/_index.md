---
"description": "تعرف على كيفية تحويل مصنفات Excel إلى تنسيق CSV بسهولة باستخدام Aspose.Cells في هذا البرنامج التعليمي الشامل خطوة بخطوة المصمم لمطوري .NET."
"linktitle": "حفظ المصنف بتنسيق نصي CSV"
"second_title": "واجهة برمجة تطبيقات معالجة Excel Aspose.Cells .NET"
"title": "حفظ المصنف بتنسيق نصي CSV"
"url": "/ar/net/saving-files-in-different-formats/save-workbook-to-text-csv-format/"
"weight": 17
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# حفظ المصنف بتنسيق نصي CSV

## مقدمة
عند التعامل مع البيانات، يُحدد التنسيق الذي تختاره مدى سهولة التعامل معها. من بين التنسيقات الأكثر شيوعًا للتعامل مع البيانات الجدولية تنسيق CSV (القيم المفصولة بفواصل). إذا كنت مطورًا تعمل على ملفات Excel وتحتاج إلى تحويل مصنفات العمل إلى تنسيق CSV، فإن Aspose.Cells for .NET مكتبة رائعة تُبسط هذه المهمة. في هذا البرنامج التعليمي، سنشرح خطوات تحويل مصنف Excel إلى تنسيق CSV نصي بسلاسة.
## المتطلبات الأساسية
قبل أن نبدأ، دعنا نتأكد من أن كل شيء جاهز للبدء:
1. المعرفة الأساسية بلغة C# و.NET: نظرًا لأننا سنكتب التعليمات البرمجية بلغة C#، فإن الإلمام باللغة وإطار عمل .NET أمر ضروري.
2. مكتبة Aspose.Cells: تأكد من تثبيت مكتبة Aspose.Cells لـ .NET في بيئة التطوير لديك. يمكنك تنزيلها. [هنا](https://releases.aspose.com/cells/net/).
3. Visual Studio أو أي بيئة تطوير متكاملة لـ C#: ستحتاج إلى بيئة تطوير متكاملة لكتابة وتنفيذ شفرتك البرمجية. يُعد Visual Studio خيارًا شائعًا.
4. مصنف Excel: قم بإعداد مصنف Excel نموذجي (على سبيل المثال، "book1.xls") يحتوي على بعض البيانات لاختبار التحويل.
## استيراد الحزم
بعد أن غطينا المتطلبات الأساسية، فإن الخطوة الأولى في العملية هي استيراد الحزم اللازمة. في مشروع C# الخاص بك، عليك تضمين مساحة الأسماء التالية في أعلى ملف الكود الخاص بك:
```csharp
using System.IO;
using Aspose.Cells;
using System;
```
ستتيح لك هذه المساحات الاسمية الوصول إلى الفئات والطرق اللازمة للعمل مع ملفات Excel وإدارة تدفقات الذاكرة.
## الخطوة 1: تحديد المسار إلى دليل المستندات
الخطوة الأولى في عمليتنا هي تحديد مكان تخزين مستنداتنا (مصنفات إكسل). هذا ضروري لأنه يُمكّن برنامجنا من معرفة مكان الملفات التي يحتاج إلى معالجتها. 
```csharp
// المسار إلى دليل المستندات.
string dataDir = "Your Document Directory";
```
تأكد من الاستبدال `"Your Document Directory"` مع المسار الفعلي لملف "book1.xls". قد يكون هذا دليلاً على جهاز الكمبيوتر أو مسارًا إلى خادم.
## الخطوة 2: تحميل مصنف المصدر الخاص بك
بعد ذلك، نحتاج إلى تحميل مصنف Excel الذي سيتم تحويله إلى تنسيق CSV.
```csharp
// قم بتحميل مصنف المصدر الخاص بك
Workbook workbook = new Workbook(dataDir + "book1.xls");
```
ال `Workbook` فئة من مكتبة Aspose.Cells تتيح لك التعامل مع مصنفات Excel والوصول إليها. بتمرير مسار الملف، نقوم بتحميل المصنف المحدد للمعالجة.
## الخطوة 3: تهيئة مصفوفة بايت لبيانات المصنف
قبل أن نبدأ في تحويل المصنف إلى ملف CSV، نحتاج إلى تهيئة مجموعة بايتات فارغة والتي ستحمل في النهاية كافة بيانات ورقة العمل.
```csharp
// مصفوفة مكونة من 0 بايت
byte[] workbookData = new byte[0];
```
ستقوم مجموعة البايتات هذه بدمج البيانات من كل ورقة عمل في بنية واحدة يمكننا كتابتها في ملف لاحقًا.
## الخطوة 4: إعداد خيارات حفظ النص
الآن، لنُعِد خيارات حفظ تنسيق النص. يمكنك اختيار فواصل مخصصة أو استخدام علامات التبويب.
```csharp
// خيارات حفظ النص. يمكنك استخدام أي نوع من الفواصل.
TxtSaveOptions opts = new TxtSaveOptions();
opts.Separator = '\t'; // تعيين علامة التبويب كفاصل
```
في هذا المثال، نستخدم علامة التبويب كفاصل. يمكنك استبدال `'\t'` مع أي حرف تريده، مثل الفاصلة (`,`), اعتمادًا على كيفية رغبتك في تنسيق ملف CSV الخاص بك.
## الخطوة 5: التكرار في كل ورقة عمل
بعد ذلك، سنكرر كل أوراق العمل داخل المصنف، ونحفظ كل واحدة منها في `workbookData` المصفوفة، ولكن يجب عليك أولاً تحديد ورقة العمل التي ستعمل عليها.
```csharp
// انسخ بيانات كل ورقة عمل بتنسيق نصي داخل مجموعة بيانات المصنف
for (int idx = 0; idx < workbook.Worksheets.Count; idx++)
{
    // حفظ ورقة العمل النشطة بتنسيق نصي
    MemoryStream ms = new MemoryStream();
    workbook.Worksheets.ActiveSheetIndex = idx;
    workbook.Save(ms, opts);
```
تمر الحلقة عبر كل ورقة عمل في المصنف. `ActiveSheetIndex` تم ضبطه بحيث نحفظ ورقة العمل الحالية في كل مرة نمر فيها عبر الحلقة. سيتم حفظ النتائج في الذاكرة باستخدام `MemoryStream`.
## الخطوة 6: استرداد بيانات ورقة العمل
بعد حفظ ورقة العمل في مجرى الذاكرة، فإن الخطوة التالية هي استرداد هذه البيانات وإضافتها إلى `workbookData` مصفوفة.
```csharp
    // حفظ بيانات ورقة العمل في مصفوفة بيانات الورقة
    ms.Position = 0; // إعادة تعيين موضع تدفق الذاكرة
    byte[] sheetData = ms.ToArray(); // احصل على مجموعة البايتات
```
`ms.Position = 0;` يعيد ضبط موضع القراءة بعد الكتابة. ثم نستخدم `ToArray()` لتحويل مجرى الذاكرة إلى مصفوفة بايتات تحتوي على بيانات ورقة العمل.
## الخطوة 7: دمج بيانات ورقة العمل
الآن، سنقوم بدمج البيانات من كل ورقة عمل في ورقة عمل واحدة `workbookData` تم تهيئتها مسبقًا.
```csharp
    // دمج بيانات ورقة العمل هذه في مجموعة بيانات المصنف
    byte[] combinedArray = new byte[workbookData.Length + sheetData.Length];
    Array.Copy(workbookData, 0, combinedArray, 0, workbookData.Length);
    Array.Copy(sheetData, 0, combinedArray, workbookData.Length, sheetData.Length);
    workbookData = combinedArray;
}
```
ننشئ مصفوفة جديدة كبيرة بما يكفي لاستيعاب بيانات مصنف العمل الحالي وبيانات ورقة العمل الجديدة. ثم ننسخ البيانات الحالية والجديدة إلى هذه المصفوفة المدمجة لاستخدامها لاحقًا.
## الخطوة 8: حفظ بيانات المصنف بالكامل في ملف
وأخيرًا، مع جمع كل البيانات في `workbookData` المصفوفة، يمكننا حفظ هذه المصفوفة في مسار ملف محدد.
```csharp
// حفظ بيانات المصنف بأكملها في ملف
File.WriteAllBytes(dataDir + "out.txt", workbookData);
```
`WriteAllBytes` يأخذ مجموعة البايتات المجمعة ويكتبها في ملف نصي يسمى "out.txt" في الدليل المحدد.
## خاتمة
وها قد انتهيت! لقد نجحت في تحويل مصنف Excel إلى صيغة CSV باستخدام Aspose.Cells لـ .NET. هذه العملية ليست فعّالة فحسب، بل تُسهّل أيضًا معالجة بيانات Excel لمزيد من التحليل أو إعداد التقارير. الآن، يمكنك أتمتة مهام معالجة البيانات أو حتى دمج هذه الوظيفة في تطبيقات أكبر.
## الأسئلة الشائعة
### هل يمكنني استخدام فواصل مختلفة لملف CSV؟
نعم يمكنك تغيير `opts.Separator` إلى أي حرف تريده، مثل الفواصل أو الأنابيب.
### هل استخدام Aspose.Cells مجاني؟
Aspose.Cells ليس مجانيًا، ولكن يمكنك الحصول على نسخة تجريبية مجانية [هنا](https://releases.aspose.com/).
### ما هي أنواع التنسيقات التي يمكنني الحفظ بها بالإضافة إلى CSV؟
يتيح لك Aspose.Cells الحفظ بتنسيقات متعددة بما في ذلك XLSX وPDF والمزيد.
### هل يمكنني معالجة ملفات Excel كبيرة الحجم باستخدام Aspose.Cells؟
نعم، تم تصميم Aspose.Cells للتعامل مع الملفات الكبيرة بكفاءة، ولكن الأداء قد يعتمد على موارد النظام.
### أين يمكنني العثور على المزيد من الوثائق التفصيلية؟
يمكنك العثور على وثائق وأمثلة شاملة على [موقع مرجعي](https://reference.aspose.com/cells/net/).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}