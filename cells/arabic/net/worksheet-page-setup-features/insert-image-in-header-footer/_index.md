---
title: إدراج صورة في رأس وتذييل ورقة العمل
linktitle: إدراج صورة في رأس وتذييل ورقة العمل
second_title: واجهة برمجة تطبيقات معالجة Excel الخاصة بـ Aspose.Cells .NET
description: تعرف على كيفية إدراج صورة بسهولة في الرأس/التذييل باستخدام Aspose.Cells لـ .NET في هذا الدليل الشامل.
weight: 15
url: /ar/net/worksheet-page-setup-features/insert-image-in-header-footer/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# إدراج صورة في رأس وتذييل ورقة العمل

## مقدمة
عندما يتعلق الأمر بإنشاء جداول بيانات Excel ذات مظهر احترافي، فإن التفاصيل الصغيرة يمكن أن تحدث فرقًا كبيرًا. ومن بين هذه التفاصيل إضافة الصور إلى رأس أو تذييل أوراق العمل الخاصة بك. إنها طريقة أكيدة لإضفاء لمسة احترافية على مستنداتك. ورغم أن هذا قد يبدو معقدًا، خاصة إذا لم تكن من خبراء التكنولوجيا، فإن استخدام Aspose.Cells لـ .NET يبسط العملية بشكل كبير. لذا، دعنا نتعمق ونتعلم كيفية القيام بذلك خطوة بخطوة!
## المتطلبات الأساسية
قبل أن تبدأ رحلتك لإدراج الصور في أقسام الرأس والتذييل، تأكد من توفر بعض الأشياء في مكانها:
1. Visual Studio: تأكد من تثبيت Visual Studio على جهاز الكمبيوتر لديك. تعد بيئة التطوير المتكاملة هذه بمثابة مصدر قوي لتطوير .NET.
2.  Aspose.Cells for .NET: يمكنك الحصول على نسخة تجريبية مجانية أو شرائها إذا كنت جادًا في تعظيم إمكانات Excel لديك. قم بتنزيلها[هنا](https://releases.aspose.com/cells/net/).
3. المعرفة الأساسية بلغة C#: سيكون من المفيد الحصول على فهم أساسي للغة C# وكيفية تشغيل تطبيق .NET.
4. ملف الصورة: احصل على ملف صورة جاهز مثل شعار الشركة. في هذا المثال، سنشير إليه باسم`aspose-logo.jpg`.
## استيراد الحزم
لبدء رحلة الترميز الخاصة بنا، تأكد من استيراد الحزم اللازمة في مشروع C# الخاص بك. أنت بحاجة إلى مساحة اسم Aspose.Cells التي تحتوي على جميع الفئات والطرق التي ستعمل بها.
إليك كيفية تضمينه في الكود الخاص بك:
```csharp
using System.IO;
using Aspose.Cells;
using System;
```
الآن بعد أن قمنا بإعداد كل شيء، دعنا ننتقل إلى العملية بخطوات سهلة المتابعة.
## الخطوة 1: إعداد الدليل الخاص بك
حدد المكان الذي سيتم تخزين ملفاتك فيه.
 أولاً، نحتاج إلى تحديد المسار إلى دليل المستندات الخاص بنا حيث يوجد ملف Excel والصورة. يمكنك تعيين أي مسار؛ فقط استبدل`"Your Document Directory"` مع مسار الدليل الفعلي الخاص بك.
```csharp
string dataDir = "Your Document Directory";
```
## الخطوة 2: إنشاء كائن مصنف
إنشاء مثيل لمصنف Excel الخاص بك.
بعد تعيين المسار، نحتاج الآن إلى إنشاء مثيل جديد لورقة عمل سنقوم فيها بإدراج صورتنا. 
```csharp
Workbook workbook = new Workbook();
```
## الخطوة 3: تحميل صورتك
افتح ملف الصورة وقم بقراءته وتحويله إلى مجموعة بايتات للمعالجة.
بعد ذلك، سنقوم بتعيين المسار لصورتنا (الشعار، في هذه الحالة) ونقوم بتهيئة`FileStream` الكائن لقراءة الصورة. إليك كيفية القيام بذلك:
```csharp
string logo_url = dataDir + "aspose-logo.jpg";
// إعلان كائن FileStream
FileStream inFile;
byte[] binaryData;
// إنشاء مثيل لكائن FileStream
inFile = new FileStream(logo_url, FileMode.Open, FileAccess.Read);
```
## الخطوة 4: قراءة الصورة في مصفوفة بايت
تحويل بيانات ملف الصورة إلى مصفوفة بايتات.
للعمل مع الصورة، نحتاج إلى قراءتها في مصفوفة بايتات. وهذا أمر ضروري لأنه يسمح لنا بالتعامل مع الصورة داخل التطبيق.
```csharp
// إنشاء مجموعة بايتات بحجم كائن FileStream
binaryData = new byte[inFile.Length];
// يقوم بقراءة كتلة من البايتات من التدفق ويكتب البيانات في مخزن مؤقت معين من مجموعة البايتات.
long bytesRead = inFile.Read(binaryData, 0, (int)inFile.Length);
```
## الخطوة 5: تكوين إعداد الصفحة للرأس/التذييل
قم بالوصول إلى كائن PageSetup للتحكم في أقسام الرأس والتذييل.
لإدراج صورتنا، نحتاج إلى تكوين كائن إعداد الصفحة. يتيح لنا هذا تخصيص رأس ورقة العمل الخاصة بنا:
```csharp
PageSetup pageSetup = workbook.Worksheets[0].PageSetup;
```
## الخطوة 6: إدراج الشعار في الرأس
قم بتضمين الصورة في قسم رأس ورقة العمل.
هذه هي اللحظة السحرية! سنقوم بإدخال شعارنا في القسم المركزي من العنوان:
```csharp
// قم بوضع الشعار/الصورة في القسم الأوسط من رأس الصفحة.
pageSetup.SetHeaderPicture(1, binaryData);
// ضبط النص للشعار/الصورة
pageSetup.SetHeader(1, "&G");
// قم بتعيين اسم الورقة في القسم الأيمن من رأس الصفحة باستخدام البرنامج النصي
pageSetup.SetHeader(2, "&A");
```
## الخطوة 7: احفظ المصنف الخاص بك
احفظ التغييرات في ملف Excel جديد.
بعد تكوين كل شيء، حان الوقت لحفظ المصنف. تأكد من توفير اسم جديد لملف الإخراج الخاص بك:
```csharp
workbook.Save(dataDir + "InsertImageInHeaderFooter_out.xls");
```
## الخطوة 8: تنظيف الموارد
أغلق FileStream لتحرير الموارد.
 أخيرًا، بعد كل هذا التلاعب، لا تنسَ أن تقوم بالترتيب عن طريق إغلاق`FileStream`!
```csharp
inFile.Close();
```
## خاتمة
وها أنت ذا! لقد نجحت في إدراج صورة في رأس/تذييل ورقة عمل Excel باستخدام Aspose.Cells for .NET. الأمر بسيط، أليس كذلك؟ بمجرد فهم الخطوات، يمكنك تخصيصها بشكل أكبر لتناسب احتياجاتك المحددة. سواء كنت تبحث عن وضع علامة تجارية على التقارير الخاصة بشركتك أو ببساطة إضافة لمسة شخصية، فإن هذه التقنية مفيدة بشكل لا يصدق. 
## الأسئلة الشائعة
### هل يمكنني استخدام أي صيغة للصورة؟
نعم، يدعم Aspose.Cells تنسيقات الصور المختلفة بما في ذلك JPEG وPNG وBMP لصور الرأس والتذييل.
### هل استخدام Aspose.Cells مجاني؟
 يقدم Aspose.Cells نسخة تجريبية مجانية، ولكن للاستخدام المستمر، ستحتاج إلى شراء ترخيص. تعرف على المزيد حول الأسعار[هنا](https://purchase.aspose.com/buy).
### كيف يمكنني الوصول إلى وثائق Aspose.Cells؟
 يمكنك التعمق في ميزات ووظائف Aspose.Cells من خلال زيارة[التوثيق](https://reference.aspose.com/cells/net/).
### هل يمكنني استخدام Aspose.Cells بدون Visual Studio؟
نعم، طالما أنك تمتلك بيئة تشغيل .NET، فيمكنك استخدام Aspose.Cells في أي بيئة تطوير متوافقة مع .NET.
### ماذا يجب أن أفعل إذا واجهت مشاكل؟
 إذا واجهت أي مشاكل أو كنت بحاجة إلى الدعم، فتحقق من[منتدى دعم Aspose](https://forum.aspose.com/c/cells/9) للحصول على المساعدة من المجتمع والمطورين.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
