---
"description": "تعرف على كيفية إعداد الرؤوس والتذييلات في أوراق عمل Excel باستخدام Aspose.Cells لـ .NET من خلال برنامج تعليمي خطوة بخطوة وأمثلة عملية ونصائح مفيدة."
"linktitle": "تنفيذ الرأس والتذييل في ورقة العمل"
"second_title": "واجهة برمجة تطبيقات معالجة Excel Aspose.Cells .NET"
"title": "تنفيذ الرأس والتذييل في ورقة العمل"
"url": "/ar/net/worksheet-page-setup-features/implement-header-and-footer/"
"weight": 22
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# تنفيذ الرأس والتذييل في ورقة العمل

## مقدمة

عند العمل مع جداول بيانات Excel، تلعب الرؤوس والتذييلات دورًا أساسيًا في إيصال معلومات سياقية مهمة، مثل أسماء الملفات والتواريخ وأرقام الصفحات، إلى جمهورك. سواء كنت تُؤتمت التقارير أو تُنشئ ملفات ديناميكية، يُسهّل Aspose.Cells for .NET تخصيص الرؤوس والتذييلات في جداول العمل برمجيًا. يتعمق هذا الدليل في نهج شامل خطوة بخطوة لإضافة الرؤوس والتذييلات باستخدام Aspose.Cells for .NET، مما يُضفي على ملفات Excel لمسةً من الأناقة والاحترافية.

## المتطلبات الأساسية

قبل أن تبدأ، تأكد من أن لديك ما يلي:

1. Aspose.Cells لـ .NET: ستحتاج إلى تثبيت Aspose.Cells لـ .NET. [تحميله هنا](https://releases.aspose.com/cells/net/).
2. إعداد IDE: Visual Studio (أو IDE المفضل لديك) مع تثبيت .NET Framework.
3. الترخيص: على الرغم من أنه يمكنك البدء بالإصدار التجريبي المجاني، فإن الحصول على ترخيص كامل أو مؤقت سيفتح لك المجال للاستفادة الكاملة من إمكانات Aspose.Cells. [احصل على ترخيص مؤقت](https://purchase.aspose.com/temporary-license/).

تُعد وثائق Aspose.Cells مرجعًا مفيدًا خلال هذه العملية. يمكنك العثور عليها [هنا](https://reference.aspose.com/cells/net/).

## استيراد الحزم

في مشروعك، قم باستيراد مساحات الأسماء المطلوبة:

```csharp
using System.IO;
using Aspose.Cells;
using System;
```

من خلال استيراد هذه الحزمة، سيكون لديك حق الوصول إلى الفئات والطرق اللازمة للعمل مع الرؤوس والتذييلات والوظائف الأخرى في Excel داخل Aspose.Cells.

في هذا الدليل، سنقوم بتقسيم كل خطوة حتى تتمكن من متابعتها بسهولة، حتى إذا كنت جديدًا على Aspose.Cells أو .NET.

## الخطوة 1: إعداد المصنف وإعداد الصفحة

أولاً: أنشئ مصنفًا جديدًا وافتح إعدادات صفحة ورقة العمل. سيوفر لك هذا الأدوات اللازمة لتعديل رأس وتذييل ورقة العمل.

```csharp
// حدد المسار لحفظ مستندك
string dataDir = "Your Document Directory";

// إنشاء كائن مصنف
Workbook excel = new Workbook();
```

هنا، قمنا بإنشاء `Workbook` الكائن الذي يمثل ملف Excel الخاص بنا. `PageSetup` في ورقة العمل يمكننا تعديل خيارات الرأس والتذييل.


## الخطوة 2: الوصول إلى خصائص ورقة العمل وإعداد الصفحة

في Aspose.Cells، تحتوي كل ورقة عمل على `PageSetup` الخاصية التي تتحكم بميزات التخطيط، بما في ذلك الرؤوس والتذييلات. لنبدأ `PageSetup` كائن لورقة العمل الخاصة بنا.

```csharp
// احصل على المرجع إلى PageSetup في ورقة العمل الأولى
PageSetup pageSetup = excel.Worksheets[0].PageSetup;
```

مع هذا، `pageSetup` يحتوي الآن على جميع الإعدادات اللازمة لتخصيص الرؤوس والتذييلات.


## الخطوة 3: تعيين القسم الأيسر من الرأس

تُقسّم الرؤوس في إكسل إلى ثلاثة أقسام: يسار، وسط، ويمين. لنبدأ بتحديد القسم الأيسر لعرض اسم ورقة العمل.

```csharp
// تعيين اسم ورقة العمل في القسم الأيسر من الرأس
pageSetup.SetHeader(0, "&A");
```

استخدام `&A` يتيح لك عرض اسم ورقة العمل ديناميكيًا. هذا مفيد بشكل خاص إذا كان لديك عدة أوراق في مصنف وتريد أن يعكس كل رأس عنوان الورقة.


## الخطوة 4: إضافة التاريخ والوقت إلى وسط الرأس

الآن، لنُضِف التاريخ والوقت الحاليين إلى القسم الأوسط من العنوان. بالإضافة إلى ذلك، سنستخدم خطًا مخصصًا للتصميم.

```csharp
// تعيين التاريخ والوقت في القسم الأوسط من الرأس باستخدام الخط العريض
pageSetup.SetHeader(1, "&\"Times New Roman,Bold\"&D-&T");
```

في هذا الكود:
- `&D` يقوم بإدراج التاريخ الحالي.
- `&T` يقوم بإدراج الوقت الحالي.
- `"Times New Roman,Bold"` يتم تطبيق الخط Times New Roman بالخط العريض على هذه العناصر.


## الخطوة 5: عرض اسم الملف في القسم الأيمن من الرأس

لإكمال العنوان، دعنا نعرض اسم الملف على الجانب الأيمن، إلى جانب تعديل الخط.

```csharp
// عرض اسم الملف في القسم الأيمن من الرأس باستخدام حجم الخط المخصص
pageSetup.SetHeader(2, "&\"Times New Roman,Bold\"&12&F");
```

- `&F` يمثل اسم الملف، مما يجعل من الواضح أي ملف تنتمي إليه الصفحات المطبوعة.
- `&12` تغير حجم الخط إلى 12 لهذا القسم.


## الخطوة 6: إضافة نص بخط مخصص إلى قسم التذييل الأيسر

ننتقل الآن إلى التذييلات! سنبدأ بإعداد قسم التذييل الأيسر بنص مخصص ونمط خط محدد.

```csharp
// أضف نصًا مخصصًا بنمط الخط إلى القسم الأيسر من التذييل
pageSetup.SetFooter(0, "Hello World! &\"Courier New\"&14 123");
```

ال `&\"Courier New\"&14` يطبق الإعداد الموجود في الكود أعلاه الخط "Courier New" بحجم 14 على النص المحدد (`123`).يبقى باقي النص بالخط الافتراضي للتذييل.


## الخطوة 7: إدراج رقم الصفحة في منتصف التذييل

يعد تضمين أرقام الصفحات في التذييل طريقة رائعة لمساعدة القراء على تتبع المستندات المكونة من عدة صفحات.

```csharp
// أدخل رقم الصفحة في القسم الأوسط من التذييل
pageSetup.SetFooter(1, "&P");
```

هنا، `&P` يضيف رقم الصفحة الحالية إلى قسم التذييل الأوسط. إنها تفصيلة صغيرة، لكنها أساسية للمستندات ذات المظهر الاحترافي.


## الخطوة 8: إظهار إجمالي عدد الصفحات في قسم التذييل الأيمن

وأخيرًا، دعنا نكمل التذييل من خلال عرض إجمالي عدد الصفحات في القسم الأيمن.

```csharp
// عرض إجمالي عدد الصفحات في القسم الأيمن من التذييل
pageSetup.SetFooter(2, "&N");
```

- `&N` يقدم إجمالي عدد الصفحات، مما يسمح للقراء بمعرفة طول المستند.


## الخطوة 9: حفظ المصنف

بعد إعداد الرؤوس والتذييلات، حان وقت حفظ المصنف. هذه هي الخطوة الأخيرة لإنشاء ملف Excel برؤوس وتذييلات مخصصة بالكامل.

```csharp
// حفظ المصنف
excel.Save(dataDir + "SetHeadersAndFooters_out.xls");
```

يحفظ هذا السطر الملف في الدليل المخصص لك مع وضع الرؤوس والتذييلات المخصصة في مكانها.


## خاتمة

إضافة الرؤوس والتذييلات إلى أوراق عمل Excel مهارة قيّمة لإنشاء مستندات منظمة واحترافية. مع Aspose.Cells لـ .NET، يمكنك التحكم الكامل في رؤوس وتذييلات ملفات Excel، بدءًا من عرض اسم ورقة العمل ووصولًا إلى إدراج نص مخصص وتاريخ ووقت وحتى أرقام صفحات ديناميكية. الآن وقد شاهدت كل خطوة عمليًا، يمكنك الارتقاء بأتمتة Excel إلى مستوى أعلى.

## الأسئلة الشائعة

### هل يمكنني استخدام خطوط مختلفة لأقسام مختلفة من الرؤوس والتذييلات؟  
نعم، يسمح لك Aspose.Cells for .NET بتحديد الخطوط لكل قسم من أقسام الرأس والتذييل باستخدام علامات الخط المحددة.

### كيف يمكنني إزالة الرؤوس والتذييلات؟  
يمكنك مسح الرؤوس والتذييلات عن طريق تعيين نص الرأس أو التذييل إلى سلسلة فارغة باستخدام `SetHeader` أو `SetFooter`.

### هل يمكنني إدراج الصور في الرؤوس أو التذييلات باستخدام Aspose.Cells لـ .NET؟  
حاليًا، يدعم Aspose.Cells النصوص في الرؤوس والتذييلات بشكل أساسي. قد تتطلب الصور حلاً بديلاً، مثل إدراجها في ورقة العمل نفسها.

### هل يدعم Aspose.Cells البيانات الديناميكية في الرؤوس والتذييلات؟  
نعم، يمكنك استخدام أكواد ديناميكية مختلفة (مثل `&D` للتاريخ أو `&P` (لرقم الصفحة) لإضافة محتوى ديناميكي.

### كيف يمكنني تعديل ارتفاع الرأس أو التذييل؟  
يوفر Aspose.Cells خيارات داخل `PageSetup` فئة لضبط هوامش الرأس والتذييل، مما يتيح لك التحكم في التباعد.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}