---
"description": "تعلّم كيفية حساب اللون الذي يختاره MS Excel باستخدام Aspose.Cells لـ .NET. اتبع هذا الدليل خطوة بخطوة للوصول إلى لون التنسيق الشرطي في Excel برمجيًا."
"linktitle": "حساب اللون الذي تم اختياره بواسطة MS Excel برمجيًا"
"second_title": "واجهة برمجة تطبيقات معالجة Excel Aspose.Cells .NET"
"title": "حساب اللون الذي تم اختياره بواسطة MS Excel برمجيًا"
"url": "/ar/net/color-settings-and-customization-in-excel/compute-color-chosen-by-ms-excel/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# حساب اللون الذي تم اختياره بواسطة MS Excel برمجيًا

## مقدمة
هل سبق لك العمل مع ملفات Excel وتساءلت عن كيفية اختيار ألوان معينة تلقائيًا للتنسيق؟ لست وحدك. قد يكون التنسيق الشرطي في Excel غامضًا بعض الشيء، خاصةً عند محاولة استخراج اللون المحدد الذي يُعيّنه Excel. لكن لا تقلق، لدينا الحل! في هذا البرنامج التعليمي، سنتعمق في كيفية حساب اللون الذي يختاره MS Excel برمجيًا باستخدام Aspose.Cells لـ .NET. سنشرح ذلك خطوة بخطوة، لتتمكن من متابعته وتطبيقه على مشاريعك الخاصة بسهولة. هيا بنا نبدأ!
## المتطلبات الأساسية
قبل الغوص في الكود، دعنا نغطي ما ستحتاجه لمتابعة هذا البرنامج التعليمي:
- تم تثبيت Aspose.Cells لـ .NET. إذا لم يكن مثبتًا لديك بعد، يمكنك [قم بتحميله هنا](https://releases.aspose.com/cells/net/).
- معرفة عملية بلغة C# وإطار عمل .NET.
- ملف Excel نموذجي (Book1.xlsx) مع بعض التنسيق الشرطي المطبق.
يمكنك أيضًا تجربة النسخة التجريبية المجانية من Aspose.Cells لـ .NET إذا لم يكن لديك ترخيص. احصل على النسخة التجريبية. [هنا](https://releases.aspose.com/).
## استيراد الحزم
قبل البدء بالبرمجة، علينا استيراد الحزم اللازمة لضمان سير العمل بسلاسة. تأكد من تضمين مساحات الأسماء التالية في مشروعك:
```csharp
using System.IO;
using Aspose.Cells;
using System.Drawing;
using System;
```
توفر هذه الواردات إمكانية الوصول إلى فئات Aspose.Cells الرئيسية ومكتبة الرسم الأصلية لنظام .NET للتعامل مع الألوان.

الآن بعد أن أصبح كل شيء في مكانه، دعونا نقسم هذه المهمة إلى خطوات قابلة للهضم:
## الخطوة 1: إعداد كائن المصنف
أول شيء يتعين علينا القيام به هو إنشاء مثيل `Workbook` الكائن وحمّل ملف Excel الذي نريد العمل عليه. هنا تبدأ الرحلة!
```csharp
// المسار إلى دليل المستندات.
string dataDir = "Your Document Directory";
// إنشاء كائن مصنف وفتح ملف القالب
Workbook workbook = new Workbook(dataDir + "Book1.xlsx");
```
في هذه الخطوة، نقوم بإنشاء مثيل جديد لـ `Workbook` فئة من Aspose.Cells. `Workbook` تمثل الفئة ملف Excel، ومن خلال توفير المسار إلى ملفنا، يمكننا تحميله بسهولة لمزيد من المعالجة.
## الخطوة 2: الوصول إلى ورقة العمل الأولى
بعد تحميل المصنف، نحتاج إلى الوصول إلى ورقة العمل المحددة التي نريد استخراج اللون منها. في هذا المثال، سنعمل على الورقة الأولى.
```csharp
// احصل على ورقة العمل الأولى
Worksheet worksheet = workbook.Worksheets[0];
```
هنا، نقوم بجلب ورقة العمل الأولى في المصنف باستخدام `Worksheets[0]` يتيح لك Aspose.Cells الوصول إلى أي ورقة عمل في ملف Excel من خلال فهرسها أو اسمها.
## الخطوة 3: حدد الخلية المطلوبة
بعد ذلك، سنختار خلية محددة في ورقة العمل. في هذا الدرس، سنركز على الخلية "A1"، ولكن يمكنك تحديد أي خلية مُطبّق عليها التنسيق الشرطي.
```csharp
// احصل على الخلية A1
Cell a1 = worksheet.Cells["A1"];
```
نحن نستخدم `Cells` خاصية للإشارة إلى خلية محددة حسب عنوانها. في هذه الحالة، نختار الخلية "A1" لأننا نريد استخراج نتائج التنسيق الشرطي المطبقة عليها.
## الخطوة 4: استرداد نتيجة التنسيق الشرطي
الآن، هنا يأتي دور السحر! سنستخدم Aspose.Cells للحصول على نتيجة التنسيق الشرطي للخلية المحددة. بهذه الطريقة يحسب Excel التنسيق ديناميكيًا، بما في ذلك الألوان.
```csharp
// الحصول على كائن التنسيق الشرطي الناتج
ConditionalFormattingResult cfr1 = a1.GetConditionalFormattingResult();
```
ال `GetConditionalFormattingResult()` الطريقة أساسية في هذه الخطوة. فهي تُرجع كائنًا يحتوي على نتائج أي تنسيق شرطي مُطبّق على الخلية. هنا نبدأ في الاستفادة من معلومات الألوان التي يستخدمها Excel.
## الخطوة 5: الوصول إلى ColorScaleResult
بمجرد حصولنا على نتيجة التنسيق الشرطي، يمكننا البحث بشكل أعمق والوصول إلى مقياس الألوان الذي استخدمه Excel لهذه الخلية المعينة.
```csharp
// احصل على كائن اللون الناتج من ColorScale
Color c = cfr1.ColorScaleResult;
```
يعتمد التنسيق الشرطي في Excel غالبًا على مقاييس الألوان. يتيح لنا هذا السطر استخراج اللون الناتج المُطبّق وفقًا لقواعد التنسيق الشرطي.
## الخطوة 6: إخراج معلومات اللون
أخيرًا، نريد رؤية اللون المُطبّق في Excel. لنطبع تفاصيل اللون بتنسيق سهل الفهم، بما في ذلك قيمة ARGB واسمه.
```csharp
// اقرأ اللون
Console.WriteLine(c.ToArgb().ToString());
Console.WriteLine(c.Name);
```
ال `ToArgb()` تعطينا الطريقة اللون بتنسيق ARGB (ألفا، أحمر، أخضر، أزرق)، بينما `Name` تُوفّر الخاصية اسم اللون بتنسيق أسهل للقراءة. يمكنك استخدام تفاصيل اللون هذه لمطابقتها في تطبيقات أخرى أو تعديل ملفات Excel برمجيًا.

## خاتمة
وهذا كل ما في الأمر! باتباع هذه الخطوات، تكون قد تعلمت كيفية حساب اللون الذي يختاره MS Excel برمجيًا باستخدام Aspose.Cells لـ .NET. يُعد هذا النهج مفيدًا للغاية لأتمتة مهام Excel، خاصةً عند التعامل مع التنسيق الشرطي المعقد. الآن، في المرة القادمة التي تواجه فيها لونًا غامضًا في Excel، ستعرف بالضبط كيفية كشف أسراره.
## الأسئلة الشائعة
### هل يمكنني تطبيق التنسيق الشرطي برمجيًا باستخدام Aspose.Cells؟
نعم، يسمح لك Aspose.Cells بتطبيق التنسيق الشرطي وتعديله وحتى إزالته في ملفات Excel برمجيًا.
### هل يدعم Aspose.Cells جميع إصدارات Excel؟
بالتأكيد! يدعم Aspose.Cells إصدارات Excel 97-2003 (XLS)، وExcel 2007-2019/365 (XLSX)، بالإضافة إلى تنسيقات أخرى، بما في ذلك PDF وHTML وCSV.
### هل Aspose.Cells متاح لمنصات أخرى غير .NET؟
نعم، يتوفر Aspose.Cells لمنصات مختلفة، بما في ذلك Java وC++ وAndroid عبر Java.
### كيف يمكنني الحصول على نسخة تجريبية مجانية من Aspose.Cells؟
يمكنك تنزيل نسخة تجريبية مجانية من Aspose.Cells لـ .NET من [هنا](https://releases.aspose.com/).
### كيف أتعامل مع ملفات Excel الكبيرة باستخدام Aspose.Cells؟
تم تحسين أداء Aspose.Cells، حتى عند التعامل مع ملفات كبيرة. يمكنك استخدام واجهات برمجة التطبيقات المتدفقة للتعامل مع البيانات الكبيرة بكفاءة.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}