---
category: general
date: 2026-02-23
description: ä½¿ç”¨ C# åŠ Aspose.Cells å»ºç«‹æ™ºæ…§æ¨™è¨˜é›†åˆã€‚å­¸ç¿’å¦‚ä½•æ–°å¢æ¨™è¨˜ã€è¨»è§£ï¼Œä¸¦åƒ…éœ€å¹¾å€‹æ­¥é©Ÿå³å¯å°‡å®ƒå€‘å¥—ç”¨è‡³å·¥ä½œè¡¨ã€‚
draft: false
keywords:
- create smart marker collection
- smart markers
- marker collection
- Aspose.Cells
- worksheet smart markers
language: zh-hant
og_description: ä½¿ç”¨ Aspose.Cells åœ¨ C# ä¸­å»ºç«‹æ™ºæ…§æ¨™è¨˜é›†åˆã€‚æœ¬æ•™å­¸ç¤ºç¯„å¦‚ä½•æ–°å¢æ¨™è¨˜ã€è¨»è§£ï¼Œä¸¦å°‡å®ƒå€‘å¥—ç”¨è‡³å·¥ä½œè¡¨ã€‚
og_title: å»ºç«‹æ™ºæ…§æ¨™è¨˜é›†åˆ â€“ å®Œæ•´ C# æŒ‡å—
tags:
- Aspose.Cells
- C#
- SmartMarkers
title: å»ºç«‹æ™ºæ…§æ¨™è¨˜é›†åˆ â€“ å®Œæ•´ C# æŒ‡å—
url: /zh-hant/net/smart-markers-dynamic-data/create-smart-marker-collection-complete-c-guide/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# å»ºç«‹æ™ºæ…§æ¨™è¨˜é›†åˆ â€“ å®Œæ•´ C# æŒ‡å—

æœ‰æ²’æœ‰æ›¾ç¶“éœ€è¦åœ¨è©¦ç®—è¡¨ä¸­ **create smart marker collection**ï¼Œå»ä¸çŸ¥é“å¾å“ªè£¡é–‹å§‹ï¼Ÿä½ ä¸¦ä¸å­¤å–®ï¼›è¨±å¤šé–‹ç™¼è€…åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨ Aspose.Cells çš„ SmartMarkers åŠŸèƒ½æ™‚ï¼Œéƒ½æœƒç¢°åˆ°åŒæ¨£çš„éšœç¤™ã€‚å¥½æ¶ˆæ¯æ˜¯ï¼Ÿåªè¦æŒæ¡äº†æ¨¡å¼ï¼Œæ•´å€‹æµç¨‹å…¶å¯¦ç›¸ç•¶ç°¡å–®ï¼Œæˆ‘æœƒä¸€æ­¥ä¸€æ­¥å¸¶ä½ å®Œæˆã€‚

åœ¨æœ¬æ•™å­¸ä¸­ï¼Œä½ å°‡å­¸æœƒå¦‚ä½•å»ºç«‹ `MarkerCollection`ã€å°‡è³‡æ–™æ¨™è¨˜èˆ‡è¨»è§£æ”¾å…¥å…¶ä¸­ã€å°‡å®ƒé™„åŠ åˆ°å·¥ä½œè¡¨çš„ **SmartMarkers**ï¼Œæœ€å¾Œå‘¼å« `Apply()` æ–¹æ³•è®“æ‰€æœ‰å…§å®¹æ­£ç¢ºå‘ˆç¾ã€‚ç„¡éœ€å¤–éƒ¨æ–‡ä»¶â€”â€”åªè¦ç´”ç²¹ã€å¯åŸ·è¡Œçš„ C# ç¨‹å¼ç¢¼ï¼ŒåŠ ä¸Šå¹¾æ®µèªªæ˜ï¼Œè§£é‡‹æ¯ä¸€è¡ŒèƒŒå¾Œçš„ã€Œç‚ºä»€éº¼ã€ã€‚

## ä½ å°‡å­¸åˆ°ä»€éº¼

- ä¸€å€‹å¯åœ¨å¤šå€‹å·¥ä½œè¡¨é–“é‡è¤‡ä½¿ç”¨çš„ **marker collection**ã€‚  
- äº†è§£ **smart markers** èˆ‡ Aspose.Cells ç‰©ä»¶çš„äº’å‹•æ–¹å¼ã€‚  
- è™•ç†é‡è¤‡éµã€æ•ˆèƒ½è€ƒé‡èˆ‡å¸¸è¦‹é™·é˜±çš„æŠ€å·§ã€‚  
- å®Œæ•´ã€å¯ç›´æ¥è¤‡è£½è²¼ä¸Šçš„ç¯„ä¾‹ï¼Œèƒ½æ”¾å…¥ä»»ä½•å·²åƒè€ƒ Aspose.Cells çš„ .NET å°ˆæ¡ˆã€‚

**å…ˆå‚™æ¢ä»¶ï¼š**  
- å·²å®‰è£ Aspose.Cells for .NET çš„ .NETâ€¯6ï¼ˆæˆ–ä»»æ„è¼ƒæ–° .NET ç‰ˆæœ¬ï¼‰ã€‚  
- å…·å‚™åŸºæœ¬çš„ C# èªæ³•èˆ‡ç‰©ä»¶å°å‘æ¦‚å¿µã€‚  
- å·²æœ‰ä¸€å€‹æƒ³è¦å¡«å……çš„ `Worksheet` å¯¦ä¾‹â€”â€”æˆ‘å€‘å‡è¨­ä½ å·²ç¶“è¼‰å…¥æˆ–å»ºç«‹äº†æ´»é ç°¿ã€‚

å¦‚æœä½ åœ¨æƒ³ *ç‚ºä»€éº¼è¦ä½¿ç”¨æ™ºæ…§æ¨™è¨˜é›†åˆ*ï¼Œå¯ä»¥æŠŠå®ƒæƒ³æˆä¸€å€‹è¼•é‡ç´šçš„å­—å…¸ï¼Œè² è²¬åœ¨ä¸ç¡¬ç·¨ç¢¼å„²å­˜æ ¼ä½å€çš„æƒ…æ³ä¸‹å‹•æ…‹æ’å…¥å…§å®¹ã€‚é€™åœ¨æ¨¡æ¿å ±è¡¨ã€éƒµä»¶åˆä½µå¼ç™¼ç¥¨ï¼Œæˆ–ä»»ä½•éœ€è¦ä»¥ç›¸åŒç‰ˆé¢é…ç½®å¡«å…¥ä¸åŒè³‡æ–™é›†çš„æƒ…å¢ƒä¸‹ï¼Œéƒ½éå¸¸å¯¦ç”¨ã€‚

---

## æ­¥é©Ÿ 1ï¼šå¦‚ä½•åœ¨ C# ä¸­ **Create Smart Marker Collection**

é¦–å…ˆï¼Œä½ éœ€è¦ä¸€å€‹ç©ºçš„å®¹å™¨ä¾†å­˜æ”¾æ‰€æœ‰æ¨™è¨˜ã€‚Aspose.Cells æä¾›äº† `MarkerCollection` é¡åˆ¥ï¼Œæ­£æ˜¯ç‚ºæ­¤è€Œè¨­ã€‚

```csharp
// Step 1: Initialize a fresh MarkerCollection instance
MarkerCollection markerCollection = new MarkerCollection();
```

> **ç‚ºä»€éº¼é€™å¾ˆé‡è¦ï¼š**  
> `MarkerCollection` å¦‚åŒä¸€å€‹æ˜ å°„ï¼Œæ¯å€‹éµå°æ‡‰ Excel ç¯„æœ¬ä¸­çš„ä½”ä½ç¬¦ã€‚æå‰å»ºç«‹å®ƒå¯ä»¥è®“ç¨‹å¼ç¢¼ä¿æŒæ•´æ½”ï¼Œé¿å…åœ¨é‚è¼¯ä¸­åˆ°è™•æ•£è½æ¨™è¨˜å®šç¾©ã€‚

### å°æŠ€å·§
å¦‚æœä½ æ‰“ç®—åœ¨å¤šå€‹å·¥ä½œè¡¨é–“é‡è¤‡ä½¿ç”¨åŒä¸€å€‹é›†åˆï¼Œè€ƒæ…®ä½¿ç”¨ `markerCollection.Clone()` ä¾†è¤‡è£½ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½é‡æ–°å»ºæ§‹ã€‚é€™å¯ä»¥åœ¨å¤§å‹æ‰¹æ¬¡ä½œæ¥­ä¸­ç¯€çœå¹¾æ¯«ç§’çš„æ™‚é–“ã€‚

---

## æ­¥é©Ÿ 2ï¼šåŠ å…¥è³‡æ–™æ¨™è¨˜èˆ‡è¨»è§£

é›†åˆå»ºç«‹å¥½ä¹‹å¾Œï¼Œå°±å¯ä»¥é–‹å§‹å¾€è£¡é¢å¡è³‡æ–™æ¨™è¨˜ã€‚ä»¥ä¸‹ç¯„ä¾‹åŠ å…¥äº†ä¸€å€‹ç°¡å–®çš„å€¼æ¨™è¨˜ (`A1`) èˆ‡ä¸€å€‹è¨»è§£æ¨™è¨˜ (`A1.Comment`)ã€‚è¨»è§£æ¨™è¨˜ç¤ºç¯„äº† **smart markers** ä¹Ÿèƒ½è™•ç†è«¸å¦‚å‚™è¨»æˆ–é è…³ç­‰è¼”åŠ©è³‡æ–™ã€‚

```csharp
// Step 2: Add a data marker and an associated comment marker
markerCollection.Add("A1", "Value");                 // Replaces ${A1} in the template
markerCollection.Add("A1.Comment", "This is a comment"); // Replaces ${A1.Comment}
```

> **ç‚ºä»€éº¼è¦åŠ å…¥è¨»è§£ï¼š**  
> è¨±å¤šå ±è¡¨æƒ…å¢ƒéœ€è¦åœ¨äººé¡å¯è®€çš„å€¼æ—åŠ ä¸Šèªªæ˜ã€‚ä½¿ç”¨ `.Comment` å¾Œç¶´å¯ä»¥è®“è³‡æ–™èˆ‡å…¶è¨»è§£ç·Šå¯†è€¦åˆï¼Œä½¿æœ€çµ‚çš„å·¥ä½œè¡¨æ›´æ˜“æ–¼é–±è®€ã€‚

### é‚Šç·£æ¡ˆä¾‹
å¦‚æœä¸å°å¿ƒé‡è¤‡åŠ å…¥ç›¸åŒçš„éµï¼Œå¾Œé¢çš„å‘¼å«æœƒè¦†å¯«å‰é¢çš„ã€‚ç‚ºé¿å…éœé»˜è³‡æ–™éºå¤±ï¼Œä½ å¯ä»¥å…ˆæª¢æŸ¥éµæ˜¯å¦å·²å­˜åœ¨ï¼š

```csharp
if (!markerCollection.ContainsKey("A1"))
{
    markerCollection.Add("A1", "Value");
}
```

---

## æ­¥é©Ÿ 3ï¼šå°‡é›†åˆé™„åŠ è‡³ **Worksheet SmartMarkers**

æ¨™è¨˜å®šç¾©å®Œæˆå¾Œï¼Œæ¥ä¸‹ä¾†è¦æŠŠé›†åˆç¶å®šåˆ°å·¥ä½œè¡¨çš„ `SmartMarkers` å±¬æ€§ã€‚é€™å‘Šè¨´ Aspose.Cells åœ¨è™•ç†ç¯„æœ¬æ™‚è©²å»å“ªè£¡æ‰¾ã€‚

```csharp
// Step 3: Link the collection to the worksheet's SmartMarkers collection
worksheet.SmartMarkers.Add(markerCollection);
```

> **ç‚ºä»€éº¼æœƒé€™æ¨£é‹ä½œï¼š**  
> `worksheet.SmartMarkers` æœ¬èº«å°±æ˜¯ä¸€å€‹å¯ä»¥å®¹ç´å¤šå€‹ `MarkerCollection` ç‰©ä»¶çš„é›†åˆã€‚å°‡ä½ çš„é›†åˆåŠ å…¥å…¶ä¸­ï¼Œå³å¯è®“å¼•æ“æŠŠå·¥ä½œè¡¨è£¡æ¯å€‹ `${...}` ä½”ä½ç¬¦æ›¿æ›æˆä½ æä¾›çš„å€¼ã€‚

### å¯¦å‹™å°æç¤º
ä½ å¯ä»¥æŠŠå¤šå€‹ `MarkerCollection` ç‰©ä»¶é™„åŠ åˆ°åŒä¸€å€‹å·¥ä½œè¡¨â€”â€”é€™åœ¨ä¸åŒæ¨¡çµ„ç”¢ç”Ÿä¸åŒè³‡æ–™é›†ï¼ˆä¾‹å¦‚æ¨™é ­èˆ‡å…§å®¹ï¼‰æ™‚éå¸¸æœ‰ç”¨ã€‚å¼•æ“æœƒä¾åŠ å…¥çš„é †åºåˆä½µå®ƒå€‘ã€‚

---

## æ­¥é©Ÿ 4ï¼šå¥—ç”¨æ™ºæ…§æ¨™è¨˜ä»¥è™•ç†å·¥ä½œè¡¨

æœ€å¾Œä¸€æ­¥æ˜¯å‘¼å« `Apply()`ã€‚æ­¤æ–¹æ³•æœƒéæ­·å·¥ä½œè¡¨ï¼Œå°‹æ‰¾æ¯å€‹ `${key}` ä½”ä½ç¬¦ï¼Œä¸¦ä»¥é›†åˆä¸­çš„å°æ‡‰å€¼å–ä»£ã€‚

```csharp
// Step 4: Execute the smart marker processing
worksheet.SmartMarkers.Apply();
```

> **åº•å±¤ç™¼ç”Ÿäº†ä»€éº¼ï¼š**  
> Aspose.Cells æœƒè§£æå„²å­˜æ ¼å…¬å¼ï¼Œè¾¨è­˜ `${}` ä»£ç¢¼ï¼Œæ–¼å·²é™„åŠ çš„é›†åˆä¸­æŸ¥æ‰¾å°æ‡‰éµï¼Œç„¶å¾ŒæŠŠè§£æå¾Œçš„å€¼å¯«å›å„²å­˜æ ¼â€”â€”å…¨éƒ¨åœ¨è¨˜æ†¶é«”ä¸­å®Œæˆã€‚é™¤éä½ ä¹‹å¾Œæ˜ç¢ºå‘¼å«å„²å­˜æ´»é ç°¿ï¼Œå¦å‰‡ä¸æœƒç”¢ç”Ÿä»»ä½•æª”æ¡ˆ I/Oã€‚

### æ•ˆèƒ½èªªæ˜
åœ¨åŠ å…¥æ‰€æœ‰æ¨™è¨˜å¾Œä¸€æ¬¡å‘¼å« `Apply()`ï¼Œé æ¯”æ¯åŠ å…¥ä¸€å€‹æ¨™è¨˜å°±å‘¼å«ä¸€æ¬¡ä¾†å¾—æœ‰æ•ˆç‡ã€‚æ‰¹æ¬¡è™•ç†å¯æ¸›å°‘å°å·¥ä½œè¡¨çš„éæ­·æ¬¡æ•¸ã€‚

---

## æ­¥é©Ÿ 5ï¼šé©—è­‰çµæœï¼ˆä½ æ‡‰è©²çœ‹åˆ°çš„ç•«é¢ï¼‰

åŸ·è¡Œ `Apply()` å¾Œï¼Œå·¥ä½œè¡¨æ‡‰è©²æœƒé¡¯ç¤ºä½ æ’å…¥çš„æ–‡å­—å€¼ã€‚è‹¥åœ¨ Excel ä¸­é–‹å•Ÿæ´»é ç°¿ï¼Œæœƒçœ‹åˆ°ï¼š

| A | B |
|---|---|
| å€¼ | ï¼ˆç©ºï¼‰ |
| ï¼ˆç©ºï¼‰ | ï¼ˆç©ºï¼‰ |
| ï¼ˆç©ºï¼‰ | ï¼ˆç©ºï¼‰ |

è€Œé™„åŠ åœ¨ `A1` çš„è¨»è§£æœƒä»¥å„²å­˜æ ¼è¨»è§£çš„å½¢å¼å‡ºç¾ï¼ˆå³éµ â†’ *é¡¯ç¤º/éš±è—è¨»è§£*ï¼‰ã€‚

ä½ ä¹Ÿå¯ä»¥é€éç¨‹å¼ç¢¼é©—è­‰çµæœï¼š

```csharp
// Optional: Verify that the cell now holds the expected value
string cellValue = worksheet.Cells["A1"].StringValue;
Console.WriteLine($"A1 = {cellValue}"); // Should output: A1 = Value

// Verify the comment
var comment = worksheet.Cells["A1"].GetComment();
Console.WriteLine($"Comment = {comment?.Note}"); // Should output: Comment = This is a comment
```

å¦‚æœè¼¸å‡ºç¬¦åˆé æœŸï¼Œæ­å–œä½ å·²æˆåŠŸ **create smart marker collection** ä¸¦å°‡å…¶å¥—ç”¨è‡³å·¥ä½œè¡¨ï¼

---

## å¸¸è¦‹é™·é˜±èˆ‡é¿å…æ–¹å¼

| ç—‡ç‹€ | å¯èƒ½åŸå›  | è§£æ±ºæ–¹æ³• |
|---------|--------------|-----|
| `${A1}` æœªè®Šæ›´ | æ¨™è¨˜æœªåŠ å…¥æˆ–é›†åˆæœªé™„åŠ  | å†æ¬¡ç¢ºèª `markerCollection.Add("A1", ...)` èˆ‡ `worksheet.SmartMarkers.Add(markerCollection)` |
| è¨»è§£æœªé¡¯ç¤º | ä½¿ç”¨äº†éŒ¯èª¤çš„éµå¾Œç¶´æˆ–æœªå‘¼å« `GetComment()` | ä½¿ç”¨ `"A1.Comment"` ä½œç‚ºéµï¼Œä¸¦ç¢ºä¿å„²å­˜æ ¼å·²å»ºç«‹è¨»è§£ç‰©ä»¶ |
| é‡è¤‡å€¼ | ä¸å°å¿ƒå¤šæ¬¡åŠ å…¥ç›¸åŒéµ | ä½¿ç”¨ `ContainsKey` é˜²è­·æˆ–æ”¹åéµï¼ˆä¾‹å¦‚ `A1_1`, `A1_2`ï¼‰ |
| å¤§å‹å·¥ä½œè¡¨æ•ˆèƒ½ä¸‹é™ | åœ¨è¿´åœˆå…§å‘¼å« `Apply()` | å…ˆæ‰¹æ¬¡åŠ å…¥æ‰€æœ‰æ¨™è¨˜ï¼Œæœ€å¾Œä¸€æ¬¡æ€§å‘¼å« `Apply()` |

---

## å®Œæ•´å¯åŸ·è¡Œç¯„ä¾‹

ä»¥ä¸‹æ˜¯ä¸€å€‹ç¨ç«‹çš„ç¨‹å¼ï¼Œä½ å¯ä»¥ç›´æ¥ç·¨è­¯åŸ·è¡Œã€‚å®ƒæœƒå»ºç«‹æ´»é ç°¿ã€åœ¨æ¨¡æ¿å„²å­˜æ ¼åŠ å…¥ä½”ä½ç¬¦ã€å»ºæ§‹æ™ºæ…§æ¨™è¨˜é›†åˆã€å¥—ç”¨æ¨™è¨˜ï¼Œæœ€å¾Œå°‡æª”æ¡ˆå­˜ç‚º `Result.xlsx`ã€‚

```csharp
using System;
using Aspose.Cells;

class SmartMarkerDemo
{
    static void Main()
    {
        // 1ï¸âƒ£ Create a new workbook and get the first worksheet
        Workbook workbook = new Workbook();
        Worksheet worksheet = workbook.Worksheets[0];

        // Insert placeholders into the sheet (this mimics a template)
        worksheet.Cells["A1"].PutValue("${A1}");
        worksheet.Cells["A2"].PutValue("${A1.Comment}");

        // 2ï¸âƒ£ Create the marker collection
        MarkerCollection markerCollection = new MarkerCollection();

        // 3ï¸âƒ£ Add data and a comment marker
        markerCollection.Add("A1", "Value");
        markerCollection.Add("A1.Comment", "This is a comment");

        // 4ï¸âƒ£ Attach the collection to the worksheet's SmartMarkers
        worksheet.SmartMarkers.Add(markerCollection);

        // 5ï¸âƒ£ Apply the markers
        worksheet.SmartMarkers.Apply();

        // 6ï¸âƒ£ Optional verification
        Console.WriteLine($"A1 = {worksheet.Cells["A1"].StringValue}");
        var comment = worksheet.Cells["A1"].GetComment();
        Console.WriteLine($"Comment = {comment?.Note}");

        // 7ï¸âƒ£ Save the workbook
        workbook.Save("Result.xlsx");
        Console.WriteLine("Workbook saved as Result.xlsx");
    }
}
```

**é æœŸçš„ä¸»æ§å°è¼¸å‡º**

```
A1 = Value
Comment = This is a comment
Workbook saved as Result.xlsx
```

é–‹å•Ÿ `Result.xlsx`ï¼Œä½ æœƒåœ¨ A1 å„²å­˜æ ¼çœ‹åˆ°æ–‡å­—ã€Œå€¼ã€ï¼Œä¸”åŒä¸€å„²å­˜æ ¼ä¸Šæœ‰è¨»è§£ã€‚

---

## ğŸ‰ çµèª

ç¾åœ¨ä½ å·²æŒæ¡å¦‚ä½•åœ¨ C# ä¸­ **create smart marker collection**ï¼ŒåŒ…æ‹¬åŠ å…¥è³‡æ–™èˆ‡è¨»è§£æ¨™è¨˜ã€å°‡é›†åˆç¶å®šè‡³å·¥ä½œè¡¨ï¼Œä¸¦å‘¼å« `Apply()` è®“è®Šæ›´å…·é«”åŒ–ã€‚é€™å€‹æ¨¡å¼ç›¸ç•¶æ˜“æ–¼æ“´å……ï¼šåªè¦æŠŠéœ€è¦çš„éµåŠ å…¥é›†åˆã€ä¸€æ¬¡æ€§é™„åŠ ï¼Œå‰©ä¸‹çš„äº¤çµ¦å¼•æ“è™•ç†ã€‚

**æ¥ä¸‹ä¾†å¯ä»¥å˜—è©¦ï¼š**  
- ä½¿ç”¨å·¢ç‹€é›†åˆè™•ç†éšå±¤å¼è³‡æ–™ï¼ˆä¾‹å¦‚ä¸»å¾å ±è¡¨ï¼‰ã€‚  
- çµåˆæ™ºæ…§æ¨™è¨˜èˆ‡ **Aspose.Cells** åœ–è¡¨ç”¢ç”Ÿï¼Œæ‰“é€ å‹•æ…‹å„€è¡¨æ¿ã€‚  
- æ¢ç´¢ `MarkerCollection.Clone()` æ–¹æ³•ï¼Œä»¥åœ¨å¤šå€‹æ´»é ç°¿é–“é‡è¤‡ä½¿ç”¨æ¨¡æ¿è€Œä¸å¿…é‡æ–°å»ºæ§‹æ¨™è¨˜ã€‚

å¦‚æœåœ¨ä½¿ç”¨éç¨‹ä¸­é‡åˆ°ä»»ä½•å•é¡Œï¼Œæˆ–æƒ³åˆ†äº«ä½ å¦‚ä½•åœ¨å°ˆæ¡ˆä¸­é‹ç”¨æ™ºæ…§æ¨™è¨˜ï¼Œæ­¡è¿ç•™ä¸‹è©•è«–ã€‚ç¥é–‹ç™¼é †åˆ©ï¼

---

![Diagram showing how to create smart marker collection in Aspose.Cells](https://example.com/images/smart-marker-collection-diagram.png "å»ºç«‹æ™ºæ…§æ¨™è¨˜é›†åˆç¤ºæ„åœ–")

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}