---
category: general
date: 2026-02-21
description: å¿«é€Ÿä½¿ç”¨ C# å»ºç«‹ Excel å·¥ä½œç°¿ï¼Œå­¸ç¿’å¦‚ä½•å¯«å…¥æ—¥æœŸåˆ° Excelã€å°‡å·¥ä½œç°¿å„²å­˜ç‚º xlsxï¼Œä»¥åŠå¦‚ä½•åœ¨ C# ä¸­ä½¿ç”¨ Aspose.Cells
  å„²å­˜ Excel æª”æ¡ˆã€‚
draft: false
keywords:
- create excel workbook c#
- save workbook as xlsx
- how to write date to excel
- how to save excel file c#
- Aspose.Cells C# tutorial
language: zh-hant
og_description: ä½¿ç”¨ Aspose.Cells æ–¼ C# å»ºç«‹ Excel æ´»é ç°¿ã€‚äº†è§£å¦‚ä½•å¯«å…¥æ—¥æœŸè‡³ Excelã€å°‡æ´»é ç°¿å„²å­˜ç‚º xlsxï¼Œä»¥åŠå¦‚ä½•åœ¨æ•¸åˆ†é˜å…§ä»¥
  C# å„²å­˜ Excel æª”æ¡ˆã€‚
og_title: ä½¿ç”¨ C# å»ºç«‹ Excel å·¥ä½œç°¿ â€“ å¯«å…¥æ—¥æœŸä¸¦å„²å­˜ç‚º XLSX
tags:
- C#
- Excel automation
- Aspose.Cells
title: ä½¿ç”¨ C# å»ºç«‹ Excel æ´»é ç°¿ â€“ å¯«å…¥æ—¥æœŸèˆ‡å¦å­˜ç‚º XLSX çš„é€æ­¥æŒ‡å—
url: /zh-hant/net/excel-workbook/create-excel-workbook-c-step-by-step-guide-to-write-dates-sa/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# å»ºç«‹ Excel å·¥ä½œç°¿ C# â€“ å¯«å…¥æ—¥æœŸä¸¦å„²å­˜ç‚º XLSX

æ˜¯å¦æ›¾éœ€è¦å¾é ­ **create Excel workbook C#**ï¼Œå»ä¸ç¢ºå®šå¦‚ä½•åœ¨å„²å­˜æ ¼ä¸­å¯«å…¥æ­£ç¢ºçš„æ—¥æœŸå€¼ï¼Ÿä½ ä¸¦ä¸å­¤å–®ã€‚åœ¨è¨±å¤šå•†æ¥­æ‡‰ç”¨ç¨‹å¼ä¸­ï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯è¼¸å‡ºè©¦ç®—è¡¨ï¼Œè€Œç•¶ä½ å˜—è©¦æ’å…¥æ—¥æœ¬å…ƒè™Ÿæ—¥æœŸæ™‚ï¼ŒAPI æœƒæ‹‹å‡ºç•°å¸¸ã€‚  

å¥½æ¶ˆæ¯æ˜¯ï¼Ÿä½¿ç”¨ Aspose.Cells ä½ å¯ä»¥å¿«é€Ÿç”¢ç”Ÿ Excel æª”æ¡ˆã€è§£ææ—¥æœ¬å…ƒè™Ÿå­—ä¸²ã€å°‡ `DateTime` æ”¾å…¥å„²å­˜æ ¼ï¼Œä¸¦ **save workbook as xlsx**â€”â€”åªéœ€å¹¾è¡Œç¨‹å¼ç¢¼ã€‚åœ¨æœ¬æ•™å­¸ä¸­ï¼Œæˆ‘å€‘å°‡é€æ­¥èªªæ˜æ•´å€‹æµç¨‹ã€è§£é‡‹æ¯ä¸€è¡Œçš„æ„ç¾©ï¼Œä¸¦ç¤ºç¯„å¦‚ä½•å°‡ç¨‹å¼ç¢¼å¥—ç”¨åˆ°å…¶ä»–æ›†æ³•æˆ–æ ¼å¼ã€‚

---

## ä½ å°‡å­¸åˆ°

- å¦‚ä½•ä½¿ç”¨ Aspose.Cells **create Excel workbook C#**ã€‚  
- ç•¶ä¾†æºå­—ä¸²ä½¿ç”¨éå…¬æ›†æ™‚ï¼Œæ­£ç¢ºçš„ **write date to Excel** æ–¹æ³•ã€‚  
- å¦‚ä½• **save workbook as xlsx** ä»¥åŠæª”æ¡ˆæœ€çµ‚æœƒå­˜æ”¾åœ¨å“ªè£¡ã€‚  
- è™•ç†ç‰¹å®šæ–‡åŒ–è§£æçš„æŠ€å·§ä»¥åŠå¯èƒ½é‡åˆ°çš„å¸¸è¦‹é™·é˜±ã€‚  

**Prerequisites**ï¼š.NET 6+ï¼ˆæˆ– .NET Framework 4.6+ï¼‰ã€å·²åƒè€ƒ Aspose.Cells NuGet å¥—ä»¶ï¼Œä»¥åŠå° C# çš„åŸºæœ¬èªè­˜ã€‚ç„¡éœ€å…¶ä»–å‡½å¼åº«ã€‚

---

## Step 1 â€“ è¨­å®šå°ˆæ¡ˆä¸¦åŠ å…¥ Aspose.Cells

åœ¨æˆ‘å€‘èƒ½ **create Excel workbook C#** ä¹‹å‰ï¼Œéœ€è¦ä¸€å€‹åŒ…å« Aspose.Cells DLL çš„ consoleï¼ˆæˆ–ä»»ä½• .NETï¼‰å°ˆæ¡ˆã€‚

```csharp
// Create a new console project (dotnet new console) and add the package:
//   dotnet add package Aspose.Cells
using System;
using System.Globalization;
using Aspose.Cells;
```

> **Pro tip**ï¼šå¦‚æœä½ çš„ç›®æ¨™æ˜¯ .NET 6ï¼Œéš±å¼çš„ `global using` åŠŸèƒ½å¯ä»¥çœæ‰æª”æ¡ˆæœ€ä¸Šæ–¹çš„ä¸€è¡Œï¼Œä½†æ˜ç¢ºçš„ `using` é™³è¿°å¼å°åˆå­¸è€…ä¾†èªªæ›´æ˜“æ–¼ç†è§£ã€‚

---

## Step 2 â€“ åˆå§‹åŒ– Workbook ä¸¦å–å¾—ç¬¬ä¸€å€‹å·¥ä½œè¡¨

å…¨æ–°çš„ `Workbook` ä¾‹é …ä»£è¡¨ä¸€å€‹ç©ºçš„ Excel æª”æ¡ˆã€‚ç¬¬ä¸€å€‹å·¥ä½œè¡¨ï¼ˆç´¢å¼• 0ï¼‰å°±æ˜¯æˆ‘å€‘è¦æ”¾è³‡æ–™çš„åœ°æ–¹ã€‚

```csharp
// Step 2: Create a workbook and obtain the first worksheet
Workbook workbook = new Workbook();               // Inâ€‘memory Excel file
Worksheet worksheet = workbook.Worksheets[0];    // Default sheet named "Sheet1"
```

**ç‚ºä»€éº¼é€™å¾ˆé‡è¦**ï¼šAspose.Cells å®Œå…¨åœ¨è¨˜æ†¶é«”ä¸­é‹ä½œï¼Œç›´åˆ°å‘¼å« `Save` ç‚ºæ­¢ã€‚é€™æ„å‘³è‘—ä½ å¯ä»¥åœ¨ä¸è§¸åŠç£ç¢Ÿçš„æƒ…æ³ä¸‹æ“ä½œæ•¸åå¼µå·¥ä½œè¡¨â€”â€”å°æ•ˆèƒ½æ˜¯æ¥µå¤§çš„åŠ åˆ†ã€‚

---

## Step 3 â€“ å®šç¾©æ—¥æœ¬æ›†æ–‡åŒ–

æ—¥æœ¬æ›†ä¸¦éä¸€èˆ¬çš„å…¬æ›†ç³»çµ±ï¼›å®ƒä½¿ç”¨åƒã€ŒR3ã€é€™æ¨£çš„å…ƒè™Ÿï¼ˆReiwaâ€¯3ï¼‰ã€‚é€éå»ºç«‹ä¸€å€‹äº†è§£æ—¥æœ¬æ›†çš„ `CultureInfo`ï¼Œæˆ‘å€‘è®“ .NET æ‰¿æ“”ç¹é‡çš„é‹ç®—ã€‚

```csharp
// Step 3: Define a CultureInfo that uses the Japanese calendar
CultureInfo japaneseCulture = new CultureInfo("ja-JP-u-ca-japanese");
```

> **Why not just use `new CultureInfo("ja-JP")`?**  
> ç´”ç²¹çš„ `ja-JP` æ–‡åŒ–é è¨­ä½¿ç”¨å…¬æ›†ã€‚åŠ å…¥ `-u-ca-japanese` å¾Œï¼ŒåŸ·è¡Œéšæ®µæœƒåˆ‡æ›æ›†æ³•æ¼”ç®—æ³•ï¼Œå¾è€Œæ­£ç¢ºè§£æåŸºæ–¼å…ƒè™Ÿçš„æ—¥æœŸã€‚

---

## Step 4 â€“ è§£æå…ƒè™Ÿæ—¥æœŸä¸¦å¯«å…¥å„²å­˜æ ¼

ç¾åœ¨æˆ‘å€‘æŠŠå­—ä¸² `"R3-04-01"` è½‰æˆ `DateTime`ã€‚æ ¼å¼å­—ä¸² `"gggy-MM-dd"` å°æ‡‰åˆ° *å…ƒè™Ÿ*ï¼ˆ`g`ï¼‰ã€*å¹´ä»½*ï¼ˆ`y`ï¼‰ã€*æœˆä»½*ï¼ˆ`MM`ï¼‰èˆ‡ *æ—¥æœŸ*ï¼ˆ`dd`ï¼‰ã€‚

```csharp
// Step 4: Parse a date string expressed in the Japanese era format
string eraDate = "R3-04-01";                     // Reiwa 3, April 1st
DateTime parsedDate = DateTime.ParseExact(
    eraDate,
    "gggy-MM-dd",
    japaneseCulture,
    DateTimeStyles.None
);

// Write the parsed DateTime value into cell A1
worksheet.Cells["A1"].PutValue(parsedDate);
```

### èƒŒå¾Œç™¼ç”Ÿäº†ä»€éº¼ï¼Ÿ

- `ParseExact` æœƒé©—è­‰æ¨¡å¼ï¼Œå› æ­¤åƒ `"R3/04/01"` é€™æ¨£çš„éŒ¯å­—æœƒæ‹‹å‡ºå…·èªªæ˜æ€§çš„ä¾‹å¤–â€”â€”æœ‰åŠ©æ–¼æ—©æœŸåµéŒ¯ã€‚  
- ç”¢ç”Ÿçš„ `DateTime` ä»¥æœ¬åœ°æ™‚é–“ï¼ˆä¸å« UTCï¼‰å„²å­˜ï¼ŒAspose.Cells æœƒè‡ªå‹•ä¾å·¥ä½œç°¿çš„é è¨­æ¨£å¼ï¼ˆé€šå¸¸æ˜¯ `mm/dd/yyyy`ï¼‰æ ¼å¼åŒ–ã€‚è‹¥éœ€è¦è‡ªè¨‚é¡¯ç¤ºæ–¹å¼ï¼Œå¯ç¨å¾Œè¨­å®šå„²å­˜æ ¼çš„æ¨£å¼ã€‚

---

## Step 5 â€“ ï¼ˆå¯é¸ï¼‰å°‡å„²å­˜æ ¼æ ¼å¼åŒ–ç‚ºæ—¥æœŸ

å¦‚æœå¸Œæœ›å„²å­˜æ ¼é¡¯ç¤ºæ—¥æœ¬å…ƒè™Ÿè€Œéå…¬æ›†æ—¥æœŸï¼Œå¯å¥—ç”¨è‡ªè¨‚çš„æ•¸å­—æ ¼å¼ï¼š

```csharp
// Optional: Show the date in Japanese era format inside Excel
Style style = worksheet.Cells["A1"].GetStyle();
style.Custom = "[$-ja-JP]ggge'å¹´'M'æœˆ'd'æ—¥'";   // e.g., "R3å¹´04æœˆ01æ—¥"
worksheet.Cells["A1"].SetStyle(style);
```

> **Edge case**ï¼šæŸäº›è¼ƒèˆŠç‰ˆçš„ Excel æœƒå¿½ç•¥è‡ªè¨‚çš„èªç³»ä»£ç¢¼ã€‚æ­¤æ™‚å¯ä¿ç•™å…¬æ›†é¡¯ç¤ºï¼Œä¸¦åœ¨å„²å­˜æ ¼åŠ å…¥è¨»è§£ä»¥ä¿ç•™åŸå§‹å…ƒè™Ÿå­—ä¸²ã€‚

---

## Step 6 â€“ å„²å­˜ Workbook ç‚º XLSX

æœ€å¾Œï¼Œæˆ‘å€‘ **save workbook as xlsx** åˆ°è‡ªè¡ŒæŒ‡å®šçš„è·¯å¾‘ã€‚Aspose.Cells æœƒä¸€æ¬¡å¯«å…¥å®Œæ•´æª”æ¡ˆï¼Œé™¤éè¦é€éç¶²è·¯å‚³è¼¸ï¼Œå¦å‰‡ä¸éœ€è¦ä½¿ç”¨ä¸­ä»‹ä¸²æµã€‚

```csharp
// Step 6: Save the workbook to verify the result
string outputPath = @"C:\Temp\output.xlsx";
workbook.Save(outputPath, SaveFormat.Xlsx);
Console.WriteLine($"Workbook saved to {outputPath}");
```

é–‹å•Ÿ `output.xlsx` å¾Œæœƒçœ‹åˆ°ï¼š

| A |
|---|
| 2021â€‘04â€‘01ï¼ˆå¦‚æœå¥—ç”¨äº†è‡ªè¨‚æ¨£å¼ï¼Œå‰‡é¡¯ç¤ºå…ƒè™Ÿæ ¼å¼å­—ä¸²ï¼‰ |

é€™å°±æ˜¯å®Œæ•´çš„ **how to save Excel file C#** å·¥ä½œæµç¨‹ã€‚

---

## å®Œæ•´ç¯„ä¾‹ç¨‹å¼

ä»¥ä¸‹æ˜¯å¯ç›´æ¥è¤‡è£½è²¼ä¸Šçš„å®Œæ•´ç¨‹å¼ç¢¼ï¼Œå…§å«è¨»è§£ã€éŒ¯èª¤è™•ç†ä»¥åŠå¯é¸çš„æ¨£å¼è¨­å®šæ­¥é©Ÿã€‚

```csharp
using System;
using System.Globalization;
using Aspose.Cells;

class Program
{
    static void Main()
    {
        try
        {
            // 1ï¸âƒ£ Create a new workbook and get the first worksheet
            Workbook workbook = new Workbook();
            Worksheet worksheet = workbook.Worksheets[0];

            // 2ï¸âƒ£ Set up Japanese calendar culture
            CultureInfo japaneseCulture = new CultureInfo("ja-JP-u-ca-japanese");

            // 3ï¸âƒ£ Parse the eraâ€‘based date string
            string eraDate = "R3-04-01"; // Reiwa 3, April 1
            DateTime parsedDate = DateTime.ParseExact(
                eraDate,
                "gggy-MM-dd",
                japaneseCulture,
                DateTimeStyles.None);

            // 4ï¸âƒ£ Put the DateTime into cell A1
            worksheet.Cells["A1"].PutValue(parsedDate);

            // 5ï¸âƒ£ (Optional) Apply Japanese era number format
            Style style = worksheet.Cells["A1"].GetStyle();
            style.Custom = "[$-ja-JP]ggge'å¹´'M'æœˆ'd'æ—¥'";
            worksheet.Cells["A1"].SetStyle(style);

            // 6ï¸âƒ£ Save as XLSX
            string outputPath = @"C:\Temp\output.xlsx";
            workbook.Save(outputPath, SaveFormat.Xlsx);
            Console.WriteLine($"âœ… Workbook saved as XLSX at {outputPath}");
        }
        catch (Exception ex)
        {
            Console.Error.WriteLine($"âŒ Something went wrong: {ex.Message}");
        }
    }
}
```

**Expected Output** â€“ åŸ·è¡Œç¨‹å¼å¾Œï¼Œä¸»æ§å°æœƒå°å‡ºæˆåŠŸè¨Šæ¯ï¼Œé–‹å•Ÿ `output.xlsx` å‰‡æœƒæ­£ç¢ºé¡¯ç¤ºæ—¥æœŸã€‚

---

## å¸¸è¦‹å•é¡Œèˆ‡é‚Šç·£æ¡ˆä¾‹

| Question | Answer |
|----------|--------|
| **Can I use a different calendar (e.g., Thai Buddhist)?** | å¯ä»¥ã€‚åªè¦å°‡æ–‡åŒ–å­—ä¸²æ”¹ç‚º `new CultureInfo("th-TH-u-ca-buddhist")`ï¼Œä¸¦ç›¸æ‡‰èª¿æ•´æ ¼å¼æ¨£å¼å³å¯ã€‚ |
| **What if the input string is malformed?** | `ParseExact` æœƒæ‹‹å‡º `FormatException`ã€‚å¦‚ç¯„ä¾‹æ‰€ç¤ºï¼Œå°‡å‘¼å«åŒ…åœ¨ `try/catch` ä¸­ï¼Œä¸¦è¨˜éŒ„å‡ºéŒ¯çš„å€¼ã€‚ |
| **Do I need to set the workbookâ€™s locale?** | ä¸ä¸€å®šã€‚Aspose.Cells æœƒéµå¾ªä½ ç”¨ä¾†è§£æçš„ `CultureInfo`ï¼Œä½†è‹¥æƒ³å½±éŸ¿å…§å»ºå‡½å¼ï¼ˆå¦‚ `NOW()`ï¼‰ï¼Œå¯è¨­å®š `workbook.Settings.CultureInfo = japaneseCulture`ã€‚ |
| **How do I write multiple dates?** | è¿­ä»£ä½ çš„è³‡æ–™é›†åˆï¼Œä½¿ç”¨ `worksheet.Cells[row, col].PutValue(dateValue)`ã€‚ç›¸åŒçš„æ¨£å¼å¯é‡è¤‡å¥—ç”¨æ–¼æ‰€æœ‰å„²å­˜æ ¼ã€‚ |
| **Is the generated XLSX compatible with older Excel versions?** | ä½¿ç”¨ `SaveFormat.Xlsx` ç”¢ç”Ÿçš„æ˜¯ Office Open XML æ ¼å¼ï¼ˆExcelâ€¯2007 ä»¥ä¸Šï¼‰ã€‚è‹¥éœ€ç›¸å®¹èˆŠç‰ˆï¼Œå¯æ”¹ç”¨ `SaveFormat.Xls`ã€‚ |

---

## é¡å¤–æç¤ºï¼šæ‰“é€ ç©©å¥çš„ Excel è‡ªå‹•åŒ–

- **Reuse Styles**ï¼šç‚ºæ¯å€‹å„²å­˜æ ¼å»ºç«‹æ–° `Style` æœƒå¾ˆè€—è²»è³‡æºã€‚å»ºè­°å…ˆå»ºç«‹å¯é‡è¤‡ä½¿ç”¨çš„æ¨£å¼ç‰©ä»¶ï¼Œå†åœ¨éœ€è¦çš„åœ°æ–¹æŒ‡æ´¾ã€‚  
- **Memory Management**ï¼šå°æ–¼å·¨é‡å·¥ä½œè¡¨ï¼Œè«‹åœ¨å…¨éƒ¨è³‡æ–™å¯«å…¥å®Œç•¢å¾Œæ‰å‘¼å« `workbook.CalculateFormula()`ï¼Œä»¥é¿å…ä¸å¿…è¦çš„é‡æ–°è¨ˆç®—ã€‚  
- **Thread Safety**ï¼šAspose.Cells ç‰©ä»¶æœ¬èº«ä¸æ˜¯åŸ·è¡Œç·’å®‰å…¨çš„ã€‚å¦‚æœéœ€è¦å¹³è¡Œç”¢ç”Ÿå¤šæœ¬å·¥ä½œç°¿ï¼Œè«‹ç‚ºæ¯å€‹åŸ·è¡Œç·’å»ºç«‹ç¨ç«‹çš„ `Workbook` å¯¦ä¾‹ã€‚  
- **License Reminder**ï¼šå…è²»è©•ä¼°ç‰ˆæœƒåœ¨æª”æ¡ˆä¸ŠåŠ ä¸Šæµ®æ°´å°ã€‚è‹¥è¦æŠ•å…¥æ­£å¼ç’°å¢ƒï¼Œè«‹è³¼è²·æˆæ¬Šæˆ–ä½¿ç”¨è‡¨æ™‚æˆæ¬Šç¢¼ã€‚

---

## çµè«–

æˆ‘å€‘å·²å®Œæ•´ç¤ºç¯„ **create Excel workbook C#** çš„æƒ…å¢ƒï¼šåˆå§‹åŒ–å·¥ä½œç°¿ã€è™•ç†æ—¥æœ¬å…ƒè™Ÿæ—¥æœŸã€å°‡ `DateTime` å¯«å…¥å„²å­˜æ ¼ã€ï¼ˆå¯é¸ï¼‰å¥—ç”¨æ¨£å¼ï¼Œæœ€å¾Œ **save workbook as xlsx**ã€‚åªè¦äº†è§£ `CultureInfo` èˆ‡ `ParseExact` çš„è§’è‰²ï¼Œå³å¯å°‡æ­¤æ¨¡å¼å¥—ç”¨åˆ°ä»»ä½•èªç³»æˆ–è‡ªè¨‚æ—¥æœŸæ ¼å¼ï¼Œè®“ä½ çš„ Excel è‡ªå‹•åŒ–æ—¢èƒ½ **write date to Excel** åˆèƒ½ **save Excel file C#**ï¼Œè®Šå¾—è¼•é¬†ç„¡ç—›ã€‚

æº–å‚™å¥½é€²ä¸€æ­¥äº†å—ï¼Ÿè©¦è‘—åŒ¯å‡ºæ•´å¼µè³‡æ–™è¡¨ã€åŠ å…¥å…¬å¼æˆ–ç”¢ç”Ÿåœ–è¡¨â€”â€”å…¨éƒ¨éƒ½å¯ä»¥ä½¿ç”¨ç›¸åŒçš„ Aspose.Cells APIã€‚è‹¥é‡åˆ°å¥‡æ€ªçš„è¡Œç‚ºï¼ŒAspose ç¤¾ç¾¤ç›¸ç•¶æ´»èºï¼Œå®˜æ–¹æ–‡ä»¶ä¹Ÿæä¾›æ›´æ·±å…¥çš„æ¨£å¼ã€æ¨ç´åˆ†æè¡¨ç­‰èªªæ˜ã€‚

ç¥ç¨‹å¼é–‹ç™¼é †åˆ©ï¼Œé¡˜ä½ çš„è©¦ç®—è¡¨æ°¸é ä¸æœƒå‡ºç¾ã€ŒWe found a problemã€çš„è­¦å‘Šï¼ ğŸš€

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}