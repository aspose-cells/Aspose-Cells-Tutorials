---
category: general
date: 2026-02-15
description: å»ºç«‹ Excel å·¥ä½œç°¿ C# æ•™å­¸ï¼Œç¤ºç¯„å¦‚ä½•æ–°å¢è‡ªè¨‚å±¬æ€§ã€å°‡å·¥ä½œç°¿å„²å­˜ç‚º XLSBï¼Œä¸¦å–å¾—å±¬æ€§å€¼â€”â€”åªéœ€å¹¾è¡Œç¨‹å¼ç¢¼ã€‚
draft: false
keywords:
- create excel workbook c#
- save workbook as xlsb
- retrieve custom property value
- add custom property excel
language: zh-hant
og_description: é€æ­¥ä½¿ç”¨ C# å»ºç«‹ Excel å·¥ä½œç°¿ã€‚å­¸ç¿’å¦‚ä½•åŠ å…¥è‡ªè¨‚å±¬æ€§ã€å°‡å·¥ä½œç°¿å„²å­˜ç‚º XLSBï¼Œä¸¦é€éæ¸…æ™°çš„ç¨‹å¼ç¢¼ç¯„ä¾‹å–å¾—å±¬æ€§å€¼ã€‚
og_title: ä½¿ç”¨ C# å»ºç«‹ Excel æ´»é ç°¿ â€“ æ–°å¢è‡ªè¨‚å±¬æ€§ä¸¦å„²å­˜ç‚º XLSB
tags:
- Aspose.Cells
- C#
- Excel Automation
title: ä½¿ç”¨ C# å»ºç«‹ Excel æ´»é ç°¿ â€“ æ–°å¢è‡ªè¨‚å±¬æ€§ä¸¦å„²å­˜ç‚º XLSB
url: /zh-hant/net/document-properties/create-excel-workbook-c-add-custom-property-save-xlsb/
---

but can keep English punctuation.

Now produce final answer.{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# å»ºç«‹ Excel å·¥ä½œç°¿ C# â€“ æ–°å¢è‡ªè¨‚å±¬æ€§ä¸¦å„²å­˜ç‚º XLSB

éœ€è¦ **create Excel workbook C#** ä¸¦åµŒå…¥ä¸€äº›è‡ªè¨‚ä¸­ç¹¼è³‡æ–™å—ï¼Ÿåœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘å€‘å°‡é€æ­¥èªªæ˜å¦‚ä½•æ–°å¢è‡ªè¨‚å±¬æ€§ã€**å°‡å·¥ä½œç°¿å„²å­˜ç‚º XLSB**ï¼Œä»¥åŠç¨å¾Œ **å–å¾—è‡ªè¨‚å±¬æ€§å€¼**â€”â€”å…¨éƒ¨ä»¥ç°¡æ½”ã€å¯ç›´æ¥åŸ·è¡Œçš„ç¨‹å¼ç¢¼ç¤ºç¯„ã€‚

å¦‚æœä½ æ›¾å¥½å¥‡ç‚ºä»€éº¼é›»å­è¡¨æ ¼æœƒéœ€è¦åœ¨å„²å­˜æ ¼ä¹‹å¤–çš„é¡å¤–è³‡æ–™ï¼Œä½ ä¾†å°åœ°æ–¹äº†ã€‚æŠŠè‡ªè¨‚å±¬æ€§æƒ³åƒæˆéš±è—çš„å‚™è¨»ï¼Œæœƒéš¨æª”æ¡ˆä¸€èµ·å‚³éï¼Œéå¸¸é©åˆå°‡å·¥ä½œç°¿èˆ‡å°ˆæ¡ˆ IDã€ç‰ˆæœ¬æ¨™ç±¤æˆ–ä»»ä½•æ¥­å‹™éµçµåˆã€‚

## ä½ å°‡å­¸æœƒ

- å¦‚ä½•ä½¿ç”¨ Aspose.Cells for .NET ç”¢ç”Ÿæ–°çš„å·¥ä½œç°¿ã€‚  
- ä½¿ç”¨ `CustomProperties` é›†åˆ **ä»¥ Excel æ–¹å¼æ–°å¢è‡ªè¨‚å±¬æ€§** çš„å®Œæ•´æ­¥é©Ÿã€‚  
- ä»¥ç·Šæ¹Šçš„äºŒé€²ä½ XLSB æ ¼å¼å„²å­˜å·¥ä½œç°¿ã€‚  
- å†æ¬¡è¼‰å…¥æª”æ¡ˆä¸¦å–å›å…ˆå‰å„²å­˜çš„å±¬æ€§å€¼ã€‚  

ä¸éœ€è¦å¤–éƒ¨è¨­å®šæª”ï¼Œä¹Ÿä¸éœ€è¦éš±æ™¦çš„æŠ€å·§â€”â€”åªè¦æŠŠä¸‹é¢çš„ C# ç¨‹å¼ç¢¼è²¼åˆ° Console æ‡‰ç”¨ç¨‹å¼ä¸­å³å¯åŸ·è¡Œã€‚å”¯ä¸€çš„å‰ç½®æ¢ä»¶æ˜¯åƒè€ƒ Aspose.Cells å‡½å¼åº«ï¼ˆå…è²»è©¦ç”¨ç‰ˆæˆ–æ­£å¼æˆæ¬Šç‰ˆï¼‰ã€‚

ç‚ºä»€éº¼è¦åœ¨æª”æ¡ˆå…§åµŒå…¥ IDï¼Ÿå› ç‚ºé€™æ¨£åœ¨ä¹‹å¾Œé–‹å•Ÿå·¥ä½œç°¿æ™‚ï¼Œå°±ä¸å¿…å†é¡å¤–æŸ¥è©¢è³‡æ–™åº«ã€‚é€™å€‹å°ç¿’æ…£åœ¨å¤§å‹å ±è¡¨è§£æ±ºæ–¹æ¡ˆä¸­å¯ä»¥çœä¸‹æ•¸å°æ™‚çš„é™¤éŒ¯æ™‚é–“ã€‚

---

![å»ºç«‹ Excel å·¥ä½œç°¿ C# ç¯„ä¾‹](https://example.com/images/create-excel-workbook-csharp.png "å»ºç«‹ Excel å·¥ä½œç°¿ C# ç¯„ä¾‹")

*åœ–ç‰‡é¡¯ç¤ºä¸€å€‹æœ€å°çš„ C# Console å°ˆæ¡ˆï¼Œæœƒå»ºç«‹ Excel å·¥ä½œç°¿ã€åŠ å…¥è‡ªè¨‚å±¬æ€§ï¼Œä¸¦å„²å­˜ç‚º XLSBã€‚*

## æ­¥é©Ÿ 1ï¼šåˆå§‹åŒ–å·¥ä½œç°¿ä¸¦æ–°å¢è‡ªè¨‚å±¬æ€§

ç¬¬ä¸€ä»¶äº‹å°±æ˜¯å–å¾—ä¸€å€‹å…¨æ–°çš„ `Workbook` ç‰©ä»¶ã€‚å–å¾—ä¹‹å¾Œï¼Œ`Worksheets[0].CustomProperties` é›†åˆå°±æ˜¯å­˜æ”¾éµ/å€¼å°çš„å¥½åœ°æ–¹ã€‚

```csharp
using Aspose.Cells;

namespace ExcelCustomPropDemo
{
    class Program
    {
        static void Main(string[] args)
        {
            // Step 1 â€“ Create a new workbook instance
            Workbook workbook = new Workbook();

            // Step 2 â€“ Add a custom property named "ProjectId" with a numeric value
            // This is the "add custom property excel" part of the tutorial.
            workbook.Worksheets[0].CustomProperties.Add("ProjectId", 12345);
```

**ç‚ºä»€éº¼é€™å¾ˆé‡è¦ï¼š**  
- `Workbook()` æœƒåœ¨è¨˜æ†¶é«”ä¸­å»ºç«‹ Excel æª”æ¡ˆçš„è¡¨ç¤ºï¼Œå°šæœªé€²è¡Œç£ç¢Ÿ I/Oã€‚  
- å°‡å±¬æ€§åŠ å…¥ *ç¬¬ä¸€å€‹* å·¥ä½œè¡¨ï¼ˆç´¢å¼•â€¯0ï¼‰å¯ç¢ºä¿å®ƒä»¥å·¥ä½œç°¿å±¤ç´šå„²å­˜ï¼Œç„¡è«–ä½¿ç”¨è€…æª¢è¦–å“ªä¸€å¼µå·¥ä½œè¡¨éƒ½èƒ½å–å¾—ã€‚  

> **å°ˆæ¥­æç¤ºï¼š** è‡ªè¨‚å±¬æ€§å¯ä»¥æ˜¯å­—ä¸²ã€æ•¸å­—ã€æ—¥æœŸï¼Œç”šè‡³æ˜¯ Booleanã€‚è«‹ä¾ç…§ä½ è¦å„²å­˜çš„è³‡æ–™é¡å‹é¸æ“‡æœ€åˆé©çš„å‹åˆ¥ã€‚

## æ­¥é©Ÿ 2ï¼šå°‡å·¥ä½œç°¿å„²å­˜ç‚º XLSB

XLSBï¼ˆExcel Binary Workbookï¼‰æ˜¯ä¸€ç¨®ç·Šæ¹Šä¸”è¼‰å…¥å¿«é€Ÿçš„æ ¼å¼â€”â€”éå¸¸é©åˆå¤§å‹è³‡æ–™é›†ã€‚`Save` æ–¹æ³•æ¥å—æª”æ¡ˆè·¯å¾‘èˆ‡ `SaveFormat` åˆ—èˆ‰ã€‚

```csharp
            // Step 3 â€“ Save the workbook to disk in XLSB format
            string outputPath = @"C:\Temp\CustomProp.xlsb";
            workbook.Save(outputPath, SaveFormat.Xlsb);

            // At this point the file on disk already contains the custom property.
```

**ç‚ºä»€éº¼ä½¿ç”¨ XLSBï¼Ÿ**  
- ç›¸è¼ƒæ–¼å‚³çµ±çš„ XLSXï¼Œå¯æ¸›å°‘é«˜é” 70â€¯% çš„æª”æ¡ˆå¤§å°ã€‚  
- äºŒé€²ä½å„²å­˜åŠ é€Ÿå¯«å…¥èˆ‡è®€å–ä½œæ¥­ï¼Œå°æ–¼ä¼ºæœå™¨ç«¯è‡ªå‹•åŒ–ç‰¹åˆ¥æœ‰å¹«åŠ©ã€‚

## æ­¥é©Ÿ 3ï¼šè¼‰å…¥å·²å„²å­˜çš„å·¥ä½œç°¿ä¸¦å–å¾—å±¬æ€§

ç¾åœ¨æ›å€‹è§’åº¦ï¼šé–‹å•Ÿå‰›æ‰å¯«å…¥çš„æª”æ¡ˆï¼Œå°‡éš±è—çš„å€¼å–å›ä¾†ã€‚é€™æ¨£å³å¯é©—è­‰å±¬æ€§åœ¨å¾€è¿”éç¨‹ä¸­ä»ç„¶å­˜åœ¨ã€‚

```csharp
            // Step 4 â€“ Load the workbook we just saved
            Workbook loadedWorkbook = new Workbook(outputPath);

            // Step 5 â€“ Retrieve the value of the "ProjectId" custom property
            object projectIdValue = loadedWorkbook.Worksheets[0]
                                                .CustomProperties["ProjectId"]
                                                .Value;

            // Display the retrieved value
            System.Console.WriteLine($"Retrieved ProjectId: {projectIdValue}");
        }
    }
}
```

**ä½ æ‡‰è©²æœƒçœ‹åˆ°ï¼š**  
```
Retrieved ProjectId: 12345
```

å¦‚æœå±¬æ€§åç¨±æ‹¼å¯«éŒ¯èª¤æˆ–ä¸å­˜åœ¨ï¼Œ`CustomProperties` ç´¢å¼•å­æœƒæ‹‹å‡º `KeyNotFoundException`ã€‚è¼ƒç‚ºé˜²ç¦¦çš„å¯«æ³•å¯ä»¥é€™æ¨£ï¼š

```csharp
if (loadedWorkbook.Worksheets[0].CustomProperties.Contains("ProjectId"))
{
    // safe to read
}
```

## å®Œæ•´ç¯„ä¾‹ï¼ˆçµåˆæ‰€æœ‰æ­¥é©Ÿï¼‰

ä»¥ä¸‹æ˜¯å®Œæ•´ç¨‹å¼ç¢¼ï¼Œç›´æ¥è¤‡è£½è²¼ä¸Šåˆ°æ–°çš„ Console å°ˆæ¡ˆå³å¯åŸ·è¡Œã€‚ç„¡éœ€é¡å¤–çš„è…³æ‰‹æ¶ã€‚

```csharp
using Aspose.Cells;
using System;

namespace ExcelCustomPropDemo
{
    class Program
    {
        static void Main(string[] args)
        {
            // 1ï¸âƒ£ Create a new workbook
            Workbook workbook = new Workbook();

            // 2ï¸âƒ£ Add a custom property named "ProjectId" (add custom property excel)
            workbook.Worksheets[0].CustomProperties.Add("ProjectId", 12345);

            // 3ï¸âƒ£ Save the workbook as XLSB (save workbook as xlsb)
            string filePath = @"C:\Temp\CustomProp.xlsb";
            workbook.Save(filePath, SaveFormat.Xlsb);

            // 4ï¸âƒ£ Load the saved workbook back into memory
            Workbook loaded = new Workbook(filePath);

            // 5ï¸âƒ£ Retrieve the custom property value (retrieve custom property value)
            object retrieved = loaded.Worksheets[0].CustomProperties["ProjectId"].Value;
            Console.WriteLine($"Retrieved ProjectId: {retrieved}");
        }
    }
}
```

åŸ·è¡Œç¨‹å¼å¾Œï¼Œæ–¼ Excel é–‹å•Ÿ `C:\Temp\CustomProp.xlsb`ï¼Œè¡¨é¢ä¸Šä¸æœƒçœ‹åˆ°ä»»ä½•ç•°å¸¸â€”â€”å› ç‚ºè‡ªè¨‚å±¬æ€§æœ¬èº«å°±æ˜¯è¨­è¨ˆç‚ºéš±è—çš„ã€‚ä½†è³‡æ–™ç¢ºå¯¦å­˜åœ¨ï¼Œå¯ä¾›ä»»ä½•ä¸‹æ¸¸ç¨‹åºä½¿ç”¨ã€‚

## é‚Šç·£æƒ…æ³èˆ‡è®ŠåŒ–

| æƒ…å¢ƒ | éœ€è¦èª¿æ•´çš„åœ°æ–¹ |
|-----------|----------------|
| **å¤šå·¥ä½œè¡¨** | å°‡å±¬æ€§åŠ å…¥ä»»æ„å·¥ä½œè¡¨ï¼›å®ƒæœƒåœ¨å·¥ä½œç°¿å±¤ç´šè‡ªå‹•è¤‡è£½ã€‚ |
| **å­—ä¸²å±¬æ€§** | `CustomProperties.Add("Status", "Approved")` â€“ æ–¹å¼ç›¸åŒã€‚ |
| **å±¬æ€§éºå¤±** | å…ˆä½¿ç”¨ `Contains` åˆ¤æ–·å†ç´¢å¼•ï¼Œä»¥é¿å…ä¾‹å¤–ã€‚ |
| **å¤§å‹æ•¸å€¼ ID** | å¯å­˜æˆ `long` æˆ– `string`ï¼Œé¿å…æº¢ä½ã€‚ |
| **è·¨å¹³å°** | Aspose.Cells æ”¯æ´ .NETâ€¯Coreã€.NETâ€¯Frameworkï¼Œç”šè‡³ Monoï¼Œæ–¼ Linux å®¹å™¨ä¸­äº¦å¯åŸ·è¡Œç›¸åŒç¨‹å¼ç¢¼ã€‚ |

## å¸¸è¦‹å•ç­”

**Q: é€™åœ¨å…è²»çš„ Aspose.Cells è©¦ç”¨ç‰ˆä¹Ÿèƒ½ä½¿ç”¨å—ï¼Ÿ**  
A: å¯ä»¥ã€‚è©¦ç”¨ç‰ˆå®Œæ•´æ”¯æ´ `CustomProperties` èˆ‡ XLSB å„²å­˜ï¼Œåªæ˜¯è¼¸å‡ºæª”æ¡ˆæœƒæœ‰æµ®æ°´å°ã€‚

**Q: æˆ‘å¯ä»¥åœ¨ Excel å…§çœ‹åˆ°è‡ªè¨‚å±¬æ€§å—ï¼Ÿ**  
A: åœ¨ Excel ä¸­ï¼Œå‰å¾€ *æª”æ¡ˆ â†’ è³‡è¨Š â†’ å±¬æ€§ â†’ é€²éšå±¬æ€§ â†’ è‡ªè¨‚*ï¼Œå³å¯çœ‹åˆ°ä½ çš„ â€œProjectIdâ€ã€‚

**Q: è‹¥è¦åˆªé™¤å±¬æ€§è©²æ€éº¼åšï¼Ÿ**  
A: åœ¨å„²å­˜å‰å‘¼å« `CustomProperties.Remove("ProjectId")` å³å¯ã€‚

## çµèª

ç¾åœ¨ä½ å·²æŒæ¡ **create Excel workbook C#**ã€åµŒå…¥è‡ªè¨‚å±¬æ€§ã€**å°‡å·¥ä½œç°¿å„²å­˜ç‚º XLSB**ï¼Œä»¥åŠç¨å¾Œ **å–å¾—è‡ªè¨‚å±¬æ€§å€¼** çš„å®Œæ•´æµç¨‹ã€‚æ•´å€‹æ­¥é©Ÿå¯æ¿ƒç¸®æˆå–®ä¸€æ–¹æ³•ï¼Œè¼•é¬†æ•´åˆåˆ°æ›´å¤§çš„å ±è¡¨ç®¡ç·šæˆ–æ–‡ä»¶ç”¢ç”Ÿæœå‹™ä¸­ã€‚

### æ¥ä¸‹ä¾†å¯ä»¥åšä»€éº¼ï¼Ÿ

- æ¢ç´¢ **æ–°å¢å¤šå€‹è‡ªè¨‚å±¬æ€§**ï¼Œç”¨æ–¼ç‰ˆæœ¬ã€ä½œè€…æˆ–éƒ¨é–€ä»£ç¢¼ã€‚  
- çµåˆ **å„²å­˜æ ¼å±¤ç´šè³‡æ–™**ï¼Œæ‰“é€ è‡ªæˆ‘æè¿°çš„å ±è¡¨ã€‚  
- ç ”ç©¶ **å¾æ—¢æœ‰ç¬¬ä¸‰æ–¹ XLSX æª”æ¡ˆè®€å–è‡ªè¨‚å±¬æ€§**â€”â€”Aspose.Cells ä¹Ÿèƒ½è™•ç†ã€‚

æ­¡è¿è‡ªè¡Œèª¿æ•´ç¯„ä¾‹ï¼Œå°‡æ•¸å€¼ ID æ›æˆ GUIDï¼Œæˆ–å˜—è©¦ä¸åŒçš„æª”æ¡ˆæ ¼å¼ã€‚API æœ¬èº«ç›¸ç•¶ç›´è§€ï¼ŒçœŸæ­£çš„å¨åŠ›ä¾†è‡ªæ–¼ä½ å¦‚ä½•åœ¨æ¥­å‹™é‚è¼¯ä¸­é‹ç”¨é€™äº›éš±è—çš„ä¸­ç¹¼è³‡æ–™ã€‚

ç¥ç·¨ç¨‹æ„‰å¿«ï¼ ğŸš€

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}