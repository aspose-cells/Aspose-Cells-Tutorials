---
category: general
date: 2026-02-23
description: ä½¿ç”¨ Aspose.Cells åœ¨ C# ä¸­åˆ›å»ºæ™ºèƒ½æ ‡è®°é›†åˆã€‚äº†è§£å¦‚ä½•æ·»åŠ æ ‡è®°ã€æ³¨é‡Šï¼Œå¹¶åœ¨å‡ æ­¥å†…å°†å®ƒä»¬åº”ç”¨åˆ°å·¥ä½œè¡¨ã€‚
draft: false
keywords:
- create smart marker collection
- smart markers
- marker collection
- Aspose.Cells
- worksheet smart markers
language: zh
og_description: ä½¿ç”¨ Aspose.Cells åœ¨ C# ä¸­åˆ›å»ºæ™ºèƒ½æ ‡è®°é›†åˆã€‚æœ¬æ•™ç¨‹å±•ç¤ºå¦‚ä½•æ·»åŠ æ ‡è®°ã€æ³¨é‡Šå¹¶å°†å…¶åº”ç”¨äºå·¥ä½œè¡¨ã€‚
og_title: åˆ›å»ºæ™ºèƒ½æ ‡è®°é›†åˆ â€“ å®Œæ•´ C# æŒ‡å—
tags:
- Aspose.Cells
- C#
- SmartMarkers
title: åˆ›å»ºæ™ºèƒ½æ ‡è®°é›†åˆ â€“ å®Œæ•´ C# æŒ‡å—
url: /zh/net/smart-markers-dynamic-data/create-smart-marker-collection-complete-c-guide/
---

ç•™è¨€ï¼Œæˆ–åˆ†äº«ä½ åœ¨é¡¹ç›®ä¸­å¦‚ä½•ä½¿ç”¨æ™ºèƒ½æ ‡è®°ã€‚ç¥ç¼–ç æ„‰å¿«ï¼"

Image markdown unchanged.

Then closing shortcodes.

Now ensure we keep all shortcodes and placeholders exactly.

Let's assemble final output.{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# åˆ›å»ºæ™ºèƒ½æ ‡è®°é›†åˆ â€“ å®Œæ•´ C# æŒ‡å—

æ˜¯å¦æ›¾ç»éœ€è¦åœ¨ç”µå­è¡¨æ ¼ä¸­**åˆ›å»ºæ™ºèƒ½æ ‡è®°é›†åˆ**ä½†ä¸çŸ¥ä»ä½•å…¥æ‰‹ï¼Ÿä½ å¹¶ä¸å­¤å•ï¼›è®¸å¤šå¼€å‘è€…åœ¨é¦–æ¬¡ä½¿ç”¨ Aspose.Cells çš„ SmartMarkers åŠŸèƒ½æ—¶éƒ½ä¼šé‡åˆ°åŒæ ·çš„éš¾é¢˜ã€‚å¥½æ¶ˆæ¯æ˜¯ï¼Ÿä¸€æ—¦äº†è§£äº†æ¨¡å¼ï¼Œè¿™å…¶å®ç›¸å½“ç®€å•ï¼Œæˆ‘å°†ä¸€æ­¥ä¸€æ­¥å¸¦ä½ å®Œæˆã€‚

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•åˆ›å»º `MarkerCollection`ã€å‘å…¶ä¸­æ·»åŠ æ•°æ®æ ‡è®°å’Œæ³¨é‡Šã€å°†å…¶é™„åŠ åˆ°å·¥ä½œè¡¨çš„ **SmartMarkers**ï¼Œä»¥åŠæœ€ç»ˆè°ƒç”¨ `Apply()` æ–¹æ³•ä½¿æ‰€æœ‰å†…å®¹æ­£ç¡®æ¸²æŸ“ã€‚æ— éœ€å¤–éƒ¨æ–‡æ¡£â€”â€”åªéœ€çº¯ç²¹å¯è¿è¡Œçš„ C# ä»£ç ä»¥åŠå¯¹æ¯è¡Œä»£ç èƒŒåâ€œä¸ºä»€ä¹ˆâ€çš„ç®€è¦è¯´æ˜ã€‚

## ä½ å°†æ”¶è·çš„å†…å®¹

- ä¸€ä¸ªå¯åœ¨å¤šä¸ªå·¥ä½œè¡¨ä¹‹é—´å¤ç”¨çš„å¯å·¥ä½œ **marker collection**ã€‚  
- å¯¹ **smart markers** å¦‚ä½•ä¸ Aspose.Cells å¯¹è±¡äº¤äº’çš„äº†è§£ã€‚  
- å¤„ç†é‡å¤é”®ã€æ€§èƒ½è€ƒè™‘ä»¥åŠå¸¸è§é™·é˜±çš„æŠ€å·§ã€‚  
- ä¸€ä¸ªå®Œæ•´çš„ã€å¯å¤åˆ¶ç²˜è´´çš„ç¤ºä¾‹ï¼Œèƒ½å¤Ÿç›´æ¥æ”¾å…¥å·²å¼•ç”¨ Aspose.Cells çš„ä»»ä½• .NET é¡¹ç›®ä¸­ã€‚

**å…ˆå†³æ¡ä»¶ï¼š**  
- å·²å®‰è£… Aspose.Cells for .NET çš„ .NETâ€¯6ï¼ˆæˆ–ä»»ä½•è¿‘æœŸçš„ .NET ç‰ˆæœ¬ï¼‰ã€‚  
- å¯¹ C# è¯­æ³•å’Œé¢å‘å¯¹è±¡æ¦‚å¿µæœ‰åŸºæœ¬äº†è§£ã€‚  
- ä¸€ä¸ªå·²æœ‰çš„ `Worksheet` å®ä¾‹ç”¨äºå¡«å……â€”â€”æˆ‘ä»¬å‡è®¾ä½ å·²ç»åŠ è½½æˆ–åˆ›å»ºäº†å·¥ä½œç°¿ã€‚

å¦‚æœä½ åœ¨æƒ³*ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ™ºèƒ½æ ‡è®°é›†åˆ*ï¼Œå¯ä»¥æŠŠå®ƒçœ‹ä½œä¸€ä¸ªè½»é‡çº§å­—å…¸ï¼Œç”¨äºåœ¨ä¸ç¡¬ç¼–ç å•å…ƒæ ¼åœ°å€çš„æƒ…å†µä¸‹é©±åŠ¨åŠ¨æ€å†…å®¹æ’å…¥ã€‚å®ƒåœ¨æ¨¡æ¿åŒ–æŠ¥è¡¨ã€é‚®ä»¶åˆå¹¶å¼å‘ç¥¨ï¼Œæˆ–ä»»ä½•éœ€è¦ç›¸åŒå¸ƒå±€å¡«å……ä¸åŒæ•°æ®é›†çš„åœºæ™¯ä¸­ç‰¹åˆ«å®ç”¨ã€‚

## æ­¥éª¤ 1ï¼šå¦‚ä½•åœ¨ C# ä¸­**åˆ›å»ºæ™ºèƒ½æ ‡è®°é›†åˆ**

é¦–å…ˆï¼Œä½ éœ€è¦ä¸€ä¸ªç©ºå®¹å™¨æ¥ä¿å­˜æ‰€æœ‰æ ‡è®°ã€‚Aspose.Cells æä¾›äº† `MarkerCollection` ç±»ä¸“é—¨ç”¨äºæ­¤ç›®çš„ã€‚

```csharp
// Step 1: Initialize a fresh MarkerCollection instance
MarkerCollection markerCollection = new MarkerCollection();
```

> **ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼š**  
> `MarkerCollection` åƒä¸€ä¸ªæ˜ å°„ï¼Œæ¯ä¸ªé”®å¯¹åº” Excel æ¨¡æ¿ä¸­çš„å ä½ç¬¦ã€‚æå‰åˆ›å»ºå®ƒå¯ä»¥è®©ä»£ç ä¿æŒæ•´æ´ï¼Œé¿å…åœ¨é€»è¾‘ä¸­åˆ°å¤„æ•£å¸ƒæ ‡è®°å®šä¹‰ã€‚

### ä¸“ä¸šæç¤º
å¦‚æœè®¡åˆ’åœ¨å¤šä¸ªå·¥ä½œè¡¨ä¹‹é—´å¤ç”¨åŒä¸€é›†åˆï¼Œè€ƒè™‘ä½¿ç”¨å…‹éš† (`markerCollection.Clone()`) è€Œä¸æ˜¯æ¯æ¬¡ä»å¤´é‡å»ºã€‚è¿™å¯ä»¥åœ¨å¤§æ‰¹é‡ä½œä¸šä¸­èŠ‚çœå‡ æ¯«ç§’çš„æ—¶é—´ã€‚

## æ­¥éª¤ 2ï¼šæ·»åŠ æ•°æ®æ ‡è®°å’Œæ³¨é‡Š

ç°åœ¨é›†åˆå·²ç»å­˜åœ¨ï¼Œä½ å¯ä»¥å¼€å§‹å‘å…¶ä¸­å¡«å……æ•°æ®æ ‡è®°ã€‚ä¸‹é¢çš„ç¤ºä¾‹æ·»åŠ äº†ä¸€ä¸ªç®€å•çš„å€¼æ ‡è®° (`A1`) å’Œä¸€ä¸ªæ³¨é‡Šæ ‡è®° (`A1.Comment`)ã€‚æ³¨é‡Šæ ‡è®°å±•ç¤ºäº† **smart markers** èƒ½å¤Ÿå¤„ç†è¯¸å¦‚å¤‡æ³¨æˆ–é¡µè„šç­‰è¾…åŠ©æ•°æ®ã€‚

```csharp
// Step 2: Add a data marker and an associated comment marker
markerCollection.Add("A1", "Value");                 // Replaces ${A1} in the template
markerCollection.Add("A1.Comment", "This is a comment"); // Replaces ${A1.Comment}
```

> **ä¸ºä»€ä¹ˆè¦æ·»åŠ æ³¨é‡Šï¼š**  
> åœ¨è®¸å¤šæŠ¥è¡¨åœºæ™¯ä¸­ï¼Œéœ€è¦åœ¨æ•°å€¼æ—è¾¹æ”¾ç½®å¯è¯»çš„å¤‡æ³¨ã€‚ä½¿ç”¨ `.Comment` åç¼€å¯ä»¥å°†æ•°æ®ä¸å…¶æ³¨é‡Šç´§å¯†è€¦åˆï¼Œä½¿æœ€ç»ˆçš„å·¥ä½œè¡¨æ›´æ˜“é˜…è¯»ã€‚

### è¾¹ç¼˜æƒ…å†µ
å¦‚æœä¸å°å¿ƒä¸¤æ¬¡æ·»åŠ ç›¸åŒçš„é”®ï¼Œåä¸€æ¬¡è°ƒç”¨ä¼šè¦†ç›–å‰ä¸€æ¬¡ã€‚ä¸ºé¿å…æ— å£°çš„æ•°æ®ä¸¢å¤±ï¼Œä½ å¯ä»¥å…ˆæ£€æŸ¥é”®æ˜¯å¦å·²å­˜åœ¨ï¼š

```csharp
if (!markerCollection.ContainsKey("A1"))
{
    markerCollection.Add("A1", "Value");
}
```

## æ­¥éª¤ 3ï¼šå°†é›†åˆé™„åŠ åˆ° **Worksheet SmartMarkers**

æ ‡è®°å®šä¹‰å¥½åï¼Œä¸‹ä¸€æ­¥æ˜¯å°†é›†åˆç»‘å®šåˆ°å·¥ä½œè¡¨çš„ `SmartMarkers` å±æ€§ã€‚è¿™å‘Šè¯‰ Aspose.Cells åœ¨å¤„ç†æ¨¡æ¿æ—¶å»å“ªé‡ŒæŸ¥æ‰¾ã€‚

```csharp
// Step 3: Link the collection to the worksheet's SmartMarkers collection
worksheet.SmartMarkers.Add(markerCollection);
```

> **ä¸ºä»€ä¹ˆè¿™æ ·æœ‰æ•ˆï¼š**  
> `worksheet.SmartMarkers` æœ¬èº«æ˜¯ä¸€ä¸ªé›†åˆï¼Œå¯ä»¥å®¹çº³å¤šä¸ª `MarkerCollection` å¯¹è±¡ã€‚æ·»åŠ ä½ çš„é›†åˆåï¼Œå¼•æ“å³å¯ç”¨æä¾›çš„å€¼æ›¿æ¢å·¥ä½œè¡¨ä¸­æ‰€æœ‰ `${...}` å ä½ç¬¦ã€‚

### å®ç”¨æŠ€å·§
ä½ å¯ä»¥å°†å¤šä¸ª `MarkerCollection` å¯¹è±¡é™„åŠ åˆ°åŒä¸€å·¥ä½œè¡¨â€”â€”å½“ä¸åŒæ¨¡å—ç”Ÿæˆä¸åŒæ•°æ®é›†ï¼ˆä¾‹å¦‚ï¼Œæ ‡é¢˜ä¸æ­£æ–‡ï¼‰æ—¶éå¸¸æœ‰ç”¨ã€‚å¼•æ“ä¼šæŒ‰æ·»åŠ é¡ºåºåˆå¹¶å®ƒä»¬ã€‚

## æ­¥éª¤ 4ï¼šåº”ç”¨ Smart Markers å¤„ç†å·¥ä½œè¡¨

æœ€åä¸€æ­¥æ˜¯è°ƒç”¨ `Apply()`ã€‚æ­¤æ–¹æ³•éå†å·¥ä½œè¡¨ï¼ŒæŸ¥æ‰¾æ¯ä¸ª `${key}` å ä½ç¬¦ï¼Œå¹¶ç”¨é›†åˆä¸­å¯¹åº”çš„å€¼æ›¿æ¢å®ƒã€‚

```csharp
// Step 4: Execute the smart marker processing
worksheet.SmartMarkers.Apply();
```

> **å†…éƒ¨å‘ç”Ÿäº†ä»€ä¹ˆï¼š**  
> Aspose.Cells è§£æå•å…ƒæ ¼å…¬å¼ï¼Œè¯†åˆ« `${}` æ ‡è®°ï¼Œåœ¨é™„åŠ çš„é›†åˆä¸­æŸ¥æ‰¾å¯¹åº”å€¼ï¼Œå¹¶å°†è§£æåçš„å€¼å†™å›å•å…ƒæ ¼â€”â€”å…¨éƒ¨åœ¨å†…å­˜ä¸­å®Œæˆã€‚é™¤éä½ æ˜¾å¼ä¿å­˜å·¥ä½œç°¿ï¼Œå¦åˆ™ä¸ä¼šè¿›è¡Œæ–‡ä»¶ I/Oã€‚

### æ€§èƒ½æç¤º
åœ¨æ·»åŠ å®Œæ‰€æœ‰æ ‡è®°åä¸€æ¬¡æ€§è°ƒç”¨ `Apply()` è¦æ¯”æ¯æ¬¡æ·»åŠ åéƒ½è°ƒç”¨æ•ˆç‡é«˜å¾—å¤šã€‚æ‰¹é‡å¤„ç†å¯ä»¥å‡å°‘å¯¹å·¥ä½œè¡¨çš„éå†æ¬¡æ•°ã€‚

## æ­¥éª¤ 5ï¼šéªŒè¯ç»“æœï¼ˆä½ åº”è¯¥çœ‹åˆ°çš„ï¼‰

è°ƒç”¨ `Apply()` åï¼Œå·¥ä½œè¡¨åº”åŒ…å«ä½ æ’å…¥çš„å­—é¢å€¼ã€‚å¦‚æœåœ¨ Excel ä¸­æ‰“å¼€å·¥ä½œç°¿ï¼Œä½ ä¼šçœ‹åˆ°ï¼š

| A | B |
|---|---|
| Value | ï¼ˆç©ºï¼‰ |
| ï¼ˆç©ºï¼‰ | ï¼ˆç©ºï¼‰ |
| ï¼ˆç©ºï¼‰ | ï¼ˆç©ºï¼‰ |

å¹¶ä¸”é™„åŠ åœ¨ `A1` çš„æ³¨é‡Šä¼šä»¥å•å…ƒæ ¼æ‰¹æ³¨çš„å½¢å¼å‡ºç°ï¼ˆå³é”® â†’ *æ˜¾ç¤º/éšè—æ‰¹æ³¨*ï¼‰ã€‚

ä½ å¯ä»¥é€šè¿‡ä»£ç éªŒè¯ç»“æœï¼š

```csharp
// Optional: Verify that the cell now holds the expected value
string cellValue = worksheet.Cells["A1"].StringValue;
Console.WriteLine($"A1 = {cellValue}"); // Should output: A1 = Value

// Verify the comment
var comment = worksheet.Cells["A1"].GetComment();
Console.WriteLine($"Comment = {comment?.Note}"); // Should output: Comment = This is a comment
```

å¦‚æœè¾“å‡ºåŒ¹é…ï¼Œæ­å–œä½ â€”â€”ä½ å·²ç»æˆåŠŸ**åˆ›å»ºæ™ºèƒ½æ ‡è®°é›†åˆ**å¹¶å°†å…¶åº”ç”¨åˆ°å·¥ä½œè¡¨ï¼

## å¸¸è§é™·é˜±åŠé¿å…æ–¹æ³•

| ç—‡çŠ¶ | å¯èƒ½åŸå›  | è§£å†³åŠæ³• |
|------|----------|----------|
| `${A1}` æœªè¢«æ›´æ”¹ | æœªæ·»åŠ æ ‡è®°æˆ–æœªé™„åŠ é›†åˆ | å†æ¬¡æ£€æŸ¥ `markerCollection.Add("A1", ...)` å’Œ `worksheet.SmartMarkers.Add(markerCollection)` |
| æ³¨é‡Šæœªæ˜¾ç¤º | ä½¿ç”¨äº†é”™è¯¯çš„é”®åç¼€æˆ–æœªè°ƒç”¨ `GetComment()` | ä½¿ç”¨é”® `"A1.Comment"` å¹¶ç¡®ä¿å•å…ƒæ ¼æ‹¥æœ‰æ‰¹æ³¨å¯¹è±¡ |
| å€¼é‡å¤ | åŒä¸€é”®å¤šæ¬¡æ·»åŠ ä¸”éæœ‰æ„ | ä½¿ç”¨ `ContainsKey` æ£€æŸ¥æˆ–é‡å‘½åé”®ï¼ˆä¾‹å¦‚ `A1_1`ã€`A1_2`ï¼‰ |
| å¤§è¡¨æ€§èƒ½ä¸‹é™ | åœ¨å¾ªç¯ä¸­è°ƒç”¨ `Apply()` | å…ˆæ‰¹é‡æ·»åŠ æ‰€æœ‰æ ‡è®°ï¼Œç„¶åä¸€æ¬¡æ€§è°ƒç”¨ `Apply()` |

## å®Œæ•´å·¥ä½œç¤ºä¾‹

ä¸‹é¢æ˜¯ä¸€ä¸ªå¯è‡ªè¡Œç¼–è¯‘è¿è¡Œçš„å®Œæ•´ç¨‹åºã€‚å®ƒåˆ›å»ºå·¥ä½œç°¿ï¼Œæ·»åŠ å¸¦å ä½ç¬¦çš„æ¨¡æ¿å•å…ƒæ ¼ï¼Œæ„å»ºæ™ºèƒ½æ ‡è®°é›†åˆï¼Œåº”ç”¨å®ƒï¼Œæœ€åå°†æ–‡ä»¶ä¿å­˜ä¸º `Result.xlsx`ã€‚

```csharp
using System;
using Aspose.Cells;

class SmartMarkerDemo
{
    static void Main()
    {
        // 1ï¸âƒ£ Create a new workbook and get the first worksheet
        Workbook workbook = new Workbook();
        Worksheet worksheet = workbook.Worksheets[0];

        // Insert placeholders into the sheet (this mimics a template)
        worksheet.Cells["A1"].PutValue("${A1}");
        worksheet.Cells["A2"].PutValue("${A1.Comment}");

        // 2ï¸âƒ£ Create the marker collection
        MarkerCollection markerCollection = new MarkerCollection();

        // 3ï¸âƒ£ Add data and a comment marker
        markerCollection.Add("A1", "Value");
        markerCollection.Add("A1.Comment", "This is a comment");

        // 4ï¸âƒ£ Attach the collection to the worksheet's SmartMarkers
        worksheet.SmartMarkers.Add(markerCollection);

        // 5ï¸âƒ£ Apply the markers
        worksheet.SmartMarkers.Apply();

        // 6ï¸âƒ£ Optional verification
        Console.WriteLine($"A1 = {worksheet.Cells["A1"].StringValue}");
        var comment = worksheet.Cells["A1"].GetComment();
        Console.WriteLine($"Comment = {comment?.Note}");

        // 7ï¸âƒ£ Save the workbook
        workbook.Save("Result.xlsx");
        Console.WriteLine("Workbook saved as Result.xlsx");
    }
}
```

**é¢„æœŸçš„æ§åˆ¶å°è¾“å‡º**

```
A1 = Value
Comment = This is a comment
Workbook saved as Result.xlsx
```

æ‰“å¼€ `Result.xlsx`ï¼Œä½ ä¼šçœ‹åˆ°å•å…ƒæ ¼ A1 ä¸­çš„å­—é¢å€¼ â€œValueâ€ï¼Œä»¥åŠé™„åŠ åœ¨åŒä¸€å•å…ƒæ ¼çš„æ‰¹æ³¨ã€‚

## ğŸ‰ æ€»ç»“

ç°åœ¨ä½ å·²ç»æŒæ¡äº†å¦‚ä½•ä½¿ç”¨ Aspose.Cells åœ¨ C# ä¸­**åˆ›å»ºæ™ºèƒ½æ ‡è®°é›†åˆ**ï¼Œæ·»åŠ æ•°æ®å’Œæ³¨é‡Šæ ‡è®°ï¼Œå°†å…¶ç»‘å®šåˆ°å·¥ä½œè¡¨ï¼Œå¹¶è°ƒç”¨ `Apply()` æ–¹æ³•ä½¿æ›´æ”¹ç”Ÿæ•ˆã€‚è¯¥æ¨¡å¼æ˜“äºæ‰©å±•ï¼šåªéœ€æŒ‰éœ€å‘é›†åˆä¸­å¡«å……é”®ï¼Œé™„åŠ ä¸€æ¬¡ï¼Œå³å¯è®©å¼•æ“å®Œæˆç¹é‡çš„å·¥ä½œã€‚

**æ¥ä¸‹æ¥åšä»€ä¹ˆï¼Ÿ**  
- å°è¯•ä½¿ç”¨åµŒå¥—é›†åˆå¤„ç†å±‚æ¬¡åŒ–æ•°æ®ï¼ˆä¾‹å¦‚ä¸»ä»æŠ¥è¡¨ï¼‰ã€‚  
- å°†æ™ºèƒ½æ ‡è®°ä¸ **Aspose.Cells** å›¾è¡¨ç”Ÿæˆç»“åˆï¼Œå®ç°åŠ¨æ€ä»ªè¡¨ç›˜ã€‚  
- æ¢ç´¢ `MarkerCollection.Clone()` æ–¹æ³•ï¼Œä»¥åœ¨å¤šä¸ªå·¥ä½œç°¿ä¹‹é—´å¤ç”¨æ¨¡æ¿ï¼Œè€Œæ— éœ€æ¯æ¬¡é‡æ–°æ„å»ºæ ‡è®°ã€‚

å¦‚æœé‡åˆ°ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿ç•™è¨€ï¼Œæˆ–åˆ†äº«ä½ åœ¨é¡¹ç›®ä¸­å¦‚ä½•ä½¿ç”¨æ™ºèƒ½æ ‡è®°ã€‚ç¥ç¼–ç æ„‰å¿«ï¼

![Diagram showing how to create smart marker collection in Aspose.Cells](https://example.com/images/smart-marker-collection-diagram.png "Create smart marker collection diagram")

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}