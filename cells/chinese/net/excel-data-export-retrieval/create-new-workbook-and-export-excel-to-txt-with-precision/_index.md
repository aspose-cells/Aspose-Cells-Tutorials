---
category: general
date: 2026-02-15
description: åˆ›å»ºæ–°å·¥ä½œç°¿å¹¶åœ¨è®¾ç½®æ•°å€¼ç²¾åº¦çš„åŒæ—¶å°† Excel å¯¼å‡ºä¸º TXTã€‚å­¦ä¹ åœ¨ C# ä¸­è®¾ç½®æœ‰æ•ˆæ•°å­—å¹¶é™åˆ¶æœ‰æ•ˆæ•°å­—ã€‚
draft: false
keywords:
- create new workbook
- export excel to txt
- set significant digits
- limit significant digits
- set numeric precision
language: zh
og_description: åˆ›å»ºæ–°å·¥ä½œç°¿å¹¶å°† Excel å¯¼å‡ºä¸º TXTï¼Œè®¾ç½®æ•°å€¼ç²¾åº¦çš„æœ‰æ•ˆæ•°å­—ã€‚ä¸€æ­¥æ­¥çš„ C# æŒ‡å—ã€‚
og_title: åˆ›å»ºæ–°å·¥ä½œç°¿ â€“ ç²¾å‡†å¯¼å‡º Excel ä¸º TXT
tags:
- C#
- Aspose.Cells
- Excel automation
title: åˆ›å»ºæ–°å·¥ä½œç°¿å¹¶ç²¾ç¡®å¯¼å‡º Excel ä¸º TXT
url: /zh/net/excel-data-export-retrieval/create-new-workbook-and-export-excel-to-txt-with-precision/
---

them as is.

Also the block shortcodes at top and bottom remain unchanged.

Proceed.

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# åˆ›å»ºæ–°å·¥ä½œç°¿ â€“ å°† Excel å¯¼å‡ºä¸º TXT å¹¶ç²¾ç¡®æ§åˆ¶æ•°å­—æ ¼å¼

æ˜¯å¦æ›¾æƒ³è¿‡å¦‚ä½•åœ¨ C# ä¸­ **åˆ›å»ºæ–°å·¥ä½œç°¿** å¯¹è±¡å¹¶ç«‹å³å°†å…¶è½¬å­˜ä¸ºçº¯æ–‡æœ¬æ–‡ä»¶ï¼Ÿä½ å¹¶ä¸æ˜¯å”¯ä¸€æœ‰æ­¤éœ€æ±‚çš„äººã€‚åœ¨è®¸å¤šæ•°æ®ç®¡é“åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ **å¯¼å‡º Excel ä¸º TXT**ï¼ŒåŒæ—¶ä¿æŒæ•°å­—å¯è¯»ï¼Œè¿™æ„å‘³ç€è¦é™åˆ¶å°æ•°ç‚¹åå‡ºç°çš„ä½æ•°ã€‚

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å®Œæ•´æ¼”ç¤ºæ•´ä¸ªè¿‡ç¨‹ï¼šä»åˆ›å»ºå…¨æ–°çš„å·¥ä½œç°¿ã€é…ç½®å¯¼å‡ºä»¥ **è®¾ç½®æœ‰æ•ˆæ•°å­—**ï¼ˆå³é™åˆ¶æœ‰æ•ˆæ•°å­—ï¼‰ï¼Œåˆ°æœ€ç»ˆå°†æ–‡ä»¶å†™å…¥ç£ç›˜ã€‚å®Œæˆåï¼Œä½ å°†æ‹¥æœ‰ä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„ä»£ç ç‰‡æ®µï¼Œæ»¡è¶³ä½ çš„ **æ•°å€¼ç²¾åº¦** è¦æ±‚â€”â€”æ— éœ€é¢å¤–åº“ï¼Œä¹Ÿä¸éœ€è¦é­”æ³•ã€‚

> **ä¸“ä¸šæç¤ºï¼š** å¦‚æœä½ å·²ç»åœ¨ä½¿ç”¨ Aspose.Cellsï¼Œä¸‹é¢å±•ç¤ºçš„ç±»éƒ½æ˜¯è¯¥åº“çš„ä¸€éƒ¨åˆ†ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯å…¶ä»–å¹³å°ï¼Œæ¦‚å¿µä»ç„¶é€‚ç”¨ï¼Œåªéœ€æ›¿æ¢ç›¸åº”çš„ API è°ƒç”¨å³å¯ã€‚

---

## ä½ éœ€è¦å‡†å¤‡çš„å†…å®¹

- .NETâ€¯6+ï¼ˆä»£ç åœ¨ .NETâ€¯Core å’Œ .NETâ€¯Framework ä¸Šå‡å¯ç¼–è¯‘ï¼‰  
- Aspose.Cells for .NETï¼ˆå…è´¹è¯•ç”¨ç‰ˆæˆ–æˆæƒç‰ˆï¼‰â€“ é€šè¿‡ NuGet å®‰è£…ï¼š`dotnet add package Aspose.Cells`  
- ä»»æ„ä½ å–œæ¬¢çš„ IDEï¼ˆVisualÂ Studioã€Riderã€VSâ€¯Codeï¼‰  

å°±è¿™äº›ã€‚æ— éœ€é¢å¤–çš„é…ç½®æ–‡ä»¶ï¼Œä¹Ÿæ²¡æœ‰éšè—çš„æ­¥éª¤ã€‚

---

## ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ–°å·¥ä½œç°¿

é¦–å…ˆè¦ **åˆ›å»ºæ–°å·¥ä½œç°¿**ã€‚æŠŠ `Workbook` ç±»æƒ³è±¡æˆä¸€ä¸ªç©ºçš„ Excel æ–‡ä»¶ï¼Œç­‰å¾…ä½ æ·»åŠ å·¥ä½œè¡¨ã€å•å…ƒæ ¼å’Œæ•°æ®ã€‚

```csharp
using Aspose.Cells;

class Program
{
    static void Main()
    {
        // Step 1: Instantiate a fresh workbook â€“ this is the core of create new workbook logic
        Workbook workbook = new Workbook();

        // (Optional) Add some sample data so you can see the effect of numeric precision later
        Worksheet sheet = workbook.Worksheets[0];
        sheet.Cells["A1"].PutValue(12345.678901);
        sheet.Cells["A2"].PutValue(0.000123456);
        sheet.Cells["A3"].PutValue(Math.PI);
```

> **ä¸ºä½•é‡è¦ï¼š** ä»ä¸€ä¸ªå¹²å‡€çš„å·¥ä½œç°¿å¼€å§‹ï¼Œå¯ä»¥é¿å…åç»­å¯èƒ½å½±å“ç²¾åº¦è®¾ç½®çš„éšè—æ ¼å¼ã€‚

---

## ç¬¬äºŒæ­¥ï¼šé…ç½®æ–‡æœ¬ä¿å­˜é€‰é¡¹ â€“ è®¾ç½®æœ‰æ•ˆæ•°å­—

æ¥ä¸‹æ¥å‘Šè¯‰ Aspose.Cells åœ¨å†™å…¥ `.txt` æ–‡ä»¶æ—¶å¸Œæœ›ä¿ç•™å¤šå°‘ **æœ‰æ•ˆæ•°å­—**ã€‚`TxtSaveOptions` ç±»æä¾›äº† `SignificantDigits` å±æ€§ï¼Œæ­£æ˜¯ç”¨æ¥å®Œæˆæ­¤æ“ä½œçš„ã€‚

```csharp
        // Step 2: Prepare save options â€“ limit numeric precision to 5 significant digits
        TxtSaveOptions txtOptions = new TxtSaveOptions
        {
            // This limits the output to 5 digits that matter, rounding the rest
            SignificantDigits = 5
        };
```

> **è§£é‡Šï¼š** `SignificantDigits = 5` è¡¨ç¤ºå¯¼å‡ºå™¨ä¼šä¿ç•™æ¯ä¸ªæ•°å­—æœ€é‡è¦çš„äº”ä½ï¼Œæ— è®ºå°æ•°ç‚¹ä½äºä½•å¤„ã€‚è¿™æ˜¯ä¸€ç§åœ¨ä¸æ‰‹åŠ¨æ ¼å¼åŒ–æ¯ä¸ªå•å…ƒæ ¼çš„æƒ…å†µä¸‹ **è®¾ç½®æ•°å€¼ç²¾åº¦** çš„ä¾¿æ·æ–¹å¼ã€‚

---

## ç¬¬ä¸‰æ­¥ï¼šå°†å·¥ä½œç°¿ä¿å­˜ä¸ºçº¯æ–‡æœ¬æ–‡ä»¶

å½“å·¥ä½œç°¿å’Œé€‰é¡¹éƒ½å‡†å¤‡å¥½åï¼Œæˆ‘ä»¬ç»ˆäº **å¯¼å‡º Excel ä¸º txt**ã€‚`Save` æ–¹æ³•æ¥å—æ–‡ä»¶è·¯å¾„å’Œæˆ‘ä»¬åˆšé…ç½®çš„é€‰é¡¹å¯¹è±¡ã€‚

```csharp
        // Step 3: Write the workbook out as a TXT file using our precision settings
        string outputPath = @"C:\Temp\numbers.txt";
        workbook.Save(outputPath, txtOptions);

        System.Console.WriteLine($"Workbook exported to {outputPath} with 5 significant digits.");
    }
}
```

è¿è¡Œç¨‹åºåä¼šç”Ÿæˆå¦‚ä¸‹æ–‡ä»¶ï¼š

```
12346
0.00012346
3.1416
```

å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªæ•°å­—éƒ½éµå¾ªäº†æˆ‘ä»¬ä¹‹å‰è®¾ç½®çš„ **é™åˆ¶æœ‰æ•ˆæ•°å­—** è§„åˆ™ã€‚

---

## ç¬¬å››æ­¥ï¼šéªŒè¯ç»“æœï¼ˆå¯é€‰ä½†æ¨èï¼‰

å¯ä»¥ç›´æ¥åœ¨ä»»æ„ç¼–è¾‘å™¨ä¸­æ‰“å¼€ç”Ÿæˆçš„ `numbers.txt`ï¼Œä½†åœ¨ CI æµæ°´çº¿ä¸­ï¼Œä½ å¯èƒ½å¸Œæœ›è‡ªåŠ¨åŒ–éªŒè¯æ­¥éª¤ã€‚

```csharp
        // Quick verification â€“ read back the file and print each line
        foreach (var line in System.IO.File.ReadAllLines(outputPath))
        {
            System.Console.WriteLine($"Line: {line}");
        }
```

å¦‚æœæ§åˆ¶å°æ˜¾ç¤ºä¸Šé¢çš„ä¸‰è¡Œå†…å®¹ï¼Œè¯´æ˜ä½ å·²ç»æˆåŠŸ **è®¾ç½®æœ‰æ•ˆæ•°å­—**ï¼Œå¯¼å‡ºå·¥ä½œå¦‚é¢„æœŸè¿è¡Œã€‚

---

## å¸¸è§é™·é˜±åŠè§„é¿æ–¹æ³•

| é—®é¢˜ | äº§ç”ŸåŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|----------|----------|
| æ•°å­—å‡ºç°è¿‡å¤šå°æ•°ä½ | `SignificantDigits` ä¿æŒé»˜è®¤å€¼ (0) | æ˜ç¡®å°† `SignificantDigits` è®¾ç½®ä¸ºæ‰€éœ€çš„ä½æ•° |
| åˆ›å»ºäº†ç©ºæ–‡ä»¶ | ä¿å­˜å‰å·¥ä½œç°¿æœªå†™å…¥ä»»ä½•æ•°æ® | åœ¨è°ƒç”¨ `Save` ä¹‹å‰ **å…ˆå¡«å……å•å…ƒæ ¼** |
| æ–‡ä»¶è·¯å¾„æŠ›å‡º `UnauthorizedAccessException` | è¯•å›¾å†™å…¥å—ä¿æŠ¤çš„æ–‡ä»¶å¤¹ | ä½¿ç”¨æœ‰å†™å…¥æƒé™çš„æ–‡ä»¶å¤¹ï¼ˆä¾‹å¦‚ `C:\Temp` æˆ– `%USERPROFILE%\Documents`ï¼‰ |
| å¯¹æå°æ•°å­—çš„ç²¾åº¦ä¸ç¬¦åˆé¢„æœŸ | æœ‰æ•ˆæ•°å­—è®¡æ•°åŒ…æ‹¬å°æ•°ç‚¹åçš„å‰å¯¼é›¶ | è®°ä½â€œæœ‰æ•ˆæ•°å­—â€ä¼šå¿½ç•¥å‰å¯¼é›¶ï¼›ä¾‹å¦‚ 0.000123456 ä½¿ç”¨ 5 ä½ä¼šå˜ä¸º `0.00012346` |

---

## å®Œæ•´å¯è¿è¡Œç¤ºä¾‹ï¼ˆå¤åˆ¶ç²˜è´´å³ç”¨ï¼‰

ä¸‹é¢æ˜¯å®Œæ•´çš„ã€ç‹¬ç«‹çš„ç¨‹åºç¤ºä¾‹ã€‚å°†å…¶ç²˜è´´åˆ°æ–°çš„æ§åˆ¶å°é¡¹ç›®ä¸­å¹¶è¿è¡Œ **Run**ã€‚

```csharp
using Aspose.Cells;
using System;

class Program
{
    static void Main()
    {
        // 1ï¸âƒ£ Create a new workbook
        Workbook workbook = new Workbook();

        // Populate with sample numbers
        Worksheet sheet = workbook.Worksheets[0];
        sheet.Cells["A1"].PutValue(12345.678901);
        sheet.Cells["A2"].PutValue(0.000123456);
        sheet.Cells["A3"].PutValue(Math.PI);

        // 2ï¸âƒ£ Set up export options â€“ limit significant digits to 5
        TxtSaveOptions txtOptions = new TxtSaveOptions
        {
            SignificantDigits = 5
        };

        // 3ï¸âƒ£ Export to TXT
        string outputPath = @"C:\Temp\numbers.txt";
        workbook.Save(outputPath, txtOptions);

        Console.WriteLine($"âœ… Export completed: {outputPath}");
        Console.WriteLine("ğŸ” Verifying content:");
        foreach (var line in System.IO.File.ReadAllLines(outputPath))
        {
            Console.WriteLine($"   {line}");
        }
    }
}
```

**é¢„æœŸçš„æ§åˆ¶å°è¾“å‡º**

```
âœ… Export completed: C:\Temp\numbers.txt
ğŸ” Verifying content:
   12346
   0.00012346
   3.1416
```

`numbers.txt` æ–‡ä»¶å°†åŒ…å«ä¸Šé¢å±•ç¤ºçš„ä¸‰è¡Œå†…å®¹ã€‚

---

## åç»­æ­¥éª¤ï¼šæ·±å…¥æ¢ç´¢

- **å¯¼å‡ºå…¶ä»–æ ¼å¼** â€“ Aspose.Cells è¿˜æ”¯æŒ CSVã€HTML å’Œ PDFã€‚æ ¹æ®éœ€è¦å°† `TxtSaveOptions` æ›¿æ¢ä¸º `CsvSaveOptions` æˆ– `PdfSaveOptions`ã€‚  
- **åŠ¨æ€ç²¾åº¦** â€“ å¯ä»¥åœ¨è¿è¡Œæ—¶æ ¹æ®ç”¨æˆ·è¾“å…¥æˆ–é…ç½®æ–‡ä»¶è®¡ç®— `SignificantDigits`ã€‚  
- **å¤šå·¥ä½œè¡¨** â€“ éå† `workbook.Worksheets`ï¼Œä¸ºæ¯ä¸ªå·¥ä½œè¡¨å¯¼å‡ºå•ç‹¬çš„ `.txt` æ–‡ä»¶ã€‚  
- **æœ¬åœ°åŒ–** â€“ å¦‚éœ€åŒ¹é…åœ°åŒºè®¾ç½®ï¼Œå¯é€šè¿‡ `CultureInfo` æ§åˆ¶å°æ•°åˆ†éš”ç¬¦ï¼ˆ`.` ä¸ `,`ï¼‰ã€‚  

æ‰€æœ‰è¿™äº›æ‰©å±•ä»ç„¶åŸºäºæˆ‘ä»¬æœ¬æ•™ç¨‹çš„æ ¸å¿ƒæ€è·¯ï¼š**åˆ›å»ºæ–°å·¥ä½œç°¿**ã€é…ç½®å¯¼å‡ºã€å¹¶ **è®¾ç½®æ•°å€¼ç²¾åº¦** ä»¥æ»¡è¶³æŠ¥å‘Šéœ€æ±‚ã€‚

---

## å°ç»“

æˆ‘ä»¬ä»ä¸€ä¸ªå…¨æ–°çš„ **åˆ›å»ºæ–°å·¥ä½œç°¿** å®ä¾‹å‡ºå‘ï¼Œå¡«å……æ•°æ®ï¼Œå¹¶æ¼”ç¤ºäº†å¦‚ä½• **å¯¼å‡º Excel ä¸º TXT**ï¼ŒåŒæ—¶ **è®¾ç½®æœ‰æ•ˆæ•°å­—** ä»¥é™åˆ¶è¾“å‡ºç²¾åº¦ã€‚å®Œæ•´ç¤ºä¾‹å¯ç›´æ¥è¿è¡Œï¼Œä¸”æ¯è¡Œä»£ç èƒŒåçš„ *why* å·²ç»è§£é‡Šæ¸…æ¥šï¼Œæ–¹ä¾¿ä½ åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­è¿›è¡Œé€‚é…ã€‚

å°½æƒ…å®éªŒå§â€”â€”ä¿®æ”¹ `SignificantDigits` çš„å€¼ã€æ·»åŠ æ›´å¤šå·¥ä½œè¡¨ï¼Œæˆ–åˆ‡æ¢è¾“å‡ºæ ¼å¼ã€‚å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æŸ¥é˜… Aspose.Cells æ–‡æ¡£æˆ–åœ¨ä¸‹æ–¹ç•™è¨€ã€‚ç¥ç¼–ç æ„‰å¿«ï¼

---

![åˆ›å»ºæ–°å·¥ä½œç°¿ç¤ºä¾‹](/images/create-new-workbook.png "å±•ç¤º C# IDE ä¸­åˆ›å»ºæ–°å·¥ä½œç°¿ä»£ç çš„æˆªå›¾")

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}