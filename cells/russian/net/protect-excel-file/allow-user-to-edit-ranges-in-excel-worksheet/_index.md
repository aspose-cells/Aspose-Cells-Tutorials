---
title: Разрешить пользователю редактировать диапазоны на листе Excel
linktitle: Разрешить пользователю редактировать диапазоны на листе Excel
second_title: Справочник API Aspose.Cells для .NET
description: Разрешить пользователям редактировать определенные диапазоны в таблице Excel с помощью Aspose.Cells для .NET. Пошаговое руководство с исходным кодом на C#.
weight: 10
url: /ru/net/protect-excel-file/allow-user-to-edit-ranges-in-excel-worksheet/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Разрешить пользователю редактировать диапазоны на листе Excel

## Введение

Когда дело доходит до работы с листами Excel, гибкость часто является ключевым фактором, особенно когда нескольким пользователям требуется доступ для редактирования определенных областей без нарушения целостности данных всего листа. Вот где Aspose.Cells for .NET блистает! В этом уроке мы собираемся углубиться в то, как разрешить пользователям редактировать определенные диапазоны в листе Excel, защищая остальную часть документа. К концу этой статьи вы не только поймете концепции, но и получите наглядный пример для работы. 

## Предпосылки

Прежде чем перейти к деталям, давайте убедимся, что у вас есть все необходимое для начала работы:

1. Среда разработки .NET: у вас должна быть настроена работающая среда разработки .NET (это может быть Visual Studio или любая другая IDE по вашему выбору).
2.  Библиотека Aspose.Cells for .NET: Загрузите и установите библиотеку Aspose.Cells. Вы можете найти ее[здесь](https://releases.aspose.com/cells/net/).
3. Базовые знания C#: знакомство с программированием на C# поможет вам легко ориентироваться в примерах кода.
4. Понимание основ Excel: знание принципов работы Excel послужит основой для тех функций, которые мы будем обсуждать.

Как только все эти предварительные условия выполнены, вы готовы приступить к работе!

## Импортные пакеты

Прежде чем начать кодирование, нам нужно убедиться, что наш проект распознает пространство имен Aspose.Cells. Вот как импортировать необходимые пакеты:

```csharp
using System.IO;
using Aspose.Cells;
```

Теперь, когда мы импортировали все необходимое, давайте шаг за шагом перейдем к нашему руководству.

## Шаг 1: Настройте каталог документов

Для любых операций с файлами важно иметь определенное место, где будут сохраняться наши документы. Давайте настроим наш рабочий каталог для хранения файлов Excel.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// Создайте каталог, если его еще нет.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```

 Сначала замените`"YOUR DOCUMENT DIRECTORY"` с путем, по которому вы хотите сохранить свои файлы. Этот код проверяет, существует ли каталог; если нет, он его создает.

## Шаг 2: Создание новой рабочей книги

Когда наш рабочий каталог готов, пришло время создать книгу Excel. 

```csharp
// Создать новую рабочую книгу
Workbook book = new Workbook();
```

 Здесь мы создаем новый экземпляр`Workbook` класс, предоставляемый Aspose.Cells, который позволяет нам манипулировать файлом Excel.

## Шаг 3: Доступ к рабочему листу по умолчанию

Каждая вновь созданная рабочая книга содержит как минимум один рабочий лист. Давайте откроем его.

```csharp
// Получить первый (по умолчанию) рабочий лист
Worksheet sheet = book.Worksheets[0];
```

В этом фрагменте кода мы получаем доступ к первому листу нашей рабочей книги, с которым мы будем работать на последующих этапах.

## Шаг 4: Получите разрешение на редактирование диапазонов

 Чтобы включить редактирование определенных диапазонов рабочего листа, нам необходимо получить доступ к`AllowEditRanges` свойство.

```csharp
// Получите разрешение на редактирование диапазонов
ProtectedRangeCollection allowRanges = sheet.AllowEditRanges;
```

Эта коллекция позволит нам управлять диапазонами, которые можно редактировать на нашем рабочем листе.

## Шаг 5: Определите защищенный диапазон

Далее давайте определим, какую часть рабочего листа мы хотим защитить, разрешив при этом редактирование указанного диапазона.

```csharp
// Определить защищенный диапазон
ProtectedRange proteced_range;

// Создать диапазон
int idx = allowRanges.Add("r2", 1, 1, 3, 3);
proteced_range = allowRanges[idx];

// Укажите пароль
proteced_range.Password = "123";
```

На этом этапе мы добавляем новый редактируемый диапазон под названием «r2», который позволяет редактировать ячейки от строки 1 столбца 1 до строки 3 столбца 3. Кроме того, мы устанавливаем пароль для защиты этого диапазона, гарантируя, что изменять его смогут только авторизованные пользователи.

## Шаг 6: Защитите рабочий лист

Теперь, когда мы настроили редактируемый диапазон, нам нужно защитить рабочий лист.

```csharp
// Защитите лист
sheet.Protect(ProtectionType.All);
```

Этот код защитит весь рабочий лист от любых нежелательных изменений, за исключением диапазона, который мы только что указали.

## Шаг 7: Сохраните файл Excel.

Давайте сохраним книгу, чтобы увидеть изменения, отраженные в файле Excel.

```csharp
// Сохраните файл Excel.
book.Save(dataDir + "protectedrange.out.xls");
```

Обязательно измените имя файла по мере необходимости. Это создаст файл Excel в указанном вами каталоге с настроенными нами параметрами.

## Заключение

Вот и все! Вы успешно создали лист Excel, который ограничивает редактирование в указанном диапазоне, защищая остальную часть листа. Использование Aspose.Cells для .NET делает управление такими задачами гораздо более простым и эффективным. Независимо от того, разрабатываете ли вы сложное приложение или просто хотите безопасно управлять данными, эти возможности могут значительно улучшить ваш рабочий процесс.

## Часто задаваемые вопросы

### Что такое Aspose.Cells?
Aspose.Cells — это мощная библиотека .NET для обработки файлов Excel, предлагающая такие функции, как программное создание, редактирование и преобразование электронных таблиц.

### Могу ли я применить несколько редактируемых диапазонов?
 Конечно! Вы можете позвонить`Add` метод на`allowRanges` сбор несколько раз для указания нескольких редактируемых диапазонов.

### Что произойдет, если я забуду пароль?
К сожалению, если вы забудете пароль для редактируемого диапазона, вам придется снять защиту или получить доступ к файлу предопределенным способом, который может потребовать ввода учетных данных.

### Существует ли бесплатная версия Aspose.Cells?
Да, Aspose предоставляет бесплатную пробную версию, которую вы можете использовать для изучения функций перед покупкой.

### Где я могу найти более подробную информацию об Aspose.Cells?
 Вы можете проверить[документация](https://reference.aspose.com/cells/net/)для получения подробных руководств и ссылок.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
