---
title: Расположить изображение (пропорционально) в Excel
linktitle: Расположить изображение (пропорционально) в Excel
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как пропорционально размещать изображения в Excel с помощью Aspose.Cells для .NET. Сделайте свои таблицы более визуально привлекательными.
weight: 14
url: /ru/net/excel-ole-picture-objects/position-picture-proportional-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Расположить изображение (пропорционально) в Excel

## Введение
Вам надоели эти пикселизированные изображения, которые, кажется, никогда не помещаются как надо в ваши таблицы Excel? Представьте себе: у вас есть красивый логотип, который должен быть виден на видном месте в вашей таблице Excel, но в итоге он сплющен, растянут или плохо размещен. Никому это не нужно! Что ж, держитесь за свои места, потому что сегодня вы узнаете, как пропорционально размещать изображения в Excel с помощью библиотеки Aspose.Cells для .NET. Эта мощная библиотека упрощает работу с файлами Excel, будь то для отчетов, анализа данных или просто для придания блеска вашим презентациям. Давайте погрузимся в тонкости идеального выравнивания ваших изображений!
## Предпосылки
Прежде чем мы погрузимся в непосредственное кодирование, вам необходимо настроить на своем компьютере несколько вещей:
1. Visual Studio: убедитесь, что у вас установлена Visual Studio, так как она обеспечит удобную среду для вашего проекта .NET.
2.  Библиотека Aspose.Cells: Вам понадобится библиотека Aspose.Cells. Вы можете получить бесплатную пробную версию или купить ее на[Сайт Aspose](https://purchase.aspose.com/buy).
3. Базовые знания C#: небольшое знакомство с программированием на C# будет иметь большое значение для понимания примеров, которые мы будем обсуждать.
4. Файл изображения: подготовьте изображение (например, ваш логотип), которое вы хотите вставить в таблицу Excel.
Теперь, когда все готово, давайте приступим к кодированию!
## Импортные пакеты
Чтобы начать использовать Aspose.Cells в вашем проекте, вам нужно импортировать определенные пространства имен. Вот как это сделать:
### Создать новый проект
В Visual Studio создайте новый проект:
- Откройте Visual Studio.
- Нажмите «Создать новый проект».
- Выберите «Библиотека классов (.NET Framework)» или «Консольное приложение» в зависимости от ваших предпочтений.
### Установить Aspose.Cells
Вы можете добавить пакет Aspose.Cells в свой проект через NuGet. Вот как:
- Щелкните правой кнопкой мыши по вашему проекту в обозревателе решений.
- Выберите «Управление пакетами NuGet».
- Найдите «Aspose.Cells» и нажмите «Установить».
### Добавить директивы использования
В верхней части файла кода включите следующие директивы:
```csharp
using System.IO;
using Aspose.Cells;
```
Эти директивы предоставят вам доступ к классам, которые понадобятся вам для работы с файлами Excel.
Теперь давайте разберем это на подробные шаги, чтобы успешно пропорционально расположить изображение в Excel.
## Шаг 1: Настройте свой каталог
Прежде всего, убедитесь, что у вас есть назначенная папка для ваших документов. Вот как создать каталог, если его нет:
```csharp
string dataDir = "Your Document Directory";
// Создайте каталог, если его еще нет.
bool isExists = System.IO.Directory.Exists(dataDir);
if (!isExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
 Этот фрагмент создает новый каталог (если он не существует) для хранения ваших файлов Excel. Просто замените`"Your Document Directory"` с фактическим путем, по которому вы хотите сохранить файлы.
## Шаг 2: Создание рабочей книги
Далее давайте создадим новую рабочую книгу:
```csharp
Workbook workbook = new Workbook();
```
Эта строка инициализирует новый объект рабочей книги, предоставляя вам чистый холст для работы.
## Шаг 3: Добавьте новый рабочий лист
Теперь, когда наша рабочая книга готова, давайте добавим в нее новый рабочий лист:
```csharp
int sheetIndex = workbook.Worksheets.Add();
```
Это добавит новый рабочий лист и вернет индекс этого листа, который мы сможем использовать для дальнейшей работы с ним.
## Шаг 4: Откройте новый рабочий лист
Чтобы управлять недавно добавленным рабочим листом, вам необходимо получить к нему доступ:
```csharp
Worksheet worksheet = workbook.Worksheets[sheetIndex];
```
 Сейчас,`worksheet` позволит нам добавлять контент и изображения на этот конкретный лист.
## Шаг 5: Вставьте изображение
А теперь самое интересное! Давайте добавим ваше прекрасное изображение. Заменить`"logo.jpg"` с именем вашего файла изображения:
```csharp
int pictureIndex = worksheet.Pictures.Add(5, 5, dataDir + "logo.jpg");
```
 Эта строка добавляет изображение в ячейку F6 (поскольку строки и столбцы имеют нулевую индексацию,`5` относится к шестой ячейке).
## Шаг 6: Получите доступ к добавленному изображению
После того, как изображение вставлено, вы можете получить к нему доступ следующим образом:
```csharp
Aspose.Cells.Drawing.Picture picture = worksheet.Pictures[pictureIndex];
```
Это позволяет вам манипулировать свойствами изображения.
## Шаг 7: Расположите изображение пропорционально
Теперь давайте пропорционально расположим картинку:
```csharp
picture.UpperDeltaX = 200;
picture.UpperDeltaY = 200;
```
 Здесь,`UpperDeltaX` и`UpperDeltaY` отрегулируйте положение изображения относительно размеров ячейки. Вы можете настроить эти значения, чтобы получить правильное изображение.
## Шаг 8: Сохраните изменения.
Наконец, сохраните книгу, чтобы сохранить все изменения:
```csharp
workbook.Save(dataDir + "book1.out.xls");
```
 Эта строка сохраняет вашу книгу как`book1.out.xls` в указанном каталоге.
## Заключение
И вот оно! Вы только что узнали, как пропорционально размещать изображения в Excel с помощью Aspose.Cells для .NET. Речь идет не только о вставке изображений; речь идет о том, чтобы они выглядели идеально в ваших таблицах. Просто помните: удачно размещенное изображение может значительно улучшить представление ваших данных.
Получайте удовольствие, экспериментируя с различными изображениями и размещениями, и не стесняйтесь погружаться глубже в богатые возможности, которые предлагает Aspose.Cells. Ваши таблицы Excel скоро получат серьезное преображение!
## Часто задаваемые вопросы
### Что такое Aspose.Cells?
Aspose.Cells — это мощная библиотека для .NET, которая позволяет пользователям создавать, изменять и конвертировать файлы Excel без необходимости установки Microsoft Excel.
### Могу ли я использовать Aspose.Cells бесплатно?
 Да, Aspose.Cells предлагает бесплатную пробную версию, которую вы можете загрузить[здесь](https://releases.aspose.com/).
### Где я могу найти документацию?
 Вы можете получить доступ к комплексной[документация](https://reference.aspose.com/cells/net/) для Aspose.Cells.
### Поддерживает ли Aspose.Cells все форматы изображений?
Aspose.Cells поддерживает различные форматы, включая JPEG, PNG, BMP, GIF и TIFF.
### Как я могу получить поддержку по Aspose.Cells?
 По любым вопросам обращайтесь на сайт[форум поддержки](https://forum.aspose.com/c/cells/9)где вы можете задать свои вопросы.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
