---
title: Преобразование диаграммы в изображение в .NET
linktitle: Преобразование диаграммы в изображение в .NET
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как преобразовать диаграммы в изображения в .NET с помощью Aspose.Cells с помощью этого пошагового руководства. Легко преобразуйте диаграммы Excel в высококачественные изображения.
weight: 10
url: /ru/net/image-and-chart-operations/chart-to-image-conversion/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Преобразование диаграммы в изображение в .NET

## Введение
Преобразование диаграммы из Excel в изображение может быть критически важным требованием при создании систем отчетности или совместном использовании визуальных представлений данных. К счастью, с Aspose.Cells для .NET этот процесс проще простого! Независимо от того, создаете ли вы отчеты или просто преобразуете диаграммы Excel в изображения для лучшего отображения, это руководство проведет вас через этот процесс шаг за шагом.
## Предпосылки
Прежде чем начать, давайте убедимся, что у вас есть все необходимое для выполнения этого руководства.
### Библиотека Aspose.Cells для .NET
Во-первых, вам нужно будет загрузить и сослаться на библиотеку Aspose.Cells for .NET в вашем проекте. Вы можете получить последнюю версию здесь:
- [Загрузить Aspose.Cells для .NET](https://releases.aspose.com/cells/net/)
### Среда .NET
Убедитесь, что в вашей системе установлен .NET Framework. Для запуска этого примера можно использовать Visual Studio или любую другую среду разработки .NET.
### Настройка лицензии (необязательно)
 Хотя вы можете использовать Aspose.Cells с бесплатной пробной версией, для полной функциональности без ограничений рассмотрите возможность подачи заявки на[временная лицензия](https://purchase.aspose.com/temporary-license/) или купите его у[здесь](https://purchase.aspose.com/buy).

## Импортные пакеты
Для начала давайте импортируем необходимые пространства имен для работы с библиотекой Aspose.Cells. Это позволит нам манипулировать файлами Excel и генерировать изображения.
```csharp
using System.IO;
using System.Drawing;
using Aspose.Cells;
```
Перед началом написания кода убедитесь, что у вас готовы эти пакеты.

Теперь давайте разберем процесс преобразования диаграммы в изображение на простые шаги.
## Шаг 1: Настройте каталог вашего проекта
Вам нужно место для сохранения сгенерированных изображений, верно? Давайте сначала создадим каталог, в котором будут сохраняться выходные изображения.

Начнем с определения пути к нашему каталогу документов и убедимся, что папка существует. Если ее нет, мы ее создадим.
```csharp
// Определите каталог для сохранения изображений
string dataDir = "Your Document Directory";
//Проверьте, существует ли каталог
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
На этом этапе вы готовы создать и сохранить изображения диаграмм в этом каталоге.
## Шаг 2: Создайте новую рабочую книгу
Здесь мы создадим экземпляр объекта Workbook. Он будет представлять наш файл Excel, в который будет встроена диаграмма.

Рабочая книга похожа на файл Excel, содержащий листы. Создавая новую рабочую книгу, мы начинаем с чистого листа Excel.
```csharp
// Создать новый объект Workbook
Workbook workbook = new Workbook();
```
## Шаг 3: Добавьте новый рабочий лист
Каждый файл Excel имеет рабочие листы (или вкладки). Давайте добавим один в нашу рабочую книгу.

Добавление нового рабочего листа необходимо, поскольку мы будем вставлять в него наши данные и диаграммы. После добавления листа мы извлекаем его ссылку.
```csharp
// Добавить новый рабочий лист в рабочую книгу
int sheetIndex = workbook.Worksheets.Add();
// Получить недавно добавленный рабочий лист
Worksheet worksheet = workbook.Worksheets[sheetIndex];
```
## Шаг 4: Заполните рабочий лист данными
Чтобы создать осмысленную диаграмму, нам нужны некоторые данные, верно? Давайте заполним несколько ячеек примерными значениями.

Мы добавим данные в определенные ячейки на рабочем листе. Эти данные будут использоваться для создания нашей диаграммы позже.
```csharp
// Добавить образцы данных в ячейки
worksheet.Cells["A1"].PutValue(50);
worksheet.Cells["A2"].PutValue(100);
worksheet.Cells["A3"].PutValue(150);
worksheet.Cells["B1"].PutValue(4);
worksheet.Cells["B2"].PutValue(20);
worksheet.Cells["B3"].PutValue(50);
```
## Шаг 5: Добавьте диаграмму на рабочий лист
Теперь давайте создадим столбчатую диаграмму, которая визуализирует только что добавленные нами данные.

Мы указываем тип диаграммы (столбчатая диаграмма) и определяем ее размер и положение на рабочем листе.
```csharp
// Добавьте столбчатую диаграмму на рабочий лист
int chartIndex = worksheet.Charts.Add(Aspose.Cells.Charts.ChartType.Column, 5, 0, 15, 5);
```
## Шаг 6: Определите источник данных диаграммы
Вот тут-то и происходит волшебство: привязка диаграммы к данным на рабочем листе!

Мы связываем диаграмму с данными в столбцах A1 - B3. Это указывает диаграмме, откуда брать данные.
```csharp
// Свяжите диаграмму с данными в диапазоне A1–B3.
Aspose.Cells.Charts.Chart chart = worksheet.Charts[chartIndex];
chart.NSeries.Add("A1:B3", true);
```
## Шаг 7: Преобразуйте диаграмму в изображение
Момент истины: мы собираемся конвертировать эту диаграмму в файл изображения!

 Здесь мы используем`ToImage` метод конвертации диаграммы в формат изображения по вашему выбору. В этом случае мы конвертируем ее в формат EMF (Enhanced Metafile).
```csharp
// Преобразуйте диаграмму в изображение и сохраните его в каталоге.
chart.ToImage(dataDir + "Chart.emf", ImageFormat.Emf);
```
Вот и все! Ваша диаграмма теперь сохранена как изображение. Пришло время похлопать себя по спине.
## Шаг 8: Отображение сообщения об успешном завершении
В завершение давайте выведем сообщение, подтверждающее генерацию изображения.
```csharp
// Отобразить сообщение об успешном завершении
System.Console.WriteLine("Image generated successfully.");
```
## Заключение
Бум! Вот как легко преобразовать диаграмму из Excel в изображение с помощью Aspose.Cells для .NET. Этот процесс не только упрощает представление данных, но и повышает гибкость отчетов или панелей мониторинга, где изображения предпочтительнее встроенных диаграмм.
Следуя инструкциям, описанным в этом руководстве, вы теперь сможете преобразовать любую диаграмму Excel в изображение, что позволит вам легко интегрировать визуальные данные в различные приложения.
## Часто задаваемые вопросы
### Можно ли с помощью этого метода конвертировать различные типы диаграмм?
Да, вы можете преобразовать любой тип диаграммы, поддерживаемый Aspose.Cells, включая круговые диаграммы, столбчатые диаграммы, линейные диаграммы и многое другое!
### Можно ли изменить формат изображения?
 Конечно! Хотя в этом примере мы использовали EMF, вы можете изменить формат изображения на PNG, JPEG, BMP и другие, просто изменив`ImageFormat` параметр.
### Поддерживает ли Aspose.Cells изображения высокого разрешения?
Да, Aspose.Cells позволяет управлять разрешением и параметрами качества изображения при экспорте диаграмм в изображения.
### Можно ли преобразовать несколько диаграмм в изображения за один раз?
Да, вы можете просмотреть несколько диаграмм в рабочей книге и преобразовать их все в изображения всего за несколько строк кода.
### Есть ли ограничение на количество диаграмм, которые я могу конвертировать?
Aspose.Cells не накладывает никаких ограничений, но обработка больших объемов данных может зависеть от памяти и производительности вашей системы.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
