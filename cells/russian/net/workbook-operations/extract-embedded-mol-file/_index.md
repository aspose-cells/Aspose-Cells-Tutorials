---
"description": "Узнайте, как извлекать встроенные файлы MOL из книг Excel с помощью Aspose.Cells для .NET в этом подробном пошаговом руководстве."
"linktitle": "Извлечь встроенный файл Mol из рабочей книги"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Извлечь встроенный файл Mol из рабочей книги"
"url": "/ru/net/workbook-operations/extract-embedded-mol-file/"
"weight": 18
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Извлечь встроенный файл Mol из рабочей книги

## Введение
Когда дело доходит до управления данными в книгах Excel, иногда вы сталкиваетесь с различными встроенными объектами, которые не имеют стандартного формата. Одним из таких форматов является MOL (файл молекулярной структуры), который обычно используется в химии для представления молекулярной информации. Если вы хотите извлечь эти файлы MOL из книги Excel с помощью Aspose.Cells для .NET, вы попали на правильное руководство. В этой статье мы проведем вас через процесс шаг за шагом, демистифицируя каждую часть по пути.
## Предпосылки
Прежде чем погрузиться в код, важно убедиться, что у вас есть необходимые навыки и инструменты. Вот что вам понадобится:
1. Базовые знания программирования .NET: вы должны быть знакомы с C# и платформой .NET.
2. Aspose.Cells для .NET: Убедитесь, что у вас есть библиотека Aspose.Cells. Вы можете [скачать здесь](https://releases.aspose.com/cells/net/).
3. IDE: вы можете использовать Visual Studio или любую другую совместимую с .NET IDE.
4. Excel Workbook со встроенными файлами MOL: Для этого руководства вам понадобится файл Excel, содержащий объекты MOL. Вы можете создать свой собственный или использовать любой файл-образец.
## Импортные пакеты
Для начала вам нужно импортировать необходимые пространства имен в ваш проект. Это важно для доступа к функциональным возможностям Aspose.Cells. Вот как это можно сделать:

```csharp
using Aspose.Cells.Drawing;
using Aspose.Cells.WebExtensions;
using System;
using System.IO;
```

Эти пространства имен позволят вам управлять рабочими книгами, получать доступ к рабочим листам и работать с файлами в целом.
Теперь, когда мы определились с предварительными условиями, давайте погрузимся в код и разберем каждый шаг, необходимый для извлечения встроенных файлов MOL из книги Excel. 
## Шаг 1: Настройка каталогов
Первый шаг — определить, где находится исходный документ и где вы хотите сохранить извлеченные файлы MOL. Давайте настроим эти каталоги.
```csharp
string SourceDir = "Your Document Directory"; // Замените на путь к вашему каталогу
string outputDir = "Your Document Directory"; // Замените на ваш выходной путь
```
Здесь вы заменяете `"Your Document Directory"` с путем к вашим фактическим каталогам. Важно, чтобы исходный и выходной каталоги были доступны для вашего приложения.
## Шаг 2: Загрузка рабочей книги
После настройки каталогов следующая задача — загрузить книгу Excel. Давайте сделаем это сейчас.

```csharp
Workbook workbook = new Workbook(SourceDir + "EmbeddedMolSample.xlsx");
```

Мы создаем экземпляр `Workbook` класс и передача пути к нашему файлу Excel с именем `EmbeddedMolSample.xlsx`. Этот шаг инициализирует рабочую книгу, позволяя вам получить доступ к ее содержимому.
## Шаг 3: Итерация по рабочим листам
Теперь, когда ваша рабочая книга загружена, вам нужно пройтись по каждому рабочему листу в рабочей книге. Это позволит вам проверить каждый лист на наличие встроенных объектов.

```csharp
var index = 1; // Используется для именования извлеченных файлов MOL.
foreach (Worksheet sheet in workbook.Worksheets)
{
    OleObjectCollection oles = sheet.OleObjects;
    // Дальнейшая логика извлечения идет здесь
}
```

Здесь вы используете `foreach` цикл для навигации по рабочим листам. Для каждого рабочего листа вы получаете доступ к `OleObjects` коллекция, содержащая все встроенные объекты.
## Шаг 4: Извлечение файлов MOL
Теперь наступает критическая часть — извлечение файлов MOL из объектов OLE. Это требует еще одного цикла внутри цикла рабочего листа.

```csharp
foreach (OleObject ole in oles)
{
    string fileName = outputDir + "OleObject" + index + ".mol ";
    FileStream fs = File.Create(fileName);
    fs.Write(ole.ObjectData, 0, ole.ObjectData.Length);
    fs.Close();
    index++;
}
```

Для каждого найденного вами объекта OLE вы создаете новый файл в выходном каталоге. `ObjectData` собственность `OleObject` содержит данные встроенного объекта, которые вы записываете во вновь созданный файл с помощью `FileStream`. Файлу присваивается последовательное имя (`OleObject1.mol`, `OleObject2.mol`и т.д.) на основе `index` переменная.
## Шаг 5: Подтверждение завершения процесса
Наконец, после извлечения всех файлов MOL рекомендуется сообщить пользователю, что процесс успешно завершен.

```csharp
Console.WriteLine("ExtractEmbeddedMolFile executed successfully.");
```

Эта строка просто выводит сообщение на консоль, сообщая, что извлечение прошло успешно. Это приятный штрих для обратной связи с пользователем.
## Заключение
И вот оно! Вы успешно извлекли встроенные файлы MOL из книги Excel с помощью Aspose.Cells для .NET. Этот процесс объединяет несколько основных шагов, обеспечивая структурированный подход к обработке встроенных объектов. Независимо от того, занимаетесь ли вы научными исследованиями, химическим анализом или просто имеете дело со сложными наборами данных, возможность извлекать и обрабатывать эти типы файлов может существенно повлиять на то, как вы управляете своей информацией. 
## Часто задаваемые вопросы
### Можно ли извлекать из Excel файлы других типов, помимо MOL?
Да, вы можете извлекать различные другие типы встроенных файлов, используя аналогичные методы.
### Можно ли использовать Aspose.Cells бесплатно?
Aspose.Cells — это коммерческая библиотека, но вы можете [попробуйте бесплатно в течение ограниченного периода](https://releases.aspose.com/).
### Работает ли этот метод со всеми версиями Excel?
Да, если формат файла поддерживается Aspose.Cells.
### Могу ли я автоматизировать этот процесс извлечения?
Конечно! Вы можете автоматизировать этот процесс, поместив код в запланированную задачу или скрипт.
### Где я могу найти дополнительную документацию по Aspose.Cells?
Вы можете проверить [Документация Aspose.Cells](https://reference.aspose.com/cells/net/) для получения более подробной информации и примеров.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}