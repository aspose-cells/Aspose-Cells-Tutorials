---
"description": "Узнайте, как остановить преобразование рабочей книги в Aspose.Cells для .NET с помощью Interrupt Monitor, с помощью подробного пошагового руководства."
"linktitle": "Остановка преобразования или загрузки с помощью монитора прерываний"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Остановка преобразования или загрузки с помощью монитора прерываний"
"url": "/ru/net/workbook-operations/stop-conversion-or-loading/"
"weight": 26
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Остановка преобразования или загрузки с помощью монитора прерываний

## Введение
Работа с большими файлами Excel часто включает в себя длительные процессы, которые могут поглощать время и ресурсы. Но что, если бы вы могли остановить процесс преобразования на полпути, когда вы понимаете, что что-то нужно изменить? Aspose.Cells for .NET имеет функцию под названием Interrupt Monitor, которая позволяет вам прерывать преобразование рабочей книги в другой формат, например PDF. Это может быть спасением, особенно при работе с большими файлами данных. В этом руководстве мы рассмотрим, как прерывать процесс преобразования с помощью Interrupt Monitor в Aspose.Cells for .NET.
## Предпосылки
Прежде чем приступить к работе, убедитесь, что у вас есть следующее:
1. Aspose.Cells для .NET — загрузите его [здесь](https://releases.aspose.com/cells/net/).
2. Среда разработки .NET — например, Visual Studio.
3. Базовые знания программирования на C#. Знакомство с синтаксисом C# поможет вам в дальнейшем изучении.
## Импортные пакеты
Для начала давайте импортируем необходимые пакеты. Эти импорты включают:
- Aspose.Cells: основная библиотека для работы с файлами Excel.
- System.Threading: Для управления потоками, поскольку в этом примере будут запущены два параллельных процесса.
```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
using System.IO;
```
Давайте разберем процесс на подробные шаги. Каждый шаг поможет вам понять важность настройки и использования Interrupt Monitor для управления преобразованием книги Excel.
## Шаг 1: Создание класса и установка выходного каталога
Во-первых, нам нужен класс для инкапсуляции наших функций, а также каталог, в котором будет сохранен выходной файл.
```csharp
class StopConversionOrLoadingUsingInterruptMonitor
{
    static string outputDir = "Your Document Directory";
}
```
Заменять `"Your Document Directory"` на фактический путь, по которому вы хотите сохранить PDF-файл.
## Шаг 2: Создание экземпляра монитора прерываний
Далее создайте объект InterruptMonitor. Этот монитор поможет контролировать процесс, настраивая возможность прерывания его в любой заданной точке.
```csharp
InterruptMonitor im = new InterruptMonitor();
```
Этот монитор прерываний будет прикреплен к нашей рабочей книге, что позволит нам управлять процессом преобразования.
## Шаг 3: Настройте рабочую книгу для преобразования
Теперь давайте создадим объект рабочей книги, назначим ему InterruptMonitor, а затем откроем первый рабочий лист, чтобы вставить пример текста.
```csharp
void CreateWorkbookAndConvertItToPdfFormat()
{
    Workbook wb = new Workbook();
    wb.InterruptMonitor = im;
    Worksheet ws = wb.Worksheets[0];
    Cell cell = ws.Cells["J1000000"];
    cell.PutValue("This is text.");
}
```
Приведенный выше код создает рабочую книгу, устанавливает для нее InterruptMonitor и помещает текст в дальнюю ячейку (`J1000000`). Размещение текста в этой позиции ячейки гарантирует, что обработка рабочей книги займет больше времени, что даст InterruptMonitor достаточно времени для вмешательства.
## Шаг 4: Сохраните рабочую книгу в формате PDF и обработайте прерывания
Теперь давайте попробуем сохранить книгу в формате PDF. Мы будем использовать `try-catch` блок для обработки любых возможных прерываний.
```csharp
try
{
    wb.Save(outputDir + "output_InterruptMonitor.pdf");
}
catch (Aspose.Cells.CellsException ex)
{
    Console.WriteLine("Process Interrupted - Message: " + ex.Message);
}
```
Если процесс будет прерван, исключение перехватит его и выведет соответствующее сообщение. В противном случае рабочая книга будет сохранена как PDF.
## Шаг 5: Прервите процесс преобразования
Главной особенностью здесь является возможность прерывания процесса. Мы добавим задержку с помощью `Thread.Sleep` а затем позвоните `Interrupt()` метод остановки преобразования через 10 секунд.
```csharp
void WaitForWhileAndThenInterrupt()
{
    Thread.Sleep(1000 * 10);
    im.Interrupt();
}
```
Эта задержка дает рабочей книге время начать преобразование в PDF до отправки сигнала прерывания.
## Шаг 6: Одновременное выполнение потоков
Чтобы все объединить, нам нужно запустить обе функции в отдельных потоках. Таким образом, преобразование рабочей книги и ожидание прерывания могут происходить одновременно.
```csharp
public void TestRun()
{
    ThreadStart ts1 = new ThreadStart(this.CreateWorkbookAndConvertItToPdfFormat);
    Thread t1 = new Thread(ts1);
    t1.Start();
    ThreadStart ts2 = new ThreadStart(this.WaitForWhileAndThenInterrupt);
    Thread t2 = new Thread(ts2);
    t2.Start();
    t1.Join();
    t2.Join();
}
```
Код выше работает `CreateWorkbookAndConvertItToPdfFormat` и `WaitForWhileAndThenInterrupt` в параллельных потоках, объединяя их после завершения обоих процессов.
## Шаг 7: Окончательное исполнение
Наконец, мы добавим `Run()` метод выполнения кода.
```csharp
public static void Run()
{
    new StopConversionOrLoadingUsingInterruptMonitor().TestRun();
    Console.WriteLine("StopConversionOrLoadingUsingInterruptMonitor executed successfully.");
}
```
Этот `Run` Метод является точкой входа для начала и наблюдения за прерыванием действия.
## Заключение
В этом уроке мы изучили, как прерывать процесс преобразования в Aspose.Cells для .NET. Interrupt Monitor — полезный инструмент при работе с большими файлами Excel, позволяющий останавливать процессы, не дожидаясь их завершения. Это особенно полезно в сценариях, где время и ресурсы имеют большое значение, а также требуется быстрая обратная связь.
## Часто задаваемые вопросы
### Что такое монитор прерываний в Aspose.Cells для .NET?  
Монитор прерываний позволяет остановить преобразование рабочей книги или процесс загрузки на полпути.
### Могу ли я использовать Interrupt Monitor для других форматов, помимо PDF?  
Да, вы также можете прервать преобразование в другие поддерживаемые форматы.
### Как Thread.Sleep() влияет на время прерывания?  
Thread.Sleep() создает задержку перед запуском прерывания, давая время для начала преобразования.
### Могу ли я прервать процесс раньше, чем через 10 секунд?  
Да, изменить задержку в `WaitForWhileAndThenInterrupt()` на более короткий срок.
### Повлияет ли прерывание процесса на производительность?  
Влияние минимально, но оно очень полезно для управления длительными процессами.
Для получения более подробной информации см. [Документация Aspose.Cells для .NET](https://reference.aspose.com/cells/net/). Если вам нужна помощь, ознакомьтесь с [Форум поддержки](https://forum.aspose.com/c/cells/9) или получить [Бесплатная пробная версия](https://releases.aspose.com/).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}