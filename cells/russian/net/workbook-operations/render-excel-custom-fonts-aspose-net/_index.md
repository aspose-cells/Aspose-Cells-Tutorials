---
"date": "2025-04-05"
"description": "Узнайте, как преобразовывать файлы Excel в форматы PNG, TIFF и PDF, используя пользовательские шрифты с Aspose.Cells для .NET. Обеспечьте единообразие типографики при всех преобразованиях документов."
"title": "Рендеринг Excel в PNG, TIFF, PDF с пользовательскими шрифтами в .NET с помощью Aspose.Cells"
"url": "/ru/net/workbook-operations/render-excel-custom-fonts-aspose-net/"
"weight": 1
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}


# Преобразование файлов Excel в форматы PNG, TIFF и PDF с пользовательскими шрифтами с помощью Aspose.Cells для .NET

## Введение

Сохранение целостности шрифтов при конвертации файлов Excel в изображения или PDF-файлы имеет решающее значение для согласованности бренда. Aspose.Cells для .NET предлагает надежное решение, позволяя вам указывать пользовательские шрифты по умолчанию при конвертации документов.

В этом уроке мы покажем вам, как преобразовать файлы Excel в форматы PNG, TIFF и PDF с помощью Aspose.Cells для .NET с указанными пользовательскими шрифтами по умолчанию. Это идеальный вариант, если вы:
- Стремитесь к единообразию типографики в визуализируемых документах.
- Необходимо настроить параметры шрифта во время конвертации.
- Хотите изучить варианты конфигурации в Aspose.Cells для .NET.

Давайте настроим вашу среду и без проблем реализуем эти функции.

### Предпосылки

Перед началом убедитесь, что у вас есть следующее:
- **Среда .NET**: Установите на свой компьютер (предпочтительно .NET Core или .NET Framework).
- **Библиотека Aspose.Cells для .NET**: Установлено в вашем проекте.
- **Файл Excel**: Книга Excel с данными для преобразования.

### Настройка Aspose.Cells для .NET

Для начала добавьте в свой проект библиотеку Aspose.Cells:

**Использование .NET CLI:**
```bash
dotnet add package Aspose.Cells
```

**Использование менеджера пакетов:**
```powershell
PM> NuGet\Install-Package Aspose.Cells
```

Приобретите лицензию для доступа ко всем функциям:
- **Бесплатная пробная версия**: Посещать [Бесплатная пробная версия Aspose](https://releases.aspose.com/cells/net/) для первоначального доступа.
- **Временная лицензия**: Получите его от [Временная лицензия Aspose](https://purchase.aspose.com/temporary-license/).
- **Покупка**: Для получения постоянной лицензии перейдите по ссылке [Покупка Aspose](https://purchase.aspose.com/buy).

После получения лицензии инициализируйте Aspose.Cells в своем приложении:
```csharp
// Установите лицензию для Aspose.Cells.
License license = new License();
license.SetLicense("path_to_your_license_file");
```

## Руководство по внедрению

### Рендеринг в PNG с пользовательским шрифтом по умолчанию

Рендеринг листа Excel в PNG с установкой пользовательского шрифта по умолчанию обеспечивает визуальную согласованность. Вот как:

#### Шаг 1: Настройте параметры изображения

Настройте параметры рендеринга для вывода изображения.
```csharp
using Aspose.Cells;
using Aspose.Cells.Rendering;

// Укажите каталоги.
string SourceDir = @"YOUR_SOURCE_DIRECTORY";
string outputDir = @"YOUR_OUTPUT_DIRECTORY";

// Откройте файл Excel.
Workbook workbook = new Workbook(SourceDir + "sampleSetDefaultFontPropertyOfPdfSaveOptionsAndImageOrPrintOptions.xlsx");

// Настройте параметры рендеринга изображения.
ImageOrPrintOptions imgOpt = new ImageOrPrintOptions();
imgOpt.ImageType = Drawing.ImageType.Png;
imgOpt.CheckWorkbookDefaultFont = false; // Используйте пользовательский шрифт для отсутствующих шрифтов в рабочей книге.
imgOpt.DefaultFont = "Times New Roman";
```

#### Шаг 2: Рендеринг и сохранение

Преобразуйте свой рабочий лист в файл изображения, используя эти настройки.
```csharp
// Преобразуйте первый рабочий лист в изображение PNG.
SheetRender sr = new SheetRender(workbook.Worksheets[0], imgOpt);
sr.ToImage(0, outputDir + "out1_imagePNG.png");
```

### Рендеринг в TIFF с пользовательским шрифтом по умолчанию

Формат TIFF идеально подходит для высококачественных изображений. Вот как можно отобразить всю книгу в виде файла TIFF:

#### Шаг 3: Настройте параметры изображения для TIFF

Настройте параметры рендеринга специально для вывода в формате TIFF.
```csharp
// Повторно используйте ранее определенные каталоги и откройте файл Excel.
Workbook workbook = new Workbook(SourceDir + "sampleSetDefaultFontPropertyOfPdfSaveOptionsAndImageOrPrintOptions.xlsx");

// Настройте параметры рендеринга изображений для TIFF.
imgOpt.ImageType = Drawing.ImageType.Tiff;
```

#### Шаг 4: Преобразование всей рабочей книги в формат TIFF

Конвертируйте всю рабочую книгу в один файл TIFF.
```csharp
// Сохраните рабочую книгу в виде изображения TIFF.
WorkbookRender wr = new WorkbookRender(workbook, imgOpt);
wr.ToImage(outputDir + "out1_imageTIFF.tiff");
```

### Рендеринг в PDF с пользовательским шрифтом по умолчанию

Сохранение книги Excel в формате PDF с обеспечением единообразия шрифтов имеет решающее значение для профессиональной документации.

#### Шаг 5: Настройте параметры сохранения PDF-файла

Настройте необходимые параметры для сохранения файла в формате PDF.
```csharp
using Aspose.Cells;

// Откройте рабочую книгу еще раз.
Workbook workbook = new Workbook(SourceDir + "sampleSetDefaultFontPropertyOfPdfSaveOptionsAndImageOrPrintOptions.xlsx");

// Настройте параметры сохранения PDF-файла.
PdfSaveOptions saveOptions = new PdfSaveOptions();
saveOptions.DefaultFont = "Times New Roman";
saveOptions.CheckWorkbookDefaultFont = false; // Используйте пользовательский шрифт для отсутствующих шрифтов в рабочей книге.
```

#### Шаг 6: Сохранить как PDF

Экспортируйте свою рабочую книгу в документ PDF.
```csharp
// Сохраните книгу как файл PDF.
workbook.Save(outputDir + "out1_pdf.pdf", saveOptions);
```

## Практические применения

- **Бизнес-отчеты**: Обеспечьте единообразие фирменного стиля во всех экспортируемых отчетах, используя пользовательские шрифты.
- **Архивация документов**: Преобразование устаревших файлов Excel в PDF-файлы для удобного обмена и архивирования с единообразной типографикой.
- **Графический дизайн**: Создавайте изображения данных Excel в формате TIFF с высоким разрешением для презентаций или дизайн-проектов.

Интеграция с другими системами, такими как платформы CRM или решения для управления документами, может еще больше улучшить эти варианты использования за счет автоматизации экспорта на основе определенных триггеров или событий.

## Соображения производительности

Оптимизация процесса рендеринга имеет решающее значение:
- **Управление памятью**: Утилизировать `Workbook`, `SheetRender`, и `WorkbookRender` объекты оперативно освобождают ресурсы.
- **Пакетная обработка**При работе с несколькими файлами используйте пакетную обработку для эффективной работы.
- **Асинхронные операции**: Используйте асинхронные методы, где это возможно, для повышения скорости реагирования приложений.

## Заключение

Теперь вы освоили рендеринг книг Excel в форматах PNG, TIFF и PDF, одновременно устанавливая пользовательские шрифты по умолчанию с помощью Aspose.Cells для .NET. Эта возможность гарантирует, что ваши документы сохранят визуальную целостность на различных платформах и в разных вариантах использования.

Изучите дополнительные функции, предлагаемые Aspose.Cells, чтобы еще больше улучшить возможности обработки документов. Для получения дополнительной информации или помощи посетите [Форум Aspose](https://forum.aspose.com/c/cells/9).

## Раздел часто задаваемых вопросов

**1. Что такое Aspose.Cells для .NET?**
   — Aspose.Cells для .NET — это библиотека, которая предоставляет надежные функции для программного управления и преобразования файлов Excel.

**2. Могу ли я использовать Aspose.Cells в веб-приложениях?**
   — Да, Aspose.Cells можно интегрировать в ASP.NET или любое другое веб-приложение на базе .NET.

**3. Как решить проблему отсутствия шрифтов во время рендеринга?**
   — Установив `CheckWorkbookDefaultFont` ложным и указанием `DefaultFont`, вы гарантируете, что во всем тексте будет использоваться выбранный вами шрифт, даже если оригинал недоступен.

**4. Поддерживаются ли форматы, отличные от PNG, TIFF и PDF?**
   — Да, Aspose.Cells поддерживает различные форматы изображений, такие как JPEG, BMP и т. д., и предлагает обширные возможности преобразования документов.

**5. Каковы наилучшие практики использования Aspose.Cells в крупномасштабных приложениях?**
   — Используйте эффективные методы управления памятью, пакетную обработку для обработки нескольких файлов и рассмотрите возможность асинхронных операций для повышения производительности приложений.

## Ресурсы
- **Документация**: [Документация Aspose.Cells](https://reference.aspose.com/cells/net/)
- **Скачать**: [Релизы Aspose.Cells](https://releases.aspose.com/cells/net/)
- **Покупка**: [Купить Aspose.Cells](https://purchase.aspose.com/buy)
- **Бесплатная пробная версия**: [Попробуйте Aspose.Cells бесплатно](https://releases.aspose.com/cells/net/)
- **Временная лицензия**: [Получить временную лицензию](https://purchase.aspose.com/temporary-license/) 


{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}