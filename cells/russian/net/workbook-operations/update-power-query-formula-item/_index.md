---
"description": "Узнайте, как обновить формулы Power Query в Excel с помощью Aspose.Cells для .NET, из этого подробного пошагового руководства."
"linktitle": "Обновление элемента формулы Power Query в рабочей книге"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Обновление элемента формулы Power Query в рабочей книге"
"url": "/ru/net/workbook-operations/update-power-query-formula-item/"
"weight": 27
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Обновление элемента формулы Power Query в рабочей книге

## Введение
Понимание того, как эффективно управлять данными с помощью Power Query в Excel, имеет первостепенное значение для любого аналитика данных или энтузиаста Excel. Если вам когда-либо требовалось обновить элементы формулы в вашей книге Power Query, вы попали по адресу. Это руководство создано специально, чтобы помочь вам научиться использовать Aspose.Cells for .NET для беспрепятственного обновления формул Power Query в книге Excel. С помощью нескольких простых шагов вы сможете управлять данными и оптимизировать их, гарантируя, что ваши книги останутся динамичными и централизованными.
## Предпосылки
Прежде чем приступить к изучению примера кода и шагов, давайте рассмотрим, что вам понадобится:
1. Базовые знания C# и .NET: знакомство с концепциями программирования на C# будет полезным, поскольку нам предстоит писать код.
2. Установить Aspose.Cells для .NET: Вам необходимо интегрировать библиотеку Aspose.Cells в ваш проект .NET. Вы можете скачать ее [здесь](https://releases.aspose.com/cells/net/).
3. Файл Excel, готовый к изменению: Убедитесь, что у вас есть файл Excel, содержащий Power Query, который вы хотите обновить. Вам нужен пример рабочей книги, например `SamplePowerQueryFormula.xlsx` в вашем распоряжении.
## Импортные пакеты
Для начала убедитесь, что в ваш файл C# включены следующие пространства имен:
```csharp
using Aspose.Cells.DigitalSignatures;
using Aspose.Cells.QueryTables;
using System;
using System.IO;
```
Это позволит вам получить доступ к функциям библиотеки Aspose.Cells, в частности, для работы с рабочими книгами и данными Power Query.
## Шаг 1: Настройте рабочие каталоги
Прежде всего, вам необходимо определить, где находятся исходные и выходные файлы. 
```csharp
string SourceDir = "Your Document Directory";
string outputDir = "Your Document Directory";
```
На этом шаге вы указываете пути к каталогам. Заменить `"Your Document Directory"` с фактическим путем сохранения ваших файлов Excel. Это сообщает программе, где искать исходный файл и где сохранять обновленный.
## Шаг 2: Загрузите рабочую книгу
Теперь, когда вы настроили рабочие каталоги, следующим шагом будет загрузка файла Excel в программу.
```csharp
Workbook workbook = new Workbook(SourceDir + "SamplePowerQueryFormula.xlsx");
```
Здесь вы создаете `Workbook` объект, который загружает указанный файл Excel. `Workbook` Класс является частью библиотеки Aspose.Cells и необходим для любых операций, которые вы будете выполнять с этим файлом Excel.
## Шаг 3: Получите доступ к данным Power Query
После загрузки рабочей книги настало время получить доступ к хранящимся в ней формулам Power Query.
```csharp
DataMashup mashupData = workbook.DataMashup;
```
В этой строке `DataMashup` свойство помогает получить доступ к структурам данных Power Query в рабочей книге. Это свойство дает вам возможность взаимодействовать с различными аспектами данных Power Query, содержащихся в вашем файле Excel.
## Шаг 4: Цикл по формулам Power Query
Получив доступ к данным Power Query, следующим шагом станет итерация по каждой из имеющихся формул.
```csharp
foreach (PowerQueryFormula formula in mashupData.PowerQueryFormulas)
{
    foreach (PowerQueryFormulaItem item in formula.PowerQueryFormulaItems)
    {
        if (item.Name == "Source")
        {
            item.Value = "Excel.Workbook(File.Contents(\"" + SourceDir + "SamplePowerQueryFormulaSource.xlsx\"), null, true)";
        }
    }
}
```
Вот где происходит волшебство. Мы проходим по каждому `PowerQueryFormula` и затем через каждый `PowerQueryFormulaItem`. `if` Оператор ищет элемент формулы с именем «Источник» и обновляет его значение, чтобы оно соответствовало пути к исходному файлу, на который должен ссылаться Power Query. Это позволяет динамически изменять файл, из которого Power Query извлекает данные.
## Шаг 5: Сохраните обновленную рабочую книгу.
После обновления необходимых элементов формулы последним шагом будет сохранение рабочей книги.
```csharp
workbook.Save(outputDir + "SamplePowerQueryFormula_out.xlsx");
```
Эта строка сохраняет измененную книгу в новом файле, тем самым сохраняя оригинал и позволяя вам работать с обновленной версией.
## Шаг 6: Подтверждающее сообщение
Наконец, хорошей практикой будет проверить, правильно ли выполнен ваш код.
```csharp
Console.WriteLine("UpdatePowerQueryFormulaItem executed successfully.");
```
Это простое сообщение подтвердит на консоли, что операция прошла успешно, и обеспечит обнадеживающее завершение процесса.
## Заключение
И вот оно! Обновление элементов формулы Power Query в Excel с помощью Aspose.Cells для .NET можно выполнить всего за несколько простых шагов. Следуя этому руководству, вы сможете эффективно управлять подключениями к данным Excel и поддерживать бесперебойную работу своих рабочих книг. Независимо от того, являетесь ли вы опытным профессионалом или только начинаете работать с данными, Aspose.Cells предоставляет мощный способ автоматизации и улучшения рабочих процессов Excel. 
## Часто задаваемые вопросы
### Могу ли я использовать Aspose.Cells с любой версией .NET?
Aspose.Cells совместим с несколькими версиями .NET, включая .NET Framework и .NET Core.
### Можно ли использовать Aspose.Cells бесплатно?
Aspose.Cells предлагает бесплатную пробную версию, но для постоянного использования требуется лицензия. Вы можете получить временную лицензию [здесь](https://purchase.aspose.com/temporary-license/).
### Что делать, если в моем существующем файле Excel нет Power Query?
Описанный процесс фокусируется на обновлении элементов Power Query, поэтому, если в вашем файле их нет, вам необходимо сначала включить Power Queries.
### Где я могу найти более подробную информацию об Aspose.Cells?
Проверьте документацию для получения исчерпывающих рекомендаций и примеров. Посетите [документация](https://reference.aspose.com/cells/net/).
### Как сообщить об ошибках или проблемах с Aspose.Cells?
Вы можете обратиться за помощью по любым возникшим у вас вопросам на поддерживаемом ими форуме.


{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}