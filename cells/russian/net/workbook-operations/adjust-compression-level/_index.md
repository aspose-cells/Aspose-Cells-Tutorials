---
title: Настройте уровень сжатия в рабочей книге
linktitle: Настройте уровень сжатия в рабочей книге
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как настроить уровень сжатия книг Excel с помощью Aspose.Cells для .NET с помощью этого пошагового руководства. Оптимизируйте управление файлами.
weight: 14
url: /ru/net/workbook-operations/adjust-compression-level/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Настройте уровень сжатия в рабочей книге

## Введение
Когда дело доходит до управления большими файлами Excel, сжатие — это игра-перевертыш. Оно не только экономит место на диске, но и ускоряет и делает передачу файлов более эффективной. Если вы работаете с Aspose.Cells for .NET, вы можете легко настроить уровень сжатия ваших рабочих книг. В этом руководстве мы проведем вас через процесс шаг за шагом, гарантируя, что вы поймете каждую часть кода и то, как он работает.
## Предпосылки
Прежде чем погрузиться в код, необходимо выполнить несколько предварительных условий:
1. Базовые знания C#: знакомство с программированием на C# поможет вам лучше понимать фрагменты кода.
2.  Библиотека Aspose.Cells: Вам необходимо установить библиотеку Aspose.Cells. Вы можете загрузить ее с[здесь](https://releases.aspose.com/cells/net/).
3. Visual Studio: Для запуска кода потребуется среда разработки, например Visual Studio.
4. .NET Framework: убедитесь, что ваш проект настроен на совместимую версию .NET Framework.
## Импортные пакеты
Для начала вам нужно импортировать необходимые пакеты в ваш проект C#. Вот как это можно сделать:
```csharp
using Aspose.Cells.Rendering;
using Aspose.Cells.WebExtensions;
using System;
```
 Эти пакеты необходимы для работы с файлами Excel с использованием библиотеки Aspose.Cells.`Aspose.Cells` Пространство имен содержит все классы, необходимые для работы с файлами Excel, в то время как`Aspose.Cells.Xlsb` предоставляет возможность сохранения файлов в формате XLSB.
Теперь давайте разобьем процесс настройки уровня сжатия в рабочей книге на управляемые этапы.
## Шаг 1: Определите исходные и выходные каталоги
Во-первых, вам нужно указать, где находятся ваши исходные файлы и где вы хотите сохранить выходные файлы. Это важно для того, чтобы ваша программа знала, где найти файлы, с которыми ей нужно работать.
```csharp
// Исходный каталог
string sourceDir = "Your Document Directory";
string outDir = "Your Document Directory";
```
 Заменять`"Your Document Directory"` с фактическим путем к вашим каталогам. Это поможет программе найти файлы, которые вы хотите сжать.
## Шаг 2: Загрузите рабочую книгу
Далее вы загрузите книгу, которую хотите сжать. Вот тут-то и начинается волшебство!
```csharp
Workbook workbook = new Workbook(sourceDir + "LargeSampleFile.xlsx");
```
В этой строке мы создаем новый экземпляр`Workbook` class и загрузить существующий файл Excel. Убедитесь, что имя файла совпадает с тем, что у вас в исходном каталоге.
## Шаг 3: Настройте параметры сохранения
Теперь пришло время настроить параметры сохранения. Мы установим тип сжатия для выходного файла. 
```csharp
XlsbSaveOptions options = new XlsbSaveOptions();
```
 The`XlsbSaveOptions` класс позволяет вам указывать различные параметры при сохранении вашей книги в формате XLSB, включая уровни сжатия.
## Шаг 4: Измерьте время сжатия для уровня 1
Начнем с первого уровня сжатия. Измерим, сколько времени займет сохранение книги с этим уровнем сжатия.
```csharp
options.CompressionType = OoxmlCompressionType.Level1;
var watch = Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_1_out.xlsb", options);
watch.Stop();
var elapsedMs = watch.ElapsedMilliseconds;
Console.WriteLine("Level 1 Elapsed Time: " + elapsedMs);
```
Здесь мы устанавливаем тип сжатия на Уровень 1, сохраняем книгу, а затем измеряем прошедшее время. Это дает нам представление о том, сколько времени занимает процесс.
## Шаг 5: Измерьте время сжатия для уровня 6
Далее давайте посмотрим, как работает сжатие уровня 6.
```csharp
watch = Stopwatch.StartNew();
options.CompressionType = OoxmlCompressionType.Level6;
workbook.Save(outDir + "LargeSampleFile_level_6_out.xlsb", options);
watch.Stop();
elapsedMs = watch.ElapsedMilliseconds;
Console.WriteLine("Level 6 Elapsed Time: " + elapsedMs);
```
Этот шаг аналогичен предыдущему, но мы меняем уровень сжатия на Уровень 6. Вы заметите, что необходимое время может варьироваться в зависимости от сложности рабочей книги.
## Шаг 6: Измерьте время сжатия для уровня 9
Наконец, давайте проверим производительность при самом высоком уровне сжатия.
```csharp
watch = Stopwatch.StartNew();
options.CompressionType = OoxmlCompressionType.Level9;
workbook.Save(outDir + "LargeSampleFile_level_9_out.xlsb", options);
watch.Stop();
elapsedMs = watch.ElapsedMilliseconds;
Console.WriteLine("Level 9 Elapsed Time: " + elapsedMs);
```
На этом этапе мы устанавливаем уровень сжатия на 9. Именно здесь вы обычно увидите наиболее существенное уменьшение размера файла, но обработка может занять больше времени.
## Шаг 7: Окончательный результат
После выполнения всех уровней сжатия вы можете вывести сообщение об успешном завершении процесса.
```csharp
Console.WriteLine("AdjustCompressionLevel executed successfully.");
```
Эта простая строка кода подтверждает, что ваша программа завершила выполнение без каких-либо сбоев.
## Заключение
Настройка уровня сжатия ваших рабочих книг с помощью Aspose.Cells for .NET — это простой процесс, который может привести к значительным преимуществам с точки зрения размера файла и производительности. Следуя шагам, описанным в этом руководстве, вы сможете легко реализовать сжатие в своих приложениях и повысить эффективность управления файлами Excel.
## Часто задаваемые вопросы
### Что такое Aspose.Cells?  
Aspose.Cells — это мощная библиотека для .NET, которая позволяет разработчикам создавать, обрабатывать и конвертировать файлы Excel без необходимости использования Microsoft Excel.
### Как установить Aspose.Cells?  
 Вы можете загрузить и установить Aspose.Cells с сайта[Сайт Aspose](https://releases.aspose.com/cells/net/).
### Какие уровни сжатия доступны?  
Aspose.Cells поддерживает несколько уровней сжатия: от уровня 1 (самое низкое сжатие) до уровня 9 (самое высокое сжатие).
### Могу ли я протестировать Aspose.Cells бесплатно?  
 Да! Вы можете получить бесплатную пробную версию Aspose.Cells[здесь](https://releases.aspose.com/).
### Где я могу найти поддержку Aspose.Cells?  
 По любым вопросам или для получения поддержки вы можете посетить форум поддержки Aspose.[здесь](https://forum.aspose.com/c/cells/9).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
