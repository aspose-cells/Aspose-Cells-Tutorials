---
"description": "Узнайте, как легко выполнять автоматическую фильтрацию строк Excel с помощью Aspose.Cells в .NET с помощью этого подробного пошагового руководства."
"linktitle": "Автофильтр начинается с Excel"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Автофильтр начинается с Excel"
"url": "/ru/net/excel-autofilter-validation/autofilter-begins-with-in-excel/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Автофильтр начинается с Excel

## Введение

Когда дело доходит до работы с данными, Excel зарекомендовал себя как приложение, к которому можно обратиться в бесчисленных отраслях и целях. Одной из его самых мощных функций является AutoFilter, который упрощает просеивание обширных наборов данных. Если вы используете Aspose.Cells для .NET, вы можете задействовать эту функциональность программно и значительно улучшить свои задачи по управлению данными. В этом руководстве мы собираемся провести вас через процесс внедрения функции, которая фильтрует строки Excel на основе того, начинаются ли они с определенной строки.

## Предпосылки

Прежде чем приступить к работе, убедитесь, что у вас выполнены следующие предварительные условия:

1. Среда разработки: Ознакомьтесь со средой разработки .NET. Это может быть Visual Studio или любая другая IDE по вашему выбору.
2. Aspose.Cells for .NET: Вам необходимо установить Aspose.Cells for .NET. Если вы еще этого не сделали, вы можете легко загрузить его [здесь](https://releases.aspose.com/cells/net/).
3. Базовые знания C#: базовые знания C# и навыки работы с библиотеками .NET помогут вам без труда освоить материал.
4. Образец данных: у вас должен быть файл Excel, желательно с именем `sourseSampleCountryNames.xlsx`, расположенный в указанном вами исходном каталоге. Этот файл будет содержать данные, которые мы будем фильтровать.
5. Лицензирование: для полной функциональности рассмотрите возможность приобретения лицензии через этот сайт. [связь](https://purchase.aspose.com/buy). Если вы хотите протестировать функции, вы можете запросить [временная лицензия](https://purchase.aspose.com/temporary-license/).

Все готово? Поехали!

## Импортные пакеты

Для начала импортируйте необходимые пространства имен в начало файла C#:

```csharp
using System.IO;
using Aspose.Cells;
using System;
```

Это импортирует основные функции Aspose.Cells вместе с базовыми системными функциями, которые мы будем использовать для взаимодействия с консолью.

Теперь, когда вы настроили среду и импортировали необходимые пакеты, давайте разберем функцию Autofilter на управляемые шаги. Мы реализуем фильтр, который извлекает строки, начинающиеся с «Ba».

## Шаг 1: Определите исходные и выходные каталоги

Для начала давайте определим, где находится наш входной файл Excel, а также где мы хотим сохранить наши отфильтрованные выходные данные:

```csharp
// Исходный каталог
string sourceDir = "Your Document Directory\\";

// Выходной каталог
string outputDir = "Your Document Directory\\";
```

Пояснение: Здесь замените `"Your Document Directory\\"` с фактическим путем к вашим каталогам. Убедитесь, что пути к каталогам заканчиваются двойной обратной косой чертой (`\\`), чтобы избежать проблем с путями.

## Шаг 2: Создание экземпляра объекта Workbook

Далее мы создадим объект Workbook, который указывает на наш файл Excel:

```csharp
// Создание объекта Workbook, содержащего образец данных
Workbook workbook = new Workbook(sourceDir + "sourseSampleCountryNames.xlsx");
```

Объяснение: Эта строка инициализирует новый экземпляр Workbook, используя указанный путь к файлу. `Workbook` класс является фундаментальным, поскольку он представляет весь файл Excel.

## Шаг 3: Доступ к первому рабочему листу

Теперь нам нужно получить доступ к конкретному рабочему листу, с которым мы хотим работать:

```csharp
// Доступ к первому листу в файле Excel
Worksheet worksheet = workbook.Worksheets[0];
```

Объяснение: `Worksheets` Коллекция позволяет нам получить доступ к отдельным листам. Использование `[0]` ссылается на первый лист в файле Excel, что обычно является обычной практикой при работе с файлом, состоящим из одного листа.

## Шаг 4: Настройка автофильтра

Вот тут и начинается волшебство! Создадим диапазон автофильтра для наших данных:

```csharp
// Создание автофильтра путем указания диапазона ячеек
worksheet.AutoFilter.Range = "A1:A18";
```

Объяснение: `AutoFilter.Range` свойство позволяет указать, какие строки фильтровать. В этом случае мы фильтруем строки в диапазоне от A1 до A18, которые, как предполагается, содержат наши данные.

## Шаг 5: Применить условие фильтра

Следующий шаг — определить условие фильтра. Мы хотим отобразить только те строки, значения первого столбца которых начинаются с «Ba»:

```csharp
// Инициализировать фильтр для строк, начинающихся со строки «Ba»
worksheet.AutoFilter.Custom(0, FilterOperatorType.BeginsWith, "Ba");
```

Объяснение: `Custom` Метод определяет нашу логику фильтрации. Первый аргумент (`0`) указывает, что мы фильтруем на основе первого столбца (A), а `FilterOperatorType.BeginsWith` задает наше условие для поиска строк, начинающихся с «Ba».

## Шаг 6: Обновите фильтр

После применения нашего условия фильтра нам нужно убедиться, что Excel обновился, чтобы отразить изменения:

```csharp
// Обновите фильтр, чтобы показать/скрыть отфильтрованные строки.
worksheet.AutoFilter.Refresh();
```

Объяснение: Эта строка вызывает обновление в AutoFilter, чтобы убедиться, что видимые строки соответствуют примененным критериям фильтра. Это похоже на нажатие кнопки обновления в Excel.

## Шаг 7: Сохраните измененный файл Excel.

Теперь пришло время сохранить внесенные нами изменения:

```csharp
// Сохранение измененного файла Excel
workbook.Save(outputDir + "outSourseSampleCountryNames.xlsx");
```

Объяснение: `Save` метод записывает измененную Workbook обратно в указанный выходной путь. Это относится к записи определенных вами фильтров в новый файл, так что ваши исходные данные остаются нетронутыми.

## Шаг 8: Подтверждение вывода

Наконец, давайте подтвердим, что наша операция прошла успешно:

```csharp
Console.WriteLine("AutofilterBeginsWith executed successfully.\r\n");
```

Пояснение: Эта простая строка выводит на консоль подтверждающее сообщение, сообщающее, что процесс фильтрации завершен без ошибок.

## Заключение

В мире, где управление данными может показаться непосильным, освоение таких функций, как AutoFilter в Excel через Aspose.Cells for .NET, позволяет вам эффективно и действенно манипулировать данными. Вы узнали, как фильтровать строки Excel, начинающиеся с «Ba», реализуя метод шаг за шагом. С практикой вы сможете адаптировать этот метод для различных нужд фильтрации данных в ваших текущих проектах.

## Часто задаваемые вопросы

### Какова цель автофильтра в Excel?  
Автофильтр позволяет пользователям быстро сортировать и фильтровать данные в электронной таблице, что позволяет легко сосредоточиться на определенных наборах данных.

### Можно ли фильтровать данные по нескольким критериям с помощью Aspose.Cells?  
Да, Aspose.Cells поддерживает расширенные параметры фильтрации, которые позволяют задавать несколько критериев.

### Нужна ли мне лицензия на Aspose.Cells для использования?  
Хотя вы можете начать с бесплатной пробной версии, для полной функциональности и снятия любых ограничений пробной версии требуется лицензия.

### Какие типы фильтрации можно выполнять с помощью Aspose.Cells?  
Вы можете фильтровать данные по значению, условию (например, начинается с или заканчивается на), а также настраивать фильтрацию в соответствии с вашими конкретными требованиями.

### Где я могу найти более подробную информацию об Aspose.Cells для .NET?  
Вы можете проверить документацию [здесь](https://reference.aspose.com/cells/net/).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}