---
title: Разрешить пользователям редактировать диапазоны на рабочем листе с помощью Aspose.Cells
linktitle: Разрешить пользователям редактировать диапазоны на рабочем листе с помощью Aspose.Cells
second_title: API обработки Excel Aspose.Cells .NET
description: Научитесь создавать редактируемые диапазоны в рабочих листах Excel с помощью Aspose.Cells для .NET, позволяя редактировать определенные ячейки и обеспечивая защиту остальных ячеек с помощью защиты рабочих листов.
weight: 10
url: /ru/net/worksheet-security/allow-edit-ranges/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Разрешить пользователям редактировать диапазоны на рабочем листе с помощью Aspose.Cells

## Введение
Документы Excel часто содержат конфиденциальные данные или структурированный контент, которые вы хотите защитить от нежелательного редактирования. Однако могут быть определенные ячейки или диапазоны, которые вы хотите сделать редактируемыми для определенных пользователей. Вот где Aspose.Cells для .NET выступает в качестве мощного инструмента, который позволяет вам защитить весь рабочий лист, при этом предоставляя разрешения на редактирование для определенных диапазонов. Представьте себе, что вы делитесь таблицей бюджета, в которой только определенные ячейки доступны для редактирования, а другие остаются защищенными — Aspose.Cells делает это легко и эффективно.
## Предпосылки
Прежде чем приступить к написанию кода, давайте убедимся, что у вас есть все необходимое:
-  Aspose.Cells for .NET: Убедитесь, что у вас установлена библиотека Aspose.Cells for .NET. Вы можете загрузить ее[здесь](https://releases.aspose.com/cells/net/).
- Среда разработки: Visual Studio или любая совместимая с C# IDE.
- .NET Framework: версия 4.0 или более поздняя.
- Лицензия: Рассмотрите возможность получения лицензии, чтобы избежать ограничений пробной версии. Вы можете получить[временная лицензия здесь](https://purchase.aspose.com/temporary-license/).
## Импортные пакеты
Обязательно включите необходимое пространство имен Aspose.Cells в начало кода:
```csharp
using System.IO;
using Aspose.Cells;
```
Это гарантирует, что вы сможете получить доступ ко всем классам и методам, необходимым для настройки защищенных диапазонов в файлах Excel.
Теперь, когда основа заложена, давайте подробно рассмотрим код, шаг за шагом.
## Шаг 1: Настройте каталог
Перед работой с файлами вам необходимо настроить каталог, в котором вы сохраните файл Excel. Это гарантирует, что ваши файлы будут хорошо организованы и надежно сохранены.
```csharp
// Определите путь к каталогу ваших документов
string dataDir = "Your Document Directory";
// Проверьте, существует ли каталог, если нет, создайте его.
bool isExists = Directory.Exists(dataDir);
if (!isExists)
{
    Directory.CreateDirectory(dataDir);
}
```
Эта часть кода гарантирует, что ваш каталог готов к файловым операциям. Думайте об этом как о закладке фундамента для всего, что последует.
## Шаг 2: Инициализация рабочей книги и рабочего листа
Теперь давайте перейдем к созданию новой рабочей книги и получению доступа к ее рабочему листу по умолчанию.
```csharp
// Инициализировать новую рабочую книгу
Workbook book = new Workbook();
// Доступ к первому рабочему листу в рабочей книге
Worksheet sheet = book.Worksheets[0];
```
Здесь мы инициализируем книгу Excel и выбираем первый лист в ней. Этот лист будет холстом, на котором мы применим наши настройки защиты и определим редактируемые диапазоны.
## Шаг 3: Доступ к коллекции «Разрешить редактирование диапазонов»
 Aspose.Cells имеет функцию, которая называется`AllowEditRanges`, представляющий собой набор диапазонов, которые можно редактировать, даже если рабочий лист защищен.
```csharp
// Доступ к коллекции «Разрешить редактирование диапазонов»
ProtectedRangeCollection allowRanges = sheet.AllowEditRanges;
```
Эта строка устанавливает доступ к специальной коллекции диапазонов, которые можно редактировать. Думайте об этом как о «VIP»-области на вашем рабочем листе, где только определенным диапазонам разрешено обходить защиту.
## Шаг 4: Определите и создайте защищенный диапазон
Теперь давайте определим и создадим защищенный диапазон на нашем листе. Укажем начальную и конечную ячейки для этого диапазона.
```csharp
// Определить переменную ProtectedRange
ProtectedRange protectedRange;
// Добавить новый диапазон в коллекцию с определенным именем и позициями ячеек
int idx = allowRanges.Add("EditableRange", 1, 1, 3, 3);
protectedRange = allowRanges[idx];
```
В этом блоке кода:
- `EditableRange` — имя, присвоенное диапазону.
- Числа (1, 1, 3, 3) определяют координаты диапазона, то есть он начинается от ячейки B2 (строка 1, столбец 1) и заканчивается ячейкой D4 (строка 3, столбец 3).
## Шаг 5: Установите пароль для защищенного диапазона
Для дополнительной безопасности вы можете установить пароль для защищенного диапазона. Этот шаг добавляет дополнительный уровень защиты, чтобы гарантировать, что только авторизованные пользователи могут редактировать диапазон.
```csharp
// Установите пароль для редактируемого диапазона
protectedRange.Password = "123";
```
Здесь мы добавили пароль (`"123"`) в защищенный диапазон. Это требование пароля обеспечивает дополнительный уровень контроля над тем, кто может вносить изменения.
## Шаг 6: Защитите рабочий лист
После того, как наш редактируемый диапазон установлен, следующим шагом будет защита всего листа. Эта настройка защиты гарантирует, что все ячейки за пределами определенного диапазона будут заблокированы и не будут доступны для редактирования.
```csharp
// Применить защиту к рабочему листу, сделав все остальные ячейки нередактируемыми.
sheet.Protect(ProtectionType.All);
```
 The`Protect`Метод блокирует весь рабочий лист, за исключением диапазонов, которые мы определили как редактируемые. Этот шаг по сути создает безопасную среду «только для чтения» с доступом к определенным ячейкам по мере необходимости.
## Шаг 7: Сохраните рабочую книгу
Последний шаг — сохранить книгу, чтобы ваши настройки были применены и сохранены.
```csharp
// Сохраните файл Excel в указанном каталоге.
book.Save(dataDir + "protectedrange.out.xls");
```
На этом этапе мы сохраняем нашу рабочую книгу как «protectedrange.out.xls» в каталоге, который мы создали на этапе 1. Теперь у вас есть полностью функциональный, безопасный файл Excel, в котором можно редактировать только определенные диапазоны!
## Заключение
Aspose.Cells for .NET предоставляет отличный способ управления защитой и разрешениями в файлах Excel. Создавая редактируемые диапазоны, вы можете защитить свои рабочие листы, при этом оставляя доступными определенные области. Эта функция особенно полезна для совместных документов, где только несколько ячеек должны быть открыты для редактирования, а другие должны оставаться заблокированными.
## Часто задаваемые вопросы
### Можно ли добавить на рабочий лист несколько редактируемых диапазонов?
Да, вы можете добавить несколько диапазонов, просто повторив`allowRanges.Add()` метод для каждого нового диапазона.
### Что делать, если я захочу удалить защищенный диапазон позже?
 Используйте`allowRanges.RemoveAt()` метод с индексом диапазона, который вы хотите удалить.
### Могу ли я установить разные пароли для каждого диапазона?
 Конечно. Каждый`ProtectedRange` может иметь свой собственный уникальный пароль, предоставляя вам точный контроль.
### Что произойдет, если я защищу рабочий лист без каких-либо редактируемых диапазонов?
Если не определить редактируемые диапазоны, весь рабочий лист будет нередактируемым после защиты.
### Виден ли защищенный диапазон другим пользователям?
Нет, защита внутренняя. Пользователям будет предложено ввести пароль только в случае попытки редактирования защищенной области.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
