---
title: Защита строк на рабочем листе с помощью Aspose.Cells
linktitle: Защита строк на рабочем листе с помощью Aspose.Cells
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как защитить строки в таблице Excel с помощью Aspose.Cells для .NET. Защитите свои данные с помощью защиты на уровне строк и предотвратите случайные изменения.
weight: 18
url: /ru/net/worksheet-security/protect-rows/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Защита строк на рабочем листе с помощью Aspose.Cells

## Введение
Работа с файлами Excel программным способом часто является задачей, которая требует не только манипулирования данными, но и их защиты. Независимо от того, нужно ли вам защитить конфиденциальные данные или предотвратить случайное редактирование, защита строк на листе может стать решающим шагом. В этом руководстве мы рассмотрим, как защитить определенные строки на листе Excel с помощью Aspose.Cells для .NET. Мы пройдем все необходимые шаги, от подготовки вашей среды до реализации функций защиты простым и понятным способом.
## Предпосылки
Прежде чем вы сможете приступить к защите строк на рабочем листе, вам необходимо выполнить несколько действий:
1.  Aspose.Cells for .NET: Убедитесь, что Aspose.Cells for .NET установлен на вашей машине разработки. Если вы еще этого не сделали, вы можете легко загрузить его с[Страница загрузки Aspose Cells](https://releases.aspose.com/cells/net/).
2. Visual Studio или любая .NET IDE: для реализации решения вам необходимо настроить среду разработки. Visual Studio — отличный вариант, но подойдет любая совместимая с .NET IDE.
3. Базовые знания C#: понимание основ программирования на C# поможет вам следовать руководству и изменять код примеров в соответствии со своими потребностями.
4.  Документация API Aspose.Cells: ознакомьтесь с[Документация Aspose.Cells для .NET](https://reference.aspose.com/cells/net/) чтобы получить обзор структуры классов и методов, используемых в библиотеке.
Если у вас все необходимые условия выполнены, мы можем приступить непосредственно к реализации.
## Импортные пакеты
Для начала вам нужно импортировать требуемые пакеты. Эти библиотеки имеют решающее значение для взаимодействия с файлами Excel в вашем проекте C#.
```csharp
using System.IO;
using Aspose.Cells;
```
Импортировав необходимые пакеты, можно приступать к кодированию. 
Теперь давайте разобьем процесс на более мелкие шаги, чтобы вам было очень легко следовать ему. Каждый шаг будет сосредоточен на определенной части внедрения, гарантируя, что вы сможете быстро понять и применить его. 
## Шаг 1: Создайте новую рабочую книгу и рабочий лист
Прежде чем вы сможете применить какие-либо настройки защиты, вам нужно создать новую рабочую книгу и выбрать рабочий лист, с которым вы хотите работать. Это будет ваш рабочий документ.
```csharp
// Путь к каталогу документов.
string dataDir = "Your Document Directory";
// Создайте каталог, если его еще нет.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
	System.IO.Directory.CreateDirectory(dataDir);
// Создайте новую рабочую книгу.
Workbook wb = new Workbook();
// Создайте объект рабочего листа и получите первый лист.
Worksheet sheet = wb.Worksheets[0];
```
В этом примере мы создаем новую книгу с одним рабочим листом (что является настройкой по умолчанию при создании новой книги с помощью Aspose.Cells). Затем мы берем первый рабочий лист в книге, который будет целью для нашей защиты строк.
## Шаг 2: Определение объектов Style и StyleFlag
Следующий шаг — определение объектов стиля и флага стиля. Эти объекты позволяют изменять свойства ячейки, например, заблокирована она или разблокирована.
```csharp
// Определите объект стиля.
Style style;
// Определите объект styleflag.
StyleFlag flag;
```
Эти объекты понадобятся вам на последующих этапах для настройки свойств ячеек и применения их к рабочему листу.
## Шаг 3: Разблокируйте все столбцы на рабочем листе.
По умолчанию все ячейки на листе Excel заблокированы. Однако при защите листа заблокированный статус применяется принудительно. Чтобы гарантировать защиту только определенных строк или ячеек, можно сначала разблокировать все столбцы. Этот шаг необходим, если вы хотите защитить только определенные строки.
```csharp
// Пройдитесь по всем столбцам на рабочем листе и разблокируйте их.
for (int i = 0; i <= 255; i++)
{
    style = sheet.Cells.Columns[(byte)i].Style;
    style.IsLocked = false;
    flag = new StyleFlag();
    flag.Locked = true;
    sheet.Cells.Columns[(byte)i].ApplyStyle(style, flag);
}
```
 В этом коде мы просматриваем все 256 столбцов на листе (листы Excel имеют максимум 256 столбцов, проиндексированных от 0 до 255) и устанавливаем их`IsLocked` собственность`false`. Это действие гарантирует, что все столбцы будут разблокированы, но мы все равно заблокируем определенные строки позже.
## Шаг 4: Закрепите первый ряд.
После разблокировки столбцов следующим шагом будет блокировка определенных строк, которые вы хотите защитить. В этом примере мы заблокируем первую строку. Это гарантирует, что пользователи не смогут ее изменять, пока другие строки остаются разблокированными.
```csharp
//Получите стиль первой строки.
style = sheet.Cells.Rows[0].Style;
// Заприте его.
style.IsLocked = true;
//Создайте флаг.
flag = new StyleFlag();
// Установите настройки блокировки.
flag.Locked = true;
// Примените стиль к первой строке.
sheet.Cells.ApplyRowStyle(0, style, flag);
```
Здесь мы получаем доступ к стилю первой строки и задаем его`IsLocked` собственность`true` . После этого мы используем`ApplyRowStyle()` метод для применения стиля блокировки ко всей строке. Вы можете повторить этот шаг, чтобы заблокировать любые другие строки, которые вы хотите защитить.
## Шаг 5: Защитите лист
Теперь, когда мы разблокировали и заблокировали необходимые строки, пришло время защитить рабочий лист. Защита гарантирует, что никто не сможет изменить заблокированные строки или ячейки, если только он не снимет пароль защиты (если он был предоставлен).
```csharp
// Защитите лист.
sheet.Protect(ProtectionType.All);
```
 На этом этапе мы применяем защиту ко всему листу с помощью`ProtectionType.All`. Этот тип защиты означает, что все аспекты листа, включая заблокированные строки и ячейки, защищены. Вы также можете настроить эту защиту, указав различные типы защиты, если это необходимо.
## Шаг 6: Сохраните рабочую книгу
Наконец, нам нужно сохранить книгу после применения необходимых стилей и защиты. Книга может быть сохранена в различных форматах, таких как Excel 97-2003, Excel 2010 и т. д.
```csharp
// Сохраните файл Excel.
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```
Эта строка кода сохраняет книгу в формате Excel 97-2003 с внесенными изменениями. Вы можете изменить формат файла в соответствии с вашими потребностями, выбрав из множества`SaveFormat` параметры.
## Заключение
И вот оно! Вы успешно узнали, как защитить строки в рабочем листе с помощью Aspose.Cells для .NET. Выполнив шаги выше, вы можете разблокировать или заблокировать любые строки или столбцы по мере необходимости и применить защиту для обеспечения целостности ваших данных.
## Часто задаваемые вопросы
### Как защитить несколько строк одновременно?  
 Вы можете пройти по нескольким строкам и применить стиль блокировки к каждой из них по отдельности. Просто замените`0` с индексом строки, которую вы хотите заблокировать.
### Могу ли я установить пароль для защиты листа?  
 Да! Вы можете передать пароль`sheet.Protect()` метод обеспечения защиты паролем.
### Можно ли разблокировать ячейки, а не целые столбцы?  
Да! Вместо разблокировки столбцов вы можете разблокировать отдельные ячейки, изменив их свойства стиля.
### Что произойдет, если я попытаюсь отредактировать защищенную строку?  
Если строка защищена, Excel не позволит вносить какие-либо изменения в заблокированные ячейки, пока вы не снимете защиту листа.
### Могу ли я защитить определенные диапазоны подряд?  
 Да! Вы можете заблокировать отдельные диапазоны в строке, установив`IsLocked` свойство для определенных ячеек в диапазоне.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
