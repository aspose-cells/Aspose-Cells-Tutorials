---
"description": "Узнайте, как задать данные категории в диаграммах Excel с помощью Aspose.Cells для .NET. Следуйте нашему пошаговому руководству для легкой реализации."
"linktitle": "Настройка данных категории"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Настройка данных категории"
"url": "/ru/net/advanced-chart-operations/setting-category-data/"
"weight": 15
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Настройка данных категории

## Введение

Когда дело доходит до программного управления и манипуляции файлами Excel, наличие правильных инструментов может иметь решающее значение. Aspose.Cells для .NET выделяется как один из таких инструментов, позволяя разработчикам создавать, редактировать и конвертировать файлы Excel без усилий. Независимо от того, создаете ли вы сложное приложение для анализа данных или просто хотите автоматизировать создание отчетов, Aspose.Cells вам поможет. 

## Предпосылки 

Прежде чем углубиться в подробности, давайте убедимся, что у вас есть все необходимое:

1. Среда разработки: Убедитесь, что у вас настроена среда разработки .NET. Рекомендуется Visual Studio.
2. Библиотека Aspose.Cells for .NET: Загрузите последнюю версию библиотеки с сайта [Страница загрузки Aspose.Cells](https://releases.aspose.com/cells/net/).
3. Базовое понимание C#: знакомство с концепциями C# и Excel поможет вам более легко усвоить материал.
4. Доступ к документации: Имея доступ к [Документация Aspose.Cells](https://reference.aspose.com/cells/net/) может предоставить дополнительную информацию, если вы застрянете. 

Теперь, когда все готово, давайте шаг за шагом откроем магию работы с Excel.

## Импортные пакеты 

Прежде чем начать кодирование, крайне важно импортировать необходимые пакеты. Это позволяет нам получить доступ к функциональным возможностям, предоставляемым Aspose.Cells.

## Шаг 1: Импорт пространства имен

Для начала давайте импортируем пространство имен Aspose.Cells в ваш файл C#.

```csharp
using System;
using System.IO;
using Aspose.Cells;
```

Добавив эту строку в начало файла, вы получите доступ ко всем соответствующим классам и методам в библиотеке Aspose.Cells.

Теперь, когда мы знакомы с предварительными условиями и импортировали необходимую библиотеку, давайте рассмотрим, как задать данные категорий в диаграмме Excel.

## Шаг 2: Определите выходной каталог

Сначала вам нужно указать, где будет сохранен файл Excel. Создайте переменную для вашего выходного каталога. 

```csharp
string outputDir = "Your Output Directory";
```

Заменять `"Your Output Directory"` с фактическим путем к месту, где вы хотите сохранить ваш выходной файл Excel. Это гарантирует, что вы точно знаете, где найти ваш готовый продукт!

## Шаг 3: Создание экземпляра объекта Workbook

Далее вы создадите новый экземпляр объекта Workbook. Этот объект служит контейнером для вашего файла Excel.

```csharp
Workbook workbook = new Workbook();
```

## Шаг 4: Доступ к первому рабочему листу

Вам нужно будет работать с первым рабочим листом в рабочей книге. Доступ к рабочему листу так же прост, как:

```csharp
Worksheet worksheet = workbook.Worksheets[0];
```

Индекс `0` указывает на первый рабочий лист. В Excel это можно сравнить с открытием первой вкладки в рабочей книге.

## Шаг 5: Добавление выборочных значений в ячейки

Давайте заполним некоторые данные для работы. Вы можете добавить числовые значения в первые два столбца. 

```csharp
worksheet.Cells["A1"].PutValue(10);
worksheet.Cells["A2"].PutValue(100);
worksheet.Cells["A3"].PutValue(170);
worksheet.Cells["A4"].PutValue(200);
worksheet.Cells["B1"].PutValue(120);
worksheet.Cells["B2"].PutValue(320);
worksheet.Cells["B3"].PutValue(50);
worksheet.Cells["B4"].PutValue(40);
```

В этом фрагменте мы заполняем строки A1–A4 различными числовыми значениями и заполняем также столбцы B1–B4. Эти данные послужат основой для нашей диаграммы.

## Шаг 6: Добавление данных категории

Теперь давайте обозначим категории наших данных. Это делается в третьем столбце (столбец C):

```csharp
worksheet.Cells["C1"].PutValue("Q1");
worksheet.Cells["C2"].PutValue("Q2");
worksheet.Cells["C3"].PutValue("Y1");
worksheet.Cells["C4"].PutValue("Y2");
```

Здесь мы обозначаем каждый набор данных категориями, такими как «Q1» и «Y1», что упрощает интерпретацию нашей диаграммы в дальнейшем.

## Создание диаграммы

Имея все данные на своем месте, мы готовы добавить диаграмму для их визуального представления.

## Шаг 7: Добавление диаграммы на рабочий лист

Теперь давайте добавим на рабочий лист диаграмму типа «Столбец».

```csharp
int chartIndex = worksheet.Charts.Add(Aspose.Cells.Charts.ChartType.Column, 5, 0, 15, 5);
```

Эта строка создает новую столбчатую диаграмму, начинающуюся со строки 5 и столбца 0 рабочего листа.

## Шаг 8: Доступ к экземпляру диаграммы

Прежде чем заполнить диаграмму данными, нам необходимо получить доступ к экземпляру только что созданной диаграммы:

```csharp
Aspose.Cells.Charts.Chart chart = worksheet.Charts[chartIndex];
```

На этом шаге мы полностью готовы добавить ряд данных на диаграмму.

## Шаг 9: Добавление ряда данных в диаграмму

Далее вы добавите коллекцию серий, которая определяет данные, которые будет отображать диаграмма. 

```csharp
chart.NSeries.Add("A1:B4", true);
```

Эта строка указывает, что диаграмма должна содержать данные из диапазонов A1–B4, что позволяет визуально отображать эти значения.

## Шаг 10: Установка данных категории

Вот и наступает решающая часть — определение наших данных категории. Это то, что маркирует наши точки данных на оси x.

```csharp
chart.NSeries.CategoryData = "C1:C4";
```

Назначая этот диапазон, мы сообщаем диаграмме, какие ячейки соответствуют категориям в нашем ряду данных. Без этого шага ваша диаграмма была бы просто набором чисел!

## Шаг 11: Сохранение файла Excel

Когда все готово, пришло время сохранить результаты нашей тяжелой работы. 

```csharp
workbook.Save(outputDir + "outputSettingCategoryData.xlsx");
```

Эта команда сохраняет вашу рабочую книгу в указанном выходном каталоге под именем «outputSettingCategoryData.xlsx». 

## Шаг 12: Подтверждающее сообщение

Наконец, мы можем добавить небольшой отзыв, чтобы подтвердить, что все прошло гладко:

```csharp
Console.WriteLine("SettingCategoryData executed successfully.");
```

Это выводит сообщение в консоль, давая вам знать, что процесс завершен. Просто, не правда ли?

## Заключение

И вот оно! Вы успешно установили данные категории для диаграммы в книге Excel с помощью Aspose.Cells for .NET. Прелесть этого подхода заключается в том, что он позволяет автоматизировать манипуляции с файлами Excel без установки Excel на вашем компьютере. 

## Часто задаваемые вопросы

### Что такое Aspose.Cells?
Aspose.Cells — это библиотека .NET для управления файлами Excel без необходимости использования Microsoft Excel. Она позволяет программно создавать, редактировать и конвертировать документы Excel.

### Могу ли я использовать Aspose.Cells бесплатно?
Да, вы можете попробовать Aspose.Cells бесплатно. Они предлагают бесплатную пробную версию [здесь](https://releases.aspose.com/).

### Подходит ли Aspose.Cells для больших наборов данных?
Конечно! Aspose.Cells разработан для эффективной обработки больших наборов данных, что делает его надежным выбором для приложений с интенсивным использованием данных.

### Как добавить диаграммы с помощью Aspose.Cells?
Вы можете добавлять диаграммы, создав новый объект диаграммы и связав его с диапазонами ячеек, содержащими ваши данные, как показано в этом руководстве.

### Где я могу найти больше примеров использования Aspose.Cells?
Вы можете изучить больше примеров и подробную документацию на сайте [Страница документации Aspose.Cells](https://reference.aspose.com/cells/net/).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}