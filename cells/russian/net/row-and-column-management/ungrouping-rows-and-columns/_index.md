---
"description": "Узнайте, как разгруппировать строки и столбцы в Excel с помощью Aspose.Cells для .NET с помощью этого всеобъемлющего руководства. Упростите манипуляции с данными Excel."
"linktitle": "Разгруппируйте строки и столбцы в Excel с помощью Aspose.Cells"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Разгруппируйте строки и столбцы в Excel с помощью Aspose.Cells"
"url": "/ru/net/row-and-column-management/ungrouping-rows-and-columns/"
"weight": 15
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Разгруппируйте строки и столбцы в Excel с помощью Aspose.Cells

## Введение
При работе с файлами Excel вы можете оказаться в ситуациях, когда вам нужно разгруппировать строки и столбцы. Независимо от того, очищаете ли вы электронную таблицу или переформатируете данные для лучшего представления, Aspose.Cells для .NET — это фантастический инструмент, который упрощает этот процесс. В этом руководстве я проведу вас через шаги по разгруппировке строк и столбцов в Excel с помощью Aspose.Cells. К концу вы будете иметь четкое представление о том, как работать с файлами Excel программно.
## Предпосылки
Прежде чем погрузиться в код, давайте убедимся, что у вас все настроено. Вот что вам понадобится:
1. Visual Studio: На вашем компьютере должна быть установлена рабочая версия Visual Studio. Если у вас ее еще нет, вы можете загрузить ее с [Сайт Visual Studio](https://visualstudio.microsoft.com/).
2. Aspose.Cells для .NET: Вам нужно будет скачать библиотеку Aspose.Cells. Вы можете взять ее с [Страница релизов Aspose](https://releases.aspose.com/cells/net/)Убедитесь, что у вас есть необходимые лицензии, которые можно приобрести или получить через [временная лицензия](https://purchase.aspose.com/temporary-license/).
3. Базовые знания C#: базовые знания программирования на C# помогут вам легче усваивать материал.
Как только все будет готово, мы можем перейти к самой интересной части: коду!
## Импортные пакеты
Для начала вам нужно импортировать необходимые пакеты в ваш проект C#. Вот как это сделать:
1. Откройте свой проект в Visual Studio.
2. Добавьте ссылку на библиотеку Aspose.Cells. Это можно сделать, щелкнув правой кнопкой мыши по References в вашем проекте и выбрав Add Reference. Перейдите к месту, где вы сохранили Aspose.Cells DLL.
3. В верхней части файла C# добавьте следующие директивы using:
```csharp
using System.IO;
using Aspose.Cells;
```
Теперь, когда все настроено, давайте рассмотрим шаги по разгруппировке строк и столбцов на листе Excel. 
## Шаг 1: Определите каталог документов
Сначала вам нужно указать каталог, в котором находится ваш файл Excel. Вы можете настроить это следующим образом:
```csharp
// Путь к каталогу документов.
string dataDir = "Your Document Directory";
```
Заменять `"Your Document Directory"` фактическим путем на вашем компьютере, где сохранен файл Excel. 
## Шаг 2: Создание потока файлов
Далее вам нужно создать файловый поток для открытия файла Excel. Вот как это можно сделать:
```csharp
// Создание файлового потока, содержащего файл Excel, который необходимо открыть
FileStream fstream = new FileStream(dataDir + "book1.xls", FileMode.Open);
```
Здесь вы открываете файл с именем `book1.xls`. Убедитесь, что этот файл существует в указанном вами каталоге, иначе вы столкнетесь с ошибкой «Файл не найден».
## Шаг 3: Создание экземпляра объекта Workbook
Теперь загрузим файл Excel в объект Workbook. Это позволит вам программно манипулировать рабочей книгой:
```csharp
// Создание объекта Workbook
// Открытие файла Excel через файловый поток
Workbook workbook = new Workbook(fstream);
```
С помощью этой строки кода вы успешно загрузили файл Excel в память и готовы к работе с ним.
## Шаг 4: Доступ к рабочему листу
После того, как у вас есть рабочая книга, следующим шагом будет доступ к определенному рабочему листу, где вы хотите разгруппировать строки и столбцы. Вот как это сделать:
```csharp
// Доступ к первому листу в файле Excel
Worksheet worksheet = workbook.Worksheets[0];
```
В этом случае мы получаем доступ к первому листу. Если ваши данные находятся на другом листе, вы можете изменить индекс соответствующим образом.
## Шаг 5: Разгруппируйте строки
А теперь самое интересное! Давайте разгруппируем первые шесть строк (от строки 0 до строки 5). Используйте следующий код:
```csharp
// Разгруппируем первые шесть строк (от 0 до 5)
worksheet.Cells.UngroupRows(0, 5);
```
Этот метод удаляет любую группировку, которая была применена к указанным строкам. Это так просто!
## Шаг 6: Разгруппируйте столбцы
Как и строки, вы можете разгруппировать столбцы. Вот как разгруппировать первые три столбца (от столбца 0 до столбца 2):
```csharp
// Разгруппировка первых трех столбцов (от 0 до 2)
worksheet.Cells.UngroupColumns(0, 2);
```
## Шаг 7: Сохраните измененный файл Excel.
После того, как вы разгруппировали строки и столбцы, следующим шагом будет сохранение изменений обратно в файл Excel. Вы можете сделать это с помощью `Save` метод:
```csharp
// Сохранение измененного файла Excel
workbook.Save(dataDir + "output.xls");
```
В этом примере мы сохраняем измененный файл как `output.xls`. Вы можете изменить имя файла на любое другое по вашему желанию.
## Шаг 8: Закройте поток файлов
Наконец, чтобы освободить ресурсы, следует закрыть файловый поток:
```csharp
// Закрытие потока файлов для освобождения всех ресурсов
fstream.Close();
```
Это хорошая практика, позволяющая гарантировать, что ваше приложение не будет удерживать дескрипторы файлов дольше, чем это необходимо.
## Заключение
И вот оно! Вы успешно научились разгруппировывать строки и столбцы в файле Excel с помощью Aspose.Cells for .NET. С помощью всего нескольких строк кода вы можете вносить значительные изменения в файлы Excel программным путем. Независимо от того, автоматизируете ли вы отчеты или готовите данные для анализа, освоение этих методов может сэкономить вам массу времени.
## Часто задаваемые вопросы
### Что такое Aspose.Cells?
Aspose.Cells — мощная библиотека для работы с файлами Excel в приложениях .NET, позволяющая легко манипулировать, преобразовывать и создавать электронные таблицы.
### Можно ли разгруппировать строки и столбцы в Excel, используя другие библиотеки?
Да, существуют и другие библиотеки для работы с Excel в .NET, но Aspose.Cells предлагает обширные возможности и простоту использования.
### Есть ли способ отменить изменения после сохранения?
После сохранения файла Excel предыдущее состояние невозможно восстановить, если у вас нет резервной копии исходного файла.
### Как получить поддержку по Aspose.Cells?
Вы можете найти поддержку, посетив [Форум поддержки Aspose](https://forum.aspose.com/c/cells/9), где вы можете задать вопросы и найти решения.
### Могу ли я использовать Aspose.Cells без лицензии?
Да, вы можете использовать Aspose.Cells бесплатно с определенными ограничениями, и вы можете начать с [временная лицензия](https://purchase.aspose.com/temporary-license/) для полной функциональности.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}