---
"description": "Узнайте, как настроить верхние и нижние колонтитулы на листах Excel с помощью Aspose.Cells для .NET с помощью пошагового руководства, практических примеров и полезных советов."
"linktitle": "Реализовать верхний и нижний колонтитулы на рабочем листе"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Реализовать верхний и нижний колонтитулы на рабочем листе"
"url": "/ru/net/worksheet-page-setup-features/implement-header-and-footer/"
"weight": 22
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Реализовать верхний и нижний колонтитулы на рабочем листе

## Введение

При работе с таблицами Excel верхние и нижние колонтитулы играют ключевую роль в предоставлении важной контекстной информации, такой как имена файлов, даты или номера страниц, вашей аудитории. Независимо от того, автоматизируете ли вы отчеты или создаете динамические файлы, Aspose.Cells for .NET упрощает программную настройку верхних и нижних колонтитулов в рабочих листах. Это руководство погружает в комплексный пошаговый подход к добавлению верхних и нижних колонтитулов с помощью Aspose.Cells for .NET, придавая вашим файлам Excel дополнительный блеск и профессионализм.

## Предпосылки

Прежде чем начать, убедитесь, что у вас есть следующее:

1. Aspose.Cells для .NET: вам потребуется установить Aspose.Cells для .NET. [Загрузить здесь](https://releases.aspose.com/cells/net/).
2. Настройка IDE: Visual Studio (или предпочитаемая вами IDE) с установленным .NET Framework.
3. Лицензия: Вы можете начать работу с бесплатной пробной версией, но получение полной или временной лицензии раскроет весь потенциал Aspose.Cells. [Получить временную лицензию](https://purchase.aspose.com/temporary-license/).

Документация по Aspose.Cells — удобный ресурс для справки в этом процессе. Вы можете найти ее [здесь](https://reference.aspose.com/cells/net/).

## Импорт пакетов

В вашем проекте импортируйте необходимые пространства имен:

```csharp
using System.IO;
using Aspose.Cells;
using System;
```

Импортировав этот пакет, вы получите доступ к классам и методам, необходимым для работы с верхними и нижними колонтитулами и другими функциями Excel в Aspose.Cells.

В этом руководстве мы подробно разберем каждый шаг, чтобы вы могли легко разобраться, даже если вы новичок в Aspose.Cells или .NET.

## Шаг 1: Настройте рабочую книгу и параметры страницы

Сначала самое главное: создайте новую книгу и получите доступ к настройкам страницы листа. Это даст вам инструменты, необходимые для изменения верхнего и нижнего колонтитула листа.

```csharp
// Определите путь для сохранения вашего документа
string dataDir = "Your Document Directory";

// Создать экземпляр объекта Workbook
Workbook excel = new Workbook();
```

Здесь мы создали `Workbook` объект, который представляет наш файл Excel. `PageSetup` рабочего листа, где мы можем изменить параметры верхнего и нижнего колонтитула.


## Шаг 2: Доступ к свойствам рабочего листа и параметров страницы

В Aspose.Cells каждый рабочий лист имеет `PageSetup` свойство, которое управляет функциями макета, включая заголовки и нижние колонтитулы. Давайте получим `PageSetup` объект для нашего рабочего листа.

```csharp
// Получите ссылку на PageSetup первого рабочего листа.
PageSetup pageSetup = excel.Worksheets[0].PageSetup;
```

С этим, `pageSetup` теперь содержит все параметры, необходимые для настройки верхних и нижних колонтитулов.


## Шаг 3: Установка левой части заголовка

Заголовки в Excel делятся на три секции: левую, центральную и правую. Начнем с настройки левой секции для отображения имени листа.

```csharp
// Установить имя рабочего листа в левой части заголовка
pageSetup.SetHeader(0, "&A");
```

С использованием `&A` позволяет динамически отображать имя листа. Это особенно полезно, если в рабочей книге несколько листов и вы хотите, чтобы каждый заголовок отражал название листа.


## Шаг 4: Добавьте дату и время в центр заголовка.

Далее добавим текущую дату и время в центральную часть заголовка. Кроме того, мы будем использовать пользовательский шрифт для стилизации.

```csharp
// Установите дату и время в центральной части заголовка жирным шрифтом.
pageSetup.SetHeader(1, "&\"Times New Roman,Bold\"&D-&T");
```

В этом коде:
- `&D` вставляет текущую дату.
- `&T` вставляет текущее время.
- `"Times New Roman,Bold"` к этим элементам применяется полужирный шрифт Times New Roman.


## Шаг 5: Отображение имени файла в правой части заголовка

Чтобы завершить заголовок, давайте отобразим имя файла с правой стороны, а также настроим шрифт.

```csharp
// Отображение имени файла в правой части заголовка с пользовательским размером шрифта
pageSetup.SetHeader(2, "&\"Times New Roman,Bold\"&12&F");
```

- `&F` представляет собой имя файла, позволяющее понять, к какому файлу относятся распечатанные страницы.
- `&12` изменяет размер шрифта на 12 для этого раздела.


## Шаг 6: Добавьте текст с пользовательским шрифтом в раздел левого нижнего колонтитула

Переходим к нижним колонтитулам! Начнем с настройки левого нижнего колонтитула с пользовательским текстом и заданным стилем шрифта.

```csharp
// Добавьте пользовательский текст со стилем шрифта в левую часть нижнего колонтитула.
pageSetup.SetFooter(0, "Hello World! &\"Courier New\"&14 123");
```

The `&\"Courier New\"&14` Настройка в приведенном выше коде применяет шрифт «Courier New» размером 14 к указанному тексту (`123`). Остальной текст остается набранным шрифтом нижнего колонтитула по умолчанию.


## Шаг 7: Вставьте номер страницы в центр нижнего колонтитула.

Включение номеров страниц в нижний колонтитул — отличный способ помочь читателям отслеживать многостраничные документы.

```csharp
// Вставьте номер страницы в центральную часть нижнего колонтитула.
pageSetup.SetFooter(1, "&P");
```

Здесь, `&P` добавляет текущий номер страницы в центральную часть нижнего колонтитула. Это небольшая деталь, но она имеет решающее значение для профессионально выглядящих документов.


## Шаг 8: Отобразите общее количество страниц в правом нижнем колонтитуле

Наконец, давайте завершим нижний колонтитул, отобразив общее количество страниц в правой части.

```csharp
// Отображение общего количества страниц в правой части нижнего колонтитула.
pageSetup.SetFooter(2, "&N");
```

- `&N` указывается общее количество страниц, позволяя читателям узнать объем документа.


## Шаг 9: Сохраните рабочую книгу

После настройки верхних и нижних колонтитулов пришло время сохранить книгу. Это последний шаг для создания файла Excel с полностью настроенными верхними и нижними колонтитулами.

```csharp
// Сохранить рабочую книгу
excel.Save(dataDir + "SetHeadersAndFooters_out.xls");
```

Эта строка сохраняет файл в указанном вами каталоге с указанными вами верхними и нижними колонтитулами.


## Заключение

Добавление верхних и нижних колонтитулов в рабочие листы Excel — ценный навык для создания организованных профессиональных документов. С Aspose.Cells for .NET вы получаете полный контроль над верхними и нижними колонтитулами файлов Excel, от отображения имени рабочего листа до вставки пользовательского текста, даты, времени и даже динамических номеров страниц. Теперь, когда вы увидели каждый шаг в действии, вы можете вывести автоматизацию Excel на новый уровень.

## Часто задаваемые вопросы

### Можно ли использовать разные шрифты для разных разделов верхних и нижних колонтитулов?  
Да, Aspose.Cells для .NET позволяет указывать шрифты для каждого раздела верхнего и нижнего колонтитула с помощью специальных тегов шрифтов.

### Как удалить верхние и нижние колонтитулы?  
Вы можете очистить верхние и нижние колонтитулы, установив текст верхнего или нижнего колонтитула на пустую строку с помощью `SetHeader` или `SetFooter`.

### Можно ли вставлять изображения в верхние или нижние колонтитулы с помощью Aspose.Cells для .NET?  
В настоящее время Aspose.Cells в основном поддерживает текст в верхних и нижних колонтитулах. Для изображений может потребоваться обходной путь, например, вставка изображений в сам рабочий лист.

### Поддерживает ли Aspose.Cells динамические данные в верхних и нижних колонтитулах?  
Да, вы можете использовать различные динамические коды (например, `&D` на дату или `&P` для номера страницы) для добавления динамического контента.

### Как настроить высоту верхнего или нижнего колонтитула?  
Aspose.Cells предоставляет возможности в пределах `PageSetup` класс для настройки полей верхнего и нижнего колонтитула, предоставляя вам контроль над интервалами.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}