---
title: Вставить изображение в верхний и нижний колонтитулы рабочего листа
linktitle: Вставить изображение в верхний и нижний колонтитулы рабочего листа
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как легко вставить изображение в верхний/нижний колонтитул с помощью Aspose.Cells для .NET в этом подробном руководстве.
weight: 15
url: /ru/net/worksheet-page-setup-features/insert-image-in-header-footer/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Вставить изображение в верхний и нижний колонтитулы рабочего листа

## Введение
Когда дело доходит до создания профессионально выглядящих таблиц Excel, маленькие детали могут иметь огромное значение. Одной из таких деталей является добавление изображений в верхний или нижний колонтитул ваших рабочих листов. Это верный способ брендировать ваши документы и придать им оттенок профессионализма. Хотя это может показаться сложным, особенно если вы не являетесь техническим гением, использование Aspose.Cells для .NET значительно упрощает процесс. Итак, давайте погрузимся и узнаем, как сделать это шаг за шагом!
## Предпосылки
Прежде чем приступить к вставке изображений в разделы верхнего и нижнего колонтитула, убедитесь, что у вас есть несколько вещей:
1. Visual Studio: Убедитесь, что на вашем компьютере установлена Visual Studio. Эта IDE — мощный инструмент для разработки .NET.
2.  Aspose.Cells для .NET: вы можете получить бесплатную пробную версию или купить ее, если вы серьезно настроены максимально использовать возможности Excel. Загрузить[здесь](https://releases.aspose.com/cells/net/).
3. Базовые знания C#: базовые знания C# и того, как запустить приложение .NET, будут полезны.
4. Файл изображения: Подготовьте файл изображения, например, логотип компании. В этом примере мы будем называть его`aspose-logo.jpg`.
## Импортные пакеты
Чтобы начать наше путешествие по кодированию, убедитесь, что у вас есть необходимые пакеты, импортированные в ваш проект C#. Вам нужно пространство имен Aspose.Cells, которое содержит все классы и методы, с которыми вы будете работать.
Вот как включить его в свой код:
```csharp
using System.IO;
using Aspose.Cells;
using System;
```
Теперь, когда у нас все готово, давайте рассмотрим процесс с помощью простых шагов.
## Шаг 1: Настройте свой каталог
Определите, где будут храниться ваши файлы.
 Во-первых, нам нужно указать путь к нашему каталогу документов, где находятся файл Excel и изображение. Вы можете указать любой путь, просто замените`"Your Document Directory"` с вашим фактическим путем к каталогу.
```csharp
string dataDir = "Your Document Directory";
```
## Шаг 2: Создание объекта рабочей книги
Создайте экземпляр вашей книги Excel.
Установив путь, нам теперь нужно создать новый экземпляр рабочего листа, куда мы будем вставлять наше изображение. 
```csharp
Workbook workbook = new Workbook();
```
## Шаг 3: Загрузите изображение
Откройте и прочитайте файл изображения, преобразуя его в массив байтов для обработки.
Далее мы зададим путь для нашего изображения (в данном случае логотипа) и инициализируем`FileStream` объект для чтения изображения. Вот как это сделать:
```csharp
string logo_url = dataDir + "aspose-logo.jpg";
// Объявление объекта FileStream
FileStream inFile;
byte[] binaryData;
// Создание экземпляра объекта FileStream
inFile = new FileStream(logo_url, FileMode.Open, FileAccess.Read);
```
## Шаг 4: Считывание изображения в массив байтов
Преобразовать данные файла изображения в массив байтов.
Для работы с изображением нам необходимо считать его в массив байтов. Это важно, поскольку позволяет нам манипулировать изображением в приложении.
```csharp
// Создание экземпляра байтового массива размера объекта FileStream
binaryData = new byte[inFile.Length];
// Считывает блок байтов из потока и записывает данные в заданный буфер массива байтов.
long bytesRead = inFile.Read(binaryData, 0, (int)inFile.Length);
```
## Шаг 5: Настройте параметры страницы для верхнего/нижнего колонтитула
Получите доступ к объекту PageSetup для управления разделами верхнего и нижнего колонтитула.
Чтобы вставить наше изображение, нам нужно настроить объект настройки страницы. Это позволяет нам настроить заголовок нашего рабочего листа:
```csharp
PageSetup pageSetup = workbook.Worksheets[0].PageSetup;
```
## Шаг 6: Вставьте логотип в заголовок
Вставьте изображение в заголовок рабочего листа.
Вот он, волшебный момент! В центральную часть заголовка мы вставим наш логотип:
```csharp
// Разместите логотип/картинку в центральной части заголовка страницы.
pageSetup.SetHeaderPicture(1, binaryData);
// Установить скрипт для логотипа/картинки
pageSetup.SetHeader(1, "&G");
// Установите имя листа в правой части заголовка страницы с помощью скрипта.
pageSetup.SetHeader(2, "&A");
```
## Шаг 7: Сохраните свою рабочую книгу
Сохраните изменения в новом файле Excel.
После настройки всего, пришло время сохранить нашу рабочую книгу. Не забудьте указать новое имя для вашего выходного файла:
```csharp
workbook.Save(dataDir + "InsertImageInHeaderFooter_out.xls");
```
## Шаг 8: Очистите ресурсы
Закройте FileStream, чтобы освободить ресурсы.
 Наконец, после всех манипуляций не забудьте убраться, закрыв`FileStream`!
```csharp
inFile.Close();
```
## Заключение
И вот оно! Вы успешно вставили изображение в верхний/нижний колонтитул листа Excel с помощью Aspose.Cells for .NET. Это просто, не так ли? Как только вы поймете шаги, вы сможете настроить его дальше в соответствии со своими конкретными потребностями. Независимо от того, хотите ли вы брендировать отчеты для своего бизнеса или просто добавить персональный штрих, этот метод невероятно полезен. 
## Часто задаваемые вопросы
### Могу ли я использовать любой формат изображения?
Да, Aspose.Cells поддерживает различные форматы изображений, включая JPEG, PNG и BMP для изображений верхнего и нижнего колонтитула.
### Можно ли использовать Aspose.Cells бесплатно?
 Aspose.Cells предлагает бесплатную пробную версию, но для дальнейшего использования вам необходимо приобрести лицензию. Узнайте больше о ценах[здесь](https://purchase.aspose.com/buy).
### Как получить доступ к документации Aspose.Cells?
 Вы можете подробно изучить возможности и функции Aspose.Cells, посетив[документация](https://reference.aspose.com/cells/net/).
### Могу ли я использовать Aspose.Cells без Visual Studio?
Да, если у вас есть среда выполнения .NET, вы можете использовать Aspose.Cells в любой среде разработки, совместимой с .NET.
### Что делать, если у меня возникнут проблемы?
 Если у вас возникли какие-либо проблемы или вам нужна поддержка, проверьте[Форум поддержки Aspose](https://forum.aspose.com/c/cells/9) за помощь от сообщества и разработчиков.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
