---
"description": "Узнайте, как управлять внешними ресурсами в Excel с помощью Aspose.Cells для .NET, из нашего подробного пошагового руководства."
"linktitle": "Управление внешними ресурсами с помощью настройки рабочей книги"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Управление внешними ресурсами с помощью настройки рабочей книги"
"url": "/ru/net/workbook-settings/control-external-resources/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Управление внешними ресурсами с помощью настройки рабочей книги

## Введение
В сфере обработки и представления данных эффективное управление внешними ресурсами может стать решающим фактором. Если вы работаете с файлами Excel и хотите беспрепятственно управлять внешними ресурсами с помощью Aspose.Cells for .NET, вы попали по адресу! В этой статье мы подробно рассмотрим управление внешними ресурсами при работе с книгами Excel. К концу этого руководства вы сможете реализовать индивидуальное решение для загрузки изображений и данных из внешних источников без особых усилий.
## Предпосылки
Прежде чем мы перейдем к тонкостям кодирования, вам необходимо выполнить несколько предварительных условий. Убедитесь, что вы:
1. Иметь Visual Studio: Вам понадобится IDE для написания и тестирования ваших .NET-приложений. Visual Studio — наиболее рекомендуемый вариант из-за его обширной поддержки и простоты использования.
2. Загрузите Aspose.Cells для .NET: если вы еще этого не сделали, скачайте библиотеку Aspose.Cells с сайта [ссылка для скачивания](https://releases.aspose.com/cells/net/). 
3. Базовые знания C#: знакомство с концепциями C# и .NET Framework упростит для вас процесс.
4. Настройте свою среду: убедитесь, что ваш проект ссылается на библиотеку Aspose.Cells. Это можно сделать через диспетчер пакетов NuGet в Visual Studio.
5. Образцы файлов: Подготовьте образец файла Excel, который включает внешний ресурс, например, связанное изображение. Этот файл поможет продемонстрировать функциональные возможности, которые мы обсуждаем.
После настройки вы будете готовы приступить к управлению внешними ресурсами с помощью Aspose.Cells.
## Импортные пакеты
Чтобы начать кодирование, вам нужно импортировать необходимые пакеты в ваш файл C#. Вот что вам нужно:
```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using Aspose.Cells.Rendering;
using System.Drawing.Imaging;
```
Эти пространства имен обеспечивают доступ к функциям, необходимым для работы с файлами Excel и изображениями.
Давайте разберем это на выполнимые шаги, которые помогут вам контролировать внешние ресурсы с помощью `Workbook Settings`Мы пройдем через создание пользовательского поставщика потока, загрузку файла Excel и рендеринг рабочего листа в изображение. Не стесняйтесь следовать за нами!
## Шаг 1: Определите исходные и выходные каталоги
Для начала нам нужно указать каталоги, из которых мы будем читать наши файлы и где мы будем сохранять наш вывод. Важно задать правильные пути, чтобы избежать ошибок «файл не найден».
```csharp
// Исходный каталог
static string sourceDir = "Your Document Directory";
// Выходной каталог
static string outputDir = "Your Document Directory";
```
Заменять `"Your Document Directory"` с фактическим путем расположения ваших файлов.
## Шаг 2: Реализация интерфейса IStreamProvider
Далее мы создадим пользовательский класс, реализующий `IStreamProvider` интерфейс. Этот класс будет управлять доступом к внешним ресурсам (например, изображениям).
```csharp
class SP : IStreamProvider
{
    public void CloseStream(StreamProviderOptions options)
    {
        // При необходимости очистите любые ресурсы.
    }
    public void InitStream(StreamProviderOptions options)
    {
        // Открыть поток файлов внешнего ресурса
        FileStream fi = new FileStream(sourceDir + "sampleControlExternalResourcesUsingWorkbookSetting_StreamProvider.png", FileMode.OpenOrCreate, FileAccess.Read);
        options.Stream = fi;
    }
}
```
В `InitStream` Методом мы открываем файл, который выступает в качестве нашего внешнего ресурса, и назначаем его `Stream` свойство. Это позволяет рабочей книге получить доступ к ресурсу при рендеринге.
## Шаг 3: Загрузите файл Excel
Теперь, когда у нас готов поставщик потока, давайте загрузим книгу Excel, содержащую внешний ресурс.
```csharp
public static void Run()
{
    // Загрузить образец файла Excel
    Workbook wb = new Workbook(sourceDir + "sampleControlExternalResourcesUsingWorkbookSetting_StreamProvider.xlsx");
    
    // Предоставьте свою реализацию IStreamProvider
    wb.Settings.StreamProvider = new SP();
```
В этом фрагменте мы загружаем наш файл Excel и назначаем наш пользовательский `StreamProvider` реализация для обработки внешних ресурсов.
## Шаг 4: Доступ к рабочему листу
После загрузки рабочей книги мы можем легко получить доступ к нужному рабочему листу. Давайте возьмем первый.
```csharp
    // Доступ к первому рабочему листу
    Worksheet ws = wb.Worksheets[0];
```
Это просто, не правда ли? Вы можете получить доступ к любому листу, указав его индекс.
## Шаг 5: Настройте параметры изображения или печати
Теперь мы определим, как должно выглядеть выходное изображение. Мы настроим такие параметры, как обеспечение одной страницы для каждого листа и указание типа выходного изображения.
```csharp
    // Укажите параметры изображения или печати
    ImageOrPrintOptions opts = new ImageOrPrintOptions();
    opts.OnePagePerSheet = true;
    opts.ImageType = Drawing.ImageType.Png;
```
Выбор PNG в качестве выходного формата гарантирует четкость и ясность изображения!
## Шаг 6: Преобразование рабочего листа в изображение
Когда все готово, давайте преобразуем выбранный нами рабочий лист в файл изображения! Это самая захватывающая часть: вы увидите, как ваш лист Excel преобразуется в прекрасное изображение.
```csharp
    // Создать рендер листа, передав необходимые параметры
    SheetRender sr = new SheetRender(ws, opts);
    // Конвертируйте весь рабочий лист в изображение png
    sr.ToImage(0, outputDir + "outputControlExternalResourcesUsingWorkbookSetting_StreamProvider.png");
    
    Console.WriteLine("ControlExternalResourcesUsingWorkbookSetting_StreamProvider executed successfully.");
}
```
The `ToImage` функция выполняет всю тяжелую работу, преобразуя лист в изображение. После завершения этого шага вы найдете изображение, сохраненное в вашем выходном каталоге.
## Заключение
И вот оно! Теперь вы владеете ноу-хау для управления внешними ресурсами при работе с файлами Excel с помощью Aspose.Cells в .NET. Это не только расширяет возможности вашего приложения, но и делает обработку наборов данных и презентаций легкой прогулкой. Следуя приведенным шагам, вы сможете легко воспроизвести и адаптировать эту функциональность в соответствии с конкретными потребностями вашего проекта.
## Часто задаваемые вопросы
### Что такое Aspose.Cells?
Aspose.Cells — это мощная библиотека, разработанная для разработчиков C# и .NET, позволяющая создавать, изменять и управлять файлами Excel без необходимости установки Microsoft Excel.
### Как загрузить Aspose.Cells для .NET?
Вы можете скачать его с сайта [Сайт Aspose](https://releases.aspose.com/cells/net/).
### Есть ли бесплатная пробная версия?
Да! Вы можете получить доступ к бесплатной пробной версии Aspose.Cells из их [страница релиза](https://releases.aspose.com/).
### Какие типы файлов поддерживает Aspose.Cells?
Aspose.Cells поддерживает различные форматы Excel, включая XLS, XLSX, CSV и другие.
### Где я могу найти поддержку Aspose.Cells?
Вы можете посетить форум поддержки Aspose по адресу [Форум Aspose](https://forum.aspose.com/c/cells/9) за помощь.


{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}