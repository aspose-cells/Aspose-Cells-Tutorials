---
title: Поворот текста с помощью фигуры в Excel
linktitle: Поворот текста с помощью фигуры в Excel
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как вращать текст с фигурами в Excel с помощью Aspose.Cells для .NET. Следуйте этому пошаговому руководству для идеальной презентации Excel.
weight: 12
url: /ru/net/excel-shape-text-modifications/rotate-text-shape-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Поворот текста с помощью фигуры в Excel

## Введение
В мире Excel визуальное представление так же важно, как и сами данные. Независимо от того, создаете ли вы отчет или проектируете динамическую панель мониторинга, способ размещения информации может существенно повлиять на ее читаемость и общий вид. Итак, вы когда-нибудь хотели повернуть текст, чтобы стильно выровнять его с фигурами? Вам повезло! В этом уроке мы углубимся в то, как повернуть текст с фигурами с помощью Aspose.Cells для .NET, гарантируя, что ваши электронные таблицы не только информируют, но и впечатляют.
## Предпосылки
Прежде чем начать, давайте убедимся, что у вас есть все необходимое:
1. Visual Studio: Убедитесь, что на вашем компьютере установлена Visual Studio, так как именно там мы будем писать код.
2.  Aspose.Cells для .NET: Вам понадобится библиотека Aspose.Cells. Вы можете[скачать последнюю версию здесь](https://releases.aspose.com/cells/net/) или попробуйте бесплатно с[бесплатная пробная версия](https://releases.aspose.com/).
3. Базовые знания C#: знакомство с C# и средой .NET будет полезным, хотя мы будем сопровождать вас на каждом этапе пути.
4.  Файл Excel: пример файла Excel, назовем его`sampleRotateTextWithShapeInsideWorksheet.xlsx`, необходим для тестирования нашего кода. Вам следует поместить этот файл в каталог, к которому вы сможете легко получить доступ.
Все готово? Фантастика! Давайте перейдем к самому интересному.
## Импортные пакеты
Чтобы начать, нам нужно импортировать необходимые пакеты в наш проект. Вот как это сделать:
### Создать новый проект
1. Откройте Visual Studio.
2. Выберите «Создать новый проект».
3. Выберите «Консольное приложение» и выберите C# в качестве предпочитаемого языка программирования.
### Установить Aspose.Cells
Теперь давайте добавим Aspose.Cells в ваш проект. Вы можете сделать это с помощью NuGet Package Manager:
1. Откройте «Инструменты» в верхнем меню.
2. Выберите «Диспетчер пакетов NuGet», а затем «Управление пакетами NuGet для решения».
3. Найдите «Aspose.Cells».
4. Нажмите «Установить», чтобы добавить его в свой проект.
### Добавить директиву using
В верхней части основного файла C# необходимо добавить следующую директиву:
```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Aspose.Cells.Drawing;
```
Теперь мы готовы приступить к кодированию!
Давайте разобьем процесс на легко усваиваемые шаги. Вот как повернуть текст с помощью фигур в файле Excel:
## Шаг 1: Настройте пути к каталогам
Сначала вам нужно настроить исходные и выходные каталоги, где будут храниться ваши файлы Excel. Вот как:
```csharp
//Исходный каталог
string sourceDir = "Your Document Directory"; // Установите каталог документов
//Выходной каталог
string outputDir = "Your Document Directory"; // Установите выходной каталог
```
 Заменять`"Your Document Directory"` с фактическим путем, где ваш`sampleRotateTextWithShapeInsideWorksheet.xlsx` файл находится .
## Шаг 2: Загрузите образец файла Excel
Теперь давайте загрузим образец файла Excel. Это важно, так как мы хотим манипулировать существующими данными.
```csharp
//Загрузите образец файла Excel.
Workbook wb = new Workbook(sourceDir + "sampleRotateTextWithShapeInsideWorksheet.xlsx");
```
## Шаг 3: Доступ к рабочему листу
После загрузки файла нам нужно получить доступ к конкретному рабочему листу, который мы хотим изменить. В нашем случае это первый рабочий лист.
```csharp
//Откройте первый рабочий лист.
Worksheet ws = wb.Worksheets[0];
```
## Шаг 4: Измените ячейку
Далее мы изменим определенную ячейку для отображения сообщения. В нашем примере мы будем использовать ячейку B4.
```csharp
//Откройте ячейку B4 и добавьте в нее сообщение.
Cell b4 = ws.Cells["B4"];
b4.PutValue("Text is not rotating with shape because RotateTextWithShape is false.");
```
Этот шаг целиком посвящен общению — необходимо, чтобы тот, кто откроет этот лист, понял, что мы вносим изменения.
## Шаг 5: Получите доступ к первой форме
Чтобы повернуть текст, нам нужна фигура для работы. Здесь мы получим доступ к первой фигуре на рабочем листе.
```csharp
//Доступ к первой форме.
Shape sh = ws.Shapes[0];
```
## Шаг 6: Настройте выравнивание текста фигуры
Вот тут-то и происходит волшебство. Мы настроим свойства выравнивания текста фигуры.
```csharp
//Доступ к выравниванию текста формы.
Aspose.Cells.Drawing.Texts.ShapeTextAlignment shapeTextAlignment = sh.TextBody.TextAlignment;
//Не вращайте текст вместе с фигурой, установив RotateTextWithShape как false.
shapeTextAlignment.RotateTextWithShape = false;
```
 Установив`RotateTextWithShape` при значении false мы гарантируем, что текст останется вертикальным и не будет вращаться вместе с формой, тем самым сохраняя аккуратность и организованность.
## Шаг 7: Сохраните выходной файл Excel
Наконец, давайте сохраним наши изменения в новом файле Excel. Это гарантирует, что мы не потеряем наши правки и получим аккуратный вывод.
```csharp
//Сохраните выходной файл Excel.
wb.Save(outputDir + "outputRotateTextWithShapeInsideWorksheet.xlsx");
```
Вот и все! Ваш выходной файл теперь сохранен, включая текст в ячейке B4 и изменения, внесенные в форму.
## Шаг 8: Выполните код
 В вашем`Main` метод, оберните все вышеприведенные фрагменты кода и запустите свой проект. Посмотрите, как изменения отразятся в вашем выходном файле!
```csharp
Console.WriteLine("RotateTextWithShapeInsideWorksheet executed successfully.");
```
## Заключение
Поворот текста с фигурами в Excel с помощью Aspose.Cells для .NET может показаться сложным процессом на первый взгляд, но это довольно просто, если разобраться. Выполнив эти простые шаги, вы сможете настроить свои электронные таблицы так, чтобы они выглядели более профессионально и визуально привлекательно. Теперь, делаете ли вы это для клиента или для своих личных проектов, все будут в восторге от качества вашей работы!
## Часто задаваемые вопросы
### Могу ли я использовать Aspose.Cells бесплатно?
 Да! Вы можете использовать[бесплатная пробная версия](https://releases.aspose.com/) чтобы опробовать библиотеку.
### Какие версии Excel поддерживает Aspose.Cells?
Aspose.Cells поддерживает множество форматов Excel, включая XLS, XLSX, CSV и другие.
### Можно ли вращать текст с фигурами в старых версиях Excel?
Да, эту функциональность можно применить к старым форматам, поддерживаемым Aspose.Cells.
### Где я могу найти более подробную документацию по Aspose.Cells?
 Вы можете изучить всеобъемлющую[документация](https://reference.aspose.com/cells/net/) для более подробной информации.
### Как получить поддержку по Aspose.Cells?
 Вы можете обратиться за поддержкой, посетив[Форум Aspose](https://forum.aspose.com/c/cells/9).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
