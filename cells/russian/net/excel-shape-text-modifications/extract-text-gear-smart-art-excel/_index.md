---
"description": "Узнайте, как извлечь текст из SmartArt типа шестеренки в Excel с помощью Aspose.Cells для .NET. Пошаговое руководство и пример кода включены."
"linktitle": "Извлечение текста из смарт-арта Gear Type в Excel"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Извлечение текста из смарт-арта Gear Type в Excel"
"url": "/ru/net/excel-shape-text-modifications/extract-text-gear-smart-art-excel/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Извлечение текста из смарт-арта Gear Type в Excel

## Введение
При работе с Excel вы можете столкнуться с графикой SmartArt, которая помогает донести ваши сообщения визуально привлекательным способом. Среди этой графики SmartArt в виде шестеренок является фаворитом за его иерархические и направленные потоки, часто используемые в управлении проектами или моделировании систем. Но что, если вам нужно извлечь текст из этих фигур программным путем? Вот где Aspose.Cells for .NET пригодится! В этой записи блога мы проведем вас через пошаговое руководство по извлечению текста из фигур SmartArt в виде шестеренок в Excel с помощью Aspose.Cells for .NET.
## Предпосылки
Прежде чем мы погрузимся, есть некоторые существенные предпосылки, которые вам нужно иметь на месте. Не волнуйтесь, это просто, и я проведу вас через это.
### Среда .NET
Убедитесь, что на вашем компьютере установлена среда разработки .NET. Это может быть Visual Studio или любая IDE по вашему выбору, которая поддерживает разработку .NET.
### Aspose.Cells для .NET
Далее вам нужно будет установить библиотеку Aspose.Cells. Это мощный инструмент, который позволит вам легко манипулировать файлами Excel. Вы можете загрузить его с [Страница релизов Aspose](https://releases.aspose.com/cells/net/). Если вы хотите сначала изучить его, воспользуйтесь [бесплатная пробная версия](https://releases.aspose.com/).
### Базовые знания C#
Базовое понимание программирования на C# — это как раз то, что вам нужно для прохождения этого урока. Если вы новичок, не волнуйтесь — я разработаю шаги так, чтобы они были максимально понятны новичкам.
### Образец файла Excel
Для этого урока вам также понадобится файл-образец Excel, содержащий фигуры SmartArt в виде шестеренок. Вы можете легко создать ее или найти шаблон в Интернете. Просто убедитесь, что SmartArt включает хотя бы одну фигуру в виде шестеренок.
## Импортные пакеты
Чтобы начать кодирование, вам нужно импортировать необходимые пакеты. Вот как это сделать:
### Создать новый проект
1. Откройте .NET IDE.
2. Создайте новый проект. Например, выберите «Консольное приложение» в параметрах .NET.
3. Дайте своему проекту имя и установите желаемый фреймворк. 
### Добавить ссылки
Чтобы использовать Aspose.Cells, вам необходимо добавить ссылки на библиотеки в свой проект:
1. Щелкните правой кнопкой мыши по названию вашего проекта в обозревателе решений.
2. Выберите «Управление пакетами NuGet».
3. Найдите «Aspose.Cells» и установите его.
После установки все готово к написанию кода!
```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```
Теперь давайте разберем код, который вы будете использовать для извлечения текста. Мы сделаем это шаг за шагом.
## Шаг 1: Настройте исходный каталог
Начните с определения каталога, в котором находится ваш файл Excel:
```csharp
// Исходный каталог
string sourceDir = "Your Document Directory";
```
Обязательно замените `"Your Document Directory"` с фактическим путем к вашему файлу Excel.
## Шаг 2: Загрузите книгу Excel
Далее мы загрузим книгу Excel. Вот как мы можем получить доступ к ее содержимому:
```csharp
// Загрузите пример файла Excel, содержащего интеллектуальную художественную фигуру типа шестеренки.
Workbook wb = new Workbook(sourceDir + "sampleExtractTextFromGearTypeSmartArtShape.xlsx");
```
Этот фрагмент загрузит ваш пример рабочей книги Excel.
## Шаг 3: Получите доступ к первому рабочему листу
Теперь, когда мы загрузили рабочую книгу, давайте перейдем к первому листу, на котором находится наш SmartArt:
```csharp
// Откройте первый рабочий лист.
Worksheet ws = wb.Worksheets[0];
```
Это извлекает первый рабочий лист для дальнейших манипуляций.
## Шаг 4: Получите доступ к первой форме
Далее нам нужно получить доступ к первой фигуре на нашем рабочем листе. Сделав это, мы сможем перемещаться по нашим графикам SmartArt:
```csharp
// Доступ к первой форме.
Aspose.Cells.Drawing.Shape sh = ws.Shapes[0];
```
Здесь мы сосредоточимся на первой фигуре, которая, как мы предполагаем, является нужным нам SmartArt.
## Шаг 5: Получите форму группы
Как только у нас есть форма, пришло время получить результат нашего представления SmartArt:
```csharp
// Получите результат умной художественной формы типа шестеренки в виде групповой формы.
Aspose.Cells.Drawing.GroupShape gs = sh.GetResultOfSmartArt();
```
Это позволит получить наш SmartArt в виде шестеренки в виде сгруппированной фигуры.
## Шаг 6: Извлечение отдельных фигур
Теперь давайте извлечем отдельные фигуры, составляющие наш SmartArt:
```csharp
// Получить список отдельных фигур, входящих в состав групповой фигуры.
Aspose.Cells.Drawing.Shape[] shps = gs.GetGroupedShapes();
```
Этот массив будет содержать все отдельные фигуры, которые нам нужно будет перебрать.
## Шаг 7: Извлечение и печать текста
Наконец, мы можем выполнить цикл по нашему массиву фигур и извлечь текст из любой фигуры типа шестеренки:
```csharp
// Извлеките текст фигур типа шестеренок и выведите его на консоль.
for (int i = 0; i < shps.Length; i++)
{
    Aspose.Cells.Drawing.Shape s = shps[i];
    if (s.Type == Aspose.Cells.Drawing.AutoShapeType.Gear9 || s.Type == Aspose.Cells.Drawing.AutoShapeType.Gear6)
    {
        Console.WriteLine("Gear Type Shape Text: " + s.Text);
    }
}
```
В этом цикле мы проверяем тип фигуры и печатаем текст, если это фигура типа шестеренки.
## Шаг 8: Подтверждение выполнения
Наконец, вы можете добавить подтверждающее сообщение после успешного завершения процесса:
```csharp
Console.WriteLine("ExtractTextFromGearTypeSmartArtShape executed successfully.");
```
На этом извлечение завершено, и вы должны увидеть текстовый вывод в консоли!
## Заключение
Поздравляем! Вы только что узнали, как извлекать текст из фигур SmartArt в виде шестеренок в Excel с помощью Aspose.Cells для .NET. Этот удобный метод открывает двери для автоматизации отчетов или документации, которые опираются на визуальное представление данных. Независимо от того, являетесь ли вы опытным разработчиком или только начинаете, контроль и извлечение информации из SmartArt может оптимизировать ваш рабочий процесс и сделать вас более эффективными. Не забудьте изучить подробные [Документация Aspose.Cells](https://reference.aspose.com/cells/net/) для дополнительных возможностей.
## Часто задаваемые вопросы
### Что такое Aspose.Cells?
Aspose.Cells — это библиотека .NET, которая позволяет разработчикам легко создавать и обрабатывать файлы Excel.
### Могу ли я использовать Aspose.Cells с другими языками?
Да! Aspose.Cells доступен на нескольких языках программирования, включая Java и Python.
### Нужно ли мне приобретать Aspose.Cells для .NET?
Aspose.Cells предлагает бесплатную пробную версию, но для длительного использования требуется покупка. Вы можете найти варианты покупки [здесь](https://purchase.aspose.com/buy).
### Доступна ли поддержка для пользователей Aspose.Cells?
Конечно! Вы можете найти поддержку сообщества на [Форум Aspose.Cells](https://forum.aspose.com/c/cells/9).
### Можно ли извлечь другие типы SmartArt с помощью этого метода?
Да, с небольшими изменениями вы можете извлекать текст из различных фигур SmartArt, изменяя условия в своем коде.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}