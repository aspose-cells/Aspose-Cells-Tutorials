---
title: Используйте анонимные типы с интеллектуальными маркерами Aspose.Cells
linktitle: Используйте анонимные типы с интеллектуальными маркерами Aspose.Cells
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как использовать анонимные типы с интеллектуальными маркерами в Aspose.Cells для динамической генерации отчетов Excel в .NET. Следуйте нашему простому руководству.
weight: 17
url: /ru/net/smart-markers-dynamic-data/use-anonymous-types-smart-markers/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Используйте анонимные типы с интеллектуальными маркерами Aspose.Cells

## Введение
Когда дело доходит до создания динамических отчетов Excel в приложениях .NET, Aspose.Cells выделяется как мощный инструмент. Одной из его лучших функций является возможность работы с интеллектуальными маркерами и анонимными типами. Если вы новичок в этой концепции, не волнуйтесь! Это руководство разложит все, что вам нужно знать, от предпосылок до практических примеров, и при этом оно будет интересным и простым для понимания.
## Предпосылки
Прежде чем углубляться в код, давайте убедимся, что у вас есть все необходимое для бесперебойной работы примеров из этого руководства.
### 1. Среда .NET
Убедитесь, что на вашем локальном компьютере установлена работающая среда .NET. Вы можете использовать Visual Studio или любую другую IDE по вашему выбору.
### 2. Библиотека Aspose.Cells
 Вам понадобится библиотека Aspose.Cells. Если вы ее еще не скачали, вы можете легко ее найти[здесь](https://releases.aspose.com/cells/net/) . Вы также можете попробовать его с бесплатной пробной версией, доступной по адресу[эта ссылка](https://releases.aspose.com/).
### 3. Базовые знания C#
Фундаментальное понимание программирования на C# поможет вам легче ориентироваться в учебнике. Если такие термины, как классы, объекты и свойства вам знакомы, то вы готовы!
## Импортные пакеты
Чтобы использовать библиотеку Aspose.Cells в вашем проекте, вы должны импортировать соответствующие пространства имен. Добавьте следующие директивы using в начало вашего файла C#:
```csharp
using System.IO;
using Aspose.Cells;
using System.Collections.Generic;
```
Эти пространства имен предоставят вам доступ ко всем необходимым классам и методам, которые будут рассмотрены позже.
Теперь давайте перейдем к сути урока! Вы увидите, как создать файл Excel с умными маркерами, используя пользовательский класс. Не волнуйтесь, мы разобьем все на управляемые шаги!
## Шаг 1: Создание пользовательского класса
Для начала нам нужен простой класс для представления данных, которые мы хотим добавить в наш файл Excel. Этот класс будет содержать информацию о человеке.
```csharp
public class Person
{
    private string m_Name;
    private int m_Age;
    public string Name
    {
        get { return m_Name; }
        set { m_Name = value; }
    }
    public int Age
    {
        get { return m_Age; }
        set { m_Age = value; }
    }
    internal Person(string name, int age)
    {
        this.m_Name = name;
        this.m_Age = age;
    }
}
```
 Здесь мы определяем класс, называемый`Person` с двумя объектами недвижимости,`Name` и`Age`. Конструктор инициализирует эти свойства. 
## Шаг 2: Настройка конструктора рабочих книг
 Далее давайте создадим экземпляр`WorkbookDesigner`класс, который мы будем использовать для создания нашего файла Excel с помощью интеллектуальных маркеров.
```csharp
// Путь к каталогу документов.
string dataDir = "Your Document Directory";
// Создайте экземпляр объекта конструктора рабочей книги.
WorkbookDesigner report = new WorkbookDesigner();
```
 Заменять`"Your Document Directory"` на ваш фактический путь к файлу, где вы хотите сохранить файл Excel.`WorkbookDesigner` класс — это сердце этой операции, в котором вы определяете свой шаблон.
## Шаг 3: Добавьте маркеры в ячейки
Теперь нам нужно добавить на рабочий лист смарт-маркеры. Эти маркеры будут заполнителями для данных, которые мы введем позже.
```csharp
// Возьмите первый рабочий лист в рабочей тетради.
Aspose.Cells.Worksheet sheet = report.Workbook.Worksheets[0];
// Введите несколько маркеров в ячейки.
sheet.Cells["A1"].PutValue("Name");
sheet.Cells["B1"].PutValue("Age");
sheet.Cells["A2"].PutValue("&=MyProduct.Name");
sheet.Cells["B2"].PutValue("&=MyProduct.Age");
```
 Мы назначаем первый рабочий лист и устанавливаем значения для ячеек заголовка. Умные маркеры имеют префикс`&=` что сообщает Aspose, что это заполнители для данных, которые будут вставлены позже.
## Шаг 4: Составьте список людей
 Теперь давайте создадим список людей, использующих наш`Person` класс, который мы будем использовать для заполнения умных маркеров.
```csharp
// Создайте коллекцию списков на основе пользовательского класса.
IList<Person> list = new List<Person>();
// Укажите значения для маркеров, используя объект пользовательского класса.
list.Add(new Person("Simon", 30));
list.Add(new Person("Johnson", 33));
```
 Мы создаем список и добавляем экземпляры`Person`к нему. Этот список служит нам источником данных при заполнении шаблона Excel.
## Шаг 5: Установка источника данных и маркеров процесса
 После того, как наш список готов, нам нужно установить его в качестве источника данных для нашего`WorkbookDesigner` экземпляр и затем обработать маркеры.
```csharp
// Установите источник данных.
report.SetDataSource("MyProduct", list);
// Обработайте маркеры.
report.Process(false);
```
 The`SetDataSource` Метод связывает наш ранее определенный список с маркерами.`Process` Метод заменяет умные маркеры в рабочей книге фактическими значениями из наших объектов.
## Шаг 6: Сохраните файл Excel.
Наконец, мы сохраним измененную рабочую книгу в указанном нами каталоге.
```csharp
// Сохраните файл Excel.
report.Workbook.Save(dataDir + "Smart Marker Customobjects.xls");
```
Эта строка сохраняет книгу по указанному пути. Вы можете открыть этот файл с помощью Excel, чтобы увидеть вставленные данные.
## Заключение
И вот оно! Вы успешно создали файл Excel с использованием интеллектуальных маркеров в Aspose.Cells с вашим собственным пользовательским классом. Этот метод не только делает управление данными более динамичным, но и сохраняет ваш код чистым и организованным.
Итак, создаете ли вы отчеты для аналитики, отслеживания информации или выполняете любые другие задачи, связанные с данными, интеллектуальные маркеры — ваш союзник, который поможет сделать отчеты Excel более управляемыми и гибкими!
## Часто задаваемые вопросы
### Что такое умные маркеры в Aspose.Cells?
Смарт-маркеры — это специальные заполнители в документе Excel, которые позволяют динамически вставлять данные во время выполнения.
### Могу ли я использовать анонимные типы для смарт-маркеров?
Да! Умные маркеры можно использовать с любым типом объекта, включая анонимные типы, если они соответствуют ожидаемой структуре данных.
### Можно ли использовать Aspose.Cells бесплатно?
Aspose.Cells — платный продукт, но вы можете начать с бесплатной пробной версии, чтобы изучить его возможности.
### Какие форматы файлов поддерживает Aspose.Cells?
Поддерживает широкий спектр форматов файлов, включая XLS, XLSX, CSV и другие.
### Где я могу найти более подробную информацию об Aspose.Cells?
 Для получения более подробной информации посетите[документация](https://reference.aspose.com/cells/net/) или посетите[форум поддержки](https://forum.aspose.com/c/cells/9).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
