---
"description": "Узнайте, как программно отслеживать ход преобразования документа с помощью Aspose.Cells для .NET в этом подробном руководстве."
"linktitle": "Отслеживание процесса преобразования документа программным способом в .NET"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Отслеживание процесса преобразования документа программным способом в .NET"
"url": "/ru/net/converting-excel-files-to-other-formats/tracking-document-conversion-progress/"
"weight": 20
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Отслеживание процесса преобразования документа программным способом в .NET

## Введение
Хотите улучшить процесс преобразования документов с помощью Aspose.Cells для .NET? Если да, то вы в правильном месте! В этом руководстве мы подробно рассмотрим отслеживание процесса преобразования документов Excel по мере их преобразования в формат PDF. Мы не только проведем вас через основные шаги для достижения этого, но и попутно добавим несколько полезных идей. Итак, начнем!
## Предпосылки
Прежде чем мы перейдем к деталям отслеживания конвертации документов, необходимо выполнить несколько предварительных условий:
1. Базовые знания C#: поскольку мы будем использовать C# для написания кода, вам пригодятся фундаментальные знания этого языка программирования.
2. Visual Studio установлена: это будет служить средой разработки. Вы можете использовать любую предпочитаемую вами версию, но последняя всегда будет хорошим выбором.
3. Aspose.Cells для .NET: Убедитесь, что у вас установлен Aspose.Cells. Вы можете загрузить его с [Сайт Aspose](https://releases.aspose.com/cells/net/).
4. Файл Excel: Имейте готовый образец файла Excel для конвертации. Вы можете создать простой `.xlsx` файл для продолжения.
## Импортные пакеты
Теперь, когда у нас есть все необходимые условия, пришло время импортировать необходимые пакеты в ваш проект C#. Вот как это сделать:
### Создать новый проект
1. Откройте Visual Studio и создайте новый проект. Выберите шаблон Console App для простоты.
### Добавить ссылку на Aspose.Cells
2. Щелкните правой кнопкой мыши References в Solution Explorer, выберите Add Reference и перейдите к сборке Aspose.Cells, если она не была добавлена автоматически. Вы также можете использовать NuGet Package Manager, выполнив следующую команду в Package Manager Console:
```bash
Install-Package Aspose.Cells
```
### Импорт пространств имен
3. В верхней части вашего `Program.cs` файл, добавьте следующую директиву using:
```csharp
using Aspose.Cells.Rendering;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```
Теперь мы полностью готовы к настройке нашего проекта!

Заложив основу, давайте разберем реальный процесс отслеживания преобразования документов на удобоваримые шаги. 
## Шаг 1: Определите свои каталоги
Начните с указания каталогов, в которых будут находиться ваши исходные и выходные файлы. Вот как это сделать:
```csharp
// Исходный каталог
string sourceDir = "Your Document Directory";
// Выходной каталог
string outputDir = "Your Document Directory";
```
Обязательно замените `"Your Document Directory"` с реальным путем в вашей системе. Это поможет вам легко найти ваши файлы.
## Шаг 2: Загрузите рабочую книгу
Далее вам необходимо загрузить вашу книгу Excel с помощью `Workbook` класс. Вот как:
```csharp
Workbook workbook = new Workbook(sourceDir + "PagesBook1.xlsx");
```
Эта строка кода создает `Workbook` объект, который позволит нам взаимодействовать с указанным нами файлом Excel.
## Шаг 3: Настройте параметры сохранения PDF-файла
Теперь давайте настроим параметры сохранения PDF. Здесь начинается магия отслеживания прогресса. Вы создадите экземпляр `PdfSaveOptions` и назначить ему обратный вызов.
```csharp
PdfSaveOptions pdfSaveOptions = new PdfSaveOptions();
pdfSaveOptions.PageSavingCallback = new TestPageSavingCallback();
```
Назначив пользовательский обратный вызов (`TestPageSavingCallback`), мы можем реализовать собственную логику для отслеживания прогресса конверсии страницы.
## Шаг 4: Сохраните рабочую книгу в формате PDF.
Когда все готово, пора сохранить вашу рабочую книгу в формате PDF. Используйте `Save` Метод `Workbook` класс такой:
```csharp
workbook.Save(outputDir + "DocumentConversionProgress.pdf", pdfSaveOptions);
```
Эта строка запустит процесс конвертации и вызовет наши методы обратного вызова по мере обработки страниц.
## Шаг 5: Реализация класса обратного вызова
Теперь давайте создадим `TestPageSavingCallback` класс. Здесь вы определяете, что происходит в начале и в конце сохранения каждой страницы.
```csharp
public class TestPageSavingCallback : IPageSavingCallback
{
    public void PageStartSaving(PageStartSavingArgs args)
    {
        Console.WriteLine("Start saving page index {0} of pages {1}", args.PageIndex, args.PageCount);
        // Не выводить страницы до индекса страницы 2.
        if (args.PageIndex < 2)
        {
            args.IsToOutput = false;
        }
    }
    public void PageEndSaving(PageEndSavingArgs args)
    {
        Console.WriteLine("End saving page index {0} of pages {1}", args.PageIndex, args.PageCount);
        // Не выводить страницы после индекса страницы 8.
        if (args.PageIndex >= 8)
        {
            args.HasMorePages = false;
        }
    }
}
```
- `PageStartSaving`: Этот метод вызывается непосредственно перед началом сохранения страницы. Здесь мы регистрируем начало процесса сохранения для каждой страницы. Кроме того, мы можем контролировать, выводить страницу или нет. В этом случае страницы до индекса 2 пропускаются.
- `PageEndSaving`: Этот метод вызывается после сохранения страницы. Он позволяет регистрировать, когда заканчивается сохранение для каждой страницы, и контролировать, следует ли обрабатывать больше страниц. В этом примере мы останавливаемся после индекса страницы 8.
## Заключение
Поздравляем! Вы успешно внедрили систему для отслеживания процесса преобразования документов с помощью Aspose.Cells for .NET. Этот подход не только позволяет вам контролировать процесс преобразования, но и дает вам контроль над тем, какие страницы следует включать или исключать, что делает управление документами гораздо более эффективным.
## Часто задаваемые вопросы
### Что такое Aspose.Cells?
Aspose.Cells — это мощная библиотека .NET, которая позволяет разработчикам программно создавать, изменять и конвертировать файлы Excel.
### Как получить бесплатную пробную версию Aspose.Cells?
Вы можете загрузить бесплатную пробную версию с сайта [Сайт Aspose](https://releases.aspose.com/).
### Можно ли настроить процесс конвертации?
Да, с помощью обратных вызовов вы можете настроить способ обработки страниц во время конвертации.
### Могу ли я контролировать имя выходного файла?
Конечно! Вы можете указать любое имя для выходного файла при сохранении рабочей книги.
### Где я могу найти поддержку Aspose.Cells?
Вы можете получить поддержку, посетив [Форум Aspose](https://forum.aspose.com/c/cells/9).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}