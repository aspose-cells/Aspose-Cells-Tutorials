---
"date": "2025-04-05"
"description": "Учебник по коду для Aspose.Cells Net"
"title": "Создание круговой диаграммы в .NET с помощью Aspose.Cells&#58; Полное руководство"
"url": "/ru/net/charts-graphs/create-pie-chart-dotnet-aspose-cells-guide/"
"weight": 1
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}


# Как создать круговую диаграмму в .NET с помощью Aspose.Cells: пошаговое руководство

## Введение

Создание визуальных представлений данных — важный навык, особенно когда пытаешься просто и эффективно передать сложную информацию. Работаете ли вы над бизнес-отчетом или анализируете демографическую статистику, круговые диаграммы предлагают простой способ проиллюстрировать части целого. Это руководство проведет вас через процесс создания круговой диаграммы в .NET с использованием Aspose.Cells — мощной библиотеки, которая упрощает работу с документами Excel программным путем.

**Что вы узнаете:**
- Как инициализировать и настроить книгу Excel.
- Заполнение ячеек рабочего листа данными для визуализации.
- Создание и настройка круговой диаграммы с помощью Aspose.Cells для .NET.
- Настройка цветов секторов круговой диаграммы для повышения визуальной привлекательности.
- Автоматическая подгонка столбцов и сохранение книги.

Давайте углубимся в то, как вы можете использовать Aspose.Cells для создания убедительных круговых диаграмм без усилий. Прежде чем мы начнем, убедитесь, что вы соответствуете предварительным условиям, чтобы все прошло гладко.

## Предпосылки

Чтобы приступить к работе с этим руководством, убедитесь, что у вас есть:

- **Необходимые библиотеки:** Вам понадобится библиотека Aspose.Cells for .NET. Убедитесь, что ваш проект настроен на ее использование.
- **Требования к настройке среды:** Подходящая среда разработки, например Visual Studio, установленная в вашей системе.
- **Необходимые знания:** Базовые знания программирования на C# и знакомство со структурами документов Excel.

## Настройка Aspose.Cells для .NET

Прежде чем погрузиться в код, вам нужно установить библиотеку Aspose.Cells в вашем проекте. Вот как это сделать:

### Установка через CLI
Откройте терминал или командную строку и выполните:
```bash
dotnet add package Aspose.Cells
```

### Установка через менеджер пакетов
Если вы используете Visual Studio, откройте консоль диспетчера пакетов NuGet и выполните:
```powershell
PM> Install-Package Aspose.Cells
```

#### Этапы получения лицензии
Вы можете начать с бесплатной пробной версии, чтобы оценить Aspose.Cells. Для длительного использования рассмотрите возможность получения временной лицензии или покупки ее непосредственно на их веб-сайте.

#### Базовая инициализация и настройка

Чтобы инициализировать библиотеку в вашем проекте C#:
```csharp
using Aspose.Cells;

// Создать экземпляр класса Workbook
Workbook workbook = new Workbook();
```

Эта базовая настройка позволяет вам начать программную работу с файлами Excel.

## Руководство по внедрению

### Функция 1: Инициализация рабочей книги и рабочего листа

**Обзор:** Эта функция создает новую рабочую книгу и открывает ее первый рабочий лист, подготавливая почву для ввода данных и создания диаграммы.

#### Пошаговая инициализация
```csharp
using Aspose.Cells;

class InitializeWorkbook {
    public void Run() {
        // Создать новый объект рабочей книги
        Workbook workbook = new Workbook();
        
        // Доступ к первому рабочему листу в рабочей книге
        Worksheet worksheet = workbook.Worksheets[0];
    }
}
```
Здесь, `Workbook` представляет собой файл Excel, и доступ к нему `Worksheets[0]` дает вам первый лист.

### Функция 2: Заполнение данных для круговой диаграммы

**Обзор:** Заполнение данных имеет решающее значение, поскольку оно формирует основу вашей диаграммы. Этот шаг включает ввод названий стран и соответствующих им процентов населения мира в определенные ячейки.

#### Пошаговое заполнение данных
```csharp
using Aspose.Cells;

class PopulateData {
    public void Run() {
        Workbook workbook = new Workbook();
        Worksheet worksheet = workbook.Worksheets[0];
        
        // Введите данные о стране в столбце C.
        worksheet.Cells["C3"].PutValue("India");
        worksheet.Cells["C4"].PutValue("China");
        worksheet.Cells["C5"].PutValue("United States");
        worksheet.Cells["C6"].PutValue("Russia");
        worksheet.Cells["C7"].PutValue("United Kingdom");
        worksheet.Cells["C8"].PutValue("Others");

        // Введите процентные данные в столбец D.
        worksheet.Cells["D2"].PutValue("% of world population");
        worksheet.Cells["D3"].PutValue(25);
        worksheet.Cells["D4"].PutValue(30);
        worksheet.Cells["D5"].PutValue(10);
        worksheet.Cells["D6"].PutValue(13);
        worksheet.Cells["D7"].PutValue(9);
        worksheet.Cells["D8"].PutValue(13);
    }
}
```
Этот шаг гарантирует, что ваши данные готовы к визуализации.

### Функция 3: Создание и настройка круговой диаграммы

**Обзор:** Эта функция включает в себя создание круговой диаграммы, установку ее рядов данных и настройку различных свойств, таких как заголовок и положение легенды.

#### Пошаговое создание круговой диаграммы
```csharp
using Aspose.Cells;
using Aspose.Cells.Charts;

class CreatePieChart {
    public void Run() {
        Workbook workbook = new Workbook();
        Worksheet worksheet = workbook.Worksheets[0];
        
        // Добавьте круговую диаграмму на рабочий лист
        int pieIdx = worksheet.Charts.Add(ChartType.Pie, 1, 6, 15, 14);
        Chart pie = worksheet.Charts[pieIdx];

        // Установить ряд данных для диаграммы
        pie.NSeries.Add("D3:D8", true);

        // Определить данные категории и настроить заголовок
        pie.NSeries.CategoryData = "=Sheet1!$C$3:$C$8";
        pie.Title.LinkedSource = "D2";
        pie.Legend.Position = LegendPositionType.Bottom;
        pie.Title.Font.Name = "Calibri";
        pie.Title.Font.Size = 18;
    }
}
```
Этот код создает визуально привлекательную диаграмму, связанную с вашими данными.

### Функция 4: Настройка цветов срезов в круговой диаграмме

**Обзор:** Персонализация внешнего вида каждого среза повышает читаемость и эстетику. Этот шаг включает назначение уникальных цветов для разных срезов.

#### Пошаговая настройка цвета
```csharp
using Aspose.Cells;
using Aspose.Cells.Charts;
using System.Drawing;

class CustomizeSliceColors {
    public void Run() {
        Workbook workbook = new Workbook();
        Worksheet worksheet = workbook.Worksheets[0];

        int pieIdx = worksheet.Charts.Add(ChartType.Pie, 1, 6, 15, 14);
        Chart pie = worksheet.Charts[pieIdx];
        
        Series srs = pie.NSeries[0];

        // Назначьте индивидуальные цвета каждому срезу
        srs.Points[0].Area.ForegroundColor = Color.FromArgb(0, 246, 22, 219);
        srs.Points[1].Area.ForegroundColor = Color.FromArgb(0, 51, 34, 84);
        srs.Points[2].Area.ForegroundColor = Color.FromArgb(0, 46, 74, 44);
        srs.Points[3].Area.ForegroundColor = Color.FromArgb(0, 19, 99, 44);
        srs.Points[4].Area.ForegroundColor = Color.FromArgb(0, 208, 223, 7);
        srs.Points[5].Area.ForegroundColor = Color.FromArgb(0, 222, 69, 8);
    }
}
```
Этот шаг добавит ярких штрихов в вашу диаграмму.

### Функция 5: Автоматический подбор столбцов и сохранение книги

**Обзор:** Заключительные шаги включают настройку ширины столбцов для лучшей видимости данных и сохранение книги в формате Excel.

#### Пошаговая настройка и сохранение столбцов
```csharp
using Aspose.Cells;

class SaveWorkbook {
    public void Run() {
        string outputDir = "YOUR_OUTPUT_DIRECTORY";
        
        Workbook workbook = new Workbook();
        Worksheet worksheet = workbook.Worksheets[0];
        
        // Автоматический подбор столбцов для соответствия содержимому
        worksheet.AutoFitColumns();

        // Сохраните книгу как файл Excel.
        workbook.Save(outputDir + "outputCustomSliceSectorColorsPieChart.xlsx", SaveFormat.Xlsx);
    }
}
```
Это гарантирует, что ваш окончательный документ будет отполирован и готов к презентации.

## Практические применения

- **Бизнес-отчеты:** Используйте круговые диаграммы для отображения распределения продаж по регионам.
- **Демографические исследования:** Визуализируйте данные о населении разных стран и регионов.
- **Образовательные инструменты:** Создавайте увлекательные наглядные пособия для студентов, изучающих статистику.
- **Анализ здравоохранения:** Отображение распределения данных о пациентах в медицинских учреждениях.

## Соображения производительности

Чтобы обеспечить оптимальную производительность при использовании Aspose.Cells, учтите следующее:

- **Эффективная обработка данных:** Управляйте большими наборами данных, обрабатывая их по частям, если это необходимо.
- **Управление памятью:** Утилизируйте объекты правильно, чтобы освободить ресурсы и избежать утечек памяти.
- **Оптимизированные конфигурации диаграмм:** Минимизируйте сложные вычисления или рендеринг при создании диаграмм для повышения производительности.

## Заключение

Теперь вы узнали, как создать круговую диаграмму в .NET с помощью Aspose.Cells. Эта мощная библиотека упрощает обработку документов Excel, позволяя вам сосредоточиться на анализе данных, а не на тонкостях обработки файлов. Экспериментируйте с различными типами диаграмм и параметрами настройки, доступными в Aspose.Cells, чтобы еще больше улучшить свои приложения.

**Следующие шаги:**
- Изучите другие типы диаграмм, такие как столбчатые или линейные диаграммы.
- Интегрируйте функции Aspose.Cells в более крупные проекты .NET для автоматизированного создания отчетов.

Готовы вывести свои навыки визуализации данных на новый уровень? Погрузитесь глубже, изучив больше функций Aspose.Cells, и начните внедрять их в свои проекты уже сегодня!

## Раздел часто задаваемых вопросов

1. **Для чего используется Aspose.Cells?**
   - Это библиотека для программного управления файлами Excel, позволяющая создавать, изменять и анализировать электронные таблицы.

2. **Могу ли я использовать Aspose.Cells без лицензии?**
   - Да, но с ограничениями. Бесплатная пробная версия или временная лицензия обеспечивает полный доступ к функциям.

3. **Как еще можно настроить внешний вид круговой диаграммы?**
   - Используйте дополнительные свойства, такие как `pie.NSeries[0].Area.Formatting` для большего контроля над эстетикой.

4. **Какие распространенные проблемы возникают при создании диаграмм в Aspose.Cells?**
   - Перед рендерингом убедитесь, что диапазоны данных указаны правильно и что вы настроили все необходимые свойства диаграммы.

5. **Как интегрировать Aspose.Cells с другими библиотеками .NET?**
   - Используйте Aspose.Cells как часть более крупного решения .NET, используя его возможности вместе с другими библиотеками для создания комплексных приложений.

## Ресурсы

- **Документация:** [Документация Aspose.Cells](https://reference.aspose.com/cells/net/)
- **Скачать:** [Релизы Aspose.Cells](https://releases.aspose.com/cells/net/)
- **Покупка:** [Купить Aspose.Cells](https://purchase.aspose.com/buy)
- **Бесплатная пробная версия:** [Бесплатная пробная версия Aspose.Cells](https://releases.aspose.com/cells/net/)
- **Временная лицензия:** [Получить временную лицензию](https://purchase.aspose.com/temporary-license/)
- **Поддерживать:** [Форум Aspose](https://forum.aspose.com/c/cells/9)

Следуя этому руководству, вы теперь готовы создавать визуально привлекательные круговые диаграммы в приложениях .NET с помощью Aspose.Cells. Удачного кодирования!

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}