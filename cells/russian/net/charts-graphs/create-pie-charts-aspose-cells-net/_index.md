---
"date": "2025-04-05"
"description": "Узнайте, как создавать динамические круговые диаграммы с линиями выноски с помощью Aspose.Cells для .NET. Следуйте этому руководству, чтобы улучшить свои навыки визуализации данных."
"title": "Создание круговых диаграмм с линиями выноски в Aspose.Cells .NET&#58; Подробное руководство"
"url": "/ru/net/charts-graphs/create-pie-charts-aspose-cells-net/"
"weight": 1
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}


# Создание круговых диаграмм с линиями выноски с помощью Aspose.Cells .NET

## Введение
Улучшите визуализацию данных, создав более информативные круговые диаграммы с помощью Aspose.Cells для .NET. Это пошаговое руководство покажет вам, как добавлять линии указателя к сегментам круговой диаграммы, что упрощает идентификацию соответствующих категорий данных с первого взгляда. Следуя этому руководству, ваши визуализации будут визуально привлекательными и высокофункциональными.

**Что вы узнаете:**
- Настройка Aspose.Cells для .NET в вашей среде
- Создание пользовательских круговых диаграмм с выносными линиями с помощью C#
- Сохранение диаграммы как изображения или в книге Excel

Убедитесь, что у вас все готово для эффективного выполнения задания.

## Предпосылки
Прежде чем начать, убедитесь, что вы выполнили следующие предварительные условия:

- **Библиотеки и версии**: Установите Aspose.Cells для .NET. Убедитесь, что ваш проект настроен на последнюю версию.
- **Настройка среды**: В этом руководстве предполагается наличие совместимой среды .NET для Aspose.Cells.
- **Необходимые знания**Базовые знания программирования на C# и операций Excel приветствуются.

## Настройка Aspose.Cells для .NET
Для начала установите Aspose.Cells в свой проект с помощью:

**.NET CLI**
```bash
dotnet add package Aspose.Cells
```

**Менеджер пакетов**
```powershell
PM> NuGet\Install-Package Aspose.Cells
```

Получите лицензию на полную функциональность, выбрав один из следующих вариантов:
- **Бесплатная пробная версия**: Начните бесплатную пробную версию на [Страница загрузки Aspose](https://releases.aspose.com/cells/net/).
- **Временная лицензия**: Получить временную лицензию [здесь](https://purchase.aspose.com/temporary-license/).
- **Покупка**: Для полного функционала приобретите лицензию [здесь](https://purchase.aspose.com/buy).

Инициализируйте Aspose.Cells в вашем проекте, создав экземпляр `Workbook` сорт.

## Руководство по внедрению

### Создание рабочей книги и рабочего листа
1. **Инициализировать рабочую книгу**
   Создайте новую рабочую книгу в формате XLSX:
   ```csharp
   Workbook workbook = new Workbook(FileFormatType.Xlsx);
   ```

2. **Доступ к первому рабочему листу**
   Используйте первый рабочий лист для ввода данных:
   ```csharp
   Worksheet worksheet = workbook.Worksheets[0];
   ```

3. **Добавление данных для круговой диаграммы**
   Заполните свой рабочий лист категориями и значениями:
   ```csharp
   worksheet.Cells["A1"].PutValue("Retail");
   // Добавьте оставшиеся названия категорий...
   worksheet.Cells["B1"].PutValue(10.4);
   // Добавьте соответствующие значения...
   ```

### Добавление круговой диаграммы на рабочий лист
1. **Создать круговую диаграмму**
   Создайте круговую диаграмму и добавьте ее в коллекцию диаграмм вашего рабочего листа:
   ```csharp
   int id = worksheet.Charts.Add(ChartType.Pie, 3, 3, 23, 13);
   ```

2. **Настройка серий и категорий данных**
   Свяжите данные по сериям и категориям:
   ```csharp
   Chart chart = worksheet.Charts[id];
   chart.NSeries.Add("B1:B16", true);
   chart.NSeries.CategoryData = "A1:A16";
   ```

3. **Настройте метки данных**
   Отключите отображение легенды, настройте метки данных для отображения названий категорий и процентов:
   ```csharp
   chart.ShowLegend = false;
   DataLabels dataLabels = chart.NSeries[0].DataLabels;
   dataLabels.ShowCategoryName = true;
   dataLabels.ShowPercentage = true;
   dataLabels.Position = LabelPositionType.OutsideEnd;
   ```

### Внедрение направляющих линий
1. **Включить направляющие линии**
   Включите направляющие линии для более четких визуальных связей:
   ```csharp
   chart.NSeries[0].HasLeaderLines = true;
   ```

2. **Отрегулируйте положение меток данных**
   Обеспечьте видимость, отрегулировав положение этикеток:
   ```csharp
   int DELTA = 100;
   foreach (var point in chart.NSeries[0].Points)
   {
       int X = point.DataLabels.X;
       if (X > 2000) 
           point.DataLabels.X += DELTA;
       else 
           point.DataLabels.X -= DELTA;
   }
   ```

### Сохранение диаграммы и рабочей книги
1. **Сохранить как изображение**
   Преобразуйте диаграмму в файл изображения:
   ```csharp
   ImageOrPrintOptions options = new ImageOrPrintOptions { ImageType = Drawing.ImageType.Png, HorizontalResolution = 200, VerticalResolution = 200 };
   chart.ToImage("output_out.png", options);
   ```

2. **Сохранить рабочую книгу**
   Сохраните книгу, чтобы просмотреть диаграмму в Excel:
   ```csharp
   workbook.Save("output_out.xlsx");
   ```

## Практические применения
- **Финансовые отчеты**: Четко представлять бюджетные ассигнования.
- **Маркетинговая аналитика**: Эффективная визуализация данных о доле рынка в презентациях и отчетах.
- **Анализ продаж**Легко отображайте распределение продаж по различным регионам/продуктам.

Возможности интеграции включают экспорт этих визуализаций в веб-приложения или встраивание их в автоматизированные инструменты отчетности.

## Соображения производительности
При использовании Aspose.Cells для достижения оптимальной производительности учитывайте следующее:
- Минимизируйте объемы больших наборов данных, загружаемых в память одновременно.
- Используйте эффективные циклы и избегайте ненужных вычислений внутри циклов.
- Регулярно очищайте ресурсы, такие как объекты рабочей книги, чтобы предотвратить утечки памяти.

## Заключение
Вы узнали, как создавать круговые диаграммы с линиями выноски с помощью Aspose.Cells для .NET. Эта функциональность повышает ясность визуализаций данных, делая их более доступными и эффективными. 

**Следующие шаги:**
Изучите дополнительные возможности настройки внешнего вида диаграмм или поэкспериментируйте с другими типами диаграмм, доступными в Aspose.Cells.

## Раздел часто задаваемых вопросов
1. **Что такое линия-выноска на круговой диаграмме?**
   Линии выноски соединяют метки данных с соответствующими им сегментами, улучшая читаемость.

2. **Могу ли я использовать Aspose.Cells бесплатно?**
   Да, вы можете начать с бесплатной пробной версии, но для использования всех функций требуется лицензия.

3. **Можно ли экспортировать диаграммы в виде изображений?**
   Конечно! Используйте `ImageOrPrintOptions` сохранить диаграмму в графических форматах, таких как PNG или JPEG.

4. **Как вручную отрегулировать положение меток данных?**
   Измените координаты X и Y меток данных в цикле точек серии.

5. **Может ли Aspose.Cells интегрироваться с другими системами?**
   Да, его можно использовать совместно с базами данных, веб-сервисами и другими решениями для автоматизированной отчетности.

## Ресурсы
- [Документация Aspose.Cells](https://reference.aspose.com/cells/net/)
- [Скачать Aspose.Cells](https://releases.aspose.com/cells/net/)
- [Лицензия на покупку](https://purchase.aspose.com/buy)
- [Бесплатная пробная версия](https://releases.aspose.com/cells/net/)
- [Временная лицензия](https://purchase.aspose.com/temporary-license/)
- [Форум поддержки](https://forum.aspose.com/c/cells/9)

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}