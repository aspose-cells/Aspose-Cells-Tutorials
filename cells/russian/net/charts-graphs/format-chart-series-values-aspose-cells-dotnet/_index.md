---
"date": "2025-04-05"
"description": "Узнайте, как форматировать значения ряда диаграмм с помощью Aspose.Cells для .NET. В этом руководстве рассматриваются установка, примеры кода и методы улучшения читаемости данных в Excel."
"title": "Как форматировать значения ряда диаграмм в Excel с помощью Aspose.Cells .NET"
"url": "/ru/net/charts-graphs/format-chart-series-values-aspose-cells-dotnet/"
"weight": 1
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}


# Как форматировать значения ряда диаграмм в Excel с помощью Aspose.Cells .NET

## Введение

Вам нужно программно форматировать значения ряда диаграмм в Excel? В этом руководстве показано, как использовать Aspose.Cells для .NET для установки кодов формата для ряда диаграмм. Независимо от того, автоматизируете ли вы создание отчетов или стандартизируете финансовые презентации, управление форматами значений может значительно улучшить читаемость и согласованность данных.

**Что вы узнаете:**
- Установка и инициализация Aspose.Cells для .NET
- Загрузка рабочей книги и доступ к ее компонентам, таким как рабочие листы и диаграммы
- Добавление рядов в диаграмму и установка кода формата их значений
- Сохранение изменений обратно в файл Excel

Для начала давайте рассмотрим предварительные условия.

## Предпосылки

Перед началом убедитесь, что у вас есть:
- **Необходимые библиотеки:** Aspose.Cells для .NET совместим с вашей средой разработки.
- **Настройка среды:** Работающая среда разработки .NET (например, Visual Studio).
- **Необходимые знания:** Базовые знания C# и знакомство со структурами файлов Excel.

## Настройка Aspose.Cells для .NET

Чтобы использовать Aspose.Cells, добавьте библиотеку в свой проект следующим образом:

**.NET CLI:**
```bash
dotnet add package Aspose.Cells
```

**Менеджер пакетов:**
```powershell
PM> NuGet\Install-Package Aspose.Cells
```

### Приобретение лицензии

Aspose предлагает бесплатную пробную лицензию для оценки возможностей библиотеки. Для длительного использования рассмотрите возможность получения временной или постоянной лицензии:
- **Бесплатная пробная версия:** Скачать с [здесь](https://releases.aspose.com/cells/net/).
- **Временная лицензия:** Запросить это [здесь](https://purchase.aspose.com/temporary-license/).
- **Лицензия на покупку:** Исследуйте варианты [здесь](https://purchase.aspose.com/buy).

После установки инициализируйте Aspose.Cells, создав новый `Workbook` пример.

## Руководство по внедрению

Давайте разобьем процесс на отдельные этапы для облегчения реализации.

### Загрузить рабочую книгу из каталога

**Обзор:** Начните с загрузки книги Excel из указанного вами каталога.

```csharp
string SourceDir = "YOUR_SOURCE_DIRECTORY";
// Загрузите исходный файл Excel 
Workbook wb = new Workbook(SourceDir + "sampleSeries_ValuesFormatCode.xlsx");
```

**Объяснение:**
- `SourceDir` — это путь к вашим входным файлам.
- The `Workbook` конструктор открывает указанный файл.

### Доступ к рабочему листу из рабочей книги

**Обзор:** Получите рабочий лист, с которым вам нужно работать.

```csharp
// Доступ к первому рабочему листу
Worksheet worksheet = wb.Worksheets[0];
```

**Объяснение:**
- Рабочие книги могут содержать несколько рабочих листов. Здесь мы получаем доступ к первому из них, используя индекс `0`.

### Доступ к диаграмме из рабочего листа

**Обзор:** Найдите диаграмму на выбранном рабочем листе, которую необходимо изменить.

```csharp
// Доступ к первой диаграмме
Chart ch = worksheet.Charts[0];
```

**Объяснение:**
- Подобно рабочим листам, рабочий лист может иметь несколько диаграмм. Этот код обращается к первой диаграмме.

### Добавить серию в диаграмму

**Обзор:** Добавьте ряд данных на диаграмму, используя массив значений.

```csharp
// Добавить ряд, используя массив значений
ch.NSeries.Add("{10000, 20000, 30000, 40000}", true);
```

**Объяснение:**
- `NSeries.Add` принимает строковое представление чисел и логическое значение, указывающее, является ли диапазон исключительным. Здесь он является инклюзивным.

### Установить код формата значений серии

**Обзор:** Настройте форматирование значений в серии диаграмм.

```csharp
// Доступ к серии и установка ее значений формата кода
Series srs = ch.NSeries[0];
srs.ValuesFormatCode = "$#,##0";
```

**Объяснение:**
- `ValuesFormatCode` позволяет вам определить пользовательский числовой формат, например, денежный в этом примере (`"$#,##0"`).

### Сохранить книгу в каталоге

**Обзор:** Сохраните изменения, сохранив книгу в выходном каталоге.

```csharp
string outputDir = "YOUR_OUTPUT_DIRECTORY";
// Сохраните выходной файл Excel.
wb.Save(outputDir + "outputSeries_ValuesFormatCode.xlsx");
```

**Объяснение:**
- The `Save` Метод записывает измененную книгу в новый файл, сохраняя ваши изменения.

## Практические применения

Вот несколько сценариев, в которых эта функция полезна:
1. **Финансовая отчетность:** Автоматически форматируйте значения валют в диаграммах для финансовых панелей.
2. **Автоматизированный анализ данных:** Стандартизируйте представление данных в нескольких отчетах Excel, созданных на основе необработанных наборов данных.
3. **Образовательные инструменты:** Создавайте учебные материалы с единообразной визуализацией данных.

## Соображения производительности

При использовании Aspose.Cells примите во внимание следующие советы по оптимизации производительности:
- **Эффективная обработка файлов:** Минимизируйте операции чтения/записи, группируя изменения перед сохранением.
- **Управление памятью:** Распоряжаться `Workbook` объекты соответствующим образом для освобождения памяти.
- **Оптимизированная обработка данных:** Для больших наборов данных обрабатывайте данные по частям.

## Заключение

В этом руководстве вы узнали, как задать коды формата для значений рядов диаграмм с помощью Aspose.Cells .NET. Выполнив эти шаги, вы сможете эффективно автоматизировать и стандартизировать представление данных в диаграммах Excel. Далее рассмотрите возможность изучения более продвинутых функций, таких как условное форматирование или интеграция с другими системами для комплексных решений по работе с данными.

Готовы применить свои новые навыки на практике? Попробуйте реализовать это решение в своем следующем проекте!

## Раздел часто задаваемых вопросов

**В1: Для чего используется Aspose.Cells .NET?**
A1: Aspose.Cells .NET — это мощная библиотека для работы с файлами Excel, позволяющая программно создавать, изменять и сохранять электронные таблицы.

**В2: Могу ли я отформатировать несколько серий одновременно?**
A2: Да, повторить `NSeries` сбор и применение форматирования к каждой серии по мере необходимости.

**В3: Как обрабатывать исключения во время обработки рабочей книги?**
A3: Используйте блоки try-catch вокруг критических операций, таких как загрузка или сохранение файла, для корректного управления ошибками.

**В4: Можно ли форматировать значения, не меняя их содержимое?**
А4: Конечно, `ValuesFormatCode` изменяет только способ отображения чисел, а не сами данные.

**В5: Где я могу найти больше примеров и документации по Aspose.Cells .NET?**
A5: Изучите подробные руководства и примеры кода на [Документация Aspose](https://reference.aspose.com/cells/net/).

## Ресурсы
- **Документация:** [Документация по Aspose Cells для .NET](https://reference.aspose.com/cells/net/)
- **Скачать:** [Страница релизов](https://releases.aspose.com/cells/net/)
- **Покупка:** [Купить лицензию](https://purchase.aspose.com/buy)
- **Бесплатная пробная версия:** [Пробная версия](https://releases.aspose.com/cells/net/)
- **Временная лицензия:** [Запросить здесь](https://purchase.aspose.com/temporary-license/)
- **Поддерживать:** [Форум Aspose](https://forum.aspose.com/c/cells/9)

С этими ресурсами вы хорошо подготовлены к использованию Aspose.Cells for .NET в своих проектах. Удачного кодирования!

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}