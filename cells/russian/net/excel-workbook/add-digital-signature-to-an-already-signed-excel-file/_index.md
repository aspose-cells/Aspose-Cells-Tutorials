---
title: Добавить цифровую подпись к уже подписанному файлу Excel
linktitle: Добавить цифровую подпись к уже подписанному файлу Excel
second_title: Справочник API Aspose.Cells для .NET
description: Узнайте, как добавить цифровую подпись к уже подписанному файлу Excel с помощью Aspose.Cells для .NET, воспользовавшись этим подробным пошаговым руководством.
weight: 30
url: /ru/net/excel-workbook/add-digital-signature-to-an-already-signed-excel-file/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Добавить цифровую подпись к уже подписанному файлу Excel

## Введение

В современном цифровом мире защита документов важнее, чем когда-либо. Цифровые подписи обеспечивают способ обеспечения подлинности и целостности ваших файлов, особенно при работе с конфиденциальной информацией. Если вы работаете с файлами Excel и хотите добавить новую цифровую подпись в уже подписанную книгу, вы попали по адресу! В этом руководстве мы проведем вас через процесс добавления цифровой подписи в уже подписанный файл Excel с помощью Aspose.Cells for .NET. Итак, давайте погрузимся!

## Предпосылки

Прежде чем мы перейдем к тонкостям кодирования, вам необходимо иметь под рукой несколько вещей:

1.  Aspose.Cells для .NET: Убедитесь, что в вашем проекте .NET установлена библиотека Aspose.Cells. Вы можете загрузить ее с[сайт](https://releases.aspose.com/cells/net/).
2.  Файл сертификата: Вам понадобится действительный файл сертификата (обычно`.pfx`файл), содержащий ваш цифровой сертификат. Убедитесь, что вы знаете пароль для этого файла.
3. Среда разработки: настройте среду разработки с помощью Visual Studio или любой другой IDE, поддерживающей .NET.
4. Базовые знания C#: знакомство с программированием на C# поможет вам легко освоить материал.
5. Образцы файлов: Имейте образец файла Excel, который уже имеет цифровую подпись. Это будет файл, в который вы добавите новую подпись.

Теперь, когда у нас все готово, давайте начнем писать код!

## Импортные пакеты

Для начала вам нужно импортировать необходимые пакеты в ваш файл C#. Вот как это сделать:

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```

Эти пространства имен позволят вам легко работать с файлами Excel и обрабатывать цифровые подписи.

## Шаг 1: Настройте исходные и выходные каталоги

Прежде чем вы сможете манипулировать файлами Excel, вам нужно определить, где находятся ваши исходные файлы и где вы хотите сохранить выходной файл. Вот как это сделать:

```csharp
// Исходный каталог
string sourceDir = "Your Document Directory";
// Выходной каталог
string outputDir = "Your Document Directory";
```

На этом этапе мы используем метод для получения путей к исходному и выходному каталогам. Убедитесь, что эти каталоги существуют и содержат требуемые файлы.

## Шаг 2: Загрузите уже подписанную рабочую книгу

 Далее вам нужно загрузить книгу Excel, которую вы хотите изменить. Это делается путем создания экземпляра`Workbook` класс и передача пути к подписанному файлу.

```csharp
// Загрузите рабочую книгу, которая уже имеет цифровую подпись.
Aspose.Cells.Workbook workbook = new Aspose.Cells.Workbook(sourceDir + "sampleDigitallySignedByCells.xlsx");
```

 Здесь мы загружаем рабочую книгу с именем`sampleDigitallySignedByCells.xlsx`. Убедитесь, что этот файл уже подписан.

## Шаг 3: Создайте коллекцию цифровых подписей

Теперь давайте создадим коллекцию цифровых подписей. Эта коллекция будет содержать все цифровые подписи, которые вы хотите добавить в книгу.

```csharp
// Создать коллекцию цифровых подписей
Aspose.Cells.DigitalSignatures.DigitalSignatureCollection dsCollection = new Aspose.Cells.DigitalSignatures.DigitalSignatureCollection();
```

Этот шаг имеет решающее значение, поскольку он позволяет вам управлять несколькими подписями при необходимости.

## Шаг 4: Создайте новый сертификат

 Вам необходимо загрузить файл сертификата для создания новой цифровой подписи. Здесь вы указываете путь к вашему`.pfx` файл и его пароль.

```csharp
// Файл сертификата и его пароль
string certFileName = sourceDir + "AsposeDemo.pfx";
string password = "aspose";

// Создать новый сертификат
System.Security.Cryptography.X509Certificates.X509Certificate2 certificate = new System.Security.Cryptography.X509Certificates.X509Certificate2(certFileName, password);
```

 Обязательно замените`AsposeDemo.pfx`и пароль с фактическим именем файла сертификата и паролем.

## Шаг 5: Создайте цифровую подпись

Имея сертификат на руках, вы можете создать цифровую подпись. Вам также нужно будет указать причину подписи и текущую дату и время.

```csharp
// Создайте новую цифровую подпись и добавьте ее в коллекцию цифровых подписей.
Aspose.Cells.DigitalSignatures.DigitalSignature signature = new Aspose.Cells.DigitalSignatures.DigitalSignature(certificate, "Aspose.Cells added new digital signature in existing digitally signed workbook.", DateTime.Now);
```

На этом этапе в вашу коллекцию добавляется новая подпись, которую вы позже примените к рабочей книге.

## Шаг 6: Добавьте коллекцию цифровых подписей в рабочую книгу

Теперь пришло время добавить коллекцию цифровых подписей в рабочую книгу. Вот где происходит волшебство!

```csharp
// Добавить коллекцию цифровых подписей в рабочую книгу
workbook.AddDigitalSignature(dsCollection);
```

Выполняя эту строку, вы фактически прикрепляете новую цифровую подпись к уже подписанной книге.

## Шаг 7: Сохраните и удалите рабочую книгу.

Наконец, вам нужно будет сохранить измененную книгу в выходном каталоге и освободить все используемые ресурсы.

```csharp
//Сохраните рабочую книгу и утилизируйте ее.
workbook.Save(outputDir + "outputDigitallySignedByCells.xlsx");
workbook.Dispose();
```

Этот шаг гарантирует сохранение изменений и правильное удаление рабочей книги для освобождения ресурсов.

## Шаг 8: Подтверждение выполнения

В заключение, хорошей идеей будет подтвердить, что ваш код успешно выполнился. Вы можете сделать это с помощью простого консольного сообщения.

```csharp
Console.WriteLine("AddDigitalSignatureToAnAlreadySignedExcelFile executed successfully.\r\n");
```

Это дает понять, что ваша операция прошла успешно, а это всегда приятно видеть!

## Заключение

И вот оно! Вы успешно добавили новую цифровую подпись в уже подписанный файл Excel с помощью Aspose.Cells for .NET. Цифровые подписи — это мощный способ гарантировать подлинность ваших документов, и теперь вы знаете, как управлять ими программно. Работаете ли вы с финансовыми документами, контрактами или любой конфиденциальной информацией, внедрение цифровых подписей может повысить безопасность и доверие.

## Часто задаваемые вопросы

### Что такое цифровая подпись?
Цифровая подпись — это криптографический метод, используемый для проверки подлинности и целостности сообщения или документа.

### Можно ли добавить несколько цифровых подписей в один и тот же файл Excel?
Да, вы можете создать коллекцию цифровых подписей и добавить несколько подписей в одну и ту же книгу.

### Какие форматы цифровых подписей поддерживает Aspose.Cells?
 Aspose.Cells поддерживает различные форматы, включая`.pfx` для сертификатов.

### Нужна ли мне определенная версия .NET для использования Aspose.Cells?
 Проверьте[Документация Aspose.Cells](https://reference.aspose.com/cells/net/) для совместимости с вашей версией .NET.

### Как получить временную лицензию для Aspose.Cells?
 Вы можете запросить временную лицензию у[Страница покупки Aspose](https://purchase.aspose.com/temporary-license/).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
