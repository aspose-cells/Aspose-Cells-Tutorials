---
title: Чтение и запись внешнего соединения файла XLSB
linktitle: Чтение и запись внешнего соединения файла XLSB
second_title: Справочник API Aspose.Cells для .NET
description: Узнайте, как управлять внешними подключениями в файлах XLSB с помощью Aspose.Cells для .NET в этом подробном руководстве.
weight: 130
url: /ru/net/excel-workbook/read-and-write-external-connection-of-xlsb-file/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Чтение и запись внешнего соединения файла XLSB

## Введение

Привет, энтузиасты Excel! Вы готовы окунуться в увлекательный мир файлов XLSB и внешних подключений? Если вы когда-либо работали с Excel, вы знаете, насколько он может быть мощным и универсальным, но иногда у него есть свои странности, особенно при работе с подключениями к внешним базам данных. Вот тут-то и приходит на помощь Aspose.Cells for .NET! Эта изящная библиотека позволяет вам управлять файлами Excel простым способом. В этой статье мы пошагово расскажем вам о том, как читать и записывать внешние подключения в файле XLSB.

## Предпосылки

Прежде чем мы начнем, вот несколько вещей, которые вам понадобятся:

1. Базовые знания C#: Знание языка программирования C# очень поможет. Если вам комфортно писать код на C#, то вы готовы!
2.  Aspose.Cells for .NET: Вам нужно установить эту библиотеку в вашей среде разработки. Если вы этого еще не сделали, вы можете легко ее скачать[здесь](https://releases.aspose.com/cells/net/). 
3. IDE: вам понадобится редактор кода или интегрированная среда разработки (IDE), например Visual Studio. 
4. Образец файла XLSB: Мы будем работать с образцом файла XLSB, который содержит внешние соединения. Вы можете создать свой собственный или загрузить образцы онлайн. 

Как только все эти предварительные условия будут выполнены, мы готовы приступить к написанию кода!

## Импортные пакеты

Для начала импортируем необходимые пакеты в наш проект. Убедитесь, что вы добавили ссылку на Aspose.Cells в свой проект. Вот как это можно сделать в C#:

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```

Этот импорт дает вам доступ к функциям, которые вам понадобятся для работы с файлами Excel и их связями.

## Шаг 1: Настройка каталогов

Перед началом работы с файлом XLSB вам необходимо настроить исходные и выходные каталоги. Этот шаг необходим для организации ваших файлов.

```csharp
// Исходный каталог
string sourceDir = "Your Document Directory";
// Выходной каталог
string outputDir = "Your Output Directory";
```

 В этом фрагменте кода`"Your Document Directory"` и`"Your Document Directory"` предполагается, что они извлекают соответствующие пути для размещения ваших входных и выходных файлов. Вы можете заменить эти методы жестко закодированными путями, если предпочитаете.

## Шаг 2: Загрузите файл XLSB

Теперь пришло время загрузить ваш файл Excel в объект Workbook. Это дает вам возможность манипулировать данными внутри.

```csharp
// Загрузите исходный файл Excel Xlsb
Workbook wb = new Workbook(sourceDir + "sampleExternalConnection_XLSB.xlsb");
```

 Просто убедитесь, что ваш файл XLSB находится в указанном месте.`sourceDir`. Если путь правильный, ваша рабочая книга будет готова к работе!

## Шаг 3: Доступ к внешним подключениям

Загрузив рабочую книгу, вы можете получить доступ к ее внешним соединениям. В нашем случае мы получим первое соединение с базой данных.

```csharp
// Прочитайте первое внешнее соединение, которое на самом деле является соединением с базой данных.
Aspose.Cells.ExternalConnections.DBConnection dbCon = wb.DataConnections[0] as Aspose.Cells.ExternalConnections.DBConnection;
```

 Здесь,`DataConnections[0]` относится к первому соединению в рабочей книге. Мы приводим его как`DBConnection` тип для дальнейших манипуляций.

## Шаг 4: Извлечение информации о подключении

Теперь, когда у вас есть доступ к подключению к базе данных, давайте извлечем и выведем ее данные на консоль. Это поможет нам увидеть, с чем именно мы работаем.

```csharp
// Распечатать имя, команду и информацию о подключении к базе данных
Console.WriteLine("Connection Name: " + dbCon.Name);
Console.WriteLine("Command: " + dbCon.Command);
Console.WriteLine("Connection Info: " + dbCon.ConnectionInfo);
```

Этот шаг позволяет вам проверить текущее состояние вашего внешнего соединения. Вы увидите имя соединения, использованную команду и информацию о соединении, выведенную на консоль.

## Шаг 5: Измените подключение

Иногда достаточно просто сменить имя, чтобы сделать вещи более понятными или соответствовать новым соглашениям об именовании. Давайте изменим существующее имя соединения на что-то более релевантное.

```csharp
// Измените имя соединения
dbCon.Name = "NewCust";
```

Эта строка кода фактически переименовывает ваше соединение с его первоначального имени на "NewCust". Это простое, но эффективное изменение!

## Шаг 6: Сохраните изменения.

После внесения изменений вам нужно будет сохранить изменения обратно в файл XLSB. Вот как это сделать:

```csharp
// Сохраните файл Excel Xlsb
wb.Save(outputDir + "outputExternalConnection_XLSB.xlsb");
```

Эта строка кода сохраняет обновленную книгу, сохраняя все изменения, включая новое имя подключения.

## Шаг 7: Подтверждение выполнения

Наконец, давайте убедимся, что все прошло гладко. Простое сообщение в конце прояснит ситуацию.

```csharp
Console.WriteLine("ReadAndWriteExternalConnectionOfXLSBFile executed successfully.\r\n");
```

Это сообщение заверит вас в том, что ваш код был успешно выполнен и все изменения были сохранены, как и ожидалось.

## Заключение

И вот оно! Вы успешно научились читать и записывать внешние соединения в файлах XLSB с помощью Aspose.Cells для .NET. Выполнив эти шаги, вы сможете эффективно управлять соединениями с данными Excel, что сделает вашу работу с Excel намного более упорядоченной и менее раздражающей. Помните, независимо от того, работаете ли вы с обширными наборами данных или просто организуете свою информацию, Aspose.Cells имеет необходимые вам инструменты.

## Часто задаваемые вопросы

### Что такое файл XLSB?  
Файл XLSB — это двоичный формат файла Excel, в котором данные электронной таблицы хранятся в двоичном формате, что делает их более компактными и ускоряет их открытие.

### Как установить Aspose.Cells для .NET?  
 Вы можете легко загрузить его с сайта Aspose.[здесь](https://releases.aspose.com/cells/net/).

### Могу ли я использовать Aspose.Cells бесплатно?  
 Да! Вы можете начать с бесплатной пробной версии, которая доступна[здесь](https://releases.aspose.com/).

### Поддерживает ли Aspose.Cells другие форматы файлов?  
Конечно! Aspose.Cells поддерживает множество форматов файлов, включая XLSX, CSV и другие.

### Куда я могу обратиться за помощью, если у меня возникнут проблемы?  
Вы можете получить поддержку на форумах Aspose.[здесь](https://forum.aspose.com/c/cells/9).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
