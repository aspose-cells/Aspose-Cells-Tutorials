---
title: Отрегулируйте уровень сжатия
linktitle: Отрегулируйте уровень сжатия
second_title: Справочник API Aspose.Cells для .NET
description: Узнайте, как настроить уровни сжатия для файлов Excel с помощью Aspose.Cells for .NET. Эффективно оптимизируйте размеры файлов с помощью этого пошагового руководства.
weight: 50
url: /ru/net/excel-workbook/adjust-compression-level/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Отрегулируйте уровень сжатия

## Введение

Когда дело доходит до обработки больших файлов Excel, эффективное хранилище является ключевым фактором. Независимо от того, являетесь ли вы разработчиком, который хочет оптимизировать размеры файлов, или аналитиком данных, который хочет ускорить передачу файлов, понимание того, как настроить уровни сжатия в Aspose.Cells для .NET, может стать решающим фактором. В этом руководстве мы проведем вас через шаги по настройке уровней сжатия при сохранении файлов Excel, гарантируя сохранение производительности без ущерба для качества.

## Предпосылки

Прежде чем углубляться в тонкости уровней сжатия, давайте убедимся, что у вас есть все необходимое для начала работы:

1. Базовые знания C#: Базовое понимание программирования на C# необходимо. Если вы знакомы с переменными, циклами и базовыми файловыми операциями, то вы готовы!
2. Библиотека Aspose.Cells for .NET: Убедитесь, что у вас установлена библиотека Aspose.Cells. Вы можете загрузить ее с[веб-сайт](https://releases.aspose.com/cells/net/) . Если вы только начинаете, рассмотрите возможность бесплатной пробной версии.[здесь](https://releases.aspose.com/).
3. Среда разработки: настройте среду разработки (в идеале Visual Studio) для написания и выполнения кода C#. 
4. Образец файла Excel: Подготовьте большой файл Excel для тестирования. Вы можете создать его или использовать любой существующий файл, но убедитесь, что он достаточно большой, чтобы увидеть эффекты сжатия.

Имея эти предпосылки, давайте начнем!

## Импортные пакеты

Прежде чем мы сможем манипулировать файлами Excel, нам нужно импортировать необходимые пространства имен. Это важный шаг, который позволяет нам получить доступ к классам и методам, предоставляемым Aspose.Cells.

### Импорт пространства имен Aspose.Cells

```csharp
using Aspose.Cells.Rendering;
using Aspose.Cells.WebExtensions;
using System;
```

 Этот фрагмент кода импортирует`Aspose.Cells` Пространство имен, которое содержит все классы, необходимые для работы с файлами Excel.`Aspose.Cells.Xlsb` Пространство имен предназначено специально для обработки форматов файлов XLSB.

Теперь, когда у нас все настроено, давайте разобьем процесс настройки уровней сжатия на управляемые шаги. Мы сохраним рабочую книгу с разными уровнями сжатия и измерим время, необходимое для каждой операции. 

## Шаг 1: Настройте свои каталоги

Прежде всего, нам нужно определить, где будут храниться наши файлы. Это включает в себя указание исходного каталога для нашего входного файла и выходного каталога для наших сжатых файлов.

```csharp
// Исходный каталог
string sourceDir = "Your Document Directory";
string outDir = "Your Document Directory";
```

## Шаг 2: Загрузите рабочую книгу

Далее мы загрузим книгу Excel, которую хотим сжать. Здесь вы укажете на свой большой файл Excel.

```csharp
Workbook workbook = new Workbook(sourceDir + "LargeSampleFile.xlsx");
```

 Эта строка инициализирует новый`Workbook` объект с указанным файлом. Убедитесь, что путь к файлу правильный; в противном случае вы столкнетесь с ошибками.

## Шаг 3: Создайте параметры сохранения для XLSB

 Теперь мы создадим экземпляр`XlsbSaveOptions`, который позволяет нам указать, как мы хотим сохранить нашу книгу, включая уровень сжатия.

```csharp
XlsbSaveOptions options = new XlsbSaveOptions();
```

В этой строке подготавливаются параметры, которые мы будем использовать для сохранения нашей книги в формате XLSB.

## Шаг 4: Установка и измерение уровней сжатия

А теперь самое интересное! Мы сохраним книгу, используя разные уровни сжатия, и измерим время, затраченное на каждую операцию. 

### Уровень 1 компрессии

Начнем с самого низкого уровня сжатия:

```csharp
options.CompressionType = OoxmlCompressionType.Level1;
var watch = System.Diagnostics.Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_1_out.xlsb", options);
watch.Stop();
var elapsedMs = watch.ElapsedMilliseconds;
Console.WriteLine("Level 1 Elapsed Time: " + elapsedMs);
```

В этом фрагменте мы устанавливаем тип сжатия на Уровень 1, сохраняем книгу и регистрируем затраченное время. 

### Уровень 6 компрессии

Далее мы попробуем средний уровень сжатия:

```csharp
options.CompressionType = OoxmlCompressionType.Level6;
watch = System.Diagnostics.Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_6_out.xlsb", options);
watch.Stop();
elapsedMs = watch.ElapsedMilliseconds;
Console.WriteLine("Level 6 Elapsed Time: " + elapsedMs);
```

На этот раз мы устанавливаем тип сжатия на Уровень 6 и повторяем операцию сохранения.

### Уровень 9 компрессии

Наконец, сохраним, используя максимальный уровень сжатия:

```csharp
options.CompressionType = OoxmlCompressionType.Level9;
watch = System.Diagnostics.Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_9_out.xlsb", options);
watch.Stop();
elapsedMs = watch.ElapsedMilliseconds;
Console.WriteLine("Level 9 Elapsed Time: " + elapsedMs);
```

На этом этапе мы устанавливаем тип сжатия на Уровень 9, что должно обеспечить наименьший размер файла, но может занять больше времени для сохранения.

## Шаг 5: Окончательный результат

После выполнения всех вышеперечисленных шагов вы увидите на консоли прошедшее время для каждого уровня сжатия. 

```csharp
Console.WriteLine("AdjustCompressionLevel executed successfully.");
```

Эта строка подтверждает, что весь процесс был завершен без проблем.

## Заключение

Настройка уровней сжатия при сохранении файлов Excel с помощью Aspose.Cells for .NET — это простая, но мощная техника. Следуя шагам, описанным в этом руководстве, вы сможете легко управлять размерами файлов, делая их более управляемыми для хранения и передачи. Независимо от того, нужен ли вам быстрый доступ к данным или вы хотите оптимизировать производительность своего приложения, освоение этих методов, несомненно, повысит ваши навыки разработчика.

## Часто задаваемые вопросы

### Что такое Aspose.Cells?
Aspose.Cells — это библиотека .NET, которая позволяет разработчикам программно создавать, изменять и преобразовывать файлы Excel.

### Как загрузить Aspose.Cells?
 Вы можете загрузить библиотеку Aspose.Cells с сайта[веб-сайт](https://releases.aspose.com/cells/net/).

### Могу ли я использовать Aspose.Cells бесплатно?
 Да, Aspose предлагает бесплатную пробную версию, к которой вы можете получить доступ[здесь](https://releases.aspose.com/).

### Какие уровни сжатия доступны?
Aspose.Cells поддерживает несколько уровней сжатия: от уровня 1 (наименьшее сжатие) до уровня 9 (максимальное сжатие).

### Где я могу найти поддержку Aspose.Cells?
 Вы можете получить поддержку и задать вопросы на[Форум Aspose](https://forum.aspose.com/c/cells/9).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
