---
title: Добавить список на рабочий лист в Excel
linktitle: Добавить список на рабочий лист в Excel
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как добавить список в лист Excel с помощью Aspose.Cells для .NET. Следуйте нашему простому пошаговому руководству и сделайте свои листы Excel интерактивными.
weight: 20
url: /ru/net/excel-shapes-controls/add-list-box-to-worksheet-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Добавить список на рабочий лист в Excel

## Введение
Добавление интерактивных элементов в ваши рабочие листы Excel, например, списка, может значительно улучшить управление данными и их представление. Независимо от того, создаете ли вы интерактивную форму или пользовательский инструмент ввода данных, возможность контролировать ввод данных пользователем с помощью списка бесценна. Aspose.Cells for .NET обеспечивает эффективный способ добавления и управления этими элементами управления в ваши файлы Excel. В этом руководстве мы проведем вас через процесс добавления списка на рабочий лист с помощью Aspose.Cells for .NET.
## Предпосылки
Прежде чем приступить к написанию кода, убедитесь, что у вас есть следующие инструменты и ресурсы:
-  Библиотека Aspose.Cells for .NET: ее можно загрузить с сайта[Страница загрузки Aspose.Cells для .NET](https://releases.aspose.com/cells/net/).
- Среда разработки: любая IDE, поддерживающая разработку .NET, например Visual Studio.
- .NET Framework: убедитесь, что ваш проект ориентирован на поддерживаемую версию .NET Framework.
 Также рассмотрите возможность получения[временная лицензия](https://purchase.aspose.com/temporary-license/) если вы хотите изучить все возможности без ограничений.
## Импортные пакеты
Прежде чем начать, убедитесь, что вы импортировали необходимые пространства имен Aspose.Cells. Вот как это сделать:
```csharp
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Drawing;
```
В этом уроке мы разобьем процесс добавления списка на несколько простых шагов. Внимательно следуйте каждому шагу, чтобы убедиться, что все работает так, как и ожидалось.
## Шаг 1: Настройка каталога документов
Прежде чем создать любой файл Excel, вам нужно место для его сохранения. Вот как настроить каталог:
```csharp
// Путь к каталогу документов.
string dataDir = "Your Document Directory";
// Создайте каталог, если он еще не существует.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
На этом этапе вы определяете, где будет храниться ваш файл. Код проверяет, существует ли каталог, и если его нет, он создает его для вас. Это гарантирует, что вы не столкнетесь с ошибками «файл не найден» в дальнейшем.
## Шаг 2: Создайте новую рабочую книгу и получите доступ к первому рабочему листу
Далее мы создадим новую рабочую книгу и откроем первый рабочий лист, куда добавим наш список.
```csharp
// Создайте новую рабочую книгу.
Workbook workbook = new Workbook();
// Получите первый рабочий лист.
Worksheet sheet = workbook.Worksheets[0];
```
Рабочая книга — это, по сути, ваш файл Excel. Здесь мы создаем новую рабочую книгу и получаем доступ к первому рабочему листу, на котором мы разместим наш список. Думайте об этом как о создании чистого холста, на котором вы будете рисовать элементы управления.
## Шаг 3: Входные данные для списка
Прежде чем добавить список, нам необходимо ввести некоторые данные, на которые будет ссылаться список.
```csharp
// Получите коллекцию ячеек рабочего листа.
Cells cells = sheet.Cells;
// Введите значение для метки.
cells["B3"].PutValue("Choose Dept:");
// Установите жирный шрифт для метки.
cells["B3"].GetStyle().Font.IsBold = true;
// Введите значения для списка.
cells["A2"].PutValue("Sales");
cells["A3"].PutValue("Finance");
cells["A4"].PutValue("MIS");
cells["A5"].PutValue("R&D");
cells["A6"].PutValue("Marketing");
cells["A7"].PutValue("HRA");
```
Здесь мы добавляем текст на рабочий лист. Метка "Choose Dept:" помещается в ячейку B3, а ее шрифт установлен на полужирный. В столбце A мы вставляем значения, которые будут служить диапазоном ввода для нашего списка, представляющего различные отделы. Этот диапазон ввода — то, из чего пользователи будут выбирать при взаимодействии со списком.
## Шаг 4: Добавьте список на рабочий лист.
Теперь, когда мы настроили данные, давайте добавим сам элемент управления списком.
```csharp
// Добавьте новый список.
Aspose.Cells.Drawing.ListBox listBox = sheet.Shapes.AddListBox(2, 0, 3, 0, 122, 100);
```
Этот код добавляет список на рабочий лист. Параметры определяют положение и размер списка. Список размещается в строке 2, столбце 0 с шириной 122 и высотой 100. Это координаты и размер, которые определяют, где список будет отображаться на рабочем листе.
## Шаг 5: Задайте свойства списка
Далее мы зададим различные свойства для списка, чтобы сделать его полностью функциональным.
```csharp
// Установите тип размещения.
listBox.Placement = PlacementType.FreeFloating;
// Установите связанную ячейку.
listBox.LinkedCell = "A1";
// Установите диапазон ввода.
listBox.InputRange = "A2:A7";
// Установите тип выбора.
listBox.SelectionType = SelectionType.Single;
// Установите для списка трехмерную заливку.
listBox.Shadow = true;
```
- PlacementType.FreeFloating: это свойство гарантирует, что список останется на своем месте независимо от того, как изменяется рабочий лист.
- LinkedCell: задает ячейку (в данном случае A1), в которой будет отображаться выбранное значение из списка.
- InputRange: сообщает списку, где искать список параметров (от A2 до A7, которые мы установили ранее).
- SelectionType.Single: позволяет пользователю выбрать только один элемент из списка.
- Тень: Эффект тени придает списку более трехмерный вид, делая его визуально привлекательнее.
## Шаг 6: Сохраните файл Excel.
Наконец, давайте сохраним нашу рабочую книгу со списком.
```csharp
// Сохраните рабочую книгу.
workbook.Save(dataDir + "book1.out.xls");
```
Эта строка кода сохраняет рабочую книгу в каталоге, который мы создали ранее. Файл называется "book1.out.xls", но вы можете выбрать любое имя, которое подходит вашему проекту.
## Заключение
И вот оно! Вы успешно добавили список на лист Excel с помощью Aspose.Cells для .NET. С помощью всего нескольких строк кода мы создали полностью функциональный список, сделав лист более интерактивным и динамичным. Этот урок должен дать вам прочную основу для изучения других элементов управления и функций в Aspose.Cells для .NET. Продолжайте экспериментировать, и вскоре вы освоите обширную функциональность библиотеки!
## Часто задаваемые вопросы
### Могу ли я разрешить множественный выбор в списке?  
 Да, вы можете изменить`SelectionType` к`SelectionType.Multi` чтобы разрешить множественный выбор.
### Могу ли я изменить внешний вид списка?  
Конечно! Aspose.Cells позволяет настраивать внешний вид списка, включая его размер, шрифт и даже цвет.
### Что делать, если мне позже понадобится удалить список?  
 Вы можете получить доступ к списку и удалить его из`Shapes` коллекция с использованием`sheet.Shapes.RemoveAt(index)`.
### Можно ли связать список с другой ячейкой?  
 Да, просто измените`LinkedCell` свойство в любую другую ячейку, в которой вы хотите отобразить выбранное значение.
### Как добавить больше элементов в список?  
Просто обновите диапазон ввода, вставив больше значений в указанные ячейки, и список автоматически обновится.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
