---
title: Добавить овал на рабочий лист в Excel
linktitle: Добавить овал на рабочий лист в Excel
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как добавить овал на лист Excel с помощью Aspose.Cells для .NET. Пошаговое руководство с подробными пояснениями кода.
weight: 17
url: /ru/net/excel-shapes-controls/add-oval-to-worksheet-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Добавить овал на рабочий лист в Excel

## Введение
Создание потрясающих и интерактивных файлов Excel может включать в себя не только числа и формулы. Такие формы, как овалы, могут добавить визуальную привлекательность или предоставить функциональные элементы на ваших рабочих листах. В этом уроке мы рассмотрим, как использовать Aspose.Cells для .NET для программного добавления овалов на рабочий лист Excel. Если вы хотите добавить немного стиля или функциональности, мы предоставим вам пошаговое руководство, в котором все подробно расписано.
## Предпосылки
Прежде чем погрузиться в код, вам необходимо выполнить несколько действий:
1.  Библиотека Aspose.Cells for .NET: ее можно загрузить с сайта[здесь](https://releases.aspose.com/cells/net/) или установите его с помощью NuGet в Visual Studio.
2. Среда разработки: AC# IDE, например Visual Studio.
3. Базовые знания C#: вы должны быть знакомы с основными концепциями кодирования на C#.
 Также не забудьте настроить свой проект, установив библиотеку Aspose.Cells for .NET. Если у вас еще нет лицензии, вы можете подать заявку на[временная лицензия](https://purchase.aspose.com/temporary-license/) или используйте[бесплатная пробная версия](https://releases.aspose.com/) версия.
## Импортные пакеты
Перед написанием любого кода убедитесь, что вы включили требуемые пространства имен. Вот фрагмент кода C#, чтобы убедиться, что вы используете правильные библиотеки:
```csharp
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Drawing;
using System.Drawing;
```
## Шаг 1: Настройте свой каталог
Первый шаг в добавлении овала на лист Excel — указать, где будет сохранен ваш файл Excel. Давайте определим путь к каталогу и убедимся, что каталог существует, прежде чем сохранять нашу работу.

Мы создадим путь к каталогу и проверим, существует ли он. Если папка не существует, она будет создана.
```csharp
// Путь к каталогу документов.
string dataDir = "Your Document Directory";
// Создайте каталог, если его еще нет.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
Этот шаг имеет решающее значение, поскольку он гарантирует, что ваш файл будет сохранен в правильном месте, и вы в дальнейшем не столкнетесь с проблемами пути к файлу.
## Шаг 2: Инициализация новой рабочей книги
Далее нам нужно создать новую рабочую книгу, в которую мы добавим наши овальные фигуры. Рабочая книга представляет собой файл Excel, и мы можем добавлять в нее содержимое или фигуры.

 На этом этапе мы создаем новый экземпляр`Workbook` объект, который будет служить контейнером нашего файла Excel.
```csharp
// Создайте новую рабочую книгу.
Workbook excelbook = new Workbook();
```
## Шаг 3: Добавьте первую овальную форму.
Теперь самое интересное — добавление овальной формы на рабочий лист. Этот овал может представлять визуальный элемент, например кнопку или выделение. Начнем с добавления первой овальной формы на первый рабочий лист нашей рабочей книги.

 Здесь мы используем`Shapes.AddOval()` метод создания овала на рабочем листе в определенной строке и столбце.
```csharp
// Добавьте овальную форму.
Aspose.Cells.Drawing.Oval oval1 = excelbook.Worksheets[0].Shapes.AddOval(2, 0, 2, 0, 130, 160);
```
 Параметры внутри`AddOval()` являются следующие:
- Первые две цифры обозначают строку и столбец для верхнего левого угла овала.
- Следующие две цифры обозначают высоту и ширину овала.
## Шаг 4: Задайте расположение и стиль овала
 После создания овала мы можем задать его положение, толщину линии и стиль штрихов.`Placement` Свойство определяет, как ведет себя овал при изменении размера или перемещении ячеек на листе.

Делаем овал свободно плавающим и корректируем его внешний вид.
```csharp
// Установите положение овала.
oval1.Placement = PlacementType.FreeFloating;
// Установите толщину линии.
oval1.Line.Weight = 1;
// Установите стиль штриховки овала.
oval1.Line.DashStyle = MsoLineDashStyle.Solid;
```
Это позволяет овалу свободно перемещаться по рабочему листу, а толщина его линии и стиль задаются для визуальной согласованности.
## Шаг 5: Добавьте еще одну овальную (круговую) форму.
Зачем останавливаться на чем-то одном? На этом этапе мы добавим еще один овал, на этот раз создав идеальный круг, сделав высоту и ширину одинаковыми.

Создаем еще один овал, размещаем его в другом месте и обеспечиваем ему круглую форму, задавая одинаковую высоту и ширину.
```csharp
// Добавьте еще один овал (круг).
Aspose.Cells.Drawing.Oval oval2 = excelbook.Worksheets[0].Shapes.AddOval(9, 0, 2, 15, 130, 130);
```
## Шаг 6: Оформите второй овал
Как и прежде, мы настроим расположение, толщину и стиль штрихов этого второго овала (или круга).

Применяем аналогичные свойства ко второму овалу, чтобы он соответствовал стилю первого.
```csharp
// Установите положение овала.
oval2.Placement = PlacementType.FreeFloating;
// Установите толщину линии.
oval2.Line.Weight = 1;
// Установите стиль штриховки овала.
oval2.Line.DashStyle = MsoLineDashStyle.Solid;
```
## Шаг 7: Сохраните рабочую книгу
Наконец, нам нужно сохранить книгу с овалами, которые мы только что добавили. Сохранение файла гарантирует, что все наши изменения будут сохранены.

Мы сохраняем рабочую книгу в каталоге, путь к которому мы определили ранее.
```csharp
// Сохраните файл Excel.
excelbook.Save(dataDir + "book1.out.xls");
```
Вот и все! Вы успешно добавили овалы на свой лист Excel и сохранили файл.
## Заключение
Добавление фигур, таких как овалы, в таблицу Excel с помощью Aspose.Cells for .NET — это не только простой, но и интересный способ улучшить ваши таблицы дополнительными визуальными элементами. Будь то для целей дизайна или добавления кликабельных элементов, фигуры могут играть важную роль в том, как выглядят и функционируют ваши файлы Excel. Поэтому в следующий раз, когда вы будете работать над проектом, требующим интерактивных или визуально привлекательных таблиц Excel, вы точно будете знать, как добавить эти идеальные овалы!
## Часто задаваемые вопросы
### Могу ли я добавлять другие фигуры, такие как прямоугольники или линии, с помощью Aspose.Cells для .NET?
 Да, вы можете добавлять различные фигуры, такие как прямоугольники, линии и стрелки, используя`Shapes` коллекция в Aspose.Cells.
### Можно ли изменить размер овалов после их добавления?
Конечно! Вы можете изменить высоту и ширину овалов после их добавления.
### В каких форматах файлов можно сохранить рабочую книгу, помимо XLS?
Aspose.Cells поддерживает множество форматов, среди которых XLSX, CSV и PDF.
### Могу ли я изменить цвет контура овала?
 Да, вы можете изменить цвет линии овала с помощью`Line.Color` свойство.
### Необходимо ли иметь лицензию для Aspose.Cells?
 Хотя вы можете попробовать Aspose.Cells с бесплатной пробной версией, вам понадобится[лицензия](https://purchase.aspose.com/buy) для долгосрочного использования или для доступа к расширенным функциям.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
