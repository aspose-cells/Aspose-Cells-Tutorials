---
title: Добавить элемент управления Spinner на рабочий лист в Excel
linktitle: Добавить элемент управления Spinner на рабочий лист в Excel
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как добавить элемент управления Spinner на лист Excel с помощью Aspose.Cells для .NET в этом пошаговом руководстве.
weight: 23
url: /ru/net/excel-shapes-controls/add-spinner-control-to-worksheet-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Добавить элемент управления Spinner на рабочий лист в Excel

## Введение
Если вы погружаетесь в мир автоматизации Excel с помощью .NET, вы, вероятно, сталкивались с необходимостью в более интерактивных элементах управления в ваших электронных таблицах. Одним из таких элементов управления является Spinner, который позволяет пользователям легко увеличивать или уменьшать значение. В этом уроке мы рассмотрим, как добавить элемент управления Spinner на лист Excel с помощью Aspose.Cells для .NET. Мы разобьем его на удобоваримые шаги, чтобы вы могли легко следовать. 
## Предпосылки
Прежде чем перейти к коду, давайте убедимся, что у вас все настроено для бесперебойной работы:
1.  Aspose.Cells для .NET: Убедитесь, что у вас есть библиотека Aspose.Cells. Если вы еще не установили ее, вы можете получить последнюю версию с[ссылка для скачивания](https://releases.aspose.com/cells/net/).
2. Visual Studio: у вас должна быть работающая установка Visual Studio или любой другой .NET IDE по вашему выбору.
3. Базовые знания C#: Знакомство с программированием на C# поможет вам легко понять фрагменты кода. Если вы только начинаете, не волнуйтесь! Я проведу вас через каждую часть.
## Импортные пакеты
Чтобы использовать Aspose.Cells в вашем проекте, вам нужно импортировать необходимые пространства имен. Вот как вы можете настроить свою среду:
```csharp
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Drawing;
using System.Drawing;
```
Эти пространства имен позволяют получить доступ к основным функциям Aspose.Cells, включая управление рабочими книгами и возможности рисования фигур, таких как Spinner.
Теперь, когда мы рассмотрели предварительные условия и импортировали необходимые пакеты, давайте погрузимся в пошаговое руководство. Каждый шаг разработан так, чтобы быть понятным и кратким, чтобы вы могли легко его реализовать.
## Шаг 1: Настройте каталог вашего проекта
Прежде чем начать кодировать, хорошей практикой будет организовать ваши файлы. Давайте создадим каталог для наших файлов Excel.
```csharp
// Путь к каталогу документов.
string dataDir = "Your Document Directory";
// Создайте каталог, если его еще нет.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
Здесь мы указываем путь к нашему каталогу документов. Если каталог не существует, мы его создаем. Это гарантирует, что все наши сгенерированные файлы будут иметь назначенный дом.
## Шаг 2: Создайте новую рабочую книгу
Теперь пришло время создать книгу Excel, в которую мы добавим наш элемент управления Spinner.
```csharp
// Создайте новую рабочую книгу.
Workbook excelbook = new Workbook();
```
 The`Workbook` класс представляет файл Excel. Создавая его экземпляр, мы создаем новую книгу, готовую к изменениям.
## Шаг 3: Получите доступ к первому рабочему листу
Мы добавим наш Spinner на первый лист рабочей книги.
```csharp
// Получите первый рабочий лист.
Worksheet worksheet = excelbook.Worksheets[0];
```
Эта строка обращается к первому листу (индекс 0) из нашей книги. У вас может быть несколько листов, но для этого примера мы сохраним простоту.
## Шаг 4: Работа с ячейками
Далее, давайте поработаем с ячейками на нашем листе. Зададим некоторые значения и стили.
```csharp
// Получите ячейки рабочего листа.
Cells cells = worksheet.Cells;
// Введите строковое значение в ячейку A1.
cells["A1"].PutValue("Select Value:");
// Установите цвет шрифта ячейки.
cells["A1"].GetStyle().Font.Color = Color.Red;
// Установите жирный шрифт текста.
cells["A1"].GetStyle().Font.IsBold = true;
// Введите значение в ячейку A2.
cells["A2"].PutValue(0);
```
Здесь мы заполняем ячейку A1 подсказкой, применяем красный цвет и делаем текст жирным. Мы также устанавливаем ячейку A2 на начальное значение 0, которое будет связано с нашим Spinner.
## Шаг 5: Оформление ячейки А2
Далее применим некоторые стили к ячейке A2, чтобы сделать ее более визуально привлекательной.
```csharp
// Установите черный цвет заливки со сплошным фоном.
cells["A2"].GetStyle().ForegroundColor = Color.Black;
cells["A2"].GetStyle().Pattern = BackgroundType.Solid;
// Установите цвет шрифта ячейки.
cells["A2"].GetStyle().Font.Color = Color.White;
// Установите жирный шрифт текста.
cells["A2"].GetStyle().Font.IsBold = true;
```
Мы добавляем черный фон со сплошным узором в ячейку A2 и устанавливаем цвет шрифта на белый. Этот контраст выделит его на рабочем листе.
## Шаг 6: Добавьте элемент управления Spinner
Теперь мы готовы добавить элемент управления Spinner на наш рабочий лист.
```csharp
// Добавьте элемент управления «Спиннер».
Aspose.Cells.Drawing.Spinner spinner = excelbook.Worksheets[0].Shapes.AddSpinner(1, 0, 1, 0, 20, 18);
```
Эта строка добавляет элемент управления Spinner на рабочий лист. Параметры определяют положение и размер Spinner (строка, столбец, ширина, высота).
## Шаг 7: Настройте свойства счетчика
Давайте настроим поведение Spinner в соответствии с нашими потребностями.
```csharp
// Установите тип размещения счетчика.
spinner.Placement = PlacementType.FreeFloating;
// Установите связанную ячейку для элемента управления.
spinner.LinkedCell = "A2";
// Установите максимальное значение.
spinner.Max = 10;
//Установите минимальное значение.
spinner.Min = 0;
// Установите шаг изменения для элемента управления.
spinner.IncrementalChange = 2;
// Установите 3-D затенение.
spinner.Shadow = true;
```
Здесь мы задаем свойства Spinner. Мы связываем его с ячейкой A2, позволяя ему управлять отображаемым там значением. Минимальное и максимальное значения определяют диапазон, в котором может работать Spinner, в то время как инкрементное изменение устанавливает, насколько сильно изменяется значение с каждым щелчком. Добавление 3-D затенения придает ему отточенный вид.
## Шаг 8: Сохраните файл Excel.
Наконец, давайте сохраним нашу книгу Excel со включенным Spinner.
```csharp
// Сохраните файл Excel.
excelbook.Save(dataDir + "book1.out.xls");
```
Эта команда сохраняет книгу в указанном каталоге. При необходимости вы можете изменить имя файла.
## Заключение
И вот оно! Вы успешно добавили элемент управления Spinner в лист Excel с помощью Aspose.Cells для .NET. Этот интерактивный элемент улучшает пользовательский опыт, позволяя быстро корректировать значения. Независимо от того, создаете ли вы динамический инструмент отчетности или форму ввода данных, элемент управления Spinner может стать ценным дополнением. 
## Часто задаваемые вопросы
### Что такое элемент управления Spinner в Excel?
Элемент управления Spinner позволяет пользователям легко увеличивать или уменьшать числовое значение, предоставляя интуитивно понятный способ выбора.
### Могу ли я настроить внешний вид спиннера?
Да, вы можете изменить его размер, положение и даже трехмерную штриховку, чтобы придать ему более изысканный вид.
### Нужна ли мне лицензия для использования Aspose.Cells?
 Aspose.Cells предлагает бесплатную пробную версию, но для использования в производстве требуется платная лицензия. Ознакомьтесь с[купить опционы](https://purchase.aspose.com/buy).
### Как мне получить помощь по Aspose.Cells?
 Для получения поддержки посетите[Форум Aspose](https://forum.aspose.com/c/cells/9) где вы можете задать вопросы и найти ответы.
### Можно ли добавить несколько счетчиков на один рабочий лист?
Конечно! Вы можете добавить столько спиннеров, сколько необходимо, выполнив те же шаги для каждого элемента управления.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
