---
title: Добавить элемент управления строкой на рабочий лист в Excel
linktitle: Добавить элемент управления строкой на рабочий лист в Excel
second_title: API обработки Excel Aspose.Cells .NET
description: В этом подробном руководстве вы научитесь добавлять и настраивать элементы управления строками на листах Excel с помощью Aspose.Cells для .NET.
weight: 26
url: /ru/net/excel-shapes-controls/add-line-control-to-worksheet-excel/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Добавить элемент управления строкой на рабочий лист в Excel

## Введение
Электронные таблицы Excel — это не только строки и столбцы данных; они также являются холстом для визуализации. Добавление элементов управления строками может улучшить способ представления информации на ваших рабочих листах, делая связи и тенденции намного яснее. Знакомьтесь с Aspose.Cells для .NET, мощной библиотекой, которая упрощает процесс создания и обработки файлов Excel программным способом. В этом руководстве мы проведем вас через шаги по добавлению элементов управления строками на рабочий лист с помощью Aspose.Cells. Если вы готовы поднять свой уровень Excel на новый уровень, давайте погрузимся в это!
## Предпосылки
Прежде чем вы начнете добавлять строки в рабочие листы Excel, вам понадобится следующее:
1.  Visual Studio: Убедитесь, что на вашем компьютере установлена Visual Studio. Если нет, вы можете загрузить ее с[веб-сайт](https://visualstudio.microsoft.com/).
2.  Aspose.Cells for .NET: Эта библиотека должна быть указана в вашем проекте. Подробную документацию можно найти[здесь](https://reference.aspose.com/cells/net/) и скачать библиотеку[здесь](https://releases.aspose.com/cells/net/).
3. Базовые знания C#: знакомство с программированием на C# поможет вам понять код, который мы будем рассматривать.
4. Среда Windows: поскольку Aspose.Cells разработан для приложений .NET, предпочтительнее использовать среду Windows.
## Импортные пакеты
Давайте настроим нашу среду кодирования, прежде чем мы начнем добавлять строки в ваш лист Excel. Вот как импортировать требуемый пакет Aspose.Cells в ваш проект.
### Создать новый проект
- Откройте Visual Studio.
- Создайте новый проект Console Application. Вы можете назвать его как угодно — например, "ExcelLineDemo" для ясности.
### Установить Aspose.Cells
- Перейдите в диспетчер пакетов NuGet в Visual Studio (`Tools` ->`NuGet Package Manager` ->`Manage NuGet Packages for Solution`).
-  Искать`Aspose.Cells` и установите его. Это действие добавит необходимые библиотеки в ваш проект.
### Импорт пространства имен
В верхней части основного файла программы добавьте следующую директиву using, чтобы сделать Aspose.Cells доступным:
```csharp
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Drawing;
```
Сделав это, вы теперь можете использовать все функции из библиотеки Aspose.Cells без добавления к ним префиксов.
Теперь, когда мы настроены, пришло время добавить несколько строк в наш рабочий лист. Мы подробно рассмотрим каждый шаг.
## Шаг 1: Настройте каталог документов
Прежде чем начать работать с файлом Excel, вам нужно определить, где он будет сохранен. Вот как это сделать:
```csharp
// Путь к каталогу документов.
string dataDir = "Your Document Directory";
```
 Заменять`"Your Document Directory"` с допустимым путем в вашей системе, где вы хотите сохранить выходной файл.
## Шаг 2: Создайте каталог
Хорошей практикой является обеспечение существования каталога. Если его нет, вы можете создать его с помощью следующего кода:
```csharp
// Создайте каталог, если его еще нет.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
```
Этот фрагмент кода проверяет, существует ли указанный каталог, и создает его, если его нет. Это как проверка рюкзака перед походом — вы хотите убедиться, что у вас есть все необходимое!
## Шаг 3: Создание новой рабочей книги
Теперь давайте создадим новую книгу Excel. Это холст, на котором вы будете рисовать свои линии.
```csharp
// Создайте новую рабочую книгу.
Workbook workbook = new Workbook();
```
 Создание нового экземпляра`Workbook` дает вам новый, пустой файл Excel для работы.
## Шаг 4: Доступ к первому рабочему листу
В каждой рабочей книге есть как минимум один рабочий лист, и для наших строк мы будем использовать первый из них.
```csharp
// Получите первый рабочий лист в книге.
Worksheet worksheet = workbook.Worksheets[0];
```
Здесь мы выбираем первый рабочий лист, обращаясь к нему через`Worksheets` коллекция`Workbook`.
## Шаг 5: Добавьте первую строку
Давайте начнем добавлять линии. Первая линия будет сплошной по стилю.
```csharp
// Добавьте новую строку на рабочий лист.
Aspose.Cells.Drawing.LineShape line1 = worksheet.Shapes.AddLine(5, 0, 1, 0, 0, 250);
```
В этом заявлении:
- `AddLine` метод добавляет линию, начинающуюся с координат`(5, 0)` и заканчивая на`(1, 0)` простирающийся на высоту`250`.
-  Координаты`(5, 0)` представляют собой начальную позицию на рабочем листе, в то время как`(1, 0, 0, 250)` обозначает конечное расстояние.
## Шаг 6: Задайте свойства линии
Теперь давайте немного персонализируем линию — зададим стиль и расположение ее штрихов.
```csharp
// Установить стиль пунктирной линии
line1.Line.DashStyle = MsoLineDashStyle.Solid;
// Установите место размещения.
line1.Placement = PlacementType.FreeFloating;
```
 Здесь мы указываем, что линия должна оставаться на одном месте независимо от изменений в структуре рабочего листа, используя`PlacementType.FreeFloating`.
## Шаг 7: Добавьте дополнительные линии
Давайте добавим вторую линию с другим стилем, используя пунктирный стиль.
```csharp
// Добавьте еще одну строку на рабочий лист.
Aspose.Cells.Drawing.LineShape line2 = worksheet.Shapes.AddLine(7, 0, 1, 0, 85, 250);
// Установите стиль пунктирной линии.
line2.Line.DashStyle = MsoLineDashStyle.DashLongDash;
// Установите толщину линии.
line2.Line.Weight = 4;
// Установите место размещения.
line2.Placement = PlacementType.FreeFloating;
```
 Обратите внимание, как мы изменили размещение и стиль тире на`DashLongDash`Свойство веса позволяет контролировать толщину линии.
## Шаг 8: Добавьте третью строку
Еще одна линия! Давайте добавим сплошную линию, чтобы завершить наш рисунок.
```csharp
// Добавьте третью строку на рабочий лист.
Aspose.Cells.Drawing.LineShape line3 = worksheet.Shapes.AddLine(13, 0, 1, 0, 0, 250);
```
Опять же, мы настраиваем его свойства аналогично тому, как мы настраивали предыдущие строки.
## Шаг 9: Скрыть линии сетки
Чтобы придать нашему рисунку более четкий вид, давайте скроем линии сетки рабочего листа.
```csharp
// Сделайте линии сетки невидимыми на первом рабочем листе.
workbook.Worksheets[0].IsGridlinesVisible = false;
```
Скрытие линий сетки помогает пользователям лучше сосредоточиться на фактически добавленных линиях, подобно тому, как художник расчищает область вокруг холста, чтобы не отвлекаться.
## Шаг 10: Сохраните рабочую книгу
Давайте наконец сохраним нашу рабочую тетрадь, чтобы наши труды не пропали даром!
```csharp
// Сохраните файл Excel.
workbook.Save(dataDir + "book1.out.xls");
```
 Вы можете назвать выходной файл как угодно — просто убедитесь, что он заканчивается на`.xls` или другое поддерживаемое расширение файла Excel.
## Заключение
Поздравляем! Вы успешно научились добавлять элементы управления строками в лист Excel с помощью Aspose.Cells для .NET. С помощью всего нескольких строк кода вы можете значительно улучшить свои файлы Excel, предлагая визуальное представление ваших данных, которое может помочь более эффективно передавать идеи. Независимо от того, хотите ли вы создавать отчеты, презентации или аналитические инструменты, освоение таких библиотек, как Aspose.Cells, может сделать ваш рабочий процесс намного более плавным и эффективным.
## Часто задаваемые вопросы
### Что такое Aspose.Cells для .NET?
Aspose.Cells для .NET — это библиотека, которая позволяет разработчикам создавать, изменять и конвертировать файлы Excel без необходимости использования Microsoft Excel.
### Могу ли я добавлять другие фигуры, кроме линий?
Да, Aspose.Cells предлагает различные формы, такие как прямоугольники, эллипсы и т. д. Вы можете легко создать их, используя похожие методы.
### Можно ли использовать Aspose.Cells бесплатно?
 Aspose.Cells — платная библиотека, но вы можете начать с[бесплатная пробная версия](https://releases.aspose.com/) для изучения его особенностей.
### Могу ли я настроить цвета линий?
 Конечно! Вы можете задать цветовые свойства линий, используя свойство линии`LineColor` свойство.
### Где я могу обратиться за технической поддержкой?
 Вы можете получить поддержку от[Форум Aspose](https://forum.aspose.com/c/cells/9) где члены сообщества и члены команды Aspose помогают пользователям.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
