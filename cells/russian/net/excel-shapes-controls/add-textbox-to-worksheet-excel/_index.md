---
"description": "Узнайте, как добавлять настраиваемые текстовые поля в Excel с помощью Aspose.Cells для .NET в этом пошаговом руководстве."
"linktitle": "Добавить текстовое поле на рабочий лист в Excel"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Добавить текстовое поле на рабочий лист в Excel"
"url": "/ru/net/excel-shapes-controls/add-textbox-to-worksheet-excel/"
"weight": 14
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Добавить текстовое поле на рабочий лист в Excel

## Введение
Хотите ли вы улучшить свои таблицы Excel уникальными визуальными эффектами, которые могут привлечь вашу аудиторию? Добавление текстовых полей — отличный способ сделать это! С Aspose.Cells для .NET вы можете легко интегрировать текстовые поля в свои рабочие листы Excel, делая свои документы более информативными и визуально привлекательными. Это пошаговое руководство проведет вас через простой процесс добавления текстовых полей с помощью Aspose.Cells, демонстрируя, как персонализировать их с помощью текста, цветов, гиперссылок и многого другого!
## Предпосылки
Прежде чем мы погрузимся в чудо кодирования, вот основные предпосылки для обеспечения бесперебойной работы:
1. Среда разработки .NET: Вам понадобится рабочая среда .NET вместе с IDE, например Visual Studio. Убедитесь, что она обновлена до последней версии!
2. Aspose.Cells для .NET: Убедитесь, что у вас загружена библиотека Aspose.Cells. Последнюю версию можно получить здесь [здесь](https://releases.aspose.com/cells/net/).
3. Базовые знания программирования: знакомство с C# и некоторыми общими концепциями обработки файлов Excel упростят этот урок!
## Импортные пакеты
Обязательно импортируйте необходимые пакеты в начале вашего файла C#. Вот как это можно сделать:
```csharp
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Drawing;
using System.Drawing;
```
## Установить Aspose.Cells
Если вы еще этого не сделали, вы можете добавить Aspose.Cells через диспетчер пакетов NuGet в Visual Studio:
1. Откройте Visual Studio.
2. Перейти к `Tools` -> `NuGet Package Manager` -> `Manage NuGet Packages for Solution`.
3. Найдите «Aspose.Cells» и установите его для своего проекта.
Теперь, когда мы заложили основу, давайте перейдем к самой интересной части!
## Шаг 1: Настройка каталога документов
Для начала давайте настроим каталог, в котором будут храниться все ваши документы Excel. Важно убедиться, что этот каталог существует, прежде чем мы начнем создавать нашу книгу.
```csharp
// Путь к каталогу документов.
string dataDir = "Your Document Directory"; 
// Создайте каталог, если его еще нет.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists) 
    System.IO.Directory.CreateDirectory(dataDir);
```
Этот фрагмент кода создаст каталог с именем `Your Document Directory` (замените на ваш реальный путь), если его еще нет. Легко и просто, правда?
## Шаг 2: Создание новой рабочей книги
Далее нам нужно создать новую рабочую книгу, в которую мы будем добавлять наши текстовые поля. Это можно легко сделать с помощью нескольких строк кода:
```csharp
// Создайте новую рабочую книгу.
Workbook workbook = new Workbook();
```
Эта строка кода создает новую книгу Excel. Просто и понятно!
## Шаг 3: Доступ к первому рабочему листу
Теперь, когда наша рабочая книга готова, давайте создадим первый рабочий лист, на который мы добавим текстовое поле:
```csharp
// Получите первый рабочий лист в книге.
Worksheet worksheet = workbook.Worksheets[0];
```
Вот так вот, теперь у вас есть доступ к первому рабочему листу под названием `worksheet`Пришло время заставить его сиять!
## Шаг 4: Добавление текстового поля
Хорошо, пришло время добавить наше первое текстовое поле! Вот как это сделать:
```csharp
// Добавьте новое текстовое поле в коллекцию.
int textboxIndex = worksheet.TextBoxes.Add(2, 1, 160, 200);
```
В этой строке мы указываем строку и столбец, где будет размещено текстовое поле, а также задаем его ширину и высоту (160 и 200 соответственно). Не стесняйтесь изменять эти числа в зависимости от вашего макета!
## Шаг 5: Получение объекта TextBox
После добавления текстового поля нам нужно получить ссылку на него, чтобы мы могли настроить его содержимое:
```csharp
// Получить объект текстового поля.
Aspose.Cells.Drawing.TextBox textbox0 = worksheet.TextBoxes[textboxIndex];
```
Сейчас, `textbox0` это ваш золотой билет на изменение этого текстового поля!
## Шаг 6: Заполнение текстового поля содержимым
Далее давайте добавим текст в текстовое поле:
```csharp
// Заполните текст.
textbox0.Text = "ASPOSE______The .NET & JAVA Component Publisher!";
```
Вставить текст в текстовое поле так просто! 
## Шаг 7: Настройте внешний вид текстового поля
А как насчет того, чтобы немного его приукрасить? Вы можете настроить цвета шрифтов, стили и многое другое!
```csharp
// Установите цвет шрифта.
textbox0.Font.Color = Color.Blue;
// Установите жирный шрифт.
textbox0.Font.IsBold = true;
// Установите размер шрифта.
textbox0.Font.Size = 14;
// Установите атрибут шрифта на курсив.
textbox0.Font.IsItalic = true;
```
Не стесняйтесь экспериментировать с разными цветами и стилями, чтобы увидеть, что будет смотреться лучше всего!
## Шаг 8: Добавление гиперссылки
Хотите превратить текстовое поле в кликабельную ссылку? Давайте сделаем это:
```csharp
// Добавьте гиперссылку в текстовое поле.
textbox0.AddHyperlink("http://www.aspose.com/");
```
Теперь любой, кто нажмет на ваше текстовое поле, будет перенесен на сайт Aspose. Это как по волшебству!
## Шаг 9: Установка типа размещения текстового поля
У вас есть разные варианты поведения текстового поля по отношению к вашему рабочему листу. Вот пример того, как сделать его свободно плавающим:
```csharp
// Установите место размещения.
textbox0.Placement = PlacementType.FreeFloating;
```
В качестве альтернативы, если вы хотите, чтобы он изменял размер и перемещался вместе с ячейками, вы можете настроить его следующим образом:
```csharp
// Установите тип размещения, так как текстовое поле будет перемещаться и изменять размер вместе с ячейками.
textbox1.Placement = PlacementType.MoveAndSize;
```
## Шаг 10: Настройка форматов линий и заливки
Вот как можно изменить внешний вид границы и заливки текстового поля:
```csharp
// Получить формат заполнения текстового поля.
Aspose.Cells.Drawing.FillFormat fillformat = textbox0.Fill;            
// Получить тип формата строки текстового поля.
Aspose.Cells.Drawing.LineFormat lineformat = textbox0.Line;           
// Установите толщину линии.
lineformat.Weight = 6;
// Установите стиль штрихов на квадратную точку.
lineformat.DashStyle = MsoLineDashStyle.SquareDot;
```
Благодаря этому вы можете дополнительно настроить текстовое поле, добавив в него визуальные элементы, соответствующие вашему стилю.
## Шаг 11: Добавление еще одного текстового поля
Никто не говорил, что мы можем добавить только одно текстовое поле! Давайте добавим еще одно с другим текстом:
```csharp
// Добавьте еще одно текстовое поле.
textboxIndex = worksheet.TextBoxes.Add(15, 4, 85, 120);
// Получите второе текстовое поле.
Aspose.Cells.Drawing.TextBox textbox1 = worksheet.TextBoxes[textboxIndex];
// Введите в него какой-нибудь текст.
textbox1.Text = "This is another simple text box";
```
Теперь вы действительно оживите свой лист Excel с помощью нескольких текстовых полей!
## Шаг 12: Сохранение вашей рабочей книги
Наконец, пришло время сохранить наш шедевр! Вот последняя строка кода на сегодня:
```csharp
// Сохраните файл Excel.
workbook.Save(dataDir + "book1.out.xls");
```
С помощью всего лишь одной строки кода вы создали и изменили файл Excel с настраиваемыми текстовыми полями!
## Заключение
Поздравляем! Вы успешно прошли через мир текстовых полей в Excel с помощью Aspose.Cells for .NET. Вы не только узнали, как добавить текстовое поле, но и как настроить его, чтобы сделать ваши таблицы более интересными. От изменения цветов и стилей до добавления гиперссылок — возможности практически безграничны! 
Вы готовы начать преобразовывать свои документы Excel? Дайте волю своему творчеству и экспериментируйте с различными макетами!
## Часто задаваемые вопросы
### Что такое Aspose.Cells для .NET?
Aspose.Cells для .NET — это мощная библиотека, которая позволяет разработчикам с легкостью создавать, изменять и конвертировать файлы Excel.
### Могу ли я попробовать Aspose.Cells перед покупкой?
Да! Вы можете скачать и использовать бесплатную пробную версию [здесь](https://releases.aspose.com/).
### Где я могу найти документацию по Aspose.Cells?
Вы можете получить доступ к полной документации по адресу [Документация Aspose.Cells](https://reference.aspose.com/cells/net/).
### Могу ли я получить поддержку, если у меня возникнут проблемы?
Конечно! Если вам нужна помощь, зайдите на [Форум Aspose](https://forum.aspose.com/c/cells/9) за помощь.
### Могу ли я использовать Aspose.Cells без лицензии?
Хотя вы можете использовать бесплатную пробную версию, для доступа к полному функционалу вам необходимо приобрести лицензию. Ознакомьтесь с ценами [здесь](https://purchase.aspose.com/buy).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}