---
"description": "Узнайте, как получить точки соединения фигур в Excel с помощью Aspose.Cells для .NET. Следуйте нашему пошаговому руководству, чтобы легко извлекать и отображать точки фигур программным способом."
"linktitle": "Получить точки соединения формы в Excel"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Получить точки соединения формы в Excel"
"url": "/ru/net/excel-shapes-controls/get-connection-points-shape-excel/"
"weight": 11
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Получить точки соединения формы в Excel

## Введение
При программной работе с файлами Excel нам часто нужно взаимодействовать с фигурами, встроенными в листы. Одной из более сложных задач, которые вы можете выполнить, является извлечение точек соединения из фигуры. Точки соединения используются для присоединения фигур с помощью соединителей и более точного управления их макетом. Если вы хотите получить точки соединения фигуры в Excel, Aspose.Cells for .NET — это инструмент, который вам нужен. В этом руководстве мы проведем вас через пошаговый процесс достижения этого.
## Предпосылки
Прежде чем приступить к изучению кода, убедитесь, что у вас выполнены следующие предварительные условия:
- Aspose.Cells для .NET: Вам понадобится установить Aspose.Cells в вашей среде разработки. Если у вас его еще нет, вы можете [скачать последнюю версию здесь](https://releases.aspose.com/cells/net/).
- Среда разработки: убедитесь, что у вас установлена рабочая версия Visual Studio или любая другая совместимая с .NET IDE.
- Базовые знания C#: в этом руководстве предполагается, что у вас есть базовые знания программирования на C# и принципов объектно-ориентированного программирования.
Вы также можете зарегистрироваться на [бесплатная пробная версия Aspose.Cells](https://releases.aspose.com/) если вы еще этого не сделали. Это даст вам доступ ко всем функциям, необходимым для этого руководства.

## Импортные пакеты
Для работы с Aspose.Cells в вашем проекте вам необходимо включить необходимые пространства имен. Следующие операторы импорта должны быть размещены в верхней части вашего кода:
```csharp
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Drawing;
using System.Drawing;
```
Эти пространства имен предоставляют вам доступ к основным функциям Aspose.Cells и позволяют управлять рабочими листами и фигурами.

## Пошаговое руководство по получению точек соединения фигуры
В этом разделе мы покажем вам, как извлечь точки соединения формы в листе Excel. Внимательно следуйте каждому шагу для ясного понимания.
## Шаг 1: Создание новой рабочей книги
Прежде всего, нам нужно создать экземпляр `Workbook` класс. Это представляет файл Excel в Aspose.Cells. Если у вас нет существующего файла, не проблема — вы можете начать с пустой книги.
```csharp
// Создать новую рабочую книгу
Workbook workbook = new Workbook();
```
На этом этапе мы создали пустую книгу Excel, но вы также можете загрузить существующую, передав путь к файлу `Workbook` конструктор.
## Шаг 2: Доступ к первому рабочему листу
Далее нам нужно получить доступ к рабочему листу, где мы хотим работать с фигурами. В этом случае мы будем использовать первый рабочий лист рабочей книги.
```csharp
// Получить первый рабочий лист в рабочей тетради
Worksheet worksheet = workbook.Worksheets[0];
```
Эта строка обращается к первому листу из коллекции листов в рабочей книге. Если вы работаете с определенным листом, вы можете заменить индекс `0` с желаемым индексом.
## Шаг 3: Добавьте новое текстовое поле (фигуру)
Теперь давайте добавим новую фигуру на рабочий лист. Мы создадим текстовое поле, которое является типом фигуры. Вы также можете добавлять другие типы фигур, но для простоты мы будем придерживаться текстового поля в этом уроке.
```csharp
// Добавить новое текстовое поле в коллекцию
int textboxIndex = worksheet.TextBoxes.Add(2, 1, 160, 200);
```
Вот что мы сделали:
- Добавлено текстовое поле в строке `2`, столбец `1`.
- Установите размеры текстового поля на `160` единиц по ширине и `200` единиц по высоте.
## Шаг 4: Получите доступ к фигуре из коллекции фигур.
После того, как мы добавили текстовое поле, оно становится частью коллекции фигур рабочего листа. Теперь мы получим доступ к этой фигуре с помощью `Shapes` коллекция.
```csharp
// Доступ к фигуре (текстовому полю) из коллекции фигур
Shape shape = workbook.Worksheets[0].Shapes[0];
```
На этом этапе мы извлекаем первую фигуру (наше текстовое поле) из коллекции. Если у вас несколько фигур, вы можете указать индекс или даже найти фигуру по имени.
## Шаг 5: Извлечение точек подключения
Теперь, когда у нас есть форма, давайте извлечем ее точки соединения. Эти точки используются для присоединения разъемов к форме. `ConnectionPoints` свойство формы возвращает все доступные точки соединения.
```csharp
// Получите все точки соединения в этой форме
var connectionPoints = shape.ConnectionPoints;
```
Это дает нам набор всех точек соединения, доступных для этой формы.
## Шаг 6: Отображение точек подключения
Наконец, мы хотим отобразить координаты каждой точки соединения. Здесь мы проходим по точкам соединения и выводим их на консоль.
```csharp
// Отобразить все точки формы
foreach (var pt in connectionPoints)
{
    System.Console.WriteLine(string.Format("X = {0}, Y = {1}", pt.X, pt.Y));
}
```
Этот цикл проходит по каждой точке соединения и выводит `X` и `Y` координаты. Это может быть полезно для отладки или визуального подтверждения точек соединения формы.
## Шаг 7: Выполнение и завершение
После того, как вы настроили все шаги выше, вы можете запустить код. Вот последняя строка, которая гарантирует успешное завершение процесса:
```csharp
System.Console.WriteLine("GetShapeConnectionPoints executed successfully.");
```
Эта строка просто выводит на консоль сообщение, указывающее на то, что процесс завершен.

## Заключение
В этом уроке мы рассмотрели, как извлечь точки соединения фигуры в Excel с помощью Aspose.Cells для .NET. Разбив задачу на небольшие, легко усваиваемые шаги, мы изучили процесс создания рабочей книги, добавления фигуры и извлечения точек соединения.
Понимая, как программно манипулировать фигурами, вы открываете мир возможностей для создания динамических и интерактивных листов Excel. Независимо от того, создаете ли вы отчеты, проектируете панели мониторинга или создаете диаграммы, эти знания пригодятся.
## Часто задаваемые вопросы
### Что такое точка соединения в форме?
Точка соединения — это определенная точка на фигуре, к которой можно прикрепить соединители или связать ее с другими фигурами.
### Можно ли получить точки соединения для всех фигур на рабочем листе?
Да, Aspose.Cells позволяет вам извлекать точки соединения для любой формы, которая их поддерживает. Просто пройдитесь по коллекции фигур на рабочем листе.
### Нужна ли мне лицензия для использования Aspose.Cells?
Да, хотя вы можете попробовать его бесплатно, для полного функционала требуется лицензия. Вы можете [купить лицензию здесь](https://purchase.aspose.com/buy) или получить [временная лицензия](https://purchase.aspose.com/temporary-license/).
### Как добавить различные типы фигур в Aspose.Cells?
Вы можете использовать `Add` метод для таких фигур, как прямоугольники, эллипсы и т. д. У каждой фигуры есть определенные параметры, которые вы можете настроить.
### Как загрузить существующий файл Excel вместо создания нового?
Чтобы загрузить существующий файл, передайте путь к файлу в `Workbook` конструктор, например такой:  
```csharp
Workbook workbook = new Workbook("path_to_file.xlsx");
```

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}