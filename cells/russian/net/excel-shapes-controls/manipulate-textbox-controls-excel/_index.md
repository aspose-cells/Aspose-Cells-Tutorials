---
"description": "Узнайте, как управлять текстовыми полями в Excel с помощью Aspose.Cells для .NET, с помощью этого простого пошагового руководства."
"linktitle": "Управление элементами управления TextBox в Excel"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Управление элементами управления TextBox в Excel"
"url": "/ru/net/excel-shapes-controls/manipulate-textbox-controls-excel/"
"weight": 15
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Управление элементами управления TextBox в Excel

## Введение
Если вы когда-либо работали с Excel, вы, вероятно, сталкивались с этими маленькими текстовыми полями, которые позволяют добавлять плавающий текст в электронную таблицу. Но что, если вам нужно программно манипулировать этими текстовыми полями? Вот где Aspose.Cells for .NET оказывается полезным. С его помощью вы можете легко получать доступ к текстовым полям и изменять их, что делает его идеальным для автоматизации задач или настройки отчетов. В этом руководстве мы проведем вас через процесс манипулирования текстовыми полями в Excel с помощью Aspose.Cells for .NET.
## Предпосылки
Прежде чем погрузиться в сам код, давайте убедимся, что у вас все настроено правильно:
1. Aspose.Cells for .NET: Вам необходимо скачать библиотеку Aspose.Cells for .NET. Ссылку на скачивание вы найдете [здесь](https://releases.aspose.com/cells/net/).
2. Среда разработки .NET: подойдет любая IDE, поддерживающая .NET, например Visual Studio.
3. Базовые знания C#: в этом руководстве предполагается, что вы знакомы с базовым синтаксисом C# и структурой рабочих книг Excel.
4. Файл Excel: существующий файл Excel с текстовыми полями (мы будем использовать `book1.xls` в этом примере).
5. Лицензия Aspose: если вы не используете бесплатную пробную версию, вам необходимо [купить](https://purchase.aspose.com/buy) лицензию или получить [временный](https://purchase.aspose.com/temporary-license/).
Теперь давайте перейдем к шагам!
## Импортные пакеты
Прежде чем вы сможете манипулировать рабочими книгами Excel и текстовыми полями с помощью Aspose.Cells, вам нужно импортировать необходимые пространства имен. Вот фрагмент кода, который вы будете использовать в верхней части файла C#:
```csharp
using System.IO;
using Aspose.Cells;
```
Эти пакеты предоставляют вам доступ к работе с рабочими книгами, доступ к рабочим листам и графическим объектам (например, текстовым полям).
Теперь, когда у нас все готово, давайте разберем процесс работы с текстовыми полями на простые шаги.
## Шаг 1: Настройте каталог ваших рабочих книг
Первый шаг — указать, где в вашей системе находятся файлы Excel. Вам нужно будет заменить заполнитель `Your Document Directory` с фактическим путем к вашему файлу. Этот путь хранится в `dataDir` переменная для удобства ссылки в коде.
```csharp
string dataDir = "Your Document Directory";
```
Это позволяет вашей программе узнать, где найти входной файл Excel (`book1.xls`) и где сохранить выходной файл.
## Шаг 2: Откройте файл Excel.
Далее вам нужно будет загрузить существующий файл Excel в объект Aspose.Cells Workbook. Эта книга выступает в качестве контейнера для ваших данных Excel, предоставляя вам доступ к ее рабочим листам и любым объектам рисования (например, текстовым полям).
```csharp
Workbook workbook = new Workbook(dataDir + "book1.xls");
```
The `Workbook` класс из Aspose.Cells загрузит указанный файл Excel из вашего каталога. Если файл не существует в указанном каталоге, он выдаст исключение, поэтому убедитесь, что путь указан правильно.
## Шаг 3: Получите доступ к первому рабочему листу
Теперь, когда рабочая книга загружена, вы можете получить доступ к ее рабочим листам. В этом примере мы получаем доступ к первому рабочему листу в рабочей книге, который хранится под индексом 0.
```csharp
Worksheet worksheet = workbook.Worksheets[0];
```
The `Worksheets` свойство дает вам доступ ко всем листам в рабочей книге. Здесь нас интересует только первый лист, но вы можете работать с любым листом, указав правильный индекс.
## Шаг 4: Получите первый объект TextBox
Текстовые поля в таблице Excel считаются объектами рисования. Класс Aspose.Cells.Drawing.TextBox предоставляет свойства и методы для управления ими. Чтобы получить доступ к первому текстовому полю на листе, вы просто ссылаетесь на `TextBoxes` коллекция по индексу.
```csharp
Aspose.Cells.Drawing.TextBox textbox0 = worksheet.TextBoxes[0];
```
Это извлекает первый объект текстового поля из `TextBoxes` коллекция. Если на вашем рабочем листе нет текстового поля с этим индексом, будет выдано исключение, поэтому всегда проверяйте, что индекс действителен.
## Шаг 5: Извлечение текста из первого текстового поля
Получив доступ к текстовому полю, вы можете извлечь содержащийся в нем текст с помощью `.Text` свойство.
```csharp
string text0 = textbox0.Text;
```
Это позволит перенести текст из первого текстового поля в `text0` string. Теперь вы можете отображать ее, манипулировать ею или обрабатывать ее в своем приложении.
## Шаг 6: Доступ ко второму объекту TextBox
Чтобы управлять несколькими текстовыми полями, мы можем извлечь дополнительные из рабочего листа. Здесь мы получим доступ ко второму текстовому полю таким же образом, как и к первому:
```csharp
Aspose.Cells.Drawing.TextBox textbox1 = worksheet.TextBoxes[1];
```
Опять же, мы получаем доступ ко второму текстовому полю, используя индекс 1 из `TextBoxes` коллекция.
## Шаг 7: Извлечение текста из второго текстового поля
Как и в случае с первым текстовым полем, вы можете извлечь текст из второго текстового поля и сохранить его в строке:
```csharp
string text1 = textbox1.Text;
```
Это позволит захватить текущий текст из второго текстового поля.
## Шаг 8: Измените текст во втором текстовом поле.
Теперь, предположим, вы хотите изменить текст во втором текстовом поле. Вы можете легко сделать это, назначив новую строку `.Text` свойство объекта текстового поля.
```csharp
textbox1.Text = "This is an alternative text";
```
Это изменит текст внутри второго текстового поля на новый контент. Вы можете вставить сюда любой текст в соответствии с вашими требованиями.
## Шаг 9: Сохраните обновленный файл Excel.
Наконец, после изменения текстовых полей, пришло время сохранить изменения. Aspose.Cells позволяет вам сохранить измененную книгу с помощью `.Save()` Метод. Вы можете указать новое имя файла или перезаписать существующий файл.
```csharp
workbook.Save(dataDir + "output.out.xls");
```
Это сохранит измененный файл Excel в указанном вами выходном пути. Теперь, когда вы откроете файл Excel, вы увидите изменения, которые вы внесли в текстовые поля.
## Заключение
И вот оно! Вы только что узнали, как управлять текстовыми полями в Excel с помощью Aspose.Cells для .NET. Независимо от того, автоматизируете ли вы создание отчетов, настраиваете таблицы Excel или создаете динамический контент, Aspose.Cells позволяет легко контролировать каждый аспект ваших файлов Excel программным путем. От извлечения и изменения текста до сохранения обновленных файлов эта библиотека является мощным инструментом для разработчиков, работающих с Excel в средах .NET.
## Часто задаваемые вопросы
### Могу ли я манипулировать другими объектами чертежей с помощью Aspose.Cells, помимо текстовых полей?
Да, Aspose.Cells позволяет вам манипулировать другими графическими объектами, такими как фигуры, диаграммы и изображения.
### Что произойдет, если я попытаюсь получить доступ к текстовому полю, которого не существует?
Если индекс текстового поля выходит за пределы диапазона, `IndexOutOfRangeException` будет брошен.
### Можно ли добавлять новые текстовые поля на лист Excel с помощью Aspose.Cells?
Да, Aspose.Cells позволяет добавлять новые текстовые поля с помощью `AddTextBox` метод.
### Нужна ли мне лицензия для использования Aspose.Cells?
Да, вам нужно будет приобрести лицензию, но Aspose также предлагает [бесплатная пробная версия](https://releases.aspose.com/).
### Могу ли я использовать Aspose.Cells с другими языками программирования, помимо C#?
Да, Aspose.Cells можно использовать с любым языком, поддерживаемым .NET, например VB.NET.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}