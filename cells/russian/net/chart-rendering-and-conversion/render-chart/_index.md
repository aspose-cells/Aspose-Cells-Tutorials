---
title: Рендеринг диаграммы
linktitle: Рендеринг диаграммы
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как визуализировать диаграммы в .NET с помощью Aspose.Cells. Следуйте нашему пошаговому руководству, чтобы создавать потрясающие визуальные эффекты без усилий.
weight: 10
url: /ru/net/chart-rendering-and-conversion/render-chart/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Рендеринг диаграммы

## Введение

Диаграммы являются важным элементом представления и анализа данных, делая сложную информацию легко усваиваемой. Если вы работаете с .NET и вам нужно программно генерировать диаграммы, Aspose.Cells — это мощная библиотека, которая предоставляет интуитивно понятные и расширенные функции для обработки файлов и диаграмм Excel. В этом руководстве мы рассмотрим процесс рендеринга диаграммы с помощью Aspose.Cells для .NET. Приготовьтесь погрузиться в этот подробный урок, который разработан так, чтобы быть увлекательным и простым для понимания!

## Предпосылки

Прежде чем перейти к коду, давайте убедимся, что у вас все готово. Вот что вам нужно:

1. Среда .NET: Убедитесь, что у вас настроена среда разработки .NET. Вы можете использовать Visual Studio или любую другую IDE, которая поддерживает .NET.
2.  Aspose.Cells для .NET: Вам необходимо установить библиотеку Aspose.Cells. Вы можете загрузить ее с[Страница релиза Aspose](https://releases.aspose.com/cells/net/).
3. Базовые знания C#: знакомство с программированием на C# поможет вам лучше понять примеры, но не волнуйтесь, если вы новичок — это руководство объяснит все шаг за шагом!

## Импортные пакеты

Первый шаг в вашем путешествии по кодированию — импорт необходимых пакетов. Откройте свой проект в IDE и добавьте следующее пространство имен:

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Aspose.Cells.Rendering;
```

Эти пространства имен предоставят вам доступ к функциональным возможностям библиотеки Aspose.Cells, что позволит вам легко создавать и изменять диаграммы.


Теперь, когда мы рассмотрели предварительные условия и импорт, давайте погрузимся в тонкости рендеринга диаграммы! Мы разобьем это на понятные, управляемые шаги.

## Шаг 1: Настройте выходной каталог

Прежде чем создавать нашу рабочую книгу и диаграмму, нам нужно установить, где будут сохраняться наши выходные данные. Таким образом, когда наша диаграмма будет создана, вы будете точно знать, где ее найти.

```csharp
string outputDir = "Your Output Directory"; // Укажите здесь выходной каталог.
```

Обязательно замените «Ваш выходной каталог» на путь, по которому вы хотите сохранить изображения диаграмм.

## Шаг 2: Создайте рабочую книгу

Далее мы создадим новую рабочую книгу. Здесь и происходит вся магия!

```csharp
Workbook workbook = new Workbook();
```

 Эта строка создает новый экземпляр`Workbook` класс, который позволяет нам работать с листами и диаграммами.

## Шаг 3: Добавьте новый рабочий лист

Теперь, когда у нас есть рабочая книга, пришло время добавить новый рабочий лист. Подумайте о рабочих листах как о разных страницах в блокноте, где вы можете хранить свои данные организованно.

```csharp
int sheetIndex = workbook.Worksheets.Add();
Worksheet worksheet = workbook.Worksheets[sheetIndex];
```

Здесь мы добавляем новый рабочий лист и получаем ссылку на него. Вы будете работать с этим рабочим листом, чтобы вводить данные и диаграммы.

## Шаг 4: Введите выборочные значения

Создав наш рабочий лист, давайте добавим в ячейки некоторые образцы данных. На этих данных будет основана ваша диаграмма, поэтому выбирайте значения, которые имеют смысл для вашего типа диаграммы!

```csharp
worksheet.Cells["A1"].PutValue(50);
worksheet.Cells["A2"].PutValue(100);
worksheet.Cells["A3"].PutValue(150);
worksheet.Cells["B1"].PutValue(4);
worksheet.Cells["B2"].PutValue(20);
worksheet.Cells["B3"].PutValue(50);
```

В этом фрагменте мы заполняем ячейки "A1" - "A3" некоторыми числовыми значениями, а ячейки "B1" - "B3" - другим набором значений. Не стесняйтесь настраивать эти числа в соответствии с вашими потребностями!

## Шаг 5: Создайте диаграмму

Теперь пришло время создать вашу диаграмму. Мы добавим столбчатую диаграмму, которая отлично подходит для сравнения значений.

```csharp
int chartIndex = worksheet.Charts.Add(ChartType.Column, 5, 0, 15, 5);
Aspose.Cells.Charts.Chart chart = worksheet.Charts[chartIndex];
```

Здесь мы добавляем диаграмму в указанное место, определяя ее макет: первый набор чисел представляет положение диаграммы на сетке.

## Шаг 6: Добавление ряда данных в диаграмму

Создав диаграмму, нам теперь нужно привязать ее к данным, которые мы ввели на предыдущих шагах.

```csharp
chart.NSeries.Add("A1:B3", true);
```

Эта линия соединяет ряд данных диаграммы со значениями в ячейках "A1" - "B3". Это означает, что ваша диаграмма будет визуально представлять данные так, как и предполагалось.

## Шаг 7: Сохраните диаграмму как изображение.

Теперь давайте преобразуем нашу диаграмму в формат изображения, чтобы ее можно было легко просматривать и делиться ею.

```csharp
chart.ToImage(outputDir + "outputChartRendering.emf", System.Drawing.Imaging.ImageFormat.Emf);
```

На этом этапе мы сохраняем диаграмму как изображение EMF (Enhanced Metafile) в указанном выходном каталоге. Вы также можете сохранить ее в различных форматах, таких как BMP или PNG.

## Шаг 8: Преобразование диаграммы в растровое изображение

Если вы предпочитаете работать с растровыми изображениями, вот как преобразовать вашу диаграмму в формат Bitmap.

```csharp
System.Drawing.Bitmap bitmap = chart.ToImage();
bitmap.Save(outputDir + "outputChartRendering.bmp", System.Drawing.Imaging.ImageFormat.Bmp);
```

Это сохранит вашу диаграмму как изображение BMP. Помните, файлы BMP, как правило, больше, но невероятно высокого качества!

## Шаг 9: Рендеринг с расширенными параметрами

Мы также можем отрисовать диаграмму с некоторыми расширенными параметрами изображения для лучшего качества и разрешения. Давайте настроим несколько параметров:

```csharp
ImageOrPrintOptions options = new ImageOrPrintOptions()
{
    VerticalResolution = 300,
    HorizontalResolution = 300,
    SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.AntiAlias
};
```

Эти параметры помогают улучшить визуальное качество создаваемого изображения, что особенно полезно для презентаций или публикаций.

## Шаг 10: Преобразование диаграммы в изображение с помощью дополнительных параметров

Теперь давайте фактически преобразуем диаграмму, используя расширенные параметры, которые мы только что установили.

```csharp
chart.ToImage(outputDir + "outputChartRendering.png", options);
```

Это позволит сохранить вашу диаграмму в формате PNG-файла с улучшенными настройками качества.

## Шаг 11: Экспорт диаграммы в PDF

Наконец, если вам нужен безупречный документ, которым легко поделиться, вы можете экспортировать свою диаграмму непосредственно в формат PDF.

```csharp
chart.ToPdf(outputDir + "outputChartRendering.pdf");
```

На этом этапе будет создан PDF-файл, содержащий вашу диаграмму, что сделает его идеальным для цифровых отчетов или для обмена с коллегами.

## Заключение 

Поздравляем! Вы успешно отрисовали диаграмму с помощью Aspose.Cells для .NET. Эта мощная библиотека упрощает создание и обработку файлов и диаграмм Excel, делая ваши данные намного более доступными и визуально привлекательными. Независимо от того, готовите ли вы отчеты, анализы или презентации, диаграммы оказывают значительное влияние, и с Aspose вы можете легко создавать их программно.

## Часто задаваемые вопросы

### Какие типы диаграмм можно создавать с помощью Aspose.Cells для .NET?
Вы можете создавать различные диаграммы, включая столбчатые, линейные, круговые и столбчатые диаграммы, а также другие.

### Могу ли я настроить внешний вид диаграмм?
Да, Aspose.Cells допускает обширную настройку, включая цвета, стили и элементы диаграмм.

### Есть ли бесплатная пробная версия?
Конечно! Вы можете скачать бесплатную пробную версию с сайта[здесь](https://releases.aspose.com/).

### Где я могу получить поддержку по Aspose.Cells?
 Поддержку и ресурсы сообщества можно найти на сайте[Форум поддержки Aspose](https://forum.aspose.com/c/cells/9).

### Нужна ли мне лицензия для использования Aspose.Cells?
 Да, для дальнейшего использования после окончания пробного периода требуется лицензия, но вы можете подать заявку на временную лицензию.[здесь](https://purchase.aspose.com/temporary-license/).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
