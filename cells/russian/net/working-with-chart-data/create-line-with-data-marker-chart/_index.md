---
"description": "Узнайте, как создать диаграмму Line with Data Markers в Excel с помощью Aspose.Cells для .NET. Следуйте этому пошаговому руководству, чтобы легко создавать и настраивать диаграммы."
"linktitle": "Создать линию с маркером данных диаграммы"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Создать линию с маркером данных диаграммы"
"url": "/ru/net/working-with-chart-data/create-line-with-data-marker-chart/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Создать линию с маркером данных диаграммы

## Введение

Вы когда-нибудь задумывались, как создавать потрясающие диаграммы в Excel программным способом? Что ж, пристегнитесь, потому что сегодня мы погрузимся в создание линии с маркером данных с помощью Aspose.Cells для .NET. Этот урок проведет вас через каждый шаг, гарантируя, что вы прочно усвоите генерацию диаграмм, даже если вы только начинаете работать с Aspose.Cells.

## Предпосылки

Прежде чем начать, убедитесь, что у вас все готово для беспрепятственного продолжения.

1. Библиотека Aspose.Cells for .NET – Вам нужно установить ее. Вы можете взять ее [здесь](https://releases.aspose.com/cells/net/).
2. .NET Framework — убедитесь, что ваша среда разработки настроена на использование последней версии .NET.
3. IDE (интегрированная среда разработки) – рекомендуется Visual Studio.
4. Действующая лицензия Aspose.Cells — если у вас ее нет, вы можете запросить [временная лицензия](https://purchase.aspose.com/temporary-license/) или проверьте их [бесплатная пробная версия](https://releases.aspose.com/).

Готовы? Давайте разберемся!

## Импорт необходимых пакетов

Для начала убедитесь, что вы импортировали следующие пространства имен в свой проект. Они предоставят необходимые классы и методы для создания вашей диаграммы.

```csharp
using System;
using System.IO;
using Aspose.Cells;
using Aspose.Cells.Charts;
using System.Drawing;
```

Как только вы это поймете, мы сможем начать кодировать!

## Шаг 1: Настройте свою рабочую книгу и рабочий лист

Прежде всего, вам необходимо создать новую рабочую книгу и получить доступ к первому рабочему листу.

```csharp
//Выходной каталог
static string outputDir = "Your Document Directory";
		
// Создать экземпляр рабочей книги
Workbook workbook = new Workbook();

// Доступ к первому рабочему листу
Worksheet worksheet = workbook.Worksheets[0];
```

Думайте о книге как о файле Excel, а о рабочем листе как о конкретном листе внутри него. В этом случае мы работаем с первым листом.

## Шаг 2: Заполните рабочий лист данными

Теперь, когда у нас есть рабочий лист, давайте заполним его данными. Мы создаем случайные точки данных для двух серий значений.

```csharp
// Установить заголовок столбца
worksheet.Cells[0, 0].Value = "X";
worksheet.Cells[0, 1].Value = "Y";

// Случайные данные для построения диаграммы
Random R = new Random();

// Создайте случайные данные и сохраните в ячейках.
for (int i = 1; i < 21; i++)
{
    worksheet.Cells[i, 0].Value = i;
    worksheet.Cells[i, 1].Value = 0.8;
}

for (int i = 21; i < 41; i++)
{
    worksheet.Cells[i, 0].Value = i - 20;
    worksheet.Cells[i, 1].Value = 0.9;
}
```

Здесь мы используем случайные числа для моделирования данных, но в реальных приложениях вы можете заполнить их реальными значениями из вашего набора данных.

## Шаг 3: Добавьте диаграмму на рабочий лист.

Далее мы добавляем диаграмму на рабочий лист и выбираем тип — в данном случае это линейная диаграмма с маркерами данных.

```csharp
// Добавить диаграмму на рабочий лист
int idx = worksheet.Charts.Add(ChartType.LineWithDataMarkers, 1, 3, 20, 20);

// Доступ к недавно созданной диаграмме
Chart chart = worksheet.Charts[idx];
```

Этот фрагмент добавляет линейную диаграмму с маркерами данных на рабочий лист, помещая ее в определенный диапазон (от 1,3 до 20,20). Довольно просто, не правда ли?

## Шаг 4: Настройте внешний вид диаграммы

После создания диаграммы вы можете оформить ее по своему вкусу. Давайте изменим фон, заголовок и стиль диаграммы.

```csharp
// Установить стиль диаграммы
chart.Style = 3;

// Установите значение автомасштабирования на true
chart.AutoScaling = true;

// Установить белый цвет переднего плана
chart.PlotArea.Area.ForegroundColor = Color.White;

// Установить свойства заголовка диаграммы
chart.Title.Text = "Sample Chart";

// Установить тип диаграммы
chart.Type = ChartType.LineWithDataMarkers;
```

Здесь мы придаем диаграмме аккуратный вид, устанавливая белый фон, автоматическое масштабирование и давая ей содержательное название.

## Шаг 5: Определите ряд и постройте график точек данных

Теперь, когда наша диаграмма выглядит хорошо, нам нужно определить ряд данных, которые будут отображены.

```csharp
// Установить свойства заголовка оси категории
chart.CategoryAxis.Title.Text = "Units";

// Определить два ряда для диаграммы
int s2_idx = chart.NSeries.Add("A2: A21", true);
int s3_idx = chart.NSeries.Add("A22: A41", true);
```

Эти ряды соответствуют диапазонам точек данных, которые мы заполнили ранее.

## Шаг 6: Добавьте цвета и настройте маркеры серий

Давайте сделаем эту диаграмму еще более привлекательной, добавив пользовательские цвета к маркерам данных.

```csharp
// Настройте первую серию
chart.NSeries[s2_idx].Marker.Area.ForegroundColor = Color.Yellow;
chart.NSeries[s2_idx].Marker.Border.IsVisible = false;

// Настроить вторую серию
chart.NSeries[s3_idx].Marker.Area.ForegroundColor = Color.Green;
chart.NSeries[s3_idx].Marker.Border.IsVisible = false;
```

Настраивая цвета, вы делаете диаграмму не только функциональной, но и визуально привлекательной!

## Шаг 7: Установите значения X и Y для каждой серии

Наконец, давайте присвоим значения X и Y для каждой из наших серий.

```csharp
// Установите значения X и Y первой серии
chart.NSeries[s2_idx].XValues = "A2: A21";
chart.NSeries[s2_idx].Values = "B2: B21";

// Установите значения X и Y второй серии
chart.NSeries[s3_idx].XValues = "A22: A41";
chart.NSeries[s3_idx].Values = "B22: B41";
```

Значения основаны на данных, которые мы ввели на шаге 2.

## Шаг 8: Сохраните рабочую книгу

Теперь, когда все настроено, давайте сохраним рабочую книгу, чтобы увидеть диаграмму в действии.

```csharp
// Сохраните рабочую книгу
workbook.Save(outputDir + @"LineWithDataMarkerChart.xlsx", Aspose.Cells.SaveFormat.Xlsx);
```

Вот и все! Вы только что создали линейную диаграмму с маркерами данных с помощью Aspose.Cells для .NET.

## Заключение

Создание диаграмм программным способом в Excel может показаться сложным, но с Aspose.Cells для .NET это так же просто, как следовать пошаговому рецепту. От настройки вашей рабочей книги до настройки внешнего вида диаграммы, эта мощная библиотека справляется со всем этим. Независимо от того, создаете ли вы отчеты, панели мониторинга или визуализации данных, Aspose.Cells позволяет вам делать это на одном дыхании.

## Часто задаваемые вопросы

### Могу ли я дополнительно настроить диаграмму?  
Конечно! Aspose.Cells предлагает массу возможностей настройки: от шрифтов до линий сетки и многого другого.

### Нужна ли мне лицензия для использования Aspose.Cells?  
Да, для полной функциональности требуется лицензия. Вы можете получить [временная лицензия](https://purchase.aspose.com/temporary-license/) или начните с [бесплатная пробная версия](https://releases.aspose.com/).

### Как добавить больше рядов данных?  
Просто добавьте дополнительные серии с помощью `NSeries.Add` метод, указывающий диапазоны ячеек для новых данных.

### Могу ли я экспортировать диаграмму как изображение?  
Да, вы можете экспортировать диаграммы напрямую как изображения, используя `Chart.ToImage` метод.

### Поддерживает ли Aspose.Cells трехмерные диаграммы?  
Да, Aspose.Cells поддерживает широкий спектр типов диаграмм, включая трехмерные диаграммы.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}