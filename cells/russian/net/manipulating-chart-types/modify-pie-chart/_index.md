---
"description": "Откройте для себя мощь Aspose.Cells для .NET, чтобы без труда изменять круговые диаграммы Excel. Следуйте этому руководству для пошагового руководства."
"linktitle": "Изменить круговую диаграмму"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Изменить круговую диаграмму"
"url": "/ru/net/manipulating-chart-types/modify-pie-chart/"
"weight": 16
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Изменить круговую диаграмму

## Введение

Вы когда-нибудь задумывались, как можно украсить круговые диаграммы в своих таблицах Excel? Круговые диаграммы могут быть фантастическим способом визуализации данных, удерживая вашу аудиторию вовлеченной и информированной. Однако иногда эти диаграммы не рассказывают ту историю, которую вы хотите, чтобы они рассказали прямо из коробки. Вот где в игру вступает Aspose.Cells для .NET. Эта мощная библиотека позволяет вам программно манипулировать файлами Excel, предоставляя вам инструменты, необходимые для настройки круговых диаграмм вплоть до мельчайших деталей. В этом уроке мы собираемся глубоко погрузиться в изменение круговой диаграммы с помощью Aspose.Cells. Будь то изменение меток данных или настройка эстетики диаграммы.

## Предпосылки

Прежде чем мы углубимся в тонкости изменения круговых диаграмм, необходимо выполнить несколько предварительных условий:

- Базовые знания C#: фундаментальное понимание программирования на C# поможет вам легко освоить материал.
- Aspose.Cells для .NET: Вам понадобится установленная библиотека Aspose.Cells. Независимо от того, решите ли вы использовать полную версию или выбрать бесплатную пробную версию, убедитесь, что она готова к работе.
- Visual Studio или любая IDE C#: вам понадобится среда для написания и выполнения кода C#.
- Образец файла Excel: для этого руководства образец файла Excel с именем `sampleModifyPieChart.xlsx` будет использоваться.

Вы можете скачать библиотеку Aspose.Cells [здесь](https://releases.aspose.com/cells/net/).

## Импортные пакеты

Первый шаг в нашем путешествии — импорт необходимых пакетов в наш проект C#. Вот как это можно сделать:

## Настройте свой проект

Для начала откройте C# IDE (настоятельно рекомендуется Visual Studio) и создайте новый проект:

1. Откройте Visual Studio.
2. Выберите «Создать новый проект».
3. Выберите консольное приложение C#.
4. Дайте название вашему проекту (например, `ModifyPieChartDemo`).
5. Нажмите «Создать».

## Установить Aspose.Cells

Как только ваш проект будет готов, пора добавить библиотеку Aspose.Cells. Вы можете установить ее с помощью NuGet:

1. В «Обозревателе решений» щелкните правой кнопкой мыши на вашем проекте.
2. Выберите «Управление пакетами NuGet».
3. Перейдите на вкладку «Обзор».
4. Найдите Aspose.Cells.
5. Нажмите «Установить» и примите все лицензионные соглашения.

Теперь, когда библиотека установлена, давайте импортируем необходимые пространства имен в ваш код.

## Импорт пространств имен

В верхней части вашего `Program.cs` файл, импортируйте следующие пространства имен:

```csharp
using System;
using System.IO;

using Aspose.Cells;
using Aspose.Cells.Drawing;
using System.Drawing;
using Aspose.Cells.Charts;
```

Теперь, когда все готово, мы готовы перейти к самому коду!

## Шаг 1: Определите входные и выходные каталоги

Давайте начнем с определения каталогов для ваших входных и выходных файлов. Здесь вы указываете, где находится ваш файл Excel и где вы хотите сохранить измененный файл.

В вашем `Main` метод, введите следующий код:

```csharp
// Выходной каталог
string outputDir = "Your Output Directory Path";

// Исходный каталог
string sourceDir = "Your Document Directory Path";
```

Обязательно замените `Your Output Directory Path` и `Your Document Directory Path` с реальными путями в вашей системе.

## Шаг 2: Откройте существующую рабочую книгу.

Далее нам нужно открыть файл Excel, содержащий круговую диаграмму, которую вы хотите изменить. Для этого используйте `Workbook` сорт:

```csharp
// Откройте существующий файл.
Workbook workbook = new Workbook(sourceDir + "sampleModifyPieChart.xlsx");
```

В этом фрагменте мы создаем новый `Workbook` объект и загрузка в него нашего файла Excel.

## Шаг 3: Доступ к рабочему листу

Теперь давайте погрузимся в конкретный лист, содержащий круговую диаграмму. Мы собираемся предположить, что круговая диаграмма находится на втором рабочем листе (индекс 1):

```csharp
// Получите схему дизайнера на втором листе.
Worksheet sheet = workbook.Worksheets[1];
```

Получив доступ к `Worksheets` собирая, мы можем добраться до нужного нам листа.

## Шаг 4: Получите диаграмму

Теперь мы готовы получить доступ к самой диаграмме. Предполагая, что на этом листе только одна диаграмма, мы можем получить ее напрямую:

```csharp
Aspose.Cells.Charts.Chart chart = sheet.Charts[0];
```

Здесь мы берем первую диаграмму с указанного рабочего листа.

## Шаг 5: Доступ к меткам данных

Теперь наступает самое интересное — изменение меток данных на круговой диаграмме. Давайте получим доступ к меткам данных ряда данных:

```csharp
// Получите метки данных в ряду данных третьей точки данных.
Aspose.Cells.Charts.DataLabels datalabels = chart.NSeries[0].Points[2].DataLabels;
```

С помощью этой строки мы нацеливаем метки данных конкретно на третью точку нашего ряда данных. 

## Шаг 6: Измените текст этикетки

Далее, пришло время изменить то, что говорит эта метка. Для нашего примера мы собираемся обновить ее на "Соединенное Королевство, 400 тыс.":

```csharp
// Измените текст этикетки.
datalabels.Text = "United Kingdom, 400K";
```

Вот так просто мы обновили этикетку! 

## Шаг 7: Сохраните рабочую книгу.

Теперь, когда мы внесли изменения, давайте сохраним измененную книгу. 

```csharp
// Сохраните файл Excel.
workbook.Save(outputDir + "outputModifyPieChart.xlsx");
```

Эта строка сохраняет рабочую книгу в указанном выходном каталоге. 

## Шаг 8: Подтверждение выполнения

Наконец, давайте выведем подтверждающее сообщение, чтобы убедиться, что все прошло гладко:

```csharp
Console.WriteLine("ModifyPieChart executed successfully.");
```

Это даст вам некоторую уверенность в том, что ваши изменения были внесены так, как и ожидалось.

# Заключение

Вот и все! Всего за несколько простых шагов вы успешно изменили круговую диаграмму с помощью Aspose.Cells для .NET. Эта мощная библиотека не только упрощает работу с файлами Excel, но и позволяет персонализировать визуализацию данных для максимального эффекта. Если вы работаете с представлением данных в своей работе, то вложение времени в изучение использования Aspose.Cells определенно окупится. Так что вперед, экспериментируйте с этими диаграммами и смотрите, как вы можете оживить свои данные!

# Часто задаваемые вопросы

### Что такое Aspose.Cells для .NET?  
Aspose.Cells для .NET — это мощная библиотека, предназначенная для программного создания, обработки и преобразования файлов Excel без необходимости использования Microsoft Excel.

### Могу ли я изменять диаграммы, отличные от круговых?  
Конечно! Aspose.Cells поддерживает различные типы диаграмм, включая столбчатые, линейные и площадные диаграммы, что обеспечивает гибкую визуализацию данных.

### Существует ли бесплатная версия Aspose.Cells?  
Да! Aspose предлагает бесплатную пробную версию, которая позволяет вам протестировать библиотеку перед покупкой.

### Где я могу найти поддержку Aspose.Cells?  
Вы можете найти поддержку на форумах Aspose, где вам могут помочь члены сообщества и сотрудники Aspose.

### Необходимо ли мне установить Microsoft Excel для использования Aspose.Cells?  
Нет, Aspose.Cells работает независимо от Microsoft Excel. Вам не нужно устанавливать его в вашей системе.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}