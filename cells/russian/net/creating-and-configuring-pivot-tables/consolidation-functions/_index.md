---
title: Функции консолидации программным способом в .NET
linktitle: Функции консолидации программным способом в .NET
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как использовать Aspose.Cells для .NET для программного применения функций консолидации. Эффективно автоматизируйте задачи анализа данных.
weight: 12
url: /ru/net/creating-and-configuring-pivot-tables/consolidation-functions/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Функции консолидации программным способом в .NET

## Введение
Хотите ли вы использовать возможности Excel для анализа данных, но хотите автоматизировать утомительные процессы? Что ж, вы в правильном месте! В этой статье мы погружаемся в мир Aspose.Cells для .NET, уделяя особое внимание его функциям консолидации. Представьте себе, что вы можете легко анализировать и суммировать свои данные, не тратя часы на повторяющиеся задачи.
## Предпосылки
Прежде чем мы начнем наше путешествие по анализу данных, давайте убедимся, что у вас все готово. Вот что вам понадобится:
1. .NET Environment: У вас должна быть рабочая среда .NET. Независимо от того, используете ли вы .NET Core или .NET Framework, шаги в основном останутся теми же.
2.  Библиотека Aspose.Cells: Вам понадобится установленная библиотека Aspose.Cells. Вы можете легко загрузить ее с[Страница релизов Aspose](https://releases.aspose.com/cells/net/).
3. Базовое понимание C#: Небольшое знакомство с программированием на C# будет полезным. Если вы уже пишете код на C#, то вы готовы!
4. Пример файла Excel: Для нашего примера убедитесь, что у вас есть файл Excel с именем`Book.xlsx` готово в вашем каталоге документов.
## Импортные пакеты
Чтобы начать кодирование, вам сначала нужно импортировать требуемые пакеты. Библиотека Aspose.Cells должна быть указана в вашем проекте. Вот как это сделать:
1.  Установите пакет NuGet: откройте свой проект в Visual Studio, щелкните правой кнопкой мыши по решению и выберите «Управление пакетами NuGet». Найдите`Aspose.Cells` и нажмите «Установить».
2. Использование директивы: в верхней части файла C# вам необходимо включить следующие пространства имен для доступа к нужным нам классам:
```csharp
using System.IO;
using Aspose.Cells;
using System.Drawing;
using Aspose.Cells.Pivot;
```
Давайте перейдем к реализации наших функций консолидации!
Теперь мы разобьем нашу основную программу на понятные, усвояемые шаги. Готовы? Давайте нырнем!
## Шаг 1: Настройте каталог документов
Во-первых, нам нужно установить путь для наших документов. Это относится к папке, где хранятся ваши файлы Excel.
```csharp
// Путь к каталогу документов.
string dataDir = "Your Document Directory";
```
 Обязательно замените`"Your Document Directory"` с фактическим путем к тому месту, где находится ваш`Book.xlsx` файл находится.
## Шаг 2: Создание экземпляра рабочей книги
Далее, давайте создадим экземпляр рабочей книги из нашего исходного файла Excel. Этот объект позволит нам взаимодействовать с данными внутри`Book.xlsx`.
```csharp
// Создать рабочую книгу из исходного файла Excel
Workbook workbook = new Workbook(dataDir + "Book.xlsx");
```
Здесь мы загружаем рабочую книгу, чтобы затем получить доступ к ее листам и данным.
## Шаг 3: Получите доступ к первому рабочему листу
После того, как у нас есть рабочая книга, нам нужно получить доступ к рабочему листу, где находится наша сводная таблица. Здесь мы предполагаем, что это первый рабочий лист.
```csharp
// Доступ к первому листу рабочей книги
Worksheet worksheet = workbook.Worksheets[0];
```
Эта строка кода захватывает первый лист, позволяя нам работать с ним напрямую.
## Шаг 4: Доступ к сводной таблице
Отлично! Теперь нам нужно найти сводную таблицу, с которой мы хотим работать. Для этого примера мы получим доступ к первой сводной таблице нашего рабочего листа.
```csharp
// Доступ к первой сводной таблице рабочего листа
PivotTable pivotTable = worksheet.PivotTables[0];
```
Для успешного выполнения этого шага убедитесь, что ваш файл Excel действительно содержит сводную таблицу.
## Шаг 5: Применение функций консолидации
Теперь пришло время применить функции консолидации! Давайте вычислим среднее значение для первого поля данных и посчитаем отдельные записи для второго поля данных.
```csharp
// Применить функцию консолидации среднего к первому полю данных
pivotTable.DataFields[0].Function = ConsolidationFunction.Average;
// Применить функцию консолидации DistinctCount ко второму полю данных
pivotTable.DataFields[1].Function = ConsolidationFunction.DistinctCount;
```
Попробуйте смешать эти функции с разными полями, чтобы посмотреть, как изменятся результаты.
## Шаг 6: Рассчитайте изменения
После настройки функций крайне важно рассчитать данные, чтобы отразить любые внесенные нами изменения. Это похоже на нажатие кнопки «обновить» на вашем листе Excel.
```csharp
// Рассчитайте данные, чтобы изменения повлияли
pivotTable.CalculateData();
```
Думайте об этом шаге как о том, чтобы убедиться, что ваш кофе заварен, прежде чем сделать глоток. Вы же не хотите упустить результаты!
## Шаг 7: Сохраните изменения.
 Наконец, пришло время сохранить нашу работу. Мы сохраним измененную книгу в новый файл Excel под названием`output.xlsx`.
```csharp
// Сохранение файла Excel
workbook.Save(dataDir + "output.xlsx");
```
И вуаля! Вы успешно консолидировали данные с помощью библиотеки Aspose.Cells в .NET.
## Заключение
Вы дошли до конца нашего руководства по консолидации функций с помощью Aspose.Cells для .NET! Этот процесс не только экономит ваше время, но и повышает вашу производительность. Вы можете использовать эти новые знания и исследовать различные варианты использования функций консолидации в своих задачах анализа данных. Не забудьте поделиться своими идеями в комментариях и не стесняйтесь обращаться, если у вас есть вопросы.
## Часто задаваемые вопросы
### Что такое Aspose.Cells?
Aspose.Cells — это библиотека .NET, которая позволяет разработчикам программно создавать, изменять и управлять файлами Excel в своих приложениях.
### Могу ли я использовать Aspose.Cells бесплатно?
 Да, Aspose предлагает бесплатную пробную версию, которую вы можете найти[здесь](https://releases.aspose.com).
### Как получить доступ к документации Aspose.Cells?
 Вы можете получить доступ к полной документации[здесь](https://reference.aspose.com/cells/net/).
### Доступна ли поддержка Aspose.Cells?
 Конечно! Вы можете обратиться за помощью к ним[форум поддержки](https://forum.aspose.com/c/cells/9).
### Где я могу приобрести лицензию на Aspose.Cells?
 Вы можете купить лицензию[здесь](https://purchase.aspose.com/buy).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
