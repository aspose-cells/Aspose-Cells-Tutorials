---
title: Создание новой сводной таблицы программным способом в .NET
linktitle: Создание новой сводной таблицы программным способом в .NET
second_title: API обработки Excel Aspose.Cells .NET
description: Научитесь программно создавать сводную таблицу в .NET с помощью Aspose.Cells с помощью нашего пошагового руководства. Эффективно анализируйте свои данные.
weight: 13
url: /ru/net/creating-and-configuring-pivot-tables/creating-new-pivot-table/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Создание новой сводной таблицы программным способом в .NET

## Введение
Создание сводной таблицы может показаться пугающей задачей, особенно когда вы делаете это программно. Но не бойтесь! С Aspose.Cells для .NET создание сводной таблицы не только простое, но и довольно мощное средство для анализа данных. В этом руководстве мы шаг за шагом проведем вас по созданию новой сводной таблицы в приложении .NET. Добавляете ли вы данные для продаж, спорта или любых других бизнес-показателей, это руководство поможет вам быстро настроить и запустить сводные таблицы.

## Предпосылки
Прежде чем приступить к делу, давайте убедимся, что у вас все готово. Вот что вам нужно сделать:

1. Установите .NET Framework: Убедитесь, что на вашем компьютере установлен .NET Framework. Aspose.Cells поддерживает различные версии, но лучше придерживаться последней.
2.  Библиотека Aspose.Cells: Вам нужна библиотека Aspose.Cells. Вы можете[скачать здесь](https://releases.aspose.com/cells/net/)или получить[временная лицензия](https://purchase.aspose.com/temporary-license/) для оценки.
3. Настройка IDE: подготовьте совместимую с C# IDE, например Visual Studio, в которой вы сможете начать новый проект.
4. Базовые знания C#: знакомство с программированием на C# поможет вам следовать курсу, не увязнув слишком глубоко.

Все готово? Отлично! Давайте перейдем к импорту необходимых пакетов.

## Импортные пакеты
Первым делом вам нужно импортировать требуемые пространства имен в ваш проект C#. Откройте ваш файл C# и добавьте следующие директивы using:

```csharp
using System.IO;
using Aspose.Cells;
using System.Drawing;
```

Эти пространства имен предоставляют вам доступ к функциям рабочей книги, рабочего листа и сводной таблицы, которые мы будем использовать в этом руководстве.

## Шаг 1: Создание объекта рабочей книги
Создание рабочей книги — это начало вашего пути. Давайте начнем с создания новой рабочей книги и доступа к первому рабочему листу.

```csharp
// Путь к каталогу документов.
string dataDir = "Your Document Directory";
// Создание объекта Workbook
Workbook workbook = new Workbook();

// Получение ссылки на недавно добавленный рабочий лист
Worksheet sheet = workbook.Worksheets[0];
```

 На этом этапе мы создаем`Workbook`экземпляр, представляющий наш файл Excel, и берем самый первый рабочий лист, который станет нашей площадкой для сводной таблицы.

## Шаг 2: Вставьте данные в ячейки
Далее давайте заполним наш рабочий лист некоторыми образцами данных. Мы собираемся ввести строки для разных видов спорта, кварталов и показателей продаж, чтобы дать нашей сводной таблице что-то для обобщения.

```csharp
Cells cells = sheet.Cells;

// Установка значения в ячейки
Cell cell = cells["A1"];
cell.PutValue("Sport");
cell = cells["B1"];
cell.PutValue("Quarter");
cell = cells["C1"];
cell.PutValue("Sales");

// Заполнение datacell = cells["A2"];
cell.PutValue("Golf");
// ... Дополнительные записи данных
```

Здесь мы определяем заголовки столбцов и вставляем значения под каждым заголовком. Эти данные будут служить источником для нашей сводной таблицы, поэтому убедитесь, что они организованы! Пройдите этот блок, и вы создадите комплексный набор данных.

## Шаг 3: Добавление сводной таблицы
Когда наши данные готовы, пришло время создать сводную таблицу. Мы будем использовать коллекцию сводных таблиц из рабочего листа, чтобы добавить нашу новую сводную таблицу.

```csharp
Aspose.Cells.Pivot.PivotTableCollection pivotTables = sheet.PivotTables;

// Добавление сводной таблицы на рабочий лист
int index = pivotTables.Add("=A1:C8", "E3", "PivotTable2");
```

В этом фрагменте мы добавляем сводную таблицу на рабочий лист, которая ссылается на наш диапазон данных (в данном случае, ячейки от A1 до C8). Мы размещаем сводную таблицу, начиная с ячейки E3, и называем ее "PivotTable2". Довольно просто, не правда ли?

## Шаг 4: Настройте сводную таблицу
Теперь, когда у нас есть сводная таблица, давайте настроим ее так, чтобы она отображала содержательные сводки. Мы можем контролировать то, что отображается в строках, столбцах и областях данных сводной таблицы.

```csharp
// Доступ к экземпляру недавно добавленной сводной таблицы
Aspose.Cells.Pivot.PivotTable pivotTable = pivotTables[index];

// Отключение отображения общих итогов по строкам.
pivotTable.RowGrand = false;

// Перетаскиваем первое поле в область строки.
pivotTable.AddFieldToArea(Aspose.Cells.Pivot.PivotFieldType.Row, 0);

// Перетаскиваем второе поле в область столбцов.
pivotTable.AddFieldToArea(Aspose.Cells.Pivot.PivotFieldType.Column, 1);

// Перетаскиваем третье поле в область данных.
pivotTable.AddFieldToArea(Aspose.Cells.Pivot.PivotFieldType.Data, 2);
```

На этом этапе мы говорим сводной таблице скрыть общие итоги для строк, а затем указываем, какие поля попадают в области строк, столбцов и данных. Названия видов спорта будут заполнять строки, кварталы будут заполнять столбцы, а цифры продаж будут предоставлять сводки.

## Шаг 5: Сохраните рабочую книгу
Наконец, мы хотим сохранить нашу новую рабочую книгу, чтобы увидеть плоды нашего труда.

```csharp
// Сохранение файла Excel
workbook.Save(dataDir + "pivotTable_test_out.xls");
```

Просто укажите правильный путь, и ваши выходные данные сводной таблицы будут сохранены в файле Excel, который вы сможете открыть и просмотреть.

## Заключение
Создание сводных таблиц программным способом с помощью Aspose.Cells для .NET может значительно сэкономить вам время, особенно при работе с большими наборами данных. Вы узнали, как настроить свой проект, импортировать необходимые пакеты, заполнить данные и создать настраиваемую сводную таблицу с нуля. Так что в следующий раз, когда вы утонете в числах, вспомните это руководство и позвольте Aspose.Cells сделать тяжелую работу за вас.

## Часто задаваемые вопросы
### Что такое Aspose.Cells?
Aspose.Cells — мощная библиотека .NET для программного создания и управления электронными таблицами Excel.

### Существует ли бесплатная пробная версия Aspose.Cells?
 Да, вы можете получить бесплатную пробную версию.[здесь](https://releases.aspose.com/).

### Могу ли я настроить внешний вид сводной таблицы?
Конечно! Вы можете настроить форматирование, макет и даже стили сводной таблицы в соответствии с вашими потребностями.

### Где я могу найти больше примеров и документации по Aspose.Cells?
 Вы можете проверить[документация](https://reference.aspose.com/cells/net/) для получения подробных руководств и примеров.

### Как получить поддержку по Aspose.Cells?
 Вы можете получить поддержку через[Форум Aspose](https://forum.aspose.com/c/cells/9).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
