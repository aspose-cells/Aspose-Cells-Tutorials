---
"description": "Улучшите свои сводные таблицы Excel с помощью Aspose.Cells для .NET. Научитесь форматировать, настраивать и автоматизировать представление данных без усилий."
"linktitle": "Форматирование и внешний вид сводных таблиц программным способом в .NET"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Форматирование и внешний вид сводных таблиц программным способом в .NET"
"url": "/ru/net/creating-and-configuring-pivot-tables/formatting-and-look/"
"weight": 16
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Форматирование и внешний вид сводных таблиц программным способом в .NET

## Введение
Сводные таблицы — это фантастические инструменты в Excel, которые позволяют пользователям обобщать и анализировать сложные наборы данных. Они могут преобразовывать обыденные данные в визуально привлекательные и информативные отчеты, позволяя пользователям быстро извлекать информацию. В этом руководстве мы рассмотрим, как управлять стилями сводных таблиц с помощью Aspose.Cells для .NET, что позволит вам автоматизировать и настраивать отчеты Excel без особых усилий. Вы готовы улучшить свои навыки представления данных? Давайте погрузимся в это!
## Предпосылки
Прежде чем отправиться в это путешествие, вам необходимо иметь под рукой несколько основных вещей:
1. Visual Studio: это будет наша основная среда для кодирования и тестирования.
2. Aspose.Cells for .NET: Убедитесь, что у вас установлена эта библиотека. Вы можете [скачать здесь](https://releases.aspose.com/cells/net/).
3. Базовые знания C#: знакомство с программированием на C# поможет вам легко усвоить материал.
4. Файл Excel: Вам понадобится существующий файл Excel, содержащий сводную таблицу. Если у вас ее нет, вы можете создать простую с помощью Microsoft Excel.
Как только вы все настроите, давайте перейдем к импорту необходимых пакетов!
## Импортные пакеты
Для начала нам нужно импортировать необходимые библиотеки в наш проект C#. Вот как это можно сделать:
### Создать новый проект C#
Сначала откройте Visual Studio и создайте новый проект Console Application. Это позволит нам легко запустить наш код.
### Добавить ссылки
После настройки проекта вам необходимо добавить ссылку на библиотеку Aspose.Cells:
- Щелкните правой кнопкой мыши по вашему проекту в обозревателе решений.
- Выберите «Управление пакетами NuGet».
- Найдите «Aspose.Cells» и установите пакет.
Сделав это, вы готовы импортировать пространство имен Aspose.Cells. Ниже приведен код для импорта необходимых пакетов:
```csharp
using System.IO;
using Aspose.Cells;
using System.Drawing;
using Aspose.Cells.Pivot;
```
Теперь, когда мы импортировали наши пакеты, давайте подробнее рассмотрим, как управлять форматированием сводной таблицы в Excel.
## Шаг 1: Настройте каталог документов
Для начала определим путь к нашему файлу Excel. Вот как это сделать:
```csharp
// Путь к каталогу документов.
string dataDir = "Your Document Directory";
```
Обязательно замените `"Your Document Directory"` на фактический путь, где хранится ваш файл Excel.
## Шаг 2: Загрузите рабочую книгу
Далее нам нужно загрузить ваш существующий файл Excel. На этом этапе мы воспользуемся `Workbook` класс предоставлен Aspose.Cells.
```csharp
// Загрузить файл шаблона
Workbook workbook = new Workbook(dataDir + "Book1.xls");
```
Когда вы заменяете `"Book1.xls"` с вашим фактическим именем файла, `workbook` объект теперь будет содержать данные Excel.
## Шаг 3: Доступ к рабочему листу и сводной таблице
Теперь нам нужно взять лист и сводную таблицу, с которыми мы будем работать:
```csharp
// Получить первый рабочий лист
Worksheet worksheet = workbook.Worksheets[0];
var pivot = workbook.Worksheets[0].PivotTables[0];
```
В этом случае мы используем первый рабочий лист и первую сводную таблицу. Если ваш файл Excel имеет несколько листов или сводных таблиц, обязательно соответствующим образом скорректируйте значения индекса.

Теперь, когда у нас есть доступ к сводной таблице, пришло время сделать ее визуально привлекательной! Мы можем задать стиль и отформатировать всю сводную таблицу. Вот как:
## Шаг 4: Настройка стиля сводной таблицы
Давайте применим предопределенный стиль к нашей сводной таблице:
```csharp
pivot.PivotTableStyleType = PivotTableStyleType.PivotTableStyleDark1;
```
Эта строка кода меняет стиль сводной таблицы на темную тему. Вы можете изучить различные стили, доступные в библиотеке Aspose.Cells, чтобы найти тот, который соответствует вашим потребностям.
## Шаг 5: Настройте стиль сводной таблицы
Для дальнейшей настройки мы можем создать свой стиль. Как это круто? Вот как это можно сделать:
```csharp
Style style = workbook.CreateStyle();
style.Font.Name = "Arial Black";
style.ForegroundColor = Color.Yellow;
style.Pattern = BackgroundType.Solid;
```
В этом фрагменте:
- Мы указываем шрифт как «Arial Black».
- Цвет переднего плана установлен на желтый.
- Устанавливаем сплошной узор.
## Шаг 6: Применение пользовательского стиля к сводной таблице
Наконец, применим этот недавно созданный стиль для форматирования всей сводной таблицы:
```csharp
pivot.FormatAll(style);
```
Эта строка применяет ваш пользовательский стиль ко всем данным в сводной таблице. Теперь ваша таблица должна выглядеть фантастически!
## Шаг 7: Сохраните изменения.
Закончив форматирование сводной таблицы, не забудьте сохранить изменения. Вот как сохранить документ:
```csharp
// Сохранение файла Excel
workbook.Save(dataDir + "output.xls");
```
Заменять `"output.xls"` с любым именем, которое вы хотите для нового отформатированного файла Excel. И вуаля! Вы успешно отформатировали сводную таблицу с помощью Aspose.Cells для .NET.
## Заключение
Подводя итог, мы отправились в путешествие по программному форматированию сводных таблиц в Excel с помощью Aspose.Cells для .NET. Мы начали с импорта необходимых пакетов, загрузили существующую книгу Excel, настроили стили сводных таблиц и, наконец, сохранили наш отформатированный вывод. Интегрируя такие навыки в свой рабочий процесс, вы можете автоматизировать утомительные задачи форматирования, которые могут стоить вам драгоценного времени. Так почему бы не попробовать? Попробуйте сами и улучшите свою игру в Excel!
## Часто задаваемые вопросы
### Что такое Aspose.Cells?
Aspose.Cells — это мощная библиотека для работы с файлами Excel в приложениях .NET, позволяющая без труда выполнять автоматизированные и программные задачи.
### Могу ли я попробовать Aspose.Cells бесплатно?
Да! Вы можете начать с бесплатной пробной версии, нажав [здесь](https://releases.aspose.com).
### Какие типы стилей сводных таблиц доступны?
Aspose.Cells предоставляет различные предопределенные стили, доступ к которым можно получить через `PivotTableStyleType`.
### Как создать сводную таблицу в Excel?
Вы можете создать сводную таблицу в Excel, используя вкладку «Вставка» на панели инструментов и выбрав «Сводная таблица» из предложенных вариантов.
### Где я могу получить поддержку по Aspose.Cells?
Вы можете найти помощь на форуме Aspose. [здесь](https://forum.aspose.com/c/cells/9).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}