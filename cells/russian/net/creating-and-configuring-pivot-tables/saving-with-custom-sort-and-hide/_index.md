---
title: Сохранение сводных таблиц с пользовательской сортировкой и скрытием в .NET
linktitle: Сохранение сводных таблиц с пользовательской сортировкой и скрытием в .NET
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как сохранять сводные таблицы с пользовательской сортировкой и скрытием строк с помощью Aspose.Cells для .NET. Пошаговое руководство с практическими примерами.
weight: 26
url: /ru/net/creating-and-configuring-pivot-tables/saving-with-custom-sort-and-hide/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Сохранение сводных таблиц с пользовательской сортировкой и скрытием в .NET

## Введение
В мире анализа данных сводные таблицы являются одним из самых мощных инструментов для обобщения, анализа и представления данных в удобном формате. Если вы работаете с .NET и ищете простой способ манипулировать сводными таблицами, в частности, сохранять их с пользовательской сортировкой и скрытием определенных строк, вы попали по адресу! Сегодня мы разберем технику сохранения сводных таблиц с помощью Aspose.Cells для .NET. Это руководство проведет вас через все, от предварительных условий до практических примеров, гарантируя, что вы будете готовы решать подобные задачи самостоятельно. Итак, давайте приступим!
## Предпосылки
Прежде чем погрузиться в тонкости кодирования, убедитесь, что у вас выполнены следующие предварительные условия:
1. Visual Studio: В идеале вам нужна надежная IDE для управления вашими проектами .NET. Visual Studio — отличный выбор.
2.  Aspose.Cells для .NET: Вам понадобится доступ к библиотеке Aspose для программного управления файлами Excel. Вы можете[скачать Aspose.Cells для .NET здесь](https://releases.aspose.com/cells/net/).
3. Базовые знания C#: знакомство с основными концепциями программирования и синтаксисом C# упростит процесс.
4.  Пример файла Excel: мы будем использовать пример файла с именем`PivotTableHideAndSortSample.xlsx`. Убедитесь, что этот файл находится в указанном вами каталоге документов.
Как только вы настроите среду разработки и подготовите файл примера, все готово!
## Импортные пакеты
Теперь, когда у нас есть проверенные предварительные условия, давайте импортируем необходимые пакеты. В вашем файле C# используйте следующую директиву для включения Aspose.Cells:
```csharp
using System;
using Aspose.Cells.Pivot;
```
Эта директива позволяет вам получить доступ к классам и методам, предоставляемым библиотекой Aspose.Cells. Убедитесь, что вы добавили Aspose.Cells.dll в ссылки вашего проекта.
## Шаг 1: Настройте рабочую книгу
Прежде всего, нам нужно загрузить нашу рабочую книгу. Следующий фрагмент кода позволяет это сделать:
```csharp
// Каталоги для исходных и выходных файлов
string sourceDir = "Your Document Directory";
string outputDir = "Your Document Directory";
// Загрузить рабочую книгу
Workbook workbook = new Workbook(sourceDir + "PivotTableHideAndSortSample.xlsx");
```
 На этом этапе вы определяете каталоги, в которых будут храниться ваши исходные и выходные файлы.`Workbook`конструктор загрузит ваш существующий файл Excel, подготовив его к обработке.
## Шаг 2: Доступ к рабочему листу и сводной таблице
Теперь давайте перейдем к конкретному листу в рабочей книге и выберем сводную таблицу, с которой мы хотим работать.
```csharp
// Доступ к первому рабочему листу
Worksheet worksheet = workbook.Worksheets[0];
// Доступ к первой сводной таблице на рабочем листе
var pivotTable = worksheet.PivotTables[0];
```
 В этом фрагменте`Worksheets[0]` выбирает первый лист в документе Excel и`PivotTables[0]` извлекает первую сводную таблицу. Это позволяет вам указать точную сводную таблицу, которую вы хотите изменить.
## Шаг 3: Сортировка строк сводной таблицы
Далее мы реализуем пользовательскую сортировку для организации наших данных. В частности, мы отсортируем баллы в порядке убывания.
```csharp
// Сортировка поля первой строки в порядке убывания
PivotField field = pivotTable.RowFields[0];
field.IsAutoSort = true;
field.IsAscendSort = false;  // ложь для убывания
field.AutoSortField = 0;     // Сортировка по первому столбцу
```
 Здесь мы используем`PivotField` для установки параметров сортировки. Это сообщает сводной таблице, что нужно сортировать указанное поле строки на основе первого столбца и делать это в порядке убывания. 
## Шаг 4: Обновление и расчет данных
После применения сортировки крайне важно обновить данные сводной таблицы, чтобы убедиться, что они отражают наши изменения.
```csharp
// Обновить и рассчитать данные сводной таблицы
pivotTable.RefreshData();
pivotTable.CalculateData();
```
Этот шаг синхронизирует сводную таблицу с вашими текущими данными, применяя любые изменения сортировки или фильтрации, которые вы сделали до сих пор. Думайте об этом как о нажатии «обновить», чтобы увидеть новую организацию ваших данных!
## Шаг 5: Скрыть определенные строки
Теперь давайте скроем строки, содержащие оценки ниже определенного порога, скажем, менее 60. Здесь мы можем еще больше отфильтровать данные.
```csharp
// Укажите начальную строку для проверки баллов
int currentRow = 3;
int rowsUsed = pivotTable.DataBodyRange.EndRow;
// Скрыть строки с оценкой менее 60
while (currentRow < rowsUsed)
{
    Cell cell = worksheet.Cells[currentRow, 1]; // Предполагая, что оценка находится в первом столбце
    double score = Convert.ToDouble(cell.Value);
    if (score < 60)
    {
        worksheet.Cells.HideRow(currentRow);  // Скрыть строку, если оценка ниже 60
    }
    currentRow++;
}
```
В этом цикле мы проверяем каждую строку в диапазоне данных сводной таблицы. Если оценка ниже 60, мы скрываем эту строку. Это похоже на уборку рабочего пространства — удаление беспорядка, который не помогает вам увидеть общую картину!
## Шаг 6: Окончательное обновление и сохранение рабочей книги.
Прежде чем завершить, давайте в последний раз обновим сводную таблицу, чтобы убедиться, что скрытие строк вступило в силу, а затем сохраним книгу в новом файле.
```csharp
// Обновите и рассчитайте данные в последний раз
pivotTable.RefreshData();
pivotTable.CalculateData();
// Сохраните измененную книгу.
workbook.Save(outputDir + "PivotTableHideAndSort_out.xlsx");
```
Это последнее обновление гарантирует, что все данные обновлены, и, сохраняя книгу, вы создаете новый файл, отражающий все внесенные нами изменения.
## Шаг 7: Подтвердите успех
Наконец, мы выведем сообщение об успешном завершении операции, чтобы подтвердить, что она прошла без сбоев.
```csharp
Console.WriteLine("PivotTableSortAndHide executed successfully.");
```
Эта строка выполняет двойную функцию: подтверждает успех и обеспечивает обратную связь на вашей консоли, делая процесс более интерактивным и удобным для пользователя.
## Заключение
И вот оно! Вы успешно научились сохранять сводные таблицы с пользовательской сортировкой и функциями скрытия с помощью Aspose.Cells для .NET. От загрузки вашей рабочей книги до сортировки данных и скрытия ненужных деталей, эти шаги обеспечивают структурированный подход к программному управлению сводными таблицами. Анализируете ли вы данные о продажах, отслеживаете производительность команды или просто организуете информацию, освоение этих навыков с Aspose.Cells может сэкономить вам драгоценное время и улучшить рабочий процесс анализа данных.
## Часто задаваемые вопросы
### Что такое Aspose.Cells для .NET?
Aspose.Cells для .NET — это библиотека .NET, которая позволяет разработчикам создавать, изменять и преобразовывать электронные таблицы Excel, не полагаясь на Microsoft Excel. Она идеально подходит для автоматизации задач в документах Excel.
### Могу ли я использовать Aspose.Cells без установленного Microsoft Office?
Конечно! Aspose.Cells — это автономная библиотека, поэтому для работы с файлами Excel вам не обязательно устанавливать Microsoft Office в своей системе.
### Как получить временную лицензию для Aspose.Cells?
 Вы можете подать заявление на получение временной лицензии через[временная страница лицензии](https://purchase.aspose.com/temporary-license/).
### Где я могу найти поддержку по вопросам Aspose.Cells?
 По любым вопросам или проблемам вы можете посетить[Форум Aspose](https://forum.aspose.com/c/cells/9), где вы найдете поддержку сообщества и команды Aspose.
### Существует ли бесплатная пробная версия Aspose.Cells?
 Да! Вы можете загрузить бесплатную пробную версию Aspose.Cells, чтобы протестировать ее возможности перед покупкой. Посетите[бесплатная пробная версия](https://releases.aspose.com/) для начала.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
