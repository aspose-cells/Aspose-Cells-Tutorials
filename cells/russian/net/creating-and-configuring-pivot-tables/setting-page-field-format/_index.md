---
"description": "Узнайте, как программно задать форматы полей страниц в сводных таблицах с помощью Aspose.Cells для .NET. Следуйте нашему пошаговому руководству для бесперебойного управления данными."
"linktitle": "Программная настройка формата поля страницы в .NET"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Программная настройка формата поля страницы в .NET"
"url": "/ru/net/creating-and-configuring-pivot-tables/setting-page-field-format/"
"weight": 21
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Программная настройка формата поля страницы в .NET

## Введение
Создание и управление файлами Excel с помощью кода может быть весьма полезным, особенно когда вам нужно анализировать большие наборы данных. Одним из фантастических инструментов в вашем арсенале является Aspose.Cells для .NET, который позволяет вам программно взаимодействовать с файлами Excel и создавать сложные структуры отчетов. В этом руководстве мы углубимся в то, как вы можете настроить форматы полей страницы в сводной таблице с помощью этой мощной библиотеки. Независимо от того, являетесь ли вы опытным разработчиком или новичком, к концу этого руководства вы будете иметь четкое представление о том, как работать со сводными таблицами и их различными настройками в .NET.
## Предпосылки
Прежде чем мы погрузимся с головой в кодирование, давайте убедимся, что у вас все настроено правильно. Вам понадобится следующее:
- Visual Studio: рабочая среда, в которой вы можете писать и выполнять свой код .NET.
- Aspose.Cells: Вы можете скачать библиотеку [здесь](https://releases.aspose.com/cells/net/).
- Базовые знания C#: знакомство с программированием на C# поможет вам лучше понимать фрагменты кода.
- Файл Excel: подготовьте файл Excel (например, `Book1.xls`), содержащий данные, подходящие для создания сводной таблицы. 
Если вы еще этого не сделали, получите бесплатную пробную версию Aspose.Cells [здесь](https://releases.aspose.com/).
## Импортные пакеты
Чтобы начать, вам нужно импортировать нужные пакеты в ваш проект. Начните с добавления ссылок на библиотеку Aspose.Cells в ваш проект C#. Вот как это сделать:
```csharp
using System.IO;
using Aspose.Cells;
using System.Drawing;
using Aspose.Cells.Pivot;
```
Это позволит подключить все необходимые классы и методы для работы с файлами Excel с помощью Aspose.Cells.
## Шаг 1: Настройте свое рабочее пространство
Начните с определения рабочего каталога, в котором будут храниться ваши файлы Excel. Например, вы можете объявить переменную следующим образом:
```csharp
string dataDir = "Your Document Directory";
```
## Загрузка рабочей книги
Далее нам нужно загрузить наш шаблон Excel. Это важный шаг, поскольку он устанавливает контекст для наших операций:
```csharp
Workbook workbook = new Workbook(dataDir + "Book1.xls");
```
Эта строка загружает существующую книгу из указанного каталога.
## Шаг 2: Доступ к рабочему листу
После загрузки вашей рабочей книги настало время получить доступ к рабочему листу, содержащему сводную таблицу или данные, которые вы хотите проанализировать. Вот как это можно сделать:
```csharp
Worksheet worksheet = workbook.Worksheets[0];
```
Это захватывает первый рабочий лист загруженной рабочей книги. Вы можете легко изменить индекс, если работаете с несколькими листами.
## Шаг 3: Доступ к сводной таблице
Продолжая, давайте получим доступ к сводной таблице на выбранном нами листе. Если вы используете одну сводную таблицу, вы можете установить ее индекс на `0`:
```csharp
int pivotindex = 0;
// Доступ к сводной таблице
PivotTable pivotTable = worksheet.PivotTables[pivotindex];
```
Этот фрагмент кода выбирает первую сводную таблицу на рабочем листе. 
## Шаг 4: Настройка сводной таблицы
А теперь самое интересное! Давайте настроим сводную таблицу на отображение общих итогов по строкам:
```csharp
pivotTable.RowGrand = true;
```
Эта строка гарантирует, что в вашем отчете будут отображаться общие итоги, которые могут быть полезным обобщением для анализа данных.
## Шаг 5: Доступ к полям строк и их настройка
Далее нам необходимо получить доступ к полям строк сводной таблицы:
```csharp
Aspose.Cells.Pivot.PivotFieldCollection pivotFields = pivotTable.RowFields;
```
Эта коллекция позволяет нам манипулировать полями по мере необходимости.
## Настройте поле первой строки
Хотите задать определенные типы промежуточных итогов? Давайте перейдем к первому полю в нашей коллекции и настроим его:
```csharp
Aspose.Cells.Pivot.PivotField pivotField = pivotFields[0];
// Установка промежуточных итогов.
pivotField.SetSubtotals(Aspose.Cells.Pivot.PivotFieldSubtotalType.Sum, true);
pivotField.SetSubtotals(Aspose.Cells.Pivot.PivotFieldSubtotalType.Count, true);
```
Включая `Sum` и `Count` промежуточные итоги, мы можем быстро суммировать данные в нашем отчете.
## Шаг 6: Настройка параметров автосортировки
Далее, давайте применим умную сортировку. Таким образом, ваша сводная таблица будет упорядочивать данные в осмысленном порядке:
```csharp
// Настройка параметров автосортировки.
pivotField.IsAutoSort = true;
pivotField.IsAscendSort = true;
pivotField.AutoSortField = -5; // Использование предопределенного поля сортировки.
```
Этот фрагмент кода включает автоматическую сортировку и задает порядок возрастания. 
## Шаг 7: Настройка параметров автопоказа
Хотите ли вы отфильтровать данные еще больше? Параметр AutoShow полезен для отображения определенных точек данных при определенных условиях:
```csharp
// Настройка параметров автопоказа.
pivotField.IsAutoShow = true;
pivotField.IsAscendShow = false;
pivotField.AutoShowField = 0; // Укажите поле для автоматического показа.
```
Это гарантирует, что в вашей сводной таблице будут отображаться только актуальные данные, что повышает ясность и фокусировку.
## Шаг 8: Сохранение вашей работы
После всех этих настроек вы не захотите потерять свою работу! Сохраните измененную книгу следующим образом:
```csharp
workbook.Save(dataDir + "output.xls");
```
Теперь вы можете найти вновь созданный файл Excel в каталоге своих документов.
## Заключение
И вот вам! Мы рассмотрели всеобъемлющий и практический подход к программной настройке форматов полей страницы в сводной таблице с использованием Aspose.Cells для .NET. С помощью простых шагов вы должны быть уверены в изменении данных Excel в соответствии с вашими потребностями в отчетности. Невероятно, чего вы можете достичь, объединив мощь C# с Aspose.Cells.
## Часто задаваемые вопросы
### Что такое Aspose.Cells?
Aspose.Cells — это библиотека .NET, которая позволяет разработчикам программно создавать, изменять и конвертировать файлы Excel.
### Как установить Aspose.Cells?
Вы можете скачать его прямо с сайта [Сайт Aspose](https://releases.aspose.com/cells/net/).
### Могу ли я использовать Aspose.Cells без установки Excel?
Да, Aspose.Cells — это автономная библиотека, не требующая установки Microsoft Excel.
### Где я могу найти подробную поддержку?
Подробную поддержку и форумы можно получить по адресу [Поддержка Aspose](https://forum.aspose.com/c/cells/9).
### Как мне получить временную лицензию?
Вы можете получить временную лицензию у [здесь](https://purchase.aspose.com/temporary-license/).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}