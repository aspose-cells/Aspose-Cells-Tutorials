---
"description": "Научитесь использовать Aspose.Cells для .NET для форматирования сводных таблиц без усилий. Изучите пошаговые методы улучшения представления данных."
"linktitle": "Настройка параметров формата сводной таблицы в .NET"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Настройка параметров формата сводной таблицы в .NET"
"url": "/ru/net/creating-and-configuring-pivot-tables/setting-format-options/"
"weight": 20
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Настройка параметров формата сводной таблицы в .NET

## Введение
Вы когда-нибудь чувствовали себя подавленными от огромного объема данных, имеющихся в вашем распоряжении? Или вам было сложно представить эти данные в ясной и содержательной манере? Если да, то добро пожаловать на борт! Сегодня мы окунемся в удивительный мир сводных таблиц в Excel с помощью библиотеки Aspose.Cells для .NET. Сводные таблицы могут стать супергероями представления данных, преобразуя горы чисел в структурированные, содержательные отчеты, которые делают принятие решений легким. Разве это не меняет правила игры?
## Предпосылки
Прежде чем мы перейдем к руководству, давайте убедимся, что у вас есть все необходимое для успеха. Вот предварительные условия:
1. Базовые знания C#: Вы должны иметь фундаментальное понимание языка программирования C#. Если вы знакомы с основами, вы готовы взяться за это!
2. Visual Studio или любая IDE C#: Вам понадобится интегрированная среда разработки (IDE), например Visual Studio. Вот где происходит волшебство. 
3. Библиотека Aspose.Cells: Чтобы использовать возможности Aspose.Cells, вам нужно загрузить этот пакет. Вы можете легко найти его на [Страница загрузки Aspose.Cells](https://releases.aspose.com/cells/net/).
4. Файл Excel: Для практики учебника требуется образец файла Excel. Не стесняйтесь создать простой набор данных в таблице Excel (например, "Book1.xls") для этого упражнения.
5. .NET Framework: Убедитесь, что на вашем компьютере установлен .NET Framework.
Все понял? Фантастика! Теперь давайте перейдем к первому шагу.
## Импортные пакеты
Чтобы начать использовать библиотеку Aspose.Cells, нам сначала нужно импортировать необходимые пакеты. Вот как это сделать:
### Откройте свой проект
Откройте Visual Studio (или любую C# IDE, которую вы используете) и создайте новый проект. Выберите консольное приложение, поскольку это позволит вам легко запустить скрипт.
### Добавить ссылку Aspose.Cells
1. Щелкните правой кнопкой мыши по вашему проекту в обозревателе решений.
2. Выберите «Управление пакетами NuGet».
3. В поле поиска введите `Aspose.Cells` и установите его.
Теперь вы готовы подключить библиотеку. Вам нужно будет добавить следующую директиву using в начало вашего файла кода:
```csharp
using System.IO;
using Aspose.Cells;
using System.Drawing;
using Aspose.Cells.Pivot;
```
Эта строка позволяет получить доступ ко всем классам и методам, доступным в библиотеке Aspose.Cells.
С заложенной основой давайте шаг за шагом пройдемся по каждой части процесса. Мы рассмотрим, как эффективно устанавливать различные параметры формата для сводной таблицы.
## Шаг 1: Определите каталог документов
Во-первых, вам нужно задать путь к каталогу вашего документа, где находится ваш входной файл Excel. Эта строка кода указывает, где находятся ваши файлы.
```csharp
string dataDir = "Your Document Directory";
```
Заменять `"Your Document Directory"` с фактическим путем, где хранится ваш файл "Book1.xls". Это помогает программе узнать, где искать входной файл.
## Шаг 2: Загрузите файл шаблона
Далее мы загрузим файл Excel, который мы хотим обработать. Это делается с помощью `Workbook` сорт.
```csharp
Workbook workbook = new Workbook(dataDir + "Book1.xls");
```
По сути, эта команда сообщает вашей программе о необходимости открыть файл «Book1.xls», чтобы мы могли работать с его данными.
## Шаг 3: Получите первый рабочий лист
Теперь, когда у нас открыта рабочая книга, давайте перейдем к рабочему листу, на котором хранятся наши данные. 
```csharp
Worksheet worksheet = workbook.Worksheets[0];
```
Здесь мы получаем доступ к первому листу рабочей книги (поскольку индексация начинается с нуля). Если ваши данные находятся на другом листе, просто настройте индекс.
## Шаг 4: Доступ к сводной таблице
Сводные таблицы — это мощно, но сначала нам нужно выбрать ту, с которой мы хотим работать. Если вы знаете индекс сводной таблицы, вот как получить к ней доступ.
```csharp
int pivotindex = 0;
PivotTable pivotTable = worksheet.PivotTables[pivotindex];
```
В этом случае мы получаем доступ к первой сводной таблице (индекс 0) на рабочем листе. 
## Шаг 5: Установите общие итоги сводной таблицы для строк
Давайте начнем форматирование! Мы можем настроить, показывать ли общие итоги для строк в нашей сводной таблице.
```csharp
pivotTable.RowGrand = true;
```
Установка этого свойства в значение `true` отобразит общие итоги внизу каждой строки в вашей сводной таблице. Это простой, но эффективный способ предоставления сводок.
## Шаг 6: Установите общие итоги для столбцов сводной таблицы
Так же, как мы устанавливаем общие итоги для строк, мы можем сделать это и для столбцов.
```csharp
pivotTable.ColumnGrand = true;
```
Включение этого параметра предоставит итоговые данные в правой части каждого столбца. Теперь ваша сводная таблица — чемпион по суммированию данных в обоих направлениях!
## Шаг 7: Отображение пользовательской строки для значений NULL
Часто упускаемая из виду деталь — обработка нулевых значений. Возможно, вам захочется, чтобы в ячейках, где есть нулевые значения, отображалась определенная строка. 
```csharp
pivotTable.DisplayNullString = true;
pivotTable.NullString = "null";
```
Это настроит сводную таблицу на отображение значения «null» при обнаружении пустой ячейки, что добавит ясности и последовательности в ваши отчеты.
## Шаг 8: Настройте макет сводной таблицы
Сводные таблицы могут иметь различные макеты, и мы можем настроить их в соответствии с нашими требованиями. Давайте установим макет на "DownThenOver".
```csharp
pivotTable.PageFieldOrder = PrintOrderType.DownThenOver;
```
Эта команда изменяет порядок отображения полей в отчете, что упрощает его чтение. 
## Шаг 9: Сохранение файла Excel
Наконец, после внесения всех этих прекрасных изменений вам необходимо сохранить их обратно в файл Excel. 
```csharp
workbook.Save(dataDir + "output.xls");
```
Эта строка сохраняет измененную книгу как «output.xls» в указанном вами каталоге. 
И вот так вы улучшили свою сводную таблицу с помощью всех этих фантастических возможностей форматирования!
## Заключение
Ого, мы вместе прошли долгий путь, не так ли? Используя возможности библиотеки Aspose.Cells для .NET, вы можете без усилий преобразовать то, как ваши данные выглядят и ведут себя в Excel. Мы рассмотрели, как загрузить книгу, получить доступ к сводной таблице и отформатировать ее, и завершили все сохранением наших изменений. Данные не должны быть серыми и унылыми; с несколькими настройками они могут сиять ослепительно.
## Часто задаваемые вопросы
### Что такое сводная таблица?
Сводные таблицы — это функция Excel, которая позволяет динамически суммировать и анализировать данные.
### Нужно ли устанавливать Excel для использования Aspose.Cells?
Нет, Aspose.Cells — это автономная библиотека, не требующая установки Excel.
### Могу ли я создавать сводные таблицы с помощью Aspose.Cells?
Да, Aspose.Cells позволяет создавать, изменять и управлять сводными таблицами.
### Является ли Aspose.Cells бесплатным?
Aspose.Cells — платная библиотека, но доступна бесплатная пробная версия.
### Где я могу найти дополнительную документацию по Aspose.Cells?
Проверьте [Документация Aspose.Cells](https://reference.aspose.com/cells/net/) для получения подробных руководств и примеров.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}