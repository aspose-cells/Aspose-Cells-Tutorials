---
title: Установить шрифт по умолчанию для параметров сохранения PDF
linktitle: Установить шрифт по умолчанию для параметров сохранения PDF
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как задать шрифты по умолчанию для параметров сохранения PDF-файлов с помощью Aspose.Cells для .NET, чтобы ваши документы всегда выглядели идеально.
weight: 11
url: /ru/net/working-with-fonts-in-spreadsheets/set-default-font-for-pdf-save-options/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Установить шрифт по умолчанию для параметров сохранения PDF

## Введение
Когда дело доходит до создания отчетов, счетов-фактур или любых других документов в формате PDF, обеспечение того, чтобы ваш контент выглядел правильно, имеет первостепенное значение. Шрифты играют важную роль в поддержании визуальной привлекательности и читаемости ваших документов. Однако что произойдет, если шрифт, который вы использовали в вашем файле Excel, недоступен в системе, где вы создаете свой PDF? Вот где Aspose.Cells for .NET оказывается полезным. Эта мощная библиотека позволяет вам устанавливать шрифты по умолчанию для параметров сохранения PDF, гарантируя, что ваши документы будут выглядеть профессионально и единообразно, независимо от того, где они открыты.
## Предпосылки
Прежде чем начать, убедитесь, что у вас есть следующее:
1. Visual Studio: для написания и выполнения кода вам понадобится среда разработки, например Visual Studio.
2.  Aspose.Cells для .NET: Вы можете загрузить последнюю версию с сайта[эта ссылка](https://releases.aspose.com/cells/net/). Кроме того, вы можете установить его через диспетчер пакетов NuGet в Visual Studio.
3. Базовые знания C#: понимание основ C# поможет вам разобраться в примерах кода.
4. Образец файла Excel: Подготовьте образец файла Excel для тестирования. Вы можете создать его с различными шрифтами и стилями, чтобы увидеть, как Aspose.Cells обрабатывает отсутствующие шрифты.
## Импортные пакеты
Прежде чем вы сможете использовать Aspose.Cells в своем проекте, вам нужно импортировать необходимые пакеты. Вот как это сделать:
1. Откройте свой проект: запустите Visual Studio и откройте существующий проект или создайте новый.
2. Добавить ссылки: щелкните правой кнопкой мыши свой проект в обозревателе решений и выберите «Управление пакетами NuGet».
3. Установите Aspose.Cells: найдите «Aspose.Cells» и нажмите кнопку «Установить».
4. Добавьте директивы Using: в верхней части файла C# включите следующие пространства имен:
```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Aspose.Cells.Rendering;
using System.Drawing.Imaging;
```
## Шаг 1: Настройте свои каталоги
Перед работой с файлами важно определить исходный и выходной каталоги. Это упростит поиск входного файла Excel и сохранение сгенерированных выходных файлов.
```csharp
// Исходный каталог
string sourceDir = "Your Document Directory";
// Выходной каталог
string outputDir = "Your Document Directory";
```
 Заменять`"Your Document Directory"` с фактическим путем к вашим каталогам.
## Шаг 2: Откройте файл Excel.
 Теперь, когда у нас настроены каталоги, давайте откроем файл Excel, с которым вы хотите работать.`Workbook` Класс в Aspose.Cells используется для загрузки документа Excel.
```csharp
// Откройте файл Excel.
Workbook workbook = new Workbook(sourceDir + "sampleSetDefaultFontPropertyOfPdfSaveOptionsAndImageOrPrintOptions.xlsx");
```
Обязательно замените имя файла на фактическое имя файла.
## Шаг 3: Настройка параметров рендеринга изображения
Далее нам нужно настроить параметры рендеринга для преобразования нашего листа Excel в формат изображения. Мы создадим экземпляр`ImageOrPrintOptions`, указав тип изображения и шрифт по умолчанию.
```csharp
// Рендеринг в формат файла PNG
ImageOrPrintOptions imgOpt = new ImageOrPrintOptions();
imgOpt.ImageType = Drawing.ImageType.Png;
imgOpt.CheckWorkbookDefaultFont = false;
imgOpt.DefaultFont = "Times New Roman";
```
 В этом фрагменте кода мы устанавливаем`CheckWorkbookDefaultFont` собственность`false`, что означает, что если какие-либо шрифты отсутствуют, вместо них будет использоваться указанный шрифт по умолчанию («Times New Roman»).
## Шаг 4: визуализируйте лист как изображение
 Теперь давайте отрисуем первый лист книги как изображение PNG. Мы будем использовать`SheetRender` класс, чтобы достичь этого.
```csharp
// Преобразовать первый рабочий лист в изображение
SheetRender sr = new SheetRender(workbook.Worksheets[0], imgOpt);
sr.ToImage(0, outputDir + "out1_imagePNG.png");
```
## Шаг 5: Измените тип изображения и отрисуйте его в формате TIFF
 Если вы хотите преобразовать тот же лист в другой формат изображения, например TIFF, вы можете просто изменить`ImageType` свойство и повторите процесс рендеринга.
```csharp
// Установить формат TIFF
imgOpt.ImageType = Drawing.ImageType.Tiff;
WorkbookRender wr = new WorkbookRender(workbook, imgOpt);
wr.ToImage(outputDir + "out1_imageTIFF.tiff");
```
## Шаг 6: Настройте параметры сохранения PDF-файла
 Далее, давайте настроим параметры сохранения PDF. Мы создадим экземпляр`PdfSaveOptions`задаем шрифт по умолчанию и указываем, что хотим проверить наличие отсутствующих шрифтов.
```csharp
// Настройте параметры сохранения PDF-файла
PdfSaveOptions saveOptions = new PdfSaveOptions();
saveOptions.DefaultFont = "Times New Roman";
saveOptions.CheckWorkbookDefaultFont = false;
```
## Шаг 7: Сохраните рабочую книгу в формате PDF.
После настройки параметров сохранения пришло время сохранить нашу книгу Excel в виде файла PDF. 
```csharp
// Сохранить книгу в формате PDF
workbook.Save(outputDir + "out1_pdf.pdf", saveOptions);
```
## Шаг 8: Подтверждение выполнения
Наконец, хорошей практикой является дать пользователю знать, что процесс успешно завершен. Вы можете добиться этого с помощью простого консольного сообщения.
```csharp
Console.WriteLine("SetDefaultFontPropertyOfPdfSaveOptionsAndImageOrPrintOptions executed successfully.\r\n");
```
## Заключение
Aspose.Cells предоставляет гибкий и надежный способ обработки файлов Excel, что упрощает разработчикам создание визуально привлекательных документов, сохраняющих свое форматирование. Независимо от того, работаете ли вы над отчетами, финансовыми документами или любой другой формой представления данных, контроль над рендерингом шрифтов может значительно повысить качество вывода.
## Часто задаваемые вопросы
### Что такое Aspose.Cells?
Aspose.Cells — это мощная библиотека .NET, которая позволяет разработчикам манипулировать файлами Excel без необходимости установки Microsoft Excel. Она поддерживает различные форматы файлов и предлагает богатые возможности для работы с электронными таблицами.
### Как установить шрифт по умолчанию для файлов Excel?
 Вы можете установить шрифт по умолчанию с помощью`PdfSaveOptions` class и укажите желаемое имя шрифта. Это гарантирует, что даже если шрифт отсутствует, ваш документ будет использовать указанный вами шрифт по умолчанию.
### Могу ли я конвертировать файлы Excel в форматы, отличные от PDF?
Конечно! Aspose.Cells позволяет конвертировать файлы Excel в различные форматы, включая изображения (PNG, TIFF), HTML, CSV и другие.
### Можно ли использовать Aspose.Cells бесплатно?
Aspose.Cells — коммерческий продукт, но вы можете попробовать его бесплатно с ограниченной пробной версией. Для полной функциональности вам нужно будет приобрести лицензию.
### Где я могу найти поддержку Aspose.Cells?
 Поддержку Aspose.Cells можно найти, посетив[Форум Aspose](https://forum.aspose.com/c/cells/9), где вы можете задавать вопросы и делиться идеями с другими пользователями и разработчиками.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
