---
"description": "Узнайте, как получить доступ и изменить метки объектов OLE в Excel с помощью Aspose.Cells для .NET. Простое руководство с включенными примерами кода."
"linktitle": "Доступ к метке объекта OLE в Excel"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Доступ к метке объекта OLE в Excel"
"url": "/ru/net/excel-shape-label-access/access-ole-object-label-excel/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Доступ к метке объекта OLE в Excel

## Введение
Если вы когда-либо пробовали Excel, вы знаете, насколько мощным и сложным он может быть. Иногда вы можете наткнуться на данные, встроенные в объекты OLE (Object Linking and Embedding) — представьте себе это как «мини-окно» в другой программный инструмент, например, документ Word или слайд PowerPoint, все это удобно расположено в вашей электронной таблице. Но как нам получить доступ и управлять этими метками в наших объектах OLE с помощью Aspose.Cells для .NET? Пристегните ремни, потому что в этом руководстве мы разберем это шаг за шагом!
## Предпосылки
 
Прежде чем мы погрузимся в полный действий мир Aspose.Cells для .NET, вот что вам нужно иметь в своем наборе инструментов:
1. Установленная среда Visual Studio: это ваша игровая площадка, где вы будете кодировать и тестировать свое приложение C#.
2. .NET Framework: Убедитесь, что вы работаете с .NET Framework 4.0 или выше. Это даст нашей программе необходимую основу для бесперебойной работы.
3. Библиотека Aspose.Cells: Вам понадобится копия библиотеки Aspose.Cells. Вы можете загрузить ее с [здесь](https://releases.aspose.com/cells/net/). Если вы хотите попробовать его перед покупкой, ознакомьтесь с [бесплатная пробная версия](https://releases.aspose.com/).
4. Базовые знания C#: знакомство с C# поможет вам быстро разобраться в коде.
Разобравшись с этим, давайте углубимся в тонкости доступа и изменения меток на объектах OLE!
## Импортные пакеты 
Для начала нам нужно импортировать необходимые пакеты в наш проект. Это облегчит нам жизнь, предоставив доступ ко всем необходимым функциям и классам. Вот как это сделать:
### Создать новый проект C# 
- Откройте Visual Studio и создайте новый проект консольного приложения C#.
- Назовите его как-то вроде «OLEObjectLabelExample».
### Добавьте ссылку Aspose.Cells 
- Щелкните правой кнопкой мыши по вашему проекту в обозревателе решений.
- Выберите «Управление пакетами NuGet».
- Найдите «Aspose.Cells» и установите библиотеку.
### Импорт пространств имен
В верхней части файла вашей программы (например, `Program.cs`), вам необходимо импортировать необходимые пространства имен:
```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
```
Эти пространства имен помогут нам получить доступ к классам и методам, необходимым для наших манипуляций с Excel.
Теперь, когда все на месте, давайте получим доступ и изменим метку объекта OLE, встроенного в файл Excel. Следуйте пошаговому руководству ниже:
## Шаг 1: Укажите исходный каталог
Сначала мы определяем каталог, в котором находится ваш документ Excel. Заменить `"Your Document Directory"` с фактическим путем к документу.
```csharp
string sourceDir = "Your Document Directory";
```
## Шаг 2: Загрузите образец файла Excel 
Далее мы загрузим файл Excel .xlsx, содержащий наш объект OLE:
```csharp
Workbook wb = new Workbook(sourceDir + "sampleAccessAndModifyLabelOfOleObject.xlsx");
```
Эта строка инициализирует `Workbook` объект, который предоставляет нам доступ ко всем рабочим листам и компонентам файла Excel.
## Шаг 3: Получите доступ к первому рабочему листу
Теперь давайте откроем первый рабочий лист в нашей рабочей книге:
```csharp
Worksheet ws = wb.Worksheets[0];
```
Здесь, `Worksheets[0]` первый рабочий лист в коллекции.
## Шаг 4: Доступ к первому объекту OLE 
Далее мы извлечем первый объект OLE:
```csharp
Aspose.Cells.Drawing.OleObject oleObject = ws.OleObjects[0];
```
Это позволит нам взаимодействовать с объектом OLE, с которым мы хотим работать.
## Шаг 5: Отображение метки объекта OLE
Прежде чем изменять метку, давайте распечатаем ее текущее значение:
```csharp
Console.WriteLine("Ole Object Label - Before: " + oleObject.Label);
```
Это дает нам четкое представление об этикетке до внесения каких-либо изменений.
## Шаг 6: Измените метку 
А теперь самое интересное — изменим метку объекта OLE:
```csharp
oleObject.Label = "Aspose APIs";
```
Вы можете установить это как вам угодно. «API Aspose» — это просто изящный способ показать, что мы делаем.
## Шаг 7: Сохраните рабочую книгу в потоке памяти 
Затем мы сохраним наши изменения в потоке памяти перед перезагрузкой книги:
```csharp
MemoryStream ms = new MemoryStream();
wb.Save(ms, SaveFormat.Xlsx);
```
Это сохранит нашу измененную книгу в памяти, что позволит легко получить к ней доступ в дальнейшем.
## Шаг 8: Установите ссылку на рабочую книгу на значение Null 
Чтобы очистить память, нам следует установить ссылку на рабочую книгу в значение null:
```csharp
wb = null;
```
## Шаг 9: Загрузка рабочей книги из потока памяти 
Далее мы перезагрузим нашу рабочую книгу из потока памяти, который мы только что сохранили:
```csharp
wb = new Workbook(ms);
```
## Шаг 10: Снова откройте первый рабочий лист. 
Как и прежде, нам снова нужно обратиться к первому рабочему листу:
```csharp
ws = wb.Worksheets[0];
```
## Шаг 11: Повторный доступ к первому объекту OLE
Теперь снова извлеките объект OLE для окончательной проверки:
```csharp
oleObject = ws.OleObjects[0];
```
## Шаг 12: Отображение измененной метки 
Чтобы проверить, вступили ли наши изменения в силу, давайте распечатаем новую этикетку:
```csharp
Console.WriteLine("Ole Object Label - After: " + oleObject.Label);
```
## Шаг 13: Подтверждение выполнения 
Наконец, отправьте сообщение об успешном завершении, чтобы мы знали, что все прошло по плану:
```csharp
Console.WriteLine("AccessAndModifyLabelOfOleObject executed successfully.");
```
## Заключение 
И вот оно! Вы успешно получили доступ и изменили метку объекта OLE в Excel с помощью Aspose.Cells для .NET. Это отличный способ добавить индивидуальности вашим встроенным документам, повышая ясность и коммуникацию в ваших электронных таблицах. 
Разрабатываете ли вы крутое приложение или просто украшаете свои отчеты, манипулирование объектами OLE может стать переломным моментом. Продолжайте изучать то, что предлагает Aspose.Cells, и вы откроете для себя целый мир возможностей.
## Часто задаваемые вопросы
### Что такое объект OLE в Excel?  
Объекты OLE — это встроенные файлы, которые позволяют интегрировать документы из других приложений Microsoft Office в электронную таблицу Excel.
### Может ли Aspose.Cells работать с другими форматами файлов?  
Да! Aspose.Cells поддерживает множество форматов, включая XLS, XLSX, CSV и другие.
### Существует ли бесплатная пробная версия Aspose.Cells?  
Да! Вы можете попробовать. [здесь](https://releases.aspose.com/).
### Могу ли я получить доступ к нескольким объектам OLE на рабочем листе?  
Конечно! Вы можете пройти по циклу `ws.OleObjects` для доступа ко всем встроенным объектам OLE на рабочем листе.
### Как приобрести лицензию на Aspose.Cells?  
Вы можете купить лицензию напрямую у [здесь](https://purchase.aspose.com/buy).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}