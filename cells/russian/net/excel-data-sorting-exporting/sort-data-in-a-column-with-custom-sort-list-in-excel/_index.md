---
"description": "В этом подробном руководстве вы узнаете, как сортировать данные в Excel, используя настраиваемый список сортировки с помощью Aspose.Cells для .NET."
"linktitle": "Сортировка данных в столбце с помощью пользовательского списка сортировки в Excel"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Сортировка данных в столбце с помощью пользовательского списка сортировки в Excel"
"url": "/ru/net/excel-data-sorting-exporting/sort-data-in-a-column-with-custom-sort-list-in-excel/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Сортировка данных в столбце с помощью пользовательского списка сортировки в Excel

## Введение

Это руководство проведет вас через процесс настройки вашего проекта, загрузки файла Excel и сортировки данных в указанном диапазоне с использованием пользовательского порядка сортировки. Следуя этому руководству, вы получите практический опыт, который может улучшить ваши навыки управления данными и удобство использования библиотеки Aspose.Cells.

## Предпосылки

Прежде чем приступить к изучению урока, давайте обозначим некоторые предварительные условия, которые помогут обеспечить бесперебойный процесс обучения.

### Базовые знания C#

Хотя учебник призван провести вас через каждый шаг, наличие базовых знаний C# облегчит понимание представленных концепций.

### Среда разработки .NET

Убедитесь, что у вас настроена рабочая среда разработки .NET. Вы можете использовать Visual Studio или любую другую IDE, которая поддерживает разработку .NET.

### Пакет Aspose.Cells для .NET NuGet

Вам необходимо установить библиотеку Aspose.Cells для .NET в вашем проекте. Вы можете легко добавить ее через NuGet Package Manager. 

Вот как это сделать:

1. Откройте свой проект в Visual Studio.
2. Перейдите в «Инструменты» > «Диспетчер пакетов NuGet» > «Управление пакетами NuGet для решения».
3. Искать `Aspose.Cells` и установите последнюю версию.

### Базовый файл Excel для тестирования

Вам понадобится образец файла Excel для работы. Вы можете создать простой файл Excel со случайными названиями стран и их кодами.

## Импортные пакеты

Для начала давайте импортируем необходимые пакеты в ваш проект. Вот фрагмент того, как настроить ваш код:

```csharp
using System;
using System.IO;
using Aspose.Cells;
using System.Drawing;
```

Импортировав посылки, мы готовы двигаться дальше.

## Шаг 1: Определите исходный и выходной каталоги 

Первый шаг — определить, где находится ваш входной файл и где вы хотите сохранить выходной файл (отсортированный файл). Вам нужно указать два пути: один для исходного файла Excel и другой для сохранения выходных данных после сортировки.

```csharp
string sourceDir = "Your Document Directory\\";
string outputDir = "Your Document Directory\\";
```

## Шаг 2: Загрузите исходный файл Excel

Далее мы загрузим файл Excel, содержащий данные, которые вы хотите отсортировать. Это делается путем создания экземпляра `Workbook` class и передав путь к исходному файлу.

```csharp
Workbook wb = new Workbook(sourceDir + "sampleSortData_CustomSortList.xlsx");
```

## Шаг 3: Получите доступ к первому рабочему листу 

После загрузки файла нам нужно получить доступ к конкретному рабочему листу, содержащему данные, которые мы собираемся сортировать. В этом случае мы нацеливаемся на первый рабочий лист.

```csharp
Worksheet ws = wb.Worksheets[0];
```

## Шаг 4: Укажите область ячеек для сортировки

Нам нужно определить диапазон ячеек, которые мы будем сортировать. В этом примере мы отсортируем ячейки от A1 до A40. Используйте `CellArea.CreateCellArea` метод определения площади ячейки.

```csharp
CellArea ca = CellArea.CreateCellArea("A1", "A40");
```

## Шаг 5: Создайте собственный список сортировки

Перед сортировкой нам нужно установить критерии, которые мы будем использовать для нашей пользовательской сортировки. Вы можете определить список сортировки как массив строк. Пользовательский список сортировки будет определять порядок сортировки.

```csharp
string[] customSortList = new string[] { "USA,US", "Brazil,BR", "China,CN", "Russia,RU", "Canada,CA" };
```

## Шаг 6: Добавьте ключ сортировки и выполните сортировку

Теперь пора сортировать! Для этого мы воспользуемся классом DataSorter. Создадим ключ для сортировки на основе нашего пользовательского списка и выполним операцию сортировки.

```csharp
wb.DataSorter.AddKey(0, SortOrder.Ascending, customSortList);
wb.DataSorter.Sort(ws.Cells, ca);
```

## Шаг 7: Сохраните выходной файл Excel

После завершения сортировки последний шаг — сохранить изменения в новом файле Excel. Укажите имя выходного файла и сохраните книгу.

```csharp
wb.Save(outputDir + "outputSortData_CustomSortList.xlsx");
```

## Шаг 8: Подтвердите успешное выполнение

Чтобы убедиться, что все прошло гладко, вы можете вывести на консоль сообщение с подтверждением. Это помогает в отладке и дает вам удовлетворение от того, что операция прошла успешно.

```csharp
Console.WriteLine("SortDataInColumnWithCustomSortList executed successfully.\r\n");
```

## Заключение

И вот оно! Вы успешно отсортировали данные в столбце Excel, используя пользовательский список сортировки с Aspose.Cells для .NET. Сортировка помогает структурировать и ясно представить ваши данные, упрощая их анализ и интерпретацию. Надеюсь, это руководство выведет ваши навыки на новый уровень и поможет вам понять, насколько мощным может быть Aspose.Cells для ваших задач, связанных с Excel.

## Часто задаваемые вопросы

### Что такое Aspose.Cells для .NET?
Aspose.Cells для .NET — это комплексная библиотека, позволяющая манипулировать файлами Excel в приложениях .NET, включая их создание, редактирование и преобразование.

### Можно ли сортировать более одного столбца, используя пользовательский список сортировки?
Да! При необходимости вы можете добавить дополнительные ключи для сортировки по нескольким столбцам, просто выполните ту же процедуру для каждого ключа.

### Нужны ли мне предварительные знания C# для использования Aspose.Cells?
Хотя это и полезно, вы можете следовать этому руководству и учиться по ходу дела! Наличие некоторых базовых знаний C# улучшит ваш опыт обучения.

### Можно ли использовать временную лицензию для Aspose.Cells?
Конечно! Вы можете приобрести временную лицензию, если хотите протестировать все возможности библиотеки без ограничений.

### Могу ли я загрузить примеры или документацию для Aspose.Cells?
Да! Aspose предоставляет обширную документацию и примеры проектов, которые могут вам очень помочь. Ознакомьтесь с [Документация Aspose.Cells](https://reference.aspose.com/cells/net/).

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}