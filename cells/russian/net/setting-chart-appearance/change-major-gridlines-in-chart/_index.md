---
title: Изменить основные линии сетки на диаграмме
linktitle: Изменить основные линии сетки на диаграмме
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как изменить основные линии сетки в диаграммах Excel с помощью Aspose.Cells для .NET, воспользовавшись нашим подробным пошаговым руководством.
weight: 11
url: /ru/net/setting-chart-appearance/change-major-gridlines-in-chart/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Изменить основные линии сетки на диаграмме

## Введение

Создание визуально привлекательных диаграмм в Excel необходимо для эффективного представления данных. Независимо от того, являетесь ли вы аналитиком данных, менеджером проектов или просто человеком, интересующимся визуализацией данных, понимание того, как настраивать диаграммы, может значительно улучшить ваши отчеты. В этой статье мы узнаем, как изменить основные линии сетки в диаграмме Excel с помощью библиотеки Aspose.Cells для .NET.

## Предпосылки

Прежде чем начать, вам необходимо выполнить несколько действий, чтобы обеспечить бесперебойную работу с Aspose.Cells:

- Visual Studio: Убедитесь, что на вашем компьютере установлена Visual Studio. Здесь вы будете писать и выполнять свой код.
-  Aspose.Cells для .NET: Вы можете загрузить последнюю версию Aspose.Cells с сайта[веб-сайт](https://releases.aspose.com/cells/net/) . Если вы хотите поэкспериментировать перед покупкой, вы можете рассмотреть возможность регистрации в[бесплатная пробная версия](https://releases.aspose.com/).
- Базовые знания C#: знакомство с программированием на C# облегчит понимание примеров в этом руководстве.

Как только вы все настроите, мы можем приступить к написанию кода!

## Импортные пакеты

Для работы с Aspose.Cells первым шагом является импорт необходимых пакетов в ваш проект C#. Откройте ваш проект Visual Studio и включите следующие директивы using в верхней части вашего файла C#:

```csharp
using Aspose.Cells;
using Aspose.Cells.Charts;
using System.Drawing;
```

Эти пакеты позволяют получить доступ к классам и методам, которые вам понадобятся для создания и изменения рабочих книг и диаграмм Excel.

Теперь давайте разобьем процесс на подробные и простые шаги. Мы создадим простую диаграмму с некоторыми данными, а затем изменим цвет ее основных линий сетки.

## Шаг 1: Укажите выходной каталог

Первое, что вам нужно сделать, это определить, где вы хотите сохранить выходной файл Excel. Это делается путем указания пути к каталогу в вашем коде:

```csharp
// Выходной каталог
string outputDir = "Your Output Directory"; // Обновите, указав желаемый путь
```

 Заменять`"Your Output Directory"` на фактический путь, по которому вы хотите сохранить файл.

## Шаг 2: Создание экземпляра объекта Workbook

 Далее вам необходимо создать новый экземпляр`Workbook` класс. Этот объект будет представлять ваш файл Excel, позволяя вам манипулировать его содержимым.

```csharp
// Создание объекта Workbook
Workbook workbook = new Workbook();
```

Эта строка кода инициализирует новую рабочую книгу, которая предоставит чистый холст для нашего рабочего листа и диаграммы.

## Шаг 3: Доступ к рабочему листу

 После создания книги вы можете получить доступ к ее рабочему листу по умолчанию. Рабочие листы в Aspose.Cells индексируются, поэтому, если вам нужен первый рабочий лист, вы ссылаетесь на него по индексу`0`.

```csharp
// Получение ссылки на недавно добавленный рабочий лист путем передачи его индекса листа
Worksheet worksheet = workbook.Worksheets[0];
```

## Шаг 4: Заполните рабочий лист образцами данных.

Давайте добавим несколько выборочных значений в ячейки рабочего листа, которые будут служить данными для нашей диаграммы. Это важно, поскольку диаграмма будет ссылаться на эти данные.

```csharp
// Добавление выборочных значений в ячейки
worksheet.Cells["A1"].PutValue(50);
worksheet.Cells["A2"].PutValue(100);
worksheet.Cells["A3"].PutValue(150);
worksheet.Cells["B1"].PutValue(60);
worksheet.Cells["B2"].PutValue(32);
worksheet.Cells["B3"].PutValue(50);
```

Здесь мы вводим несколько числовых значений в определенные ячейки. Столбцы «A» и «B» содержат точки данных, которые мы будем визуализировать.

## Шаг 5: Добавьте диаграмму на рабочий лист

Имея данные на месте, пришло время создать диаграмму. Мы добавим столбчатую диаграмму, которая визуализирует наш набор данных.

```csharp
// Добавление диаграммы на рабочий лист
int chartIndex = worksheet.Charts.Add(Aspose.Cells.Charts.ChartType.Column, 5, 0, 25, 10);
```

В этом коде мы указываем тип диаграммы (в данном случае столбчатую диаграмму) и место, где мы хотим ее разместить.

## Шаг 6: Доступ к экземпляру диаграммы

 После создания диаграммы нам нужно получить доступ к ее экземпляру, чтобы изменить ее свойства. Это делается путем ее извлечения через`Charts`коллекция.

```csharp
// Доступ к экземпляру недавно добавленной диаграммы
Aspose.Cells.Charts.Chart chart = worksheet.Charts[chartIndex];
```

## Шаг 7: Добавьте ряд данных в диаграмму

Теперь нам нужно привязать наши данные к диаграмме. Это включает в себя указание ячеек в качестве источника данных для диаграммы.

```csharp
// Добавление SeriesCollection (источник данных диаграммы) к диаграмме в диапазоне от ячейки «A1» до «B3»
chart.NSeries.Add("A1:B3", true);
```

На этом этапе мы сообщаем диаграмме диапазон данных, которые она должна визуализировать.

## Шаг 8: Настройте внешний вид диаграммы

Давайте немного украсим нашу диаграмму, изменив цвета области построения, области диаграммы и коллекций серий. Это поможет нашей диаграмме выделиться и улучшить ее визуальную привлекательность.

```csharp
// Установка цвета переднего плана области графика
chart.PlotArea.Area.ForegroundColor = Color.Blue;

// Установка цвета переднего плана области диаграммы
chart.ChartArea.Area.ForegroundColor = Color.Yellow;

// Установка цвета переднего плана для области 1-й серииКоллекция
chart.NSeries[0].Area.ForegroundColor = Color.Red;

// Установка цвета переднего плана области 1-й серииТочка сбора
chart.NSeries[0].Points[0].Area.ForegroundColor = Color.Cyan;

// Заливка области 2-й серииКоллекции градиентом
chart.NSeries[1].Area.FillFormat.SetOneColorGradient(Color.Lime, 1, Aspose.Cells.Drawing.GradientStyleType.Horizontal, 1);
```

В этом коде мы задаем различные цвета для разных частей диаграммы. Настройка внешнего вида может сделать ваши данные гораздо более интересными!

## Шаг 9: Измените цвета основных линий сетки

А теперь самое главное! Для улучшения читабельности мы изменим цвет основных линий сетки по обеим осям нашей диаграммы.

```csharp
// Установка серебристого цвета основных линий сетки осей категорий
chart.CategoryAxis.MajorGridLines.Color = Color.Silver;

// Установка красного цвета основных линий сетки оси значений
chart.ValueAxis.MajorGridLines.Color = Color.Red;
```

Эти команды устанавливают основные линии сетки для осей категорий и значений на серебряный и красный цвета соответственно. Такое различие гарантирует, что ваши зрители смогут легко следить за линиями сетки по всей диаграмме.

## Шаг 10: Сохраните рабочую книгу

После внесения всех изменений пришло время сохранить рабочую книгу. Это последний шаг, который принесет плоды вашим усилиям.

```csharp
// Сохранение файла Excel
workbook.Save(outputDir + "outputChangingMajorGridlinesInChart.xlsx");
```

Эта строка сохраняет ваш новый файл Excel в указанном выходном каталоге с именем, отражающим его назначение.

## Шаг 11: Подтверждающее сообщение

Наконец, добавим сообщение, подтверждающее, что наша задача выполнена успешно:

```csharp
Console.WriteLine("Changing Major Gridlines in Chart executed successfully.");
```

Этот простой вывод на консоль информирует вас о том, что ваша программа отработала правильно, без каких-либо сбоев.

## Заключение

И вот оно! Вы успешно научились изменять основные линии сетки в диаграмме с помощью Aspose.Cells для .NET. Следуя этому пошаговому руководству, вы не только программно манипулировали файлами Excel, но и улучшили их визуальную привлекательность с помощью настроек цвета. Не стесняйтесь экспериментировать дальше с Aspose.Cells, чтобы углубить свои навыки представления данных и сделать ваши диаграммы еще более динамичными!

## Часто задаваемые вопросы

### Что такое Aspose.Cells?  
Aspose.Cells — это библиотека .NET, предназначенная для программного создания, обработки и управления файлами Excel.

### Могу ли я попробовать Aspose.Cells бесплатно?  
 Да, вы можете зарегистрироваться на бесплатную пробную версию.[здесь](https://releases.aspose.com/).

### Как изменить другие элементы диаграммы с помощью Aspose.Cells?  
 Аналогичным образом можно настраивать различные свойства диаграммы, получая доступ к элементам диаграммы через`Chart` класс, такой как заголовки, легенды и метки данных.

### Какие форматы файлов поддерживает Aspose.Cells?  
Aspose.Cells поддерживает множество форматов файлов, включая XLSX, XLS, CSV и другие.

### Где я могу найти документацию по Aspose.Cells?  
 Подробную документацию можно найти по адресу[Документация Aspose.Cells](https://reference.aspose.com/cells/net/).
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
