---
title: Установить линии диаграммы
linktitle: Установить линии диаграммы
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как настраивать линии диаграммы в Excel с помощью Aspose.Cells для .NET, воспользовавшись нашим подробным пошаговым руководством.
weight: 14
url: /ru/net/setting-chart-appearance/set-chart-lines/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Установить линии диаграммы

## Введение

Создание визуально привлекательных и информативных диаграмм имеет важное значение в представлении данных. Независимо от того, являетесь ли вы аналитиком данных, бизнес-менеджером или просто любителем организовывать данные, диаграммы могут значительно улучшить способ представления информации. Это руководство проведет вас через процесс настройки линий диаграммы с помощью Aspose.Cells для .NET, мощной библиотеки для работы с файлами Excel. К концу вы узнаете, как создавать потрясающие диаграммы, наполненные настройками, чтобы сделать ваши данные Excel яркими!

## Предпосылки

Прежде чем приступить к написанию кода, убедитесь, что у вас есть следующее:

- Visual Studio: Убедитесь, что у вас установлена Visual Studio. Настоятельно рекомендуется использовать последнюю версию, чтобы использовать все функции.
- .NET Framework: Ваш проект должен быть основан на .NET Framework (или .NET Core), где вы будете реализовывать Aspose.Cells.
-  Aspose.Cells для .NET: Загрузите и установите Aspose.Cells с сайта[Сайт Aspose](https://releases.aspose.com/cells/net/).
- Базовые знания C#: знакомство с языком программирования C# будет полезно при написании кода.

## Импортные пакеты

Чтобы начать работу с Aspose.Cells, вам нужно импортировать необходимые пространства имен в ваш проект. Это позволит вам получить доступ ко всем интересным функциям и возможностям, которые предлагает Aspose.Cells. Вот как импортировать пакеты в ваш файл C#:

```csharp
using Aspose.Cells;
using Aspose.Cells.Charts;
using System.Drawing;
```

Давайте разобьем процесс на простые шаги, чтобы вам было легче его выполнять.

## Шаг 1: Определите выходной каталог

Прежде всего, вам понадобится место для сохранения вашего нового файла Excel. Определите выходной каталог в верхней части кода следующим образом:

```csharp
// Выходной каталог
string outputDir = "Your Output Directory";
```

 Объяснение: замените «Ваш выходной каталог» на путь, по которому Aspose.Cells должен сохранить файл, например:`C:\\MyExcelFiles\\`.

## Шаг 2: Создание экземпляра объекта Workbook

Теперь мы создадим объект рабочей книги, который будет служить контейнером для вашей электронной таблицы.

```csharp
// Создание объекта Workbook
Workbook workbook = new Workbook();
```

 Пояснение: Эта строка создает экземпляр`Workbook`класс из библиотеки Aspose.Cells. Это похоже на открытие нового пустого файла Excel, в который вы можете начать добавлять свои листы и данные.

## Шаг 3: Ссылка на рабочий лист

Далее вам нужно будет работать с определенным листом в вашей рабочей тетради. Мы возьмем первый рабочий лист.

```csharp
// Получение ссылки на недавно добавленный рабочий лист путем передачи его индекса листа
Worksheet worksheet = workbook.Worksheets[0];
```

 Пояснение: Рабочие листы индексируются, начиная с 0, поэтому`worksheets[0]` относится к первому рабочему листу.

## Шаг 4: Добавьте выборочные значения в ячейки

Давайте заполним некоторые ячейки данными, которые мы позже будем использовать для создания нашей диаграммы.

```csharp
// Добавление выборочных значений в ячейки
worksheet.Cells["A1"].PutValue(50);
worksheet.Cells["A2"].PutValue(100);
worksheet.Cells["A3"].PutValue(150);
worksheet.Cells["B1"].PutValue(60);
worksheet.Cells["B2"].PutValue(32);
worksheet.Cells["B3"].PutValue(50);
```

Пояснение: Здесь мы заполняем ячейки "A1" - "A3" и "B1" - "B3" некоторыми числовыми значениями. Они будут нанесены на нашу диаграмму позже.

## Шаг 5: Добавьте диаграмму на рабочий лист

Теперь пришло время создать диаграмму! Мы добавим столбчатую диаграмму.

```csharp
// Добавление диаграммы на рабочий лист
int chartIndex = worksheet.Charts.Add(Aspose.Cells.Charts.ChartType.Column, 5, 0, 25, 10);
```

Объяснение: Эта строка добавляет столбчатую диаграмму в определенных координатах на рабочем листе. Параметры определяют, где диаграмма будет нарисована на сетке.

## Шаг 6: Получите доступ к недавно добавленной диаграмме

Теперь вам нужно сослаться на только что созданную вами диаграмму.

```csharp
// Доступ к экземпляру недавно добавленной диаграммы
Aspose.Cells.Charts.Chart chart = worksheet.Charts[chartIndex];
```

Пояснение: Это дает вам контроль над экземпляром диаграммы, позволяя вам настраивать и стилизовать его дальше.

## Шаг 7: Добавьте ряд данных в диаграмму

Давайте добавим ряд данных для нашей диаграммы.

```csharp
// Добавление SeriesCollection (источник данных диаграммы) к диаграмме в диапазоне от ячейки «A1» до «B3»
chart.NSeries.Add("A1:B3", true);
```

Объяснение: Эта строка указывает диаграмме извлекать данные из указанного диапазона. Второй параметр указывает, включают ли диапазоны данных категории.

## Шаг 8: Настройте внешний вид диаграммы

А теперь самое интересное — настройка диаграммы! Давайте изменим некоторые цвета.

```csharp
// Установка цвета переднего плана области графика
chart.PlotArea.Area.ForegroundColor = Color.Blue;

// Установка цвета переднего плана области диаграммы
chart.ChartArea.Area.ForegroundColor = Color.Yellow;

// Установка цвета переднего плана для области 1-й серииКоллекция
chart.NSeries[0].Area.ForegroundColor = Color.Red;

// Установка цвета переднего плана области 1-й серииТочка сбора
chart.NSeries[0].Points[0].Area.ForegroundColor = Color.Cyan;

// Заливка области 2-й серииКоллекции градиентом
chart.NSeries[1].Area.FillFormat.SetOneColorGradient(Color.Lime, 1, Aspose.Cells.Drawing.GradientStyleType.Horizontal, 1);
```

Пояснение: Здесь вы настраиваете цвета различных компонентов диаграммы, чтобы сделать ее визуально яркой. Каждая линия нацелена на разные области диаграммы.

## Шаг 9: Применение стилей линий

Далее вы можете изменить стили линий для ваших рядов данных, чтобы сделать вашу диаграмму не только красивой, но и профессиональной.

```csharp
// Применение пунктирного стиля к линиям SeriesCollection
chart.NSeries[0].Border.Style = Aspose.Cells.Drawing.LineType.Dot;

// Применение треугольного стиля маркера к маркерам данных SeriesCollection
chart.NSeries[0].Marker.MarkerStyle = Aspose.Cells.Charts.ChartMarkerType.Triangle;

// Установка веса всех линий в SeriesCollection на средний
chart.NSeries[1].Border.Weight = Aspose.Cells.Drawing.WeightType.MediumLine;
```

Объяснение: Приведенный выше код настраивает границы ряда диаграммы, придавая ей пунктирную линию и даже изменяя маркеры точек данных на треугольники. Все дело в этом личном подходе!

## Шаг 10: Сохраните свою рабочую книгу

Теперь давайте сохраним результаты вашей тяжелой работы в файле Excel.

```csharp
// Сохранение файла Excel
workbook.Save(outputDir + "outputSettingChartLines.xlsx");
```

Объяснение: Эта строка сохраняет вашу рабочую книгу с указанным именем в указанном вами выходном каталоге. Теперь вы можете открыть ее и увидеть вашу классную диаграмму!

## Шаг 11: Подтверждение выполнения

Наконец, давайте убедимся, что все прошло гладко.

```csharp
Console.WriteLine("SettingChartLines executed successfully.");
```

Пояснение: Простое сообщение, информирующее о том, что ваш код выполнен без каких-либо проблем.

## Заключение

Поздравляем! Теперь вы освоили основы создания и настройки диаграмм с помощью Aspose.Cells для .NET. Всего за несколько простых шагов вы можете улучшить представление данных, сделав его более понятным и визуально привлекательным. Экспериментируя с другими вариантами настройки, помните, что отличная диаграмма не только рассказывает историю, но и привлекает вашу аудиторию.

## Часто задаваемые вопросы

### Что такое Aspose.Cells для .NET?  
Aspose.Cells для .NET — мощная библиотека для работы с электронными таблицами Excel в приложениях .NET.

### Могу ли я использовать Aspose.Cells бесплатно?  
 Да, Aspose предоставляет бесплатную пробную версию для проверки функциональности. Вы можете загрузить ее[здесь](https://releases.aspose.com/).

### Доступна ли поддержка Aspose.Cells?  
 Конечно! Вы можете получить поддержку через[Форум Aspose](https://forum.aspose.com/c/cells/9).

### Могу ли я создавать другие типы диаграмм с помощью Aspose.Cells?  
Да, Aspose поддерживает различные типы диаграмм, включая линейные, круговые и площадные диаграммы.

### Как получить временную лицензию для Aspose.Cells?  
 Вы можете подать заявку на[временная лицензия](https://purchase.aspose.com/temporary-license/) через веб-сайт Aspose.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
