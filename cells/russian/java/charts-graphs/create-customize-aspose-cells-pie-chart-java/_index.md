---
"date": "2025-04-08"
"description": "Научитесь создавать и настраивать круговые диаграммы с помощью Aspose.Cells для Java. Пошаговое руководство с примерами кода для разработчиков."
"title": "Освоение Aspose.Cells&#58; Создание и настройка круговых диаграмм в Java"
"url": "/ru/java/charts-graphs/create-customize-aspose-cells-pie-chart-java/"
"weight": 1
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}


# Освоение Aspose.Cells: создание и настройка круговых диаграмм в Java

## Введение
Создание визуально привлекательных диаграмм является обычным требованием при работе с визуализацией данных в Excel. Независимо от того, представляете ли вы демографическую информацию или анализируете рыночные тенденции, круговые диаграммы предлагают понятный способ представления пропорциональных данных. Однако программная настройка этих диаграмм может быть сложной. Это руководство проведет вас через создание и настройку круговой диаграммы Aspose.Cells с помощью Java, упрощая процесс для разработчиков.

**Что вы узнаете:**
- Настройте свою среду с помощью Aspose.Cells для Java.
- Создайте новую рабочую книгу и получите доступ к ячейкам рабочего листа.
- Заполните данные в определенных ячейках, чтобы подготовиться к созданию диаграммы.
- Создайте круговую диаграмму на основе этих данных.
- Настройте внешний вид круговой диаграммы, включая цвета, заголовки и легенды.

Прежде чем погрузиться, убедитесь, что у вас есть базовые знания программирования Java и управления зависимостями Maven или Gradle. Давайте настроим нашу среду!

## Предпосылки
Для прохождения этого урока вам понадобится:
- **Комплект разработчика Java (JDK)**: Версия 8 или выше.
- **Интегрированная среда разработки (IDE)**: Например, IntelliJ IDEA или Eclipse.
- **Управление зависимостью**: Используйте Maven или Gradle для управления зависимостями.

### Необходимые библиотеки и зависимости
Обязательно включите Aspose.Cells для Java в свой проект, используя Maven или Gradle.

**Знаток**
```xml
<dependency>
    <groupId>com.aspose</groupId>
    <artifactId>aspose-cells</artifactId>
    <version>25.3</version>
</dependency>
```

**Градл**
```gradle
implementation 'com.aspose:aspose-cells:25.3'
```

### Этапы получения лицензии
Aspose.Cells для Java — это коммерческая библиотека, но вы можете начать с бесплатной пробной версии или подать заявку на временную лицензию. Посетите [страница покупки](https://purchase.aspose.com/buy) изучить варианты лицензирования.

## Настройка Aspose.Cells для Java
Во-первых, убедитесь, что ваша проектная среда включает необходимые библиотеки, добавив их через Maven или Gradle, как показано выше. После включения вы можете инициализировать Aspose.Cells:

```java
import com.aspose.cells.Workbook;

// Инициализировать новый экземпляр рабочей книги
Workbook workbook = new Workbook();
```

## Руководство по внедрению

### Создание и настройка рабочей книги
Создание рабочей книги — это первый шаг, на котором вы настроите свои данные.

#### Импорт библиотек
Убедитесь, что эти импорты включены в начало вашего файла:

```java
import com.aspose.cells.Workbook;
import com.aspose.cells.Worksheet;
import com.aspose.cells.Cells;
import com.aspose.cells.ChartType;
import com.aspose.cells.Chart;
import com.aspose.cells.Series;
import com.aspose.cells.Color;
import com.aspose.cells.LegendPositionType;
import com.aspose.cells.SaveFormat;
```

#### Шаг 1: Создание экземпляра рабочей книги
```java
// Создает пустой экземпляр рабочей книги для работы.
Workbook workbook = new Workbook();
```
На этом этапе файл Excel программно инициализируется, что позволяет вам управлять им с помощью функций Aspose.Cells.

### Доступ к ячейкам рабочего листа или их изменение
Затем заполните ячейки рабочего листа данными, которые будут использоваться для круговой диаграммы.

#### Шаг 2: Доступ к рабочему листу и его ячейкам
```java
// Откройте первый рабочий лист в рабочей книге.
Worksheet worksheet = workbook.getWorksheets().get(0);
Cells cells = worksheet.getCells();

// Поместите образцы значений, используемые для круговой диаграммы, в определенные ячейки.
cells.get("C3").putValue("India");
cells.get("C4").putValue("China");
cells.get("C5").parseNumber("United States", true, null);
cells.get("C6").setValue("Russia");
cells.get("C7").setValue("United Kingdom");
cells.get("C8").setValue("Others");

// Введите процентные значения для круговой диаграммы в определенные ячейки.
cells.get("D2").putValue("% of world population");
cells.get("D3").putValue(25);
cells.get("D4").putValue(30);
cells.get("D5").putValue(10);
cells.get("D6").putValue(13);
cells.get("D7").putValue(9);
cells.get("D8").putValue(13);
```
Здесь вы заполняете рабочий лист данными, которые будут представлять различные сегменты круговой диаграммы.

### Создать круговую диаграмму

#### Шаг 3: Добавьте круговую диаграмму на рабочий лист.
```java
// Создайте на рабочем листе круговую диаграмму.
int pieIdx = worksheet.getCharts().add(ChartType.PIE, 1, 6, 15, 14);
Chart pie = worksheet.getCharts().get(pieIdx);
```
На этом этапе на рабочий лист добавляется новая круговая диаграмма в указанных позициях и размерах.

### Настройка рядов и данных круговой диаграммы

#### Шаг 4: Установите серию для диаграммы
```java
// Настройте диапазон данных серии для диаграммы.
pie.getNSeries().add("D3:D8", true);
pie.getNSeries().setCategoryData("=Sheet1!$C$3:$C$8");

// Свяжите заголовок круговой диаграммы с ячейкой, содержащей текст заголовка.
pie.getTitle().setLinkedSource("D2");
```
Этот код связывает диапазон данных и настраивает ряд для круговой диаграммы.

### Настройте внешний вид легенды и заголовка диаграммы

#### Шаг 5: Настройте легенду и заголовок диаграммы
```java
// Установите положение легенды внизу диаграммы.
pie.getLegend().setPosition(LegendPositionType.BOTTOM);

// Задайте свойства шрифта для заголовка диаграммы.
pie.getTitle().getFont().setName("Calibri");
pie.getTitle().getFont().setSize(18);
```
Настройка внешнего вида повышает читабельность и визуальную привлекательность.

### Настройте цвета серии диаграмм

#### Шаг 6: Измените цвета сегментов круговой диаграммы
```java
import com.aspose.cells.Color;

// Доступ и настройка цветов отдельных сегментов круговой диаграммы.
Series srs = pie.getNSeries().get(0);
srs.getPoints().get(0).getArea().setForegroundColor(Color.fromArgb(0, 246, 22, 219));
srs.getPoints().get(1).getArea().setForegroundColor(Color.fromArgb(0, 51, 34, 84));
srs.getPoints().get(2).getArea().setForegroundColor(Color.fromArgb(0, 46, 74, 44));
srs.getPoints().get(3).getArea().setForegroundColor(Color.fromArgb(0, 19, 99, 44));
srs.getPoints().get(4).getArea().setForegroundColor(Color.fromArgb(0, 208, 223, 7));
srs.getPoints().get(5).getArea().setForegroundColor(Color.fromArgb(0, 222, 69, 8));
```
Эти настройки персонализируют вашу диаграмму в соответствии с определенными цветовыми схемами.

### Автоматическая подгонка столбцов и сохранение рабочей книги

#### Шаг 7: Отрегулируйте ширину столбцов и сохраните файл.
```java
// Автоматический подбор всех столбцов.
worksheet.autoFitColumns();

// Определите путь-заполнитель выходного каталога для сохранения рабочей книги.
String outDir = "YOUR_OUTPUT_DIRECTORY";

// Сохраните измененную книгу в файле Excel в указанном каталоге.
workbook.save(outDir + "/CSOrSColorsPieChart_out.xlsx", SaveFormat.XLSX);
```
Наконец, выполните автоматическую подгонку столбцов и сохраните книгу.

## Практические применения
1. **Демографический анализ**: Используйте круговые диаграммы для отображения распределения населения по разным странам или регионам.
2. **Отчеты о доле рынка**: проиллюстрировать долю рынка различных компаний в секторе.
3. **Распределение бюджета**: Визуализируйте, как распределяются бюджеты между различными отделами организации.

Эти приложения демонстрируют универсальность и полезность Aspose.Cells в реальных сценариях.

## Соображения производительности
Для оптимизации производительности при использовании Aspose.Cells:
- Минимизируйте использование памяти, избавляясь от ненужных объектов.
- Используйте эффективные структуры данных для обработки больших наборов данных.
- Профилируйте свое приложение, чтобы выявить узкие места.

Соблюдение передовых практик обеспечивает бесперебойную и эффективную работу приложений.

## Заключение
В этом руководстве вы прошли по шагам создания и настройки круговой диаграммы с помощью Aspose.Cells в Java. С этими знаниями вы теперь можете применять эти методы для различных задач визуализации данных в своих проектах. Для дальнейшего изучения рассмотрите возможность погружения в дополнительные типы диаграмм и расширенные параметры настройки, доступные в Aspose.Cells.


{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}