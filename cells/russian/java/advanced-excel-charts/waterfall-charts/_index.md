---
date: 2025-12-10
description: Изучите, как создать водопадную диаграмму в Java с помощью Aspose.Cells.
  Пошаговое руководство по добавлению диаграммы на лист, её настройке и сохранению
  книги в формате XLSX.
linktitle: Waterfall Charts
second_title: Aspose.Cells Java Excel Processing API
title: Как создать водопадную диаграмму с помощью Aspose.Cells для Java
url: /ru/java/advanced-excel-charts/waterfall-charts/
weight: 18
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Водопадные диаграммы

## Введение в водопадные диаграммы с использованием Aspose.Cells для Java

В этом руководстве вы узнаете, как **создать водопадную диаграмму** с помощью Aspose.Cells для Java. Водопадные диаграммы являются важным инструментом визуализации данных, поскольку позволяют увидеть совокупный эффект серии положительных и отрицательных значений. Независимо от того, готовите ли вы финансовый отчёт, отчёт о продажах или любой другой анализ, основанный на данных, водопадная диаграмма может превратить сырые цифры в понятные, практические выводы.

## Быстрые ответы
- **Что такое водопадная диаграмма?** Визуальное представление, показывающее, как начальное значение увеличивается и уменьшается серией промежуточных значений, завершаясь конечным итогом.  
- **Какая библиотека используется?** Aspose.Cells for Java.  
- **Нужна ли лицензия?** Бесплатная пробная версия подходит для разработки; для продакшн требуется коммерческая лицензия.  
- **Можно ли сохранить файл как XLSX?** Да — используйте `workbook.save("FileName.xlsx")`.  
- **Подходит ли она для визуализации данных в Java?** Абсолютно; Aspose.Cells предоставляет расширенные возможности построения диаграмм без необходимости установки Office.

## Что такое водопадная диаграмма?
Водадная диаграмма отображает последовательные положительные и отрицательные вклады к исходному значению, помогая понять, как каждый компонент влияет на общий результат.

## Почему стоит использовать Aspose.Cells для Java для добавления водопадной диаграммы?
- **Не требуется Microsoft Excel** — генерируйте диаграммы на любом сервере или в CI‑конвейере.  
- **Полный контроль над форматированием** — цвета, подписи данных и оси можно настраивать программно.  
- **Поддерживает несколько форматов вывода** — XLSX, PDF, HTML и другие.  
- **Высокая производительность** — идеально подходит для больших книг и автоматизированных отчётов.

## Предварительные требования

Прежде чем погрузиться в код, убедитесь, что у вас есть следующие предварительные требования:

- Aspose.Cells for Java: Вам необходимо установить Aspose.Cells for Java. Скачать его можно [здесь](https://releases.aspose.com/cells/java/).
- Среда разработки Java: Убедитесь, что Java установлена в вашей системе.

Теперь давайте пошагово начнём создавать водопадную диаграмму.

## Как создать водопадную диаграмму в Java

### Шаг 1: Импортировать Aspose.Cells

```java
import com.aspose.cells.*;
```

Сначала вам нужно импортировать библиотеку Aspose.Cells в ваш Java‑проект. Эта библиотека предоставляет обширный набор функций для работы с файлами Excel, включая создание диаграмм.

### Шаг 2: Инициализировать Workbook и Worksheet

```java
Workbook workbook = new Workbook();
Worksheet worksheet = workbook.getWorksheets().get(0);
```

Создайте новую книгу и добавьте в неё лист. Мы будем использовать этот лист для ввода данных и **добавления диаграммы на лист**.

### Шаг 3: Ввести данные

Теперь давайте заполним лист данными, которые мы хотим отобразить в водопадной диаграмме.

```java
Cells cells = worksheet.getCells();

// Insert data
cells.get("A1").putValue("Categories");
cells.get("A2").putValue("Start");
cells.get("A3").putValue("Positive Value 1");
cells.get("A4").putValue("Negative Value 1");
cells.get("A5").putValue("Positive Value 2");
cells.get("A6").putValue("End");

cells.get("B1").putValue("Values");
cells.get("B2").putValue(0);
cells.get("B3").putValue(20);
cells.get("B4").putValue(-10);
cells.get("B5").putValue(15);
cells.get("B6").putValue(25);
```

В этом примере категории находятся в столбце A, а соответствующие значения — в столбце B. Вы можете заменить эти данные своим набором.

### Шаг 4: Создать водопадную диаграмму

```java
int chartIndex = worksheet.getCharts().add(ChartType.WATERFALL, 5, 0, 15, 5);
Chart waterfallChart = worksheet.getCharts().get(chartIndex);
waterfallChart.getNSeries().add("B2:B6", true);
waterfallChart.getNSeries().setCategoryData("A2:A6");
```

Мы добавили водопадную диаграмму на наш лист, указали серию данных и данные категорий. Это основной шаг, который **добавляет водопадную диаграмму** на ваш лист. Вы можете дополнительно настроить внешний вид диаграммы (цвета, подписи данных и т.д.) с помощью свойств объекта `Chart`.

### Шаг 5: Сохранить книгу

```java
workbook.save("WaterfallChart.xlsx");
```

Сохраните книгу в файл. В примере используется формат XLSX, но Aspose.Cells также позволяет экспортировать в PDF, CSV и многие другие форматы. Это удовлетворяет требование **save workbook xlsx**.

## Распространённые проблемы и решения
- **Диаграмма отображается пустой** — Убедитесь, что ссылки на диапазоны данных (`B2:B6` и `A2:A6`) соответствуют фактическим ячейкам с вашими значениями и категориями.  
- **Отрицательные значения отображаются некорректно** — Убедитесь, что тип серии установлен как `ChartType.WATERFALL`; другие типы диаграмм обрабатывают отрицательные значения иначе.  
- **Файл не открывается в Excel** — Убедитесь, что вы используете актуальную версию Aspose.Cells (последний релиз) и что расширение файла соответствует формату (`.xlsx` для Excel).

## Часто задаваемые вопросы

### Как я могу настроить внешний вид моей водопадной диаграммы?
Вы можете настроить внешний вид вашей водопадной диаграммы, изменяя свойства, такие как цвета, подписи данных и подписи осей. Обратитесь к документации Aspose.Cells для подробных инструкций.

### Могу ли я создать несколько водопадных диаграмм на одном листе?
Да, вы можете создать несколько водопадных диаграмм на одном листе, следуя тем же шагам с разными диапазонами данных.

### Совместима ли Aspose.Cells с различными средами разработки Java?
Да, Aspose.Cells для Java совместима с различными средами разработки Java, включая Eclipse, IntelliJ IDEA и NetBeans.

### Могу ли я добавить дополнительные серии данных в мою водопадную диаграмму?
Конечно, вы можете добавить дополнительные серии данных в вашу водопадную диаграмму, чтобы эффективно представлять сложные сценарии данных.

### Где я могу найти больше ресурсов и примеров для Aspose.Cells для Java?
Вы можете изучить документацию Aspose.Cells для Java по адресу [reference.aspose.com/cells/java/](https://reference.aspose.com/cells/java/) для получения подробной информации и примеров кода.

---

**Последнее обновление:** 2025-12-10  
**Тестировано с:** Aspose.Cells for Java 24.12 (latest)  
**Автор:** Aspose  

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}