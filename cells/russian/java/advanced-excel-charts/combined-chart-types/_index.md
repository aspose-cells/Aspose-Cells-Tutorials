---
date: 2025-12-06
description: Узнайте, как добавить серии данных, создать комбинированные типы диаграмм,
  сохранить книгу Excel и экспортировать диаграмму в PNG с помощью Aspose.Cells для
  Java.
linktitle: Add data series to create combined chart using Aspose.Cells
second_title: Aspose.Cells Java Excel Processing API
title: Добавьте серию данных для создания комбинированной диаграммы с помощью Aspose.Cells
url: /ru/java/advanced-excel-charts/combined-chart-types/
weight: 12
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Добавление серии данных для создания комбинированной диаграммы с использованием Aspose.Cells

В этом руководстве вы **добавите серию данных** в книгу Excel и узнаете, как **создавать комбинированные типы диаграмм** с помощью Aspose.Cells for Java. Мы пройдем каждый шаг — от настройки книги, добавления серий, настройки легенды, до **сохранения книги Excel** и экспорта **диаграммы в PNG**. В конце у вас будет готовая комбинированная диаграмма, которую можно встроить в отчёты или панели мониторинга.

## Быстрые ответы
- **Какая библиотека создаёт комбинированные диаграммы?** Aspose.Cells for Java  
- **Как добавить серию данных?** Используйте `chart.getNSeries().add(...)`  
- **Можно ли экспортировать диаграмму как изображение?** Да, с помощью `chart.toImage(...)` (PNG)  
- **В каком формате можно сохранить книгу?** Стандартный `.xlsx` (Excel)  
- **Нужна ли лицензия для продакшн?** Требуется действующая лицензия Aspose.Cells  

## Что такое **add data series** в Aspose.Cells?
Добавление серии данных указывает диаграмме, какие ячейки содержат значения, которые вы хотите отобразить. Каждая серия может представлять линию, столбец или любой другой тип диаграммы, и их можно комбинировать для создания **комбинированной диаграммы**.

## Зачем создавать **комбинированную диаграмму**?
Комбинированная диаграмма позволяет отображать разные наборы данных с различными визуальными представлениями (например, линейную серию поверх столбцовой) в одном окне. Это идеально для сравнения тенденций с общими итогами, выделения корреляций или предоставления более глубоких инсайтов в компактном формате.

## Требования
- Java Development Kit (JDK) 8 или выше  
- Библиотека Aspose.Cells for Java (скачайте по ссылке ниже)  
- Базовые знания синтаксиса Java и концепций Excel  

## Начало работы

Сначала скачайте библиотеку Aspose.Cells for Java с официального сайта:

[Download Aspose.Cells for Java](https://releases.aspose.com/cells/java/)

После того как JAR будет добавлен в classpath вашего проекта, вы можете начать создавать диаграмму.

### Шаг 1: Импортировать классы Aspose.Cells
```java
import com.aspose.cells.*;
```

### Шаг 2: Создать новую книгу
```java
Workbook workbook = new Workbook();
```

### Шаг 3: Получить доступ к первому листу
```java
Worksheet worksheet = workbook.getWorksheets().get(0);
```

### Шаг 4: Добавить объект комбинированной диаграммы  
Мы начнём с линейной диаграммы и позже добавим другие серии, чтобы достичь эффекта **комбинированной диаграммы**.
```java
int chartIndex = worksheet.getCharts().add(ChartType.LINE, 0, 0, 20, 10);
Chart chart = worksheet.getCharts().get(chartIndex);
```

## Добавление данных в диаграмму

Теперь, когда контейнер диаграммы создан, нам нужно заполнить его данными.

### Шаг 5: Определить диапазоны данных и **добавить серию данных**
```java
Cells cells = worksheet.getCells();
chart.getNSeries().add("A1:A5", true);
chart.getNSeries().add("B1:B5", true);
```
> **Совет:** Первый параметр (`"A1:A5"`) — диапазон для первой серии, а второй (`"B1:B5"`) создаёт вторую серию, которая будет комбинирована с первой.

### Шаг 6: Установить данные категорий (ось X)
```java
chart.getNSeries().setCategoryData("C1:C5");
```

## Настройка диаграммы

Хорошая диаграмма рассказывает историю. Давайте добавим заголовки, подписи осей и понятную легенду.

### Шаг 7: Установить заголовок диаграммы и подписи осей
```java
chart.getTitle().setText("Combined Chart Example");
chart.getCategoryAxis().getTitle().setText("Categories");
chart.getValueAxis().getTitle().setText("Values");
```

### Шаг 8: **Добавить легенду к диаграмме** и скорректировать её позицию
```java
chart.getLegend().setPosition(LegendPositionType.BOTTOM);
chart.getLegend().setOverlay(true);
```

## Сохранение и экспорт диаграммы

После настройки вы захотите **сохранить книгу Excel** и также создать изображение.

### Шаг 9: Сохранить книгу в файл Excel
```java
workbook.save("CombinedChart.xlsx");
```

### Шаг 10: Экспортировать **диаграмму в PNG**
```java
chart.toImage("CombinedChart.png", ImageFormat.getPng());
```
> Метод `chart.toImage` **создаёт изображения диаграмм Excel**, которые можно использовать в веб‑страницах, отчётах или электронных письмах.

## Распространённые проблемы и их решение

| Проблема | Решение |
|----------|---------|
| **Нет данных** | Убедитесь, что диапазоны ячеек (`A1:A5`, `B1:B5`, `C1:C5`) действительно содержат данные перед созданием диаграммы. |
| **Легенда перекрывает диаграмму** | Установите `chart.getLegend().setOverlay(false)` или переместите легенду в другое положение (например, `RIGHT`). |
| **Файл изображения пустой** | Убедитесь, что у диаграммы есть хотя бы одна серия и что `chart.toImage` вызывается после всех настроек. |
| **Ошибка при сохранении** | Проверьте, что у вас есть права записи в целевую директорию и что файл не открыт в Excel. |

## Часто задаваемые вопросы

**В: Как установить Aspose.Cells for Java?**  
О: Скачайте JAR с официального сайта и добавьте его в classpath вашего проекта. Ссылка для загрузки: [Download Aspose.Cells for Java](https://releases.aspose.com/cells/java/).

**В: Можно ли создавать другие типы диаграмм, кроме линейных и столбцовых?**  
О: Да, Aspose.Cells поддерживает гистограммы, круговые, точечные, областные и многие другие типы диаграмм. Обратитесь к документации API для полного списка.

**В: Требуется ли лицензия для использования в продакшн?**  
О: Для продакшн‑развёртываний требуется действующая лицензия Aspose.Cells. Доступна бесплатная пробная версия для оценки.

**В: Как изменить цвета каждой серии?**  
О: После добавления серии используйте `chart.getNSeries().get(i).setAreaColor(Color.getRed())` (или аналогичный метод).

**В: Где найти больше примеров кода?**  
О: Полная документация и дополнительные примеры доступны на сайте справки Aspose: [here](https://reference.aspose.com/cells/java/).

---

**Last Updated:** 2025-12-06  
**Tested With:** Aspose.Cells for Java 24.12  
**Author:** Aspose  

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
