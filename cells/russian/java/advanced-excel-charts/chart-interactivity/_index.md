---
date: 2026-02-09
description: Узнайте, как добавить подписи данных к диаграмме Excel и изменить тип
  диаграммы с помощью Aspose.Cells for Java, а также добавить подсказки и интерактивность
  drill‑down.
linktitle: Change Excel Chart Type
second_title: Aspose.Cells Java Excel Processing API
title: Добавьте подписи данных к диаграмме Excel с помощью Aspose.Cells Java
url: /ru/java/advanced-excel-charts/chart-interactivity/
weight: 19
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Добавление подписей данных к диаграмме Excel и изменение типа диаграммы – Aspose.Cells Java

Интерактивные диаграммы придают вашим отчетам Excel новый уровень аналитики, а **добавление подписей данных к диаграмме Excel** делает информацию мгновенно читаемой. В этом руководстве вы узнаете, как **добавить подписи данных к диаграмме Excel**, изменить тип диаграммы и создать интерактивные решения на Java с помощью Aspose.Cells. Мы также покажем, как добавить всплывающие подсказки и простую гиперссылку‑drill‑down, чтобы ваша аудитория могла глубже исследовать данные.

## Быстрые ответы
- **Какая библиотека используется?** Aspose.Cells for Java  
- **Можно ли изменить тип диаграммы?** Да – просто измените перечисление `ChartType`, когда создаёте диаграмму.  
- **Как добавить всплывающие подсказки к диаграмме?** Используйте API подписи данных (`setHasDataLabels(true)`) и включите отображение значений.  
- **Поддерживается ли drill‑down?** Вы можете привязать гиперссылки к точкам данных для базового поведения drill‑down.  
- **Требования?** Java IDE, Aspose.Cells JAR и файл Excel с примерными данными.

## Требования

Прежде чем начать, убедитесь, что у вас есть следующее:

- Среда разработки Java (рекомендовано JDK 8+)  
- Библиотека Aspose.Cells for Java (скачать можно [здесь](https://releases.aspose.com/cells/java/))  
- Пример рабочей книги (`data.xlsx`) с данными, которые вы хотите визуализировать  

## Шаг 1: Настройка Java‑проекта

1. Создайте новый Java‑проект в любимой IDE (IntelliJ IDEA, Eclipse и т.д.).  
2. Добавьте Aspose.Cells JAR в путь сборки проекта или в зависимости Maven/Gradle.

## Шаг 2: Загрузка данных

Чтобы работать с диаграммами, сначала необходимо загрузить рабочую книгу в память.

```java
// Load the Excel file
Workbook workbook = new Workbook("data.xlsx");
Worksheet worksheet = workbook.getWorksheets().get(0);
```

## Шаг 3: Создание диаграммы (и изменение её типа)

Вы можете выбрать любой тип диаграммы, подходящий для вашего анализа. Ниже мы создаём **столбчатую диаграмму**, но легко переключиться на линейную, круговую или гистограмму, изменив перечисление `ChartType`.

```java
// Create a column chart
int chartIndex = worksheet.getCharts().add(ChartType.COLUMN, 5, 0, 15, 5);
Chart chart = worksheet.getCharts().get(chartIndex);
```

> **Pro tip:** Чтобы **изменить тип диаграммы Excel**, замените `ChartType.COLUMN` на `ChartType.LINE`, `ChartType.PIE` и т.д.

## Шаг 4: Добавление интерактивности

### 4.1. Добавление всплывающих подсказок (Add Tooltips to Chart)

Всплывающие подсказки появляются, когда пользователь наводит курсор на точку данных. Следующий код включает подписи данных и отображает значение в виде подсказки.

```java
// Enable tooltips for data points
chart.getNSeries().get(0).getPoints().setHasDataLabels(true);
chart.getNSeries().get(0).getPoints().getDataLabels().setShowValue(true);
```

### 4.2. Добавление подписей данных – **add data labels to excel chart**

Подписи данных предоставляют постоянный визуальный индикатор непосредственно на диаграмме. Вы можете отображать их в виде выноски для лучшей читаемости.

```java
// Enable data labels for data points
chart.getNSeries().get(0).getPoints().setHasDataLabels(true);
chart.getNSeries().get(0).getPoints().getDataLabels().setShowLabelAsDataCallout(true);
```

> **Почему стоит добавлять подписи данных?** Размещение подписей данных непосредственно на диаграмме устраняет необходимость наведения курсора или угадывания значений, повышая ясность отчёта.

### 4.3. Реализация drill‑down (гиперссылка на точку данных)

Простой способ добавить возможность drill‑down – привязать гиперссылку к конкретной точке. При щелчке по точке откроется веб‑страница с подробной информацией.

```java
// Add a hyperlink to a data point
String url = "https://example.com/data-details";
chart.getNSeries().get(0).getPoints().get(0).getHyperlinks().add(url);
```

## Шаг 5: Сохранение рабочей книги

После настройки диаграммы сохраните рабочую книгу, чтобы интерактивные функции были сохранены в выходном файле.

```java
// Save the workbook
workbook.save("interactive_chart_output.xlsx");
```

## Распространённые проблемы и решения

| Проблема | Решение |
|----------|---------|
| **Всплывающие подсказки не отображаются** | Убедитесь, что `setHasDataLabels(true)` вызывается до настройки `setShowValue(true)`. |
| **Гиперссылка не кликабельна** | Проверьте, что выбранный формат вывода поддерживает гиперссылки (например, XLSX, а не CSV). |
| **Тип диаграммы не меняется** | Дважды проверьте, что вы изменили правильное перечисление `ChartType` при добавлении диаграммы. |

## Часто задаваемые вопросы

**В: Как изменить тип диаграммы после её создания?**  
О: Нужно создать новую диаграмму с нужным `ChartType`. Aspose.Cells не предоставляет преобразование типа «на месте», поэтому удалите старую диаграмму и добавьте новую.

**В: Можно ли настроить внешний вид всплывающих подсказок?**  
О: Да. Используйте свойства `DataLabel`, такие как `setFontSize`, `setFontColor` и `setBackgroundColor`, чтобы стилизовать текст подсказки.

**В: Как обрабатывать пользовательские взаимодействия в веб‑приложении?**  
О: Экспортируйте рабочую книгу в HTML или XLSX и используйте JavaScript на клиенте для захвата событий клика по элементам диаграммы.

**В: Где найти больше примеров и документацию?**  
О: Посетите [Aspose.Cells Java API Reference](https://reference.aspose.com/cells/java/) для полного списка классов и методов, связанных с диаграммами.

## Заключение

Теперь вы знаете, как **добавить подписи данных к диаграмме Excel**, **изменить тип диаграммы Excel**, **создать интерактивные решения на Java для диаграмм**, а также обогатить их всплывающими подсказками, подписями данных и гиперссылками drill‑down с помощью Aspose.Cells for Java. Эти улучшения делают ваши Excel‑отчёты гораздо более привлекательными и информативными для конечных пользователей.

---

**Последнее обновление:** 2026-02-09  
**Тестировано с:** Aspose.Cells for Java 24.12  
**Автор:** Aspose  

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}